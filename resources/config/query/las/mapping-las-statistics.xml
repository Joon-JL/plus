<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.1.dtd">

<queryservice>
	<queries>

		<!-- 담당자 배정 현황 -->

		<query id="las.statistics.listStatistics" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
            	SELECT *                                           
                  FROM(                                            
                    SELECT ROWNUM RM                               
                          ,COUNT(1) OVER() TOTAL_CNT               
                          ,A.*                                     
                      FROM ( 		    
							SELECT  
							        RESPMAN_ID RESPMAN_ID, 
							        RESPMAN_NM RESPMAN_NM, 
							        SUM(ISNULL(TOTCNT,0)) TOTCNT, 
							        SUM(ISNULL(AA,0)) CNCLSNPURPS_BIGCLSFCN1, 
							        SUM(ISNULL(BB,0)) CNCLSNPURPS_BIGCLSFCN2, 
							        SUM(ISNULL(CC,0)) CNCLSNPURPS_BIGCLSFCN3, 
							        SUM(ISNULL(DD,0)) CNCLSNPURPS_BIGCLSFCN4,
							        SUM(ISNULL(EE,0)) CNCLSNPURPS_BIGCLSFCN5, 
							        SUM(ISNULL(FF,0)) CNCLSNPURPS_BIGCLSFCN6, 
							        SUM(ISNULL(GG,0)) CNCLSNPURPS_BIGCLSFCN7,   
							        SUM(ISNULL(HH,0)) CNCLSNPURPS_BIGCLSFCN8,
							        SUM(ISNULL(II,0)) CNCLSNPURPS_BIGCLSFCN9,
							        SUM(ISNULL(JJ,0)) CNCLSNPURPS_BIGCLSFCN10,
							        SUM(ISNULL(KK,0)) CNCLSNPURPS_BIGCLSFCN11,
							        SUM(ISNULL(LL,0)) CNCLSNPURPS_BIGCLSFCN12,
							        SUM(ISNULL(MM,0)) CNCLSNPURPS_BIGCLSFCN13,
							        SUM(ISNULL(TOTCNT,0)) + SUM(ISNULL(TOTCNT2,0)) TOTCNT1,  
							        SUM(ISNULL(TOTCNT2,0)) TOTCNT2   
							FROM        
									(        
									SELECT
										    D.RESPMAN_ID, 
										    D.RESPMAN_NM,        				
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0301'  THEN  1 ELSE 0 END) AA,  
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0302'  THEN  1 ELSE 0 END) BB, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0303'  THEN  1 ELSE 0 END) CC, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0304'  THEN  1 ELSE 0 END) DD, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0305'  THEN  1 ELSE 0 END) EE, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0306'  THEN  1 ELSE 0 END) FF, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0307'  THEN  1 ELSE 0 END) GG, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0308'  THEN  1 ELSE 0 END) HH, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0309'  THEN  1 ELSE 0 END) II, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0310'  THEN  1 ELSE 0 END) JJ, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0311'  THEN  1 ELSE 0 END) KK, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0312'  THEN  1 ELSE 0 END) LL, 
										    SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0313'  THEN  1 ELSE 0 END) MM,                                               
										    COUNT(A.CNTRT_ID) TOTCNT,
										    0 TOTCNT2			
									FROM 	TN_CLM_CONTRACT_MASTER A,
											TN_CLM_CONTRACT_CNSD B,
											TN_CLM_CONT_CNSDREQ C,
											TN_CLM_CONT_CNSDREQ_RESPMAN D
									WHERE   A.DEL_YN = 'N'
									
									AND A.COMP_CD = :vo.session_comp_cd

									#if ($vo.dmstfrgn_gbn && $vo.dmstfrgn_gbn.equals("H")) 
										AND	  A.REGION_GBN = 'C01801'
									#elseif ($vo.dmstfrgn_gbn && $vo.dmstfrgn_gbn.equals("F")) 
										AND	  A.REGION_GBN = 'C01802'
									#end			                		
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end 
			                		AND     A.CNTRT_ID = B.CNTRT_ID
			                		AND     B.CNSDREQ_ID = C.CNSDREQ_ID		 
			                		AND     C.CNSDREQ_ID = D.CNSDREQ_ID               										
									GROUP BY D.RESPMAN_ID,
									         D.RESPMAN_NM          
									UNION ALL
									SELECT        
										A.RESPMAN_ID, 
										A.RESPMAN_NM,   
										0 AA,
										0 BB,
										0 CC,
										0 DD,
										0 EE,
										0 FF,
										0 GG,
										0 HH,
										0 II,
										0 JJ,
										0 KK,
										0 LL,
										0 MM,     	
										0 TOTCNT,									
										ISNULL(COUNT(A.CNSLT_NO),0) TOTCNT2
									FROM        
										(        
										SELECT  A.CNSLT_NO, 
										        B.RESPMAN_ID, 
										        B.RESPMAN_NM
										FROM    TN_LAS_CONSULT  A, 
										        TN_LAS_CONSULT_RESPMAN B 
										WHERE   A.CNSLT_NO = B.CNSLT_NO
										AND     A.HSTRY_NO = 0 
										AND     B.RESPMAN_ID IS NOT NULL
										AND 	A.DEL_YN = 'N'	
										AND A.COMP_CD = :vo.session_comp_cd
			                		#if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end 			                		 											
										) A   
									GROUP BY RESPMAN_ID, RESPMAN_NM  
									)
										
							GROUP BY RESPMAN_ID, RESPMAN_NM   						    
                            ORDER BY RESPMAN_ID
                            ) A  
                    WHERE RESPMAN_NM IS NOT NULL         
				    ) B
				    ORDER BY RESPMAN_NM                                            
                                                                   
				--WHERE B.RM BETWEEN :vo.start_index and :vo.end_index
		    ]]>
			</statement>
		</query>

		<!-- 개인별 통계 현황 -->

		<query id="las.statistics.listPersonStatistics" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[  
            	SELECT *                                           
                  FROM(                                            
                    SELECT ROWNUM RM                               
                          ,COUNT(1) OVER() TOTAL_CNT               
                          ,A.*                                     
                      FROM ( 		    
							SELECT  SUM(REQ1) REQ1,           -- 의뢰건수
							        SUM(REPLY1) REPLY1,         -- 회신건수
							        SUM(RE1) RE_REQ1,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN1) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT1)/2, 2)+1) END REPLY_TIME1,-- 회신기간
									SUM(REQ2) REQ2,           -- 의뢰건수
							        SUM(REPLY2) REPLY2,         -- 회신건수
							        SUM(RE2) RE_REQ2,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN2) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT2)/2, 2)+1) END REPLY_TIME2,-- 회신기간
									SUM(REQ3) REQ3,           -- 의뢰건수
							        SUM(REPLY3) REPLY3,         -- 회신건수
							        SUM(RE3) RE_REQ3,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN3) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT3)/2, 2)+1) END REPLY_TIME3,-- 회신기간
									SUM(REQ4) REQ4,           -- 의뢰건수
							        SUM(REPLY4) REPLY4,         -- 회신건수
							        SUM(RE4) RE_REQ4,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN4) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT4)/2, 2)+1) END REPLY_TIME4,-- 회신기간
									SUM(REQ5) REQ5,           -- 의뢰건수
							        SUM(REPLY5) REPLY5,         -- 회신건수
							        SUM(RE5) RE_REQ5,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN5) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT5)/2, 2)+1) END REPLY_TIME5,-- 회신기간
							        A.RESPMAN_NM RESPMAN_NM
							FROM
							        (
							        SELECT  SUM(A.REQ) REQ1,           -- 법무_자문 의뢰 건수
							                SUM(A.REPLY) REPLY1,       -- 법무_자문 회신 건수
							                SUM(A.RE) RE1,             -- 법무_자문 재의뢰 건수
                                            SUM(A.REPLY_YN) REPLY_YN1,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT1,  
							                
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							                							                
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                                                
							                                
							                A.RESPMAN_NM               
							        FROM
							                (
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN, 				
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT			                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON = 1
							                AND		A.DEL_YN = 'N'
							                AND A.COMP_CD = :vo.session_comp_cd
							                --AND     A.HSTRY_NO > 0
							                AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                                
							                UNION ALL
							                
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        --AND     A.HSTRY_NO > 0
							                        AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                        AND		A.DEL_YN = 'N'
							                        AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON > 1
							                AND		A.DEL_YN = 'N'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                                                
							                UNION ALL
							                -- 재의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        1 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT						                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO > 0
							                AND		A.DEL_YN = 'N'
							                --AND     A.EXTNL_PRGRS_STATUS = 'S04'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID
							                
							                UNION ALL
							                
							                --의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT						                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO = 0
							                AND		A.DEL_YN = 'N'
							                AND     A.EXTNL_PRGRS_STATUS != 'S01' 
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID                
							     
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM      
							         
							        UNION ALL
							        
							        SELECT  SUM(A.REQ) REQ1,           -- 계약_검토 의뢰 건수
							                SUM(A.REPLY) REPLY1,       -- 계약_검토 회신 건수
							                SUM(A.RE) RE1,             -- 계약_검토 재의뢰 건수
							                SUM(REPLY_YN) REPLY_YN1,
							                CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT1,
							                
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							                
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                     
							                A.RESPMAN_NM                
							        FROM
							                (
							                /* 공동배정건이 아닌경우 회신 COUNT */
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                        GROUP BY A.CNSDREQ_ID
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID         
							                AND     C.CON = 1
							                AND     D.CNSD_DT IS NOT NULL
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)               
							                UNION ALL
							                /* 공동배정건인 경우 회신 COUNT */                        
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT                          
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT IS NOT NULL
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                        GROUP BY A.CNSDREQ_ID                      
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID              
							                AND     C.CON > 1
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                
							               UNION ALL
							               
							                -- 의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     PREV_CNSDREQ_ID IS NULL
							                AND		A.DEL_YN = 'N'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							                               
							                UNION ALL
							
							                -- 재의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        1 RE,
							                        0 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     PREV_CNSDREQ_ID IS NOT NULL
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
							              
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM  
							        
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
							                0 REPLY1,       -- 법무_자문 회신 건수
							                0 RE1,             -- 법무_자문 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							                
							                SUM(A.REQ) REQ2,           
							                SUM(A.REPLY) REPLY2,       
							                SUM(A.RE) RE2,            
                                            SUM(A.REPLY_YN) REPLY_YN2,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT2,  
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							                
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                                                
							                                
							                A.RESPMAN_NM               
							        FROM
							                (
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT								                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND		A.DEL_YN = 'N'
							                AND     C.CON = 1
							                --AND     A.HSTRY_NO > 0
							                AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                                
							                UNION ALL
							                
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT	 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        --AND     A.HSTRY_NO > 0
							                        AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                        AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND		A.DEL_YN = 'N'
							                AND     C.CON > 1
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                                                
							                UNION ALL
							                -- 재의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        1 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT	  							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO > 0
							                AND		A.DEL_YN = 'N'
							                --AND     A.EXTNL_PRGRS_STATUS = 'S04'
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID
							                
							                UNION ALL
							                
							                --의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT	  							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND		A.DEL_YN = 'N'
							                AND     A.HSTRY_NO = 0
							                AND     A.EXTNL_PRGRS_STATUS != 'S01' 
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID                
							     
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM      
							         
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
							                0 REPLY1,       -- 계약_검토 회신 건수
							                0 RE1,             -- 계약_검토 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							                
							                SUM(A.REQ) REQ2,           
							                SUM(A.REPLY) REPLY2,       
							                SUM(A.RE) RE2,            
							                SUM(REPLY_YN) REPLY_YN2,
							                CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							                
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                     
							                A.RESPMAN_NM                
							        FROM
							                (
							                /* 공동배정건이 아닌경우 회신 COUNT */
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                        GROUP BY A.CNSDREQ_ID
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     C.CON = 1
							                AND     D.CNSD_DT IS NOT NULL
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                               
							                UNION ALL
							                /* 공동배정건인 경우 회신 COUNT */                        
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT                                  
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT IS NOT NULL
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                        GROUP BY A.CNSDREQ_ID                   
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID              
							                AND     C.CON > 1
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                
							               UNION ALL
							               
							                -- 의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     PREV_CNSDREQ_ID IS NULL
							                AND		A.DEL_YN = 'N'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							                               
							                UNION ALL
							
							                -- 재의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        1 RE,
							                        0 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     PREV_CNSDREQ_ID IS NOT NULL
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
							              
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM   
							        
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
							                0 REPLY1,       -- 법무_자문 회신 건수
							                0 RE1,             -- 법무_자문 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							                                
							                SUM(A.REQ) REQ3,           
							                SUM(A.REPLY) REPLY3,       
							                SUM(A.RE) RE3,            
                                            SUM(A.REPLY_YN) REPLY_YN3,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT3, 
							                
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                                                
							                                
							                A.RESPMAN_NM               
							        FROM
							                (
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT								                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON = 1
							                --AND     A.HSTRY_NO > 0
							                AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                                
							                UNION ALL
							                
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT	 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        AND		A.DEL_YN = 'N'
							                        --AND     A.HSTRY_NO > 0
							                        AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                        AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON > 1
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                                                
							                UNION ALL
							                -- 재의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        1 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT	  							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO > 0
							                AND		A.DEL_YN = 'N'
							                --AND     A.EXTNL_PRGRS_STATUS = 'S04'
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID
							                
							                UNION ALL
							                
							                --의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT	  							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO = 0
							                AND		A.DEL_YN = 'N'
							                AND     A.EXTNL_PRGRS_STATUS != 'S01' 
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID                
							     
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM      
							         
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
							                0 REPLY1,       -- 계약_검토 회신 건수
							                0 RE1,             -- 계약_검토 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							                                
							                SUM(A.REQ) REQ3,           
							                SUM(A.REPLY) REPLY3,       
							                SUM(A.RE) RE3,            
							                SUM(REPLY_YN) REPLY_YN3,
							                CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT3,
							                
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                     
							                A.RESPMAN_NM                
							        FROM
							                (
							                /* 공동배정건이 아닌경우 회신 COUNT */
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                        GROUP BY A.CNSDREQ_ID
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     C.CON = 1
							                AND     D.CNSD_DT IS NOT NULL
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                               
							                UNION ALL
							                /* 공동배정건인 경우 회신 COUNT */                        
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT                                   
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                        AND     A.CNSD_DT IS NOT NULL
							                        GROUP BY A.CNSDREQ_ID                   
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID  
							                AND     C.CON > 1
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                
							                UNION ALL
							               
							                -- 의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     PREV_CNSDREQ_ID IS NULL
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
							                               
							                UNION ALL
							
							                -- 재의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        1 RE,
							                        0 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     PREV_CNSDREQ_ID IS NOT NULL
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e) 
							              
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM   
							        
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
							                0 REPLY1,       -- 법무_자문 회신 건수
							                0 RE1,             -- 법무_자문 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							                                                
							                SUM(A.REQ) REQ4,           
							                SUM(A.REPLY) REPLY4,       
							                SUM(A.RE) RE4,            
                                            SUM(A.REPLY_YN) REPLY_YN4,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT4,  

							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                                                
							                                
							                A.RESPMAN_NM               
							        FROM
							                (
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT   							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON = 1
							                --AND     A.HSTRY_NO > 0
							                AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                                
							                UNION ALL
							                
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT   						                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        --AND     A.HSTRY_NO > 0
							                        AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                        AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON > 1
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                                                
							                UNION ALL
							                -- 재의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        1 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT  							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO > 0
							                AND		A.DEL_YN = 'N'
							                --AND     A.EXTNL_PRGRS_STATUS = 'S04'
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID
							                
							                UNION ALL
							                
							                --의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT  							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO = 0
							                AND		A.DEL_YN = 'N'
							                AND     A.EXTNL_PRGRS_STATUS != 'S01' 
							                AND 	A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID                
							     
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM      
							         
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
							                0 REPLY1,       -- 계약_검토 회신 건수
							                0 RE1,             -- 계약_검토 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							                                                
							                SUM(A.REQ) REQ4,           
							                SUM(A.REPLY) REPLY4,       
							                SUM(A.RE) RE4,            
							                SUM(REPLY_YN) REPLY_YN4,
							                CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT4,
							                
							                0 REQ5,           
							                0 REPLY5,       
							                0 RE5,            
							                0 REPLY_YN5,
							                0 REPLY_DT5,                     
							                A.RESPMAN_NM                
							        FROM
							                (
							                /* 공동배정건이 아닌경우 회신 COUNT */
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                        GROUP BY A.CNSDREQ_ID
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     C.CON = 1
							                AND     D.CNSD_DT IS NOT NULL
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e) 
							                               
							                UNION ALL
							                /* 공동배정건인 경우 회신 COUNT */                        
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT                                  
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT IS NOT NULL
							                        AND     A.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                        GROUP BY A.CNSDREQ_ID                   
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID             
							                AND     C.CON > 1
							                AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                
							                UNION ALL
							               
							                -- 의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     PREV_CNSDREQ_ID IS NULL
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							                               
							                UNION ALL
							
							                -- 재의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        1 RE,
							                        0 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     PREV_CNSDREQ_ID IS NOT NULL
							                AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
							              
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM   
							        
							        UNION ALL
							
							        SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
							                0 REPLY1,       -- 법무_자문 회신 건수
							                0 RE1,             -- 법무_자문 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4, 
							                                                                
							                SUM(A.REQ) REQ5,           
							                SUM(A.REPLY) REPLY5,       
							                SUM(A.RE) RE5,            
                                            SUM(A.REPLY_YN) REPLY_YN5,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT5, 
							                 
							                A.RESPMAN_NM               
							        FROM
							                (
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT  	 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON = 1
							                --AND     A.HSTRY_NO > 0
							                AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
							                                
							                UNION ALL
							                
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT  	 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSLT_NO
							                        FROM    TN_LAS_CONSULT A,
							                                TN_LAS_CONSULT_RESPMAN B
							                        WHERE   A.CNSLT_NO = B.CNSLT_NO
							                        AND		A.DEL_YN = 'N'
							                        --AND     A.HSTRY_NO > 0
							                        AND     A.EXTNL_PRGRS_STATUS = 'S03'
							                        AND 	A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
							                        GROUP BY A.CNSLT_NO
							                        ) C                         
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.CNSLT_NO = C.CNSLT_NO
							                AND     C.CON > 1
							                AND 	A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
							                                                
							                UNION ALL
							                -- 재의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        1 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT  	 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO > 0
							                AND		A.DEL_YN = 'N'
							                --AND     A.EXTNL_PRGRS_STATUS = 'S04'
							                AND A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID
							                
							                UNION ALL
							                
							                --의뢰 건수
							                       
							                SELECT  
							                        B.RESPMAN_NM,
							                        A.CNSLT_NO,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN,
                                                    A.DMSTFRGN_GBN,
                                                    A.REG_DT  	 							                        
							                FROM    TN_LAS_CONSULT A,
							                        TN_LAS_CONSULT_RESPMAN B
							                WHERE   A.CNSLT_NO = B.CNSLT_NO
							                AND     A.HSTRY_NO = 0
							                AND		A.DEL_YN = 'N'
							                AND     A.EXTNL_PRGRS_STATUS != 'S01' 
							                AND 	A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
							                --GROUP BY A.CNSLT_NO, B.RESPMAN_ID                
							     
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM      
							         
							        UNION ALL
							        
							        SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
							                0 REPLY1,       -- 계약_검토 회신 건수
							                0 RE1,             -- 계약_검토 재의뢰 건수
							                0 REPLY_YN1,
							                0 REPLY_DT1,
							
							                0 REQ2,           
							                0 REPLY2,       
							                0 RE2,            
							                0 REPLY_YN2,
							                0 REPLY_DT2,
							
							                0 REQ3,           
							                0 REPLY3,       
							                0 RE3,            
							                0 REPLY_YN3,
							                0 REPLY_DT3,
							
							                0 REQ4,           
							                0 REPLY4,       
							                0 RE4,            
							                0 REPLY_YN4,
							                0 REPLY_DT4,                                                 
							                
							                SUM(A.REQ) REQ5,           
							                SUM(A.REPLY) REPLY5,       
							                SUM(A.RE) RE5,            
							                SUM(REPLY_YN) REPLY_YN5,
							                CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT4,                    
							                A.RESPMAN_NM                
							        FROM
							                (
							                /* 공동배정건이 아닌경우 회신 COUNT */
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
							                        GROUP BY A.CNSDREQ_ID
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND     C.CON = 1
							                AND     D.CNSD_DT IS NOT NULL
							                AND     D.CNSD_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
							                               
							                UNION ALL
							                /* 공동배정건인 경우 회신 COUNT */                        
							                SELECT  DISTINCT 
							                        B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        1 REPLY,
							                        0 RE,
							                        0 REQ,
							                        CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
							                        1 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT                                   
							                FROM    TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D,
							                        (
							                        SELECT  
							                                COUNT(DISTINCT B.RESPMAN_ID) CON,
							                                A.CNSDREQ_ID
							                        FROM    TN_CLM_CONTRACT_CNSD A,
							                                TN_CLM_CONT_CNSDREQ_RESPMAN B
							                        WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                        AND     A.CNSD_DT IS NOT NULL
							                        AND     A.CNSD_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
							                        GROUP BY A.CNSDREQ_ID                   
							                        ) C                         
							                WHERE   B.CNSDREQ_ID = D.CNSDREQ_ID 
							                AND     C.CON > 1
							                AND     D.CNSD_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
							                
							               UNION ALL
							               
							                -- 의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        0 RE,
							                        1 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     PREV_CNSDREQ_ID IS NULL
							                AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
							                               
							                UNION ALL
							
							                -- 재의뢰 건수                               
							                SELECT  B.RESPMAN_NM,
							                        D.CNSDREQ_ID,
							                        0 REPLY,
							                        1 RE,
							                        0 REQ,
							                        0 REPLY_DT,
							                        0 REPLY_YN,
							                        CASE WHEN B.RESP_DEPT = 'A00000001' THEN 'H' ELSE 'F' END DMSTFRGN_GBN,
                                                    D.REG_DT
							                FROM    TN_CLM_CONT_CNSDREQ A,
							                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
							                        TN_CLM_CONTRACT_CNSD D                 
							                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
							                AND     B.CNSDREQ_ID = D.CNSDREQ_ID
							                AND		A.DEL_YN = 'N'
							                AND     PREV_CNSDREQ_ID IS NOT NULL
							                AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
							              
							                ) A 
							        WHERE 1=1
							        #if ($vo.dmstfrgn_gbn && !$vo.dmstfrgn_gbn.equals(""))
			                			AND A.DMSTFRGN_GBN = :vo.dmstfrgn_gbn	                	
			                		#end 
			                		#if ($vo.srch_regdt1 && !$vo.srch_regdt1.equals(""))
			                			AND TO_CHAR(A.REG_DT,'YYYYMMDD') BETWEEN REPLACE(:vo.srch_regdt1, '-', '') AND REPLACE(:vo.srch_regdt2, '-', '')
			                		#end
							        GROUP BY A.RESPMAN_NM                                           
							        ) A
							GROUP BY A.RESPMAN_NM				      
                            ) A           
				    ) B                                            
                                                                   
				--WHERE B.RM BETWEEN :vo.start_index and :vo.end_index 	
			         
		    ]]>
			</statement>
		</query>
		<!-- 팀별 통계 현황 -->
		<query id="las.statistics.listDeptStatistics" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[  
            	SELECT *                                           
                  FROM(                                            
                    SELECT ROWNUM RM                               
                          ,COUNT(1) OVER() TOTAL_CNT               
                          ,A.*                                     
                      FROM ( 		    
							SELECT  SUM(REQ1) REQ1,           -- 의뢰건수
							        SUM(REPLY1) REPLY1,         -- 회신건수
							        SUM(RE1) RE_REQ1,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN1) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT1)/2+1,2)) END REPLY_TIME1,-- 회신기간
									SUM(REQ2) REQ2,           -- 의뢰건수
							        SUM(REPLY2) REPLY2,         -- 회신건수
							        SUM(RE2) RE_REQ2,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN2) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT2)/2+1,2)) END REPLY_TIME2,-- 회신기간
									SUM(REQ3) REQ3,           -- 의뢰건수
							        SUM(REPLY3) REPLY3,         -- 회신건수
							        SUM(RE3) RE_REQ3,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN3) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT3)/2+1,2)) END REPLY_TIME3,-- 회신기간
									SUM(REQ4) REQ4,           -- 의뢰건수
							        SUM(REPLY4) REPLY4,         -- 회신건수
							        SUM(RE4) RE_REQ4,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN4) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT4)/2+1,2)) END REPLY_TIME4,-- 회신기간
									SUM(REQ5) REQ5,           -- 의뢰건수
							        SUM(REPLY5) REPLY5,         -- 회신건수
							        SUM(RE5) RE_REQ5,            -- 재의뢰건수
							        CASE WHEN SUM(REPLY_YN5) = 0 THEN TO_CHAR(0+1) ELSE TO_CHAR(ROUND(SUM(REPLY_DT5)/2+1,2)) END REPLY_TIME5,-- 회신기간				        
                                    							        							        							        
                                    --CASE WHEN A.DMSTFRGN_GBN='F' THEN '해외' ELSE '국내' END DMSTFRGN_GBN
                                    A.DMSTFRGN_GBN 
                            FROM
                                    (
                                    SELECT  SUM(A.REQ) REQ1,           -- 법무_자문 의뢰 건수
                                            SUM(A.REPLY) REPLY1,       -- 법무_자문 회신 건수
                                            SUM(A.RE) RE1,             -- 법무_자문 재의뢰 건수
                                            SUM(A.REPLY_YN) REPLY_YN1,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT1, 
                                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                                                
                                                            
                                            A.DMSTFRGN_GBN               
                                    FROM
                                            (
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN                                                      
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   1=1 --AND     A.HSTRY_NO > 0
                                            AND     A.EXTNL_PRGRS_STATUS = 'S03'
                                            AND		A.DEL_YN = 'N'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
                                                                            
                                            UNION ALL
                                            -- 재의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    1 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                     
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO > 0
                                            AND		A.DEL_YN = 'N'
                                           -- AND     A.EXTNL_PRGRS_STATUS = 'S04'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
                                            
                                            UNION ALL
                                            
                                            --의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                     
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO = 0
                                            AND     A.EXTNL_PRGRS_STATUS != 'S01'
                                            AND		A.DEL_YN = 'N'
                                            --AND     A.REG_DEPT = ':reg_detp' 
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
                                 
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN      
                                     
                                    UNION ALL
                                    
                                    SELECT  SUM(A.REQ) REQ1,           -- 계약_검토 의뢰 건수
                                            SUM(A.REPLY) REPLY1,       -- 계약_검토 회신 건수
                                            SUM(A.RE) RE1,             -- 계약_검토 재의뢰 건수
                                            SUM(REPLY_YN) REPLY_YN1,
                                            CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT1,
                                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                     
                                            A.DMSTFRGN_GBN                
                                    FROM
                                            (
                                            /* 회신 COUNT */
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
                                                    1 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND		A.DEL_YN = 'N'
                                            AND     D.CNSD_DT IS NOT NULL
                                            AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
                                            
                                           UNION ALL
                                           
                                            -- 의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                 
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.PREV_CNSDREQ_ID IS NULL
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
                                                           
                                            UNION ALL
                            
                                            -- 재의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    1 RE,
                                                    0 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                  
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)
                                          
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN  
                                    
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
                                            0 REPLY1,       -- 법무_자문 회신 건수
                                            0 RE1,             -- 법무_자문 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                                            
                                            SUM(A.REQ) REQ2,           
                                            SUM(A.REPLY) REPLY2,       
                                            SUM(A.RE) RE2,            
                                            SUM(A.REPLY_YN) REPLY_YN2,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT2, 
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                                                
                                                            
                                            A.DMSTFRGN_GBN               
                                    FROM
                                            (
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN                                                      
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   1=1 --AND     A.HSTRY_NO > 0
                                            AND     A.EXTNL_PRGRS_STATUS = 'S03'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
                                                                            
                                            UNION ALL
                                            -- 재의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    1 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                      
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO > 0
                                            --AND     A.EXTNL_PRGRS_STATUS = 'S04'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
                                            
                                            UNION ALL
                                            
                                            --의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                      
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO = 0
                                            AND     A.EXTNL_PRGRS_STATUS != 'S01'
                                            --AND     A.REG_DEPT = ':reg_detp' 
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
                                 
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN         
                                     
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
                                            0 REPLY1,       -- 계약_검토 회신 건수
                                            0 RE1,             -- 계약_검토 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                                            
                                            SUM(A.REQ) REQ2,           
                                            SUM(A.REPLY) REPLY2,       
                                            SUM(A.RE) RE2,            
                                            SUM(REPLY_YN) REPLY_YN2,
                                            CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                     
                                            A.DMSTFRGN_GBN                
                                    FROM
                                            (
                                            /* 회신 COUNT */
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
                                                    1 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     D.CNSD_DT IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
                                            
                                           UNION ALL
                                           
                                            -- 의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                 
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
                                                           
                                            UNION ALL
                            
                                            -- 재의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    1 RE,
                                                    0 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                  
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)
                                          
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN    
                                    
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
                                            0 REPLY1,       -- 법무_자문 회신 건수
                                            0 RE1,             -- 법무_자문 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                                                            
                                            SUM(A.REQ) REQ3,           
                                            SUM(A.REPLY) REPLY3,       
                                            SUM(A.RE) RE3,            
                                            SUM(A.REPLY_YN) REPLY_YN3,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT3,  
                                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                                                
                                                            
                                            A.DMSTFRGN_GBN               
                                    FROM
                                            (
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN                                                      
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   1=1 --AND     A.HSTRY_NO > 0
                                            AND     A.EXTNL_PRGRS_STATUS = 'S03'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
                                                                            
                                            UNION ALL
                                            -- 재의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    1 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                       
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO > 0
                                            --AND     A.EXTNL_PRGRS_STATUS = 'S04'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
                                            
                                            UNION ALL
                                            
                                            --의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                       
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO = 0
                                            AND     A.EXTNL_PRGRS_STATUS != 'S01'
                                            --AND     A.REG_DEPT = ':reg_detp' 
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
                                 
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN      
                                     
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
                                            0 REPLY1,       -- 계약_검토 회신 건수
                                            0 RE1,             -- 계약_검토 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                                                            
                                            SUM(A.REQ) REQ3,           
                                            SUM(A.REPLY) REPLY3,       
                                            SUM(A.RE) RE3,            
                                            SUM(REPLY_YN) REPLY_YN3,
                                            CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT3,
                                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                     
                                            A.DMSTFRGN_GBN                
                                    FROM
                                            (
                                            /* 회신 COUNT */
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
                                                    1 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     D.CNSD_DT IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
                                            
                                           UNION ALL
                                           
                                            -- 의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                 
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e) 
                                                           
                                            UNION ALL
                            
                                            -- 재의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    1 RE,
                                                    0 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                  
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)
                                          
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN  
                                    
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
                                            0 REPLY1,       -- 법무_자문 회신 건수
                                            0 RE1,             -- 법무_자문 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                                                                            
                                            SUM(A.REQ) REQ4,           
                                            SUM(A.REPLY) REPLY4,       
                                            SUM(A.RE) RE4,            
                                            SUM(A.REPLY_YN) REPLY_YN4,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT4,  
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                                                
                                                            
                                            A.DMSTFRGN_GBN               
                                    FROM
                                            (
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN                                                       
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   1=1 --AND     A.HSTRY_NO > 0
                                            AND     A.EXTNL_PRGRS_STATUS = 'S03'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
                                                                            
                                            UNION ALL
                                            -- 재의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    1 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                       
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO > 0
                                            --AND     A.EXTNL_PRGRS_STATUS = 'S04'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
                                            
                                            UNION ALL
                                            
                                            --의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                         
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO = 0
                                            AND     A.EXTNL_PRGRS_STATUS != 'S01'
                                            --AND     A.REG_DEPT = ':reg_detp' 
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
                                 
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN      
                                     
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
                                            0 REPLY1,       -- 계약_검토 회신 건수
                                            0 RE1,             -- 계약_검토 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                                                                            
                                            SUM(A.REQ) REQ4,           
                                            SUM(A.REPLY) REPLY4,       
                                            SUM(A.RE) RE4,            
                                            SUM(REPLY_YN) REPLY_YN4,
                                            CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT4,
                                            
                                            0 REQ5,           
                                            0 REPLY5,       
                                            0 RE5,            
                                            0 REPLY_YN5,
                                            0 REPLY_DT5,                     
                                            A.DMSTFRGN_GBN                
                                    FROM
                                            (
                                            /* 회신 COUNT */
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
                                                    1 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     D.CNSD_DT IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
                                            
                                           UNION ALL
                                           
                                            -- 의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                 
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
                                                           
                                            UNION ALL
                            
                                            -- 재의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    1 RE,
                                                    0 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                  
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)
                                          
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN    
                                    
                                    UNION ALL
                            
                                    SELECT  0 REQ1,           -- 법무_자문 의뢰 건수
                                            0 REPLY1,       -- 법무_자문 회신 건수
                                            0 RE1,             -- 법무_자문 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4, 
                                                                                            
                                            SUM(A.REQ) REQ5,           
                                            SUM(A.REPLY) REPLY5,       
                                            SUM(A.RE) RE5,            
                                            SUM(A.REPLY_YN) REPLY_YN5,
                                            CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT5,  
                                             
                                            A.DMSTFRGN_GBN               
                                    FROM
                                            (
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                    CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN                                                     
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   1=1 --AND     A.HSTRY_NO > 0
                                            AND     A.EXTNL_PRGRS_STATUS = 'S03'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
                                                                            
                                            UNION ALL
                                            -- 재의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    1 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                     
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO > 0
                                            --AND     A.EXTNL_PRGRS_STATUS = 'S04'
                                            --AND     A.REG_DEPT = ':reg_detp'
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
                                            
                                            UNION ALL
                                            
                                            --의뢰 건수
                                                   
                                            SELECT  
                                                    A.DMSTFRGN_GBN,
                                                    A.CNSLT_NO,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN                                                 
                                            FROM    TN_LAS_CONSULT A
                                            WHERE   A.HSTRY_NO = 0
                                            AND     A.EXTNL_PRGRS_STATUS != 'S01'
                                            --AND     A.REG_DEPT = ':reg_detp' 
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
                                 
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN        
                                     
                                    UNION ALL
                                    
                                    SELECT  0 REQ1,           -- 계약_검토 의뢰 건수
                                            0 REPLY1,       -- 계약_검토 회신 건수
                                            0 RE1,             -- 계약_검토 재의뢰 건수
                                            0 REPLY_YN1,
                                            0 REPLY_DT1,
                            
                                            0 REQ2,           
                                            0 REPLY2,       
                                            0 RE2,            
                                            0 REPLY_YN2,
                                            0 REPLY_DT2,
                            
                                            0 REQ3,           
                                            0 REPLY3,       
                                            0 RE3,            
                                            0 REPLY_YN3,
                                            0 REPLY_DT3,
                            
                                            0 REQ4,           
                                            0 REPLY4,       
                                            0 RE4,            
                                            0 REPLY_YN4,
                                            0 REPLY_DT4,                                                 
                                            
                                            SUM(A.REQ) REQ5,           
                                            SUM(A.REPLY) REPLY5,       
                                            SUM(A.RE) RE5,            
                                            SUM(REPLY_YN) REPLY_YN5,
                                            CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT4,                    
                                            A.DMSTFRGN_GBN                
                                    FROM
                                            (
                                            /* 회신 COUNT */
                                            SELECT  DISTINCT 
                                                    A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    1 REPLY,
                                                    0 RE,
                                                    0 REQ,
                                                    CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
                                                    1 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     D.CNSD_DT IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     D.CNSD_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
                                            
                                           UNION ALL
                                           
                                            -- 의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    0 RE,
                                                    1 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                 
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
                                                           
                                            UNION ALL
                            
                                            -- 재의뢰 건수                               
                                            SELECT  A.DMSTFRGN_GBN,
                                                    D.CNTRT_ID,
                                                    0 REPLY,
                                                    1 RE,
                                                    0 REQ,
                                                    0 REPLY_DT,
                                                    0 REPLY_YN
                                            FROM    TN_CLM_CONT_CNSDREQ A,
                                                    TN_CLM_CONTRACT_CNSD D                  
                                            WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                            --AND     D.CNSD_DEPT = ':cnsd_dept'
                                            AND     A.PREV_CNSDREQ_ID IS NOT NULL
                                            AND		A.DEL_YN = 'N'
                                            AND     A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%' 
                                          
                                            ) A 
                                    GROUP BY A.DMSTFRGN_GBN                                             
                                    ) A
                            WHERE	A.DMSTFRGN_GBN IN ('F', 'H')
                            GROUP BY A.DMSTFRGN_GBN 
                            ) A           
				    ) B                                            
                                                                   
				--WHERE B.RM BETWEEN :vo.start_index and :vo.end_index
			         
		    ]]>
			</statement>
		</query>
		<!-- 년도별 사업부 통계 현황 -->
		<query id="las.statistics.listDeptStatistics1" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[  
            SELECT   REQ1
                    ,REPLY1
                    ,RE_REQ1
                    ,ROUND(REPLY_TIME1/CNT, 2) AS REPLY_TIME1
                    --,TO_CHAR(ROUND(REPLY_TIME1/CNT, 2) + 1) AS REPLY_TIME1
                    ,REQ_DEPT
                    ,COUNT(1) OVER() TOTAL_CNT
            FROM    (

                    SELECT   DISTINCT
                             SUM(B.REQ1) OVER(PARTITION BY B.REQ_DEPT) REQ1
                            ,SUM(B.REPLY1) OVER(PARTITION BY B.REQ_DEPT) REPLY1
                            ,SUM(B.RE_REQ1) OVER(PARTITION BY B.REQ_DEPT) RE_REQ1
                            ,SUM(B.REPLY_TIME1) OVER(PARTITION BY B.REQ_DEPT) REPLY_TIME1
                            ,COUNT(1) OVER(PARTITION BY B.REQ_DEPT) CNT
                            ,B.REQ_DEPT                                             
                    FROM    (  
                                                      
                            SELECT        
                                   A.REQ1
                                  ,A.REPLY1
                                  ,A.RE_REQ1
                                  ,A.REPLY_TIME1 
			        		      , (
			        		        SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN DEPT_NM ELSE DEPT_NM_ENG END AS DEPT_NM
			        		        FROM TB_COM_DEPT
			        		        WHERE DEPT_LEVEL=4
			        		        START WITH DEPT_CD=A.REQ_DEPT
			        		        CONNECT BY PRIOR UP_DEPT_CD=DEPT_CD      
			        		        ) AS REQ_DEPT                                                           
                              FROM ( 
                      		    
                      		    
			        				SELECT  SUM(REQ1) REQ1,           -- 의뢰건수
			        				        SUM(REPLY1) REPLY1,         -- 회신건수
			        				        SUM(RE1) RE_REQ1,            -- 재의뢰건수
			        				        CASE WHEN SUM(REPLY_YN1) > 0 THEN SUM(REPLY_DT1)/2 ELSE 0 END REPLY_TIME1,-- 회신기간   							        
                                            REQ_DEPT
                                    FROM
                                            (
                                            SELECT  SUM(A.REQ) REQ1,           -- 법무_자문 의뢰 건수
                                                    SUM(A.REPLY) REPLY1,       -- 법무_자문 회신 건수
                                                    SUM(A.RE) RE1,             -- 법무_자문 재의뢰 건수
                                                    SUM(A.REPLY_YN) REPLY_YN1,
                                                    CASE WHEN SUM(A.REPLY_YN) > 0 THEN SUM(A.REPLY_DT)/SUM(A.REPLY_YN) ELSE 0 END REPLY_DT1,   
                                                    A.REQ_DEPT               
                                            FROM
                                                    (
                                                    /* 회신 COUNT */
                                                    SELECT  DISTINCT 
                                                            A.REG_DEPT REQ_DEPT,
                                                            A.CNSLT_NO,
                                                            1 REPLY,
                                                            0 RE,
                                                            0 REQ,
                                                            CASE WHEN A.RE_DT IS NULL THEN 0 ELSE A.RE_DT - A.REG_DT END REPLY_DT,
                                                            CASE WHEN A.RE_DT IS NULL THEN 0 ELSE 1 END REPLY_YN
                                                    FROM    TN_LAS_CONSULT A
                                                    WHERE   1=1 --AND     A.HSTRY_NO > 0
                                                    AND     A.EXTNL_PRGRS_STATUS = 'S03'
                                                    
													#if ($vo.srch_year && !$vo.srch_year.equals("")) 
														AND	  A.REG_DT LIKE :vo.srch_year + '%'
													#else
														AND   A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
													#end	                                                    
                                                                                                                                
                                                    UNION ALL
                                                    -- 재의뢰 건수
                                                           
                                                    SELECT  
                                                            A.REG_DEPT REQ_DEPT,
                                                            A.CNSLT_NO,
                                                            0 REPLY,
                                                            1 RE,
                                                            1 REQ,
                                                            0 REPLY_DT,
                                                            0 REPLY_YN                                                    
                                                    FROM    TN_LAS_CONSULT A
                                                    WHERE   A.HSTRY_NO > 0
                                                    AND		A.DEL_YN = 'N'
                                                    --AND     A.EXTNL_PRGRS_STATUS = 'S04'
													#if ($vo.srch_year && !$vo.srch_year.equals("")) 
														AND	  A.REG_DT LIKE :vo.srch_year + '%'
													#else
														AND   A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
													#end
                                                    
                                                    UNION ALL
                                                    
                                                    --의뢰 건수
                                                           
                                                    SELECT  
                                                            A.REG_DEPT REQ_DEPT,
                                                            A.CNSLT_NO,
                                                            0 REPLY,
                                                            0 RE,
                                                            1 REQ,
                                                            0 REPLY_DT,
                                                            0 REPLY_YN                                                    
                                                    FROM    TN_LAS_CONSULT A
                                                    WHERE   A.HSTRY_NO = 0
                                                    AND		A.DEL_YN = 'N'
                                                    AND     A.EXTNL_PRGRS_STATUS != 'S01'
													#if ($vo.srch_year && !$vo.srch_year.equals("")) 
														AND	  A.REG_DT LIKE :vo.srch_year + '%'
													#else
														AND   A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
													#end
                                         
                                                    ) A 
                                            GROUP BY A.REQ_DEPT      
                                             
                                            UNION ALL
                                            
                                            SELECT  SUM(A.REQ) REQ1,           -- 계약_검토 의뢰 건수
                                                    SUM(A.REPLY) REPLY1,       -- 계약_검토 회신 건수
                                                    SUM(A.RE) RE1,             -- 계약_검토 재의뢰 건수
                                                    SUM(REPLY_YN) REPLY_YN1,
                                                    CASE WHEN SUM(REPLY_YN) > 0 THEN SUM(REPLY_DT)/SUM(REPLY_YN) ELSE 0 END REPLY_DT1,              
                                                    A.REQ_DEPT                
                                            FROM
                                                    (
                                                    /* 회신 COUNT */
                                                    SELECT  DISTINCT 
                                                            A.REQ_DEPT REQ_DEPT,
                                                            D.CNTRT_ID,
                                                            1 REPLY,
                                                            0 RE,
                                                            0 REQ,
                                                            CASE WHEN D.CNSD_DT IS NULL THEN 0 ELSE D.CNSD_DT - D.REG_DT END REPLY_DT,
                                                            1 REPLY_YN
                                                    FROM    TN_CLM_CONT_CNSDREQ A,
                                                            TN_CLM_CONTRACT_CNSD D
                                                    WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                                    AND		A.DEL_YN = 'N'
                                                    AND     D.CNSD_DT IS NOT NULL
													#if ($vo.srch_year && !$vo.srch_year.equals("")) 
														AND	  D.CNSD_DT LIKE :vo.srch_year + '%'
													#else
														AND   D.CNSD_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
													#end                                                    
                                                    
                                                   UNION ALL
                                                   
                                                    -- 의뢰 건수                               
                                                    SELECT  A.REQ_DEPT REQ_DEPT,
                                                            D.CNTRT_ID,
                                                            0 REPLY,
                                                            0 RE,
                                                            1 REQ,
                                                            0 REPLY_DT,
                                                            0 REPLY_YN
                                                    FROM    TN_CLM_CONT_CNSDREQ A,
                                                            TN_CLM_CONTRACT_CNSD D                 
                                                    WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                                    AND     A.PREV_CNSDREQ_ID IS NULL
                                                    AND		A.DEL_YN = 'N'
													#if ($vo.srch_year && !$vo.srch_year.equals("")) 
														AND	  A.REG_DT LIKE :vo.srch_year + '%'
													#else
														AND   A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
													#end                                                                   
                                                    UNION ALL
                                    
                                                    -- 재의뢰 건수                               
                                                    SELECT  A.REQ_DEPT REQ_DEPT,
                                                            D.CNTRT_ID,
                                                            0 REPLY,
                                                            1 RE,
                                                            0 REQ,
                                                            0 REPLY_DT,
                                                            0 REPLY_YN
                                                    FROM    TN_CLM_CONT_CNSDREQ A,
                                                            TN_CLM_CONTRACT_CNSD D                  
                                                    WHERE   A.CNSDREQ_ID = D.CNSDREQ_ID
                                                    AND		A.DEL_YN = 'N'
                                                    AND     A.PREV_CNSDREQ_ID IS NOT NULL
													#if ($vo.srch_year && !$vo.srch_year.equals("")) 
														AND	  A.REG_DT LIKE :vo.srch_year + '%'
													#else
														AND   A.REG_DT LIKE CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '%'
													#end
                                                  
                                                    ) A 
                                            GROUP BY A.REQ_DEPT  
                                            
                                            ) A
                                    GROUP BY A.REQ_DEPT 
                                    
                                    
                                    ) A
			        	    ) B                                            
                            WHERE B.REQ_DEPT IS NOT NULL
                     )
			         
		    ]]>
			</statement>
		</query>

		<!-- 조회조건일 가져오기 -->
		<query id="las.statistics.selectSearchDt" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[  
				SELECT 
			    /* 전주시작일 */
			    CASE 
			        WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '2' THEN  
			        	REPLACE(CONVERT(CHAR(10), DATEADD(DD,-7,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '3' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-8,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '4' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-9,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '5' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-10,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '6' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-11,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '7' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-12,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '1' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-13,GETDATE()), 23),'-','') /*YYYYMMDD*/
				END BEFOREWEEK_S,
				/* 전주마지막일 */
			    CASE 
			        WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '2' THEN
			        	REPLACE(CONVERT(CHAR(10), DATEADD(DD,-1,GETDATE()), 23),'-','') /*YYYYMMDD*/ 
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '3' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-2,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '4' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-3,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '5' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-4,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '6' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-5,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '7' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-5,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '1' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-7,GETDATE()), 23),'-','') /*YYYYMMDD*/
				END BEFOREWEEK_E,	
				/* 전월시작일 */
				LEFT(REPLACE(CONVERT(CHAR(10), DATEADD(mm,-1,GETDATE()), 23),'-',''),6)+'01' BEFOREMONTH_S,
				/* 전월말일 */
				REPLACE(CONVERT(CHAR(10), DBO.[COM_LASTDAY](DATEADD(mm,-1,GETDATE())), 23),'-','') BEFOREMONTH_E,
				/* 금주시작일 */
			    CASE 
			        WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR)= '2' THEN
			        	REPLACE(CONVERT(CHAR(10), GETDATE(), 23),'-','') /*YYYYMMDD*/ 
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '3' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-1,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '4' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-2,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '5' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-3,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '6' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-4,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '7' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-5,GETDATE()), 23),'-','') /*YYYYMMDD*/
					WHEN CAST(DATEPART(DW,GETDATE()) AS NVARCHAR) = '1' THEN
						REPLACE(CONVERT(CHAR(10), DATEADD(DD,-6,GETDATE()), 23),'-','') /*YYYYMMDD*/
				END CURWEEK_S,
			    /* 금주마지막일 (현재일) */
			    REPLACE(CONVERT(CHAR(10), GETDATE(), 23),'-','') CURWEEK_E,
				/* 금월시작일 */
				LEFT(REPLACE(CONVERT(CHAR(10), GETDATE(), 23),'-',''),6)+'01' CURMONTH_S,
				/* 금월말일(현재일) */
				REPLACE(CONVERT(CHAR(10), GETDATE(), 23),'-','')	CURMONTH_E
		    ]]>
			</statement>
		</query>

		<!-- 계약유형 분류 -->
		<query id="las.statistics.selectCntrtTypeDiv" isCamelCase="false"
			isDynamic="true">
			<statement>
				SELECT TYPE_CD AS CD
				,CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			          WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			          WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			          ELSE CD_NM_ENG
			     END CD_NM
				FROM TN_COM_CONTRACTTYPE_CD
				WHERE UP_TYPE_CD = :vo.srch_div
				AND USE_YN != 'N'
				ORDER BY PRNT_SRT
			</statement>
		</query>

		<!-- 자문유형 분류 -->
		<query id="las.statistics.selectLawTypeDiv" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
				SELECT  CD
				       ,CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
				       		 WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				       		 WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				        	 ELSE CD_NM_ENG END AS CD_NM
				  FROM  TB_COM_CD
				 WHERE  GRP_CD = :vo.srch_grp_cd
				   AND  USE_YN = 'Y'
				   AND  CD != 'A00'
				   #if ($vo.srch_type.equals("L") && $vo.srch_cnsd_dept.equals("A00000003"))
				   AND  USEMAN_MNG_ITM1 = 'IP'
				   #end
				   #if ($vo.srch_type.equals("P") && $vo.srch_cnsd_dept.equals("A00000003"))
				   AND  USEMAN_MNG_ITM1 = 'IP'
				   #end
				 ORDER  BY CD
                ]]>
			</statement>
		</query>

		<!-- 자문유형 분류(표준계약서) -->
		<query id="las.statistics.selectLawTypeDiv_p" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
				SELECT  CD
				       ,CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
				       		 WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				       		 WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				        	 ELSE CD_NM_ENG END AS CD_NM
				  FROM  TB_COM_CD
				 WHERE  GRP_CD = :vo.srch_grp_cd
				   AND  USE_YN = 'Y'
				   AND  CD = 'A20'
				 ORDER  BY CD
                ]]>
			</statement>
		</query>

		<!-- 담당자 배정현황 - 법률자문 -->
		<query id="las.statistics.assignLaw" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
                
               SELECT COMP_CD,
					RESPMAN_NM AS USER_NM,
					SUM(ISNULL( TOTAL_CNT,0)) AS TOTAL_CNT,
					SUM(ISNULL( A01,0)) AS A01,
					SUM(ISNULL(A02,0)) AS A02,
					SUM(ISNULL(A03,0)) AS A03,
					SUM(ISNULL(A04,0)) AS A04,
					SUM(ISNULL(A05,0)) AS A05,
					SUM(ISNULL(A06,0)) AS A06,
					SUM(ISNULL(A07,0)) AS A07,
					SUM(ISNULL(A08,0)) AS A08,
					SUM(ISNULL(A09,0)) AS A09,
					SUM(ISNULL(A10,0)) AS A10,
					SUM(ISNULL(A11,0)) AS A11,
					SUM(ISNULL(A12,0)) AS A12,
					SUM(ISNULL(A13,0)) AS A13,
					SUM(ISNULL(A14,0)) AS A14,
					SUM(ISNULL(A15,0)) AS A15,
					SUM(ISNULL(A16,0)) AS A16,
					SUM(ISNULL(A17,0)) AS A17,
					SUM(ISNULL(A18,0)) AS A18,
					SUM(ISNULL(A19,0)) AS A19,
					SUM(ISNULL(A20,0)) AS A20,
					SUM(ISNULL(A21,0)) AS A21,
					SUM(ISNULL(A22,0)) AS A22,
					SUM(ISNULL(A23,0)) AS A23,
					SUM(ISNULL(A24,0)) AS A24,
 					SUM(ISNULL(A25,0)) AS A25
 				FROM (
					SELECT A.COMP_CD,TLCR.RESPMAN_NM, ISNULL(TLCT.CNSLT_TYPE, 'TOTAL_CNT') CNSLT_TYPE,  count( TLCR.CNSLT_NO) CNT FROM  tn_las_consult a, 
   					(
                		SELECT  
		                  CNSLT_NO ,
		                  CNSLT_TYPE,
						  CNSLT_TYPENM
		                FROM
		                  TN_LAS_CONSULT_TYPE
		                WHERE
		                  HSTRY_NO      = 0
		                AND CNSLT_TYPE != 'A20'
		              ) TLCT    ,
              		(
		                SELECT 
		                  CNSLT_NO ,
		                  RESPMAN_ID,
						  RESPMAN_NM
		                FROM
		                  TN_LAS_CONSULT_RESPMAN
		                WHERE
		                  DEL_YN = 'N'
		              )  TLCR,
	     			(
	     				 SELECT  TCU.USER_ID, TCU.USER_NM
				                      FROM  TB_COM_USER TCU
				                          , ( SELECT  DISTINCT USER_ID
				                                FROM  TB_COM_ROLE_USER
				                               WHERE  ROLE_CD = 'RA02'
				                            ) TCRU
				                     WHERE  TCU.USER_ID = TCRU.USER_ID
						      #if($vo.session_comp_cd.equals("EHQ"))
							#else
							AND TCU.COMP_CD = :vo.session_comp_cd
							#end
				                     
				    ) RESPMAN
 WHERE A.CNSLT_NO = TLCT.CNSLT_NO
   AND TLCT.CNSLT_NO = TLCR.CNSLT_NO
   AND TLCR.RESPMAN_ID = RESPMAN.USER_ID
	AND A.DEL_YN         = 'N'
	AND   A.DMSTFRGN_GBN  = :vo.srch_dmstfrgn_gbn
	AND A.HSTRY_NO = 0
        #if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
	AND  REG_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
	#end
	#if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
	AND  REG_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
	#end
	#if($vo.session_comp_cd.equals("EHQ"))
	#else
	AND A.COMP_CD = :vo.session_comp_cd
	#end
group by rollup(A.COMP_CD,TLCR.RESPMAN_NM,  TLCT.CNSLT_TYPE)
having respman_nm is not null
) T   pivot
(
  sum(cnt)
  for CNSLT_TYPE in ([TOTAL_CNT],[A01],[A02],[A03],[A04],[A05],[A06],[A07],[A08],[A09],[A10],[A11],[A12],[A13],[A14],[A15],[A16],[A17],[A18],[A19],[A20],[A21],[A22],[A23],[A24],[A25])
) piv 
group by rollup(COMP_CD,RESPMAN_NM)
ORDER BY ISNULL(COMP_CD ,'zzzzzzzzzz'), ISNULL(RESPMAN_NM,'zzzzzzzzzzzz')

                ]]>
			</statement>
		</query>

		<!-- 담당자 배정현황 - 법률자문(표준계약서) -->
		<query id="las.statistics.assignLaw_p" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
                SELECT  1 TORDER, * 
				  FROM  ( 
                SELECT	CASE WHEN :vo.session_user_locale = 'ko' THEN  
							'계'
						WHEN :vo.session_user_locale = 'fr' THEN  
							'TOTAL'
						WHEN :vo.session_user_locale = 'de' THEN  
							'TOTAL' 
						ELSE
							'TOTAL'
						END USER_NM
					  , COUNT(CNSLT_TYPE) TOTAL_CNT
				      , SUM(A20) A20
				  FROM  ( SELECT  CNSLT_TYPE
				                , CASE WHEN CNSLT_TYPE = 'A20' THEN 1 ELSE 0 END A20
				            FROM  ( SELECT  CNSLT_NO, DMSTFRGN_GBN
				                      FROM  TN_LAS_CONSULT
				                     WHERE  DEL_YN = 'N'
				                     
				                     AND COMP_CD = :vo.session_comp_cd 
				                     
               
                                       AND  DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
                   
                                     #if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
                                       AND  REG_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
                                     #end
                            
                                     #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
                                       AND  REG_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
                                     #end
				                       AND  HSTRY_NO = 0) TLC
				                 ,( SELECT  CNSLT_NO, CNSLT_TYPE
				                      FROM  TN_LAS_CONSULT_TYPE
				                     WHERE  HSTRY_NO = 0
				                      AND CNSLT_TYPE = 'A20' 
				                     ) TLCT
				                 ,( SELECT  CNSLT_NO, RESPMAN_ID
				                      FROM  TN_LAS_CONSULT_RESPMAN
				                     WHERE  DEL_YN = 'N') TLCR
				                 ,( SELECT  TCU.USER_ID, TCU.USER_NM
				                      FROM  TB_COM_USER TCU
				                          , ( SELECT  DISTINCT USER_ID
				                                FROM  TB_COM_ROLE_USER
				                               WHERE  ROLE_CD = 'RA02'
				                            ) TCRU
				                     WHERE  TCU.USER_ID = TCRU.USER_ID
				                  ) RESPMAN
				           WHERE  TLC.CNSLT_NO = TLCT.CNSLT_NO
				             AND  TLCT.CNSLT_NO = TLCR.CNSLT_NO
				             AND  TLCR.RESPMAN_ID = RESPMAN.USER_ID
				             
				             ) CONSULT_TYPE
				             ) TA
                
                UNION ALL
                
				SELECT  2 TORDER, * 
				  FROM  ( SELECT  USER_NM
				                , ISNULL(TOTAL_CNT,0) TOTAL_CNT
 								, ISNULL(A20,0) A20
				            FROM  ( SELECT  TCU.USER_ID
				                          , TCU.USER_NM
				                          , TCU.BLNGT_ORGNZ
				                      FROM  TB_COM_USER TCU
				                          , ( SELECT  DISTINCT USER_ID
				                                FROM  TB_COM_ROLE_USER
				                               WHERE  ROLE_CD = 'RA02'
				                            ) TCRU
				                     WHERE  TCU.USER_ID = TCRU.USER_ID
				                     	AND TCU.COMP_CD = :vo.session_comp_cd
				                     
				                  ) RESPMAN LEFT OUTER JOIN
				                 ( SELECT  RESPMAN_ID
				                          , SUM(A20) A20, COUNT(RESPMAN_ID) TOTAL_CNT
				                      FROM  ( SELECT TLCR.RESPMAN_ID
				                                    , CASE WHEN CNSLT_TYPE = 'A20' THEN 1 ELSE 0 END A20
				                                FROM  ( SELECT  CNSLT_NO
				                                              , DMSTFRGN_GBN
				                                          FROM  TN_LAS_CONSULT
				                                         WHERE  DEL_YN = 'N'
				                                         
				                                         AND COMP_CD = :vo.session_comp_cd 
				                                         
					                    
					                                       AND  DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
					                              
					                                     #if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
					                                       AND  REG_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
					                                     #end
					                      
					                                     #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
					                                       AND  REG_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
					                                     #end
				                                           AND  HSTRY_NO = 0
				                                      ) TLC
				                                    , ( SELECT  CNSLT_NO
				                                              , CNSLT_TYPE
				                                          FROM  TN_LAS_CONSULT_TYPE
				                                         WHERE  HSTRY_NO = 0 
				                                          AND CNSLT_TYPE = 'A20' 
				                                      ) TLCT
				                                    , ( SELECT  CNSLT_NO
				                                              , RESPMAN_ID
				                                          FROM  TN_LAS_CONSULT_RESPMAN
				                                         WHERE  DEL_YN = 'N') TLCR
				                               WHERE  TLC.CNSLT_NO = TLCT.CNSLT_NO
				                                 AND  TLCT.CNSLT_NO = TLCR.CNSLT_NO) SA
				                     GROUP  BY RESPMAN_ID
				                  ) CONSULT_TYPE
				             ON  RESPMAN.USER_ID = CONSULT_TYPE.RESPMAN_ID
				             
				        )	TB	
						ORDER  BY TORDER, USER_NM

                ]]>
			</statement>
		</query>


		<!-- 담당자 배정현황 - 계약 -->
		<query id="las.statistics.assignCntrt" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
                 SELECT * FROM (
                 		SELECT
						COMP_CD,
						USER_NM,              /* 담당자명 */
				        CAST(SUM(ISNULL(TOTCNT,0)-ISNULL(TOTCNT_BU,0)) AS NUMERIC) AS TOTAL_CNT,    /* 계 */
				        CAST(SUM(ISNULL(TOTCNT_BU,0)) AS NUMERIC) AS TOTAL_CNT_BU,    /* 계(부) */
				        /** 체결목적 **/
				        #if($vo.srch_div.equals("T03"))
					        SUM(ISNULL(AA_JUNG,0)) AS T0301,            /* 개발(정) */
					        SUM(ISNULL(AA_BU,0)) AS T0301_BU,           /* 개발(부) */
					        SUM(ISNULL(BB_JUNG,0)) AS T0302,            /* 특허(정) */
					        SUM(ISNULL(BB_BU,0)) AS T0302_BU,           /* 특허(부) */
					        SUM(ISNULL(CC_JUNG,0)) AS T0303,            /* 라이선스(정) */
					        SUM(ISNULL(CC_BU,0)) AS T0303_BU,           /* 라이선스(부) */
					        SUM(ISNULL(DD_JUNG,0)) AS T0304,            /* 구매(정) */
					        SUM(ISNULL(DD_BU,0)) AS T0304_BU,           /* 구매(부) */
					        SUM(ISNULL(EE_JUNG,0)) AS T0305,            /* 제조(정) */
					        SUM(ISNULL(EE_BU,0)) AS T0305_BU,           /* 제조(부) */
					        SUM(ISNULL(FF_JUNG,0)) AS T0306,            /* 물류(정) */
					        SUM(ISNULL(FF_BU,0)) AS T0306_BU,           /* 물류(부) */
					        SUM(ISNULL(GG_JUNG,0)) AS T0307,            /* 마케팅/영업(정)   */
					        SUM(ISNULL(GG_BU,0)) AS T0307_BU,           /* 마케팅/영업(부)   */
					        SUM(ISNULL(HH_JUNG,0)) AS T0308,            /* 서비스/품질/환경(정) */
					        SUM(ISNULL(HH_BU,0)) AS T0308_BU,           /* 서비스/품질/환경(부) */
					        SUM(ISNULL(II_JUNG,0)) AS T0309,            /* 인사/총무(정) */
					        SUM(ISNULL(II_BU,0)) AS T0309_BU,           /* 인사/총무(부) */
					        SUM(ISNULL(JJ_JUNG,0)) AS T0310,            /* 건설(정) */
					        SUM(ISNULL(JJ_BU,0)) AS T0310_BU,           /* 건설(부) */
					        SUM(ISNULL(KK_JUNG,0)) AS T0311,            /* 협력/투자/금융/보험(정) */
					        SUM(ISNULL(KK_BU,0)) AS T0311_BU,           /* 협력/투자/금융/보험(부) */
					        SUM(ISNULL(LL_JUNG,0)) AS T0312,            /* 컨설팅/조사(정) */
					        SUM(ISNULL(LL_BU,0)) AS T0312_BU,           /* 컨설팅/조사(부) */
					        SUM(ISNULL(MM_JUNG,0)) AS T0313,            /* IT/시스템(정) */
					        SUM(ISNULL(MM_BU,0)) AS T0313_BU,           /* IT/시스템(부) */
					        SUM(ISNULL(NN_JUNG,0)) AS T0399,            /* 미정(정) */
					        SUM(ISNULL(NN_BU,0)) AS T0399_BU            /* 미정(부) */
					   /** 체결단계 **/
				       #elseif($vo.srch_div.equals("T02"))
				            SUM(ISNULL(AA_JUNG,0)) AS T0201,   /** 신규계약(정) **/
				            SUM(ISNULL(AA_BU,0)) AS T0201_BU,  /** 신규계약(부) **/
						    SUM(ISNULL(BB_JUNG,0)) AS T0202,   /** 변경계약(정) **/
						    SUM(ISNULL(BB_BU,0)) AS T0202_BU,  /** 변경계약(부) **/
						    SUM(ISNULL(CC_JUNG,0)) AS T0203,   /** 해지계약(정) **/
						    SUM(ISNULL(CC_BU,0)) AS T0203_BU   /** 해지계약(부) **/
				       /** 비지니스단계 **/
                       #elseif($vo.srch_div.equals("T01"))
                            SUM(ISNULL(AA_JUNG,0)) AS T0101,    /** NDA(정) **/
                            SUM(ISNULL(AA_BU,0)) AS T0101_BU,   /** NDA(부) **/
						    SUM(ISNULL(BB_JUNG,0)) AS T0102,    /** MOU/LOI(정) **/
                            SUM(ISNULL(BB_BU,0)) AS T0102_BU,   /** MOU/LOI(부) **/
						    SUM(ISNULL(CC_JUNG,0)) AS T0103,    /** 본계약(정) **/
                            SUM(ISNULL(CC_BU,0)) AS T0103_BU    /** 본계약(부) **/
                       
                       #end
					FROM
					(SELECT   A.COMP_CD, A.USER_ID, A.USER_NM 
						FROM TB_COM_USER A,
							(SELECT  DISTINCT USER_ID
				             	FROM  TB_COM_ROLE_USER
				                WHERE  ROLE_CD = 'RA02') B 
						WHERE A.USER_ID=B.USER_ID 
						#if($vo.session_comp_cd.equals("EHQ"))
						#else
							AND A.COMP_CD = :vo.session_comp_cd
						#end
							 
					)MAN
					LEFT OUTER JOIN			        
					(        
					    SELECT
					        D.RESPMAN_ID, 
					        D.RESPMAN_NM,
					        
					        /** 체결목적 **/
	                        #if($vo.srch_div.equals("T03"))                       
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0301' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) AA_JUNG,  
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0301' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) AA_BU,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0302' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) BB_JUNG, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0302' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) BB_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0303' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) CC_JUNG, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0303' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) CC_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0304' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) DD_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0304' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) DD_BU,  
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0305' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) EE_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0305' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) EE_BU,  
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0306' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) FF_JUNG, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0306' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) FF_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0307' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) GG_JUNG, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0307' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) GG_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0308' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) HH_JUNG, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0308' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) HH_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0309' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) II_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0309' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) II_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0310' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) JJ_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0310' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) JJ_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0311' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) KK_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0311' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) KK_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0312' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) LL_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0312' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) LL_BU, 
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0313' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) MM_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0313' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) MM_BU,                                               
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0399' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) NN_JUNG,
						        SUM(CASE WHEN  A.CNCLSNPURPS_BIGCLSFCN = 'T0399' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) NN_BU,
	                       /** 체결단계 **/
	                       #elseif($vo.srch_div.equals("T02"))
	                            SUM(CASE WHEN  A.DEPTH_CLSFCN = 'T0201' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) AA_JUNG,  
	                            SUM(CASE WHEN  A.DEPTH_CLSFCN = 'T0201' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) AA_BU,  
						        SUM(CASE WHEN  A.DEPTH_CLSFCN = 'T0202' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) BB_JUNG, 
						        SUM(CASE WHEN  A.DEPTH_CLSFCN = 'T0202' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) BB_BU, 
						        SUM(CASE WHEN  A.DEPTH_CLSFCN = 'T0203' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) CC_JUNG, 
						        SUM(CASE WHEN  A.DEPTH_CLSFCN = 'T0203' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) CC_BU, 
	                       /** 비지니스단계 **/
	                       #elseif($vo.srch_div.equals("T01"))
	                       		SUM(CASE WHEN  A.BIZ_CLSFCN = 'T0101' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) AA_JUNG,  
		                        SUM(CASE WHEN  A.BIZ_CLSFCN = 'T0101' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) AA_BU,
		                        SUM(CASE WHEN  A.BIZ_CLSFCN = 'T0102' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) BB_JUNG,  
		                        SUM(CASE WHEN  A.BIZ_CLSFCN = 'T0102' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) BB_BU,  
		                        SUM(CASE WHEN  A.BIZ_CLSFCN = 'T0103' AND D.MAIN_CNSD_YN = 'Y' THEN  1 ELSE 0 END) CC_JUNG,  
		                        SUM(CASE WHEN  A.BIZ_CLSFCN = 'T0103' AND D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) CC_BU,  
	                       #end
					            
					        COUNT(A.CNTRT_ID) TOTCNT,
					        SUM(CASE WHEN D.MAIN_CNSD_YN = 'N' THEN  1 ELSE 0 END) TOTCNT_BU
					
					    FROM    TN_CLM_CONTRACT_MASTER A,
					        TN_CLM_CONTRACT_CNSD B,
					        TN_CLM_CONT_CNSDREQ C,
					        TN_CLM_CONT_CNSDREQ_RESPMAN D,
					        TB_COM_USER TCU
					       
					    WHERE   A.DEL_YN = 'N'
					    #if($vo.session_comp_cd.equals("EHQ"))
						#else
							AND A.COMP_CD = :vo.session_comp_cd
						#end
					     AND TCU.USER_ID = D.RESPMAN_ID
					     AND C.DEL_YN = 'N'
					     AND A.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499') /* 구법무시스템이관, 사업부이관 제외 코드  */    
					    
					    /* 국내/해외/IP 검색조건 국내:A00000001, 해외:A00000002, IP:A00000003 */
	                      AND  C.MN_CNSD_DEPT = :vo.srch_dmstfrgn_gbn
	                    /* 시작일시 검색조건 */
	                    #if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
	                      AND  C.REQ_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
	                    #end
	                    /* 종료일시 검색조건 */
	                    #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
	                      AND  C.REQ_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
	                    #end
					
					      AND A.CNTRT_ID = B.CNTRT_ID
					      AND B.CNSDREQ_ID = C.CNSDREQ_ID       
					      AND C.CNSDREQ_ID = D.CNSDREQ_ID                                                      
					    GROUP BY D.RESPMAN_ID, D.RESPMAN_NM          
					) TA ON MAN.USER_ID = TA.RESPMAN_ID
					
					 GROUP BY ROLLUP(MAN.COMP_CD,MAN.USER_NM)
				)TB 
				ORDER BY ISNULL(COMP_CD, 'ZZZZZZZZ')   ASC  ,ISNULL (USER_NM,'ZZZZZZZZZZZ') ASC  
				
                ]]>
			</statement>
		</query>

		<!-- 담당자별 통계현황(현재기준일) - 계약검토 -->
		<query id="las.statistics.personCntrtToday" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
                   SELECT X.RESPMAN_NM,                 /** 담당자 **/ 
                       X.RESPMAN_ID,                    /** 담당자 ID **/
                       
                       CAST(SUM(REQ_JUNG1) AS NUMERIC) REQ_JUNG1,        /** 전주실적 - 의뢰(정) **/
                       CAST(SUM(REQ_BU1) AS NUMERIC) REQ_BU1,            /** 전주실적 - 의뢰(부) **/
                       CAST(SUM(CHULI_JUNG1) AS NUMERIC) CHULI_JUNG1,    /** 전주실적 - 처리(정) **/
                       CAST(SUM(CHULI_BU1) AS NUMERIC) CHULI_BU1,        /** 전주실적 - 처리(부) **/
                       CAST(SUM(REPLY_JUNG1) AS NUMERIC) REPLY_JUNG1,    /** 전주실적 - 회신(정) **/
                       CAST(SUM(REPLY_BU1) AS NUMERIC) REPLY_BU1,        /** 전주실적 - 회신(부) **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT1 AS NUMERIC)), '99999.99')) LT1_SUM, /** 전주실적 - L/T(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY_JUNG1) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT1)/(SUM(REPLY_JUNG1)),1) AS FLOAT)
                               END, '99999.9')) LT1,   /** 전주실적 - LT **/
                       
                       CAST(SUM(REQ_JUNG2) AS NUMERIC) REQ_JUNG2,        /** 금주실적 - 의뢰(정) **/
                       CAST(SUM(REQ_BU2) AS NUMERIC) REQ_BU2,            /** 금주실적 - 의뢰(부) **/
                       CAST(SUM(CHULI_JUNG2) AS NUMERIC) CHULI_JUNG2,    /** 금주실적 - 처리(정) **/
                       CAST(SUM(CHULI_BU2) AS NUMERIC) CHULI_BU2,        /** 금주실적 - 처리(부) **/
                       CAST(SUM(REPLY_JUNG2) AS NUMERIC) REPLY_JUNG2,    /** 금주실적 - 회신(정) **/
                       CAST(SUM(REPLY_BU2) AS NUMERIC) REPLY_BU2,        /** 금주실적 - 회신(부) **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT2 AS NUMERIC)), '99999.99')) LT2_SUM, /** 금주실적 - L/T(합) **/
                       
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY_JUNG2) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT2)/(SUM(REPLY_JUNG2)),1) AS FLOAT)
                               END, '99999.9')) LT2,   /** 금주실적 - LT **/
                       
                       CAST(SUM(REQ_JUNG3) AS NUMERIC) REQ_JUNG3,        /** 전월실적 - 의뢰(정) **/
                       CAST(SUM(REQ_BU3) AS NUMERIC) REQ_BU3,            /** 전월실적 - 의뢰(부) **/
                       CAST(SUM(CHULI_JUNG3) AS NUMERIC) CHULI_JUNG3,    /** 전월실적 - 처리(정) **/
                       CAST(SUM(CHULI_BU3) AS NUMERIC) CHULI_BU3,        /** 전월실적 - 처리(부) **/
                       CAST(SUM(REPLY_JUNG3) AS NUMERIC) REPLY_JUNG3,    /** 전월실적 - 회신(정) **/
                       CAST(SUM(REPLY_BU3) AS NUMERIC) REPLY_BU3,        /** 전월실적 - 회신(부) **/
                       RTRIM(DBO.NUM_FORMAT(SUM(LT3), '99999.99')) LT3_SUM, /** 전월실적 - L/T(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY_JUNG3) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT3)/(SUM(REPLY_JUNG3)),1) AS FLOAT) 
                               END, '99999.9')) LT3,   /** 전월실적 - L/T **/
                       
                       CAST(SUM(REQ_JUNG4) AS NUMERIC) REQ_JUNG4,        /** 금월실적 - 의뢰(정) **/
                       CAST(SUM(REQ_BU4) AS NUMERIC) REQ_BU4,            /** 금월실적 - 의뢰(부) **/
                       CAST(SUM(CHULI_JUNG4) AS NUMERIC) CHULI_JUNG4,    /** 금월실적 - 처리(정) **/
                       CAST(SUM(CHULI_BU4) AS NUMERIC) CHULI_BU4,        /** 금월실적 - 처리(부) **/
                       CAST(SUM(REPLY_JUNG4) AS NUMERIC) REPLY_JUNG4,    /** 금월실적 - 회신(정) **/
                       CAST(SUM(REPLY_BU4) AS NUMERIC) REPLY_BU4,        /** 금월실적 - 회신(부) **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT4 AS NUMERIC)), '99999.99')) LT4_SUM, /** 금월실적 - L/T(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY_JUNG4) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT4)/(SUM(REPLY_JUNG4)),1) AS FLOAT)
                              END, '99999.9')) LT4,    /** 금월실적 - L/T **/
                       
                       CAST(SUM(REQ_JUNG5) AS NUMERIC) REQ_JUNG5,        /** 금년실적 - 의뢰(정) **/
                       CAST(SUM(REQ_BU5) AS NUMERIC) REQ_BU5,            /** 금년실적 - 의뢰(부) **/
                       CAST(SUM(CHULI_JUNG5) AS NUMERIC) CHULI_JUNG5,    /** 금년실적 - 처리(정) **/
                       CAST(SUM(CHULI_BU5) AS NUMERIC) CHULI_BU5,        /** 금년실적 - 처리(부) **/
                       CAST(SUM(REPLY_JUNG5) AS NUMERIC) REPLY_JUNG5,    /** 금년실적 - 회신(정) **/
                       CAST(SUM(REPLY_BU5) AS NUMERIC) REPLY_BU5,        /** 금년실적 - 회신(부) **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT5 AS NUMERIC)), '99999.99')) LT5_SUM, /** 금년실적 - L/T(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY_JUNG5) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT5)/(SUM(REPLY_JUNG5)),1) AS FLOAT)
                               END, '99999.9')) LT5    /** 금년실적 - L/T **/
                            
                FROM (
                /** 전주 실적 **/
                SELECT A.RESPMAN_NM,
                       A.RESPMAN_ID,
                       SUM(REQ_JUNG) REQ_JUNG1,
                       SUM(REQ_BU) REQ_BU1,
                       SUM(CHULI_JUNG) CHULI_JUNG1,
                       SUM(CHULI_BU) CHULI_BU1,
                       SUM(REPLY_JUNG) REPLY_JUNG1,
                       SUM(REPLY_BU) REPLY_BU1,
                       SUM(LT) LT1,
                       0 REQ_JUNG2,
                       0 REQ_BU2,
                       0 CHULI_JUNG2,
                       0 CHULI_BU2,
                       0 REPLY_JUNG2,
                       0 REPLY_BU2,
                       0 LT2,
                       0 REQ_JUNG3,
                       0 REQ_BU3,
                       0 CHULI_JUNG3,
                       0 CHULI_BU3,
                       0 REPLY_JUNG3,
                       0 REPLY_BU3,
                       0 LT3,
                       0 REQ_JUNG4,
                       0 REQ_BU4,
                       0 CHULI_JUNG4,
                       0 CHULI_BU4,
                       0 REPLY_JUNG4,
                       0 REPLY_BU4,
                       0 LT4,
                       0 REQ_JUNG5,
                       0 REQ_BU5,
                       0 CHULI_JUNG5,
                       0 CHULI_BU5,
                       0 REPLY_JUNG5,
                       0 REPLY_BU5,
                       0 LT5
                FROM
                (
                   /** 의뢰 건수 **/                               
                    SELECT  B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REQ_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,
                          TB_COM_USER TCU         
                                
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = b.RESPMAN_ID                  
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */ 
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforeweek_s) AND CONVERT(DATETIME,:vo.srch_beforeweek_e)+1
                    
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) CHULI_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID 
                      AND A.COMP_CD = :vo.session_comp_cd                 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforeweek_s) AND CONVERT(DATETIME,:vo.srch_beforeweek_e)+1
                      AND A.PREV_CNSDREQ_ID IS NULL    
                
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REPLY_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID 
                      AND E.COMP_CD = :vo.session_comp_cd                 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforeweek_s) AND CONVERT(DATETIME,:vo.srch_beforeweek_e)+1
                
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ_JUNG,
                            0 REQ_BU,
                            0 CHULI_JUNG,
                            0 CHULI_BU,
                            0 REPLY_JUNG,
                            0 REPLY_BU,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND D.CNSD_STATUS = 'C04305'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforeweek_s) AND CONVERT(DATETIME,:vo.srch_beforeweek_e)+1
                
                    ) A 
                WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn 
                
                GROUP BY A.RESPMAN_NM, A.RESPMAN_ID
                
                UNION ALL
                
                /** 금주 실적 **/
                SELECT A.RESPMAN_NM,
                       A.RESPMAN_ID,
                       0 REQ_JUNG1,
                       0 REQ_BU1,
                       0 CHULI_JUNG1,
                       0 CHULI_BU1,
                       0 REPLY_JUNG1,
                       0 REPLY_BU1,
                       0 LT1,        
                       SUM(REQ_JUNG) REQ_JUNG2,
                       SUM(REQ_BU) REQ_BU2,
                       SUM(CHULI_JUNG) CHULI_JUNG2,
                       SUM(CHULI_BU) CHULI_BU2,
                       SUM(REPLY_JUNG) REPLY_JUNG2,
                       SUM(REPLY_BU) REPLY_BU2,
                       SUM(LT) LT2,
                       0 REQ_JUNG3,
                       0 REQ_BU3,
                       0 CHULI_JUNG3,
                       0 CHULI_BU3,
                       0 REPLY_JUNG3,
                       0 REPLY_BU3,
                       0 LT3,
                       0 REQ_JUNG4,
                       0 REQ_BU4,
                       0 CHULI_JUNG4,
                       0 CHULI_BU4,
                       0 REPLY_JUNG4,
                       0 REPLY_BU4,
                       0 LT4,
                       0 REQ_JUNG5,
                       0 REQ_BU5,
                       0 CHULI_JUNG5,
                       0 CHULI_BU5,
                       0 REPLY_JUNG5,
                       0 REPLY_BU5,
                       0 LT5
                FROM
                (
                    /** 의뢰 건수 **/                               
                    SELECT  B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REQ_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,
                          TB_COM_USER TCU         
                                
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID               
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */ 
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME,:vo.srch_curweek_s) AND CONVERT(DATETIME,:vo.srch_curweek_e)+1
                    
                    UNION ALL
                    /** 처리 건수 **/
                    SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) CHULI_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_curweek_s) AND CONVERT(DATETIME,:vo.srch_curweek_e)+1
                      AND A.PREV_CNSDREQ_ID IS NULL        
                
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REPLY_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_curweek_s) AND CONVERT(DATETIME,:vo.srch_curweek_e)+1
                
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ_JUNG,
                            0 REQ_BU,
                            0 CHULI_JUNG,
                            0 CHULI_BU,
                            0 REPLY_JUNG,
                            0 REPLY_BU,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_curweek_s) AND CONVERT(DATETIME,:vo.srch_curweek_e)+1
                
                    ) A 
                WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
                
                GROUP BY A.RESPMAN_NM, A.RESPMAN_ID
                
                UNION ALL
                
                /** 전월 실적 **/
                SELECT A.RESPMAN_NM,
                       A.RESPMAN_ID,
                       0 REQ_JUNG1,
                       0 REQ_BU1,
                       0 CHULI_JUNG1,
                       0 CHULI_BU1,
                       0 REPLY_JUNG1,
                       0 REPLY_BU1,
                       0 LT1,  
                       0 REQ_JUNG2,
                       0 REQ_BU2,
                       0 CHULI_JUNG2,
                       0 CHULI_BU2,
                       0 REPLY_JUNG2,
                       0 REPLY_BU2,
                       0 LT2,
                       SUM(REQ_JUNG) REQ_JUNG3,
                       SUM(REQ_BU) REQ_BU3,
                       SUM(CHULI_JUNG) CHULI_JUNG3,
                       SUM(CHULI_BU) CHULI_BU3,
                       SUM(REPLY_JUNG) REPLY_JUNG3,
                       SUM(REPLY_BU) REPLY_BU3,
                       SUM(LT) LT3,
                       0 REQ_JUNG4,
                       0 REQ_BU4,
                       0 CHULI_JUNG4,
                       0 CHULI_BU4,
                       0 REPLY_JUNG4,
                       0 REPLY_BU4,
                       0 LT4,
                       0 REQ_JUNG5,
                       0 REQ_BU5,
                       0 CHULI_JUNG5,
                       0 CHULI_BU5,
                       0 REPLY_JUNG5,
                       0 REPLY_BU5,
                       0 LT5
                FROM
                (
                    /** 의뢰 건수 **/                               
                    SELECT  B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REQ_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,
                          TB_COM_USER TCU         
                                
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID     
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */ 
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforemonth_s) AND CONVERT(DATETIME,:vo.srch_beforemonth_e)+1
                    
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) CHULI_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforemonth_s) AND CONVERT(DATETIME,:vo.srch_beforemonth_e)+1
                      AND A.PREV_CNSDREQ_ID IS NULL        
                
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REPLY_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforemonth_s) AND CONVERT(DATETIME,:vo.srch_beforemonth_e)+1
                
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ_JUNG,
                            0 REQ_BU,
                            0 CHULI_JUNG,
                            0 CHULI_BU,
                            0 REPLY_JUNG,
                            0 REPLY_BU,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_beforemonth_s) AND CONVERT(DATETIME,:vo.srch_beforemonth_e)+1
                    
                    ) A 
                WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
                GROUP BY A.RESPMAN_NM, A.RESPMAN_ID
                
                UNION ALL
                
                /** 금월 실적 **/
                SELECT A.RESPMAN_NM,
                       A.RESPMAN_ID,
                       0 REQ_JUNG1,
                       0 REQ_BU1,
                       0 CHULI_JUNG1,
                       0 CHULI_BU1,
                       0 REPLY_JUNG1,
                       0 REPLY_BU1,
                       0 LT1,  
                       0 REQ_JUNG2,
                       0 REQ_BU2,
                       0 CHULI_JUNG2,
                       0 CHULI_BU2,
                       0 REPLY_JUNG2,
                       0 REPLY_BU2,
                       0 LT2,
                       0 REQ_JUNG3,
                       0 REQ_BU3,
                       0 CHULI_JUNG3,
                       0 CHULI_BU3,
                       0 REPLY_JUNG3,
                       0 REPLY_BU3,
                       0 LT3,
                       SUM(REQ_JUNG) REQ_JUNG4,
                       SUM(REQ_BU) REQ_BU4,
                       SUM(CHULI_JUNG) CHULI_JUNG4,
                       SUM(CHULI_BU) CHULI_BU4,
                       SUM(REPLY_JUNG) REPLY_JUNG4,
                       SUM(REPLY_BU) REPLY_BU4,
                       SUM(LT) LT4,
                       0 REQ_JUNG5,
                       0 REQ_BU5,
                       0 CHULI_JUNG5,
                       0 CHULI_BU5,
                       0 REPLY_JUNG5,
                       0 REPLY_BU5,
                       0 LT5
                FROM
                (
                     /** 의뢰 건수 **/                               
                    SELECT  B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REQ_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,
                          TB_COM_USER TCU         
                                
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */ 
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME,:vo.srch_curmonth_s) AND CONVERT(DATETIME,:vo.srch_curmonth_e)+1
                    
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) CHULI_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                   
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_curmonth_s) AND CONVERT(DATETIME,:vo.srch_curmonth_e)+1
                      AND A.PREV_CNSDREQ_ID IS NULL     
                
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REPLY_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                   
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_curmonth_s) AND CONVERT(DATETIME,:vo.srch_curmonth_e)+1
                
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ_JUNG,
                            0 REQ_BU,
                            0 CHULI_JUNG,
                            0 CHULI_BU,
                            0 REPLY_JUNG,
                            0 REPLY_BU,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                   
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,:vo.srch_curmonth_s) AND CONVERT(DATETIME,:vo.srch_curmonth_e)+1
                     
                    ) A 
                WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
                GROUP BY A.RESPMAN_NM, A.RESPMAN_ID
                
                UNION ALL
                
                /** 금년 실적 **/
                SELECT A.RESPMAN_NM,
                       A.RESPMAN_ID,
                       0 REQ_JUNG1,
                       0 REQ_BU1,
                       0 CHULI_JUNG1,
                       0 CHULI_BU1,
                       0 REPLY_JUNG1,
                       0 REPLY_BU1,
                       0 LT1,  
                       0 REQ_JUNG2,
                       0 REQ_BU2,
                       0 CHULI_JUNG2,
                       0 CHULI_BU2,
                       0 REPLY_JUNG2,
                       0 REPLY_BU2,
                       0 LT2,
                       0 REQ_JUNG3,
                       0 REQ_BU3,
                       0 CHULI_JUNG3,
                       0 CHULI_BU3,
                       0 REPLY_JUNG3,
                       0 REPLY_BU3,
                       0 LT3,
                       0 REQ_JUNG4,
                       0 REQ_BU4,
                       0 CHULI_JUNG4,
                       0 CHULI_BU4,
                       0 REPLY_JUNG4,
                       0 REPLY_BU4,
                       0 LT4,
                       SUM(REQ_JUNG) REQ_JUNG5,
                       SUM(REQ_BU) REQ_BU5,
                       SUM(CHULI_JUNG) CHULI_JUNG5,
                       SUM(CHULI_BU) CHULI_BU5,
                       SUM(REPLY_JUNG) REPLY_JUNG5,
                       SUM(REPLY_BU) REPLY_BU5,
                       SUM(LT) LT5
                       
                FROM
                (
                     /** 의뢰 건수 **/                               
                    SELECT  B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REQ_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,
                          TB_COM_USER TCU         
                                
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                   
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */ 
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'0101') AND CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'1231')+1
                    
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) CHULI_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                  
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'0101') AND CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'1231')+1
                      AND A.PREV_CNSDREQ_ID IS NULL     
                
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESPMAN_ID,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) AS FLOAT) REPLY_JUNG,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) AS FLOAT) REPLY_BU,
                        0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				      AND TCU.USER_ID = B.RESPMAN_ID                   
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'0101') AND CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'1231')+1
                
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ_JUNG,
                            0 REQ_BU,
                            0 CHULI_JUNG,
                            0 CHULI_BU,
                            0 REPLY_JUNG,
                            0 REPLY_BU,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER TCU
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
					  AND TCU.USER_ID = B.RESPMAN_ID                   
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'0101') AND CONVERT(DATETIME,CAST(YEAR(GETDATE()) AS NVARCHAR)+'1231')+1
                   
                    ) A 
                WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn                      
                GROUP BY A.RESPMAN_NM, A.RESPMAN_ID
                
                ) X
                GROUP BY X.RESPMAN_NM, X.RESPMAN_ID
                ORDER BY X.RESPMAN_NM
                ]]>
			</statement>
		</query>


		<!-- 담당자별 통계현황(기간별 실적) - 계약검토 -->
		<query id="las.statistics.personCntrtPeriod" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
            SELECT A.RESPMAN_NM,                /** 담당자 **/
                   CAST(SUM(REQ_JUNG) AS NUMERIC) REQ_JUNG1,     /** 의뢰(정) **/
                   CAST(SUM(REQ_BU) AS NUMERIC) REQ_BU1,         /** 의뢰(부) **/
                   CAST(SUM(CHULI_JUNG) AS NUMERIC) CHULI_JUNG1, /** 처리(정) **/
                   CAST(SUM(CHULI_BU) AS NUMERIC) CHULI_BU1,     /** 처리(부) **/
                   CAST(SUM(REPLY_JUNG) AS NUMERIC) REPLY_JUNG1, /** 회신(정) **/
                   CAST(SUM(REPLY_BU) AS NUMERIC) REPLY_BU1,     /** 회신(부) **/
                   RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT AS NUMERIC)), '99999.99')) LT1_SUM,  /** L/T(합) **/
                   RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY_JUNG) = 0 THEN 0 
                        ELSE CAST(DBO.TRUNC(SUM(LT)/(SUM(REPLY_JUNG)),2) AS FLOAT) END,'99999.9')) LT1 /** L/T **/
                   
            FROM
            (
                /** 의뢰 건수 **/                               
                SELECT  B.RESPMAN_NM,
                    B.RESP_DEPT AS DMSTFRGN_GBN,
                    D.CNSDREQ_ID,
                    DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ_JUNG,
                    DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) REQ_BU,
                    0 CHULI_JUNG,
                    0 CHULI_BU,
                    0 REPLY_JUNG,
                    0 REPLY_BU,
                    0 LT
                    
                FROM    TN_CLM_CONT_CNSDREQ A,
                    TN_CLM_CONT_CNSDREQ_RESPMAN B,
                    TN_CLM_CONTRACT_CNSD D,
                    TN_CLM_CONTRACT_MASTER E,
                    TB_COM_USER TCU
                                     
                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                  AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                  		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                  			   ELSE 'N' END
		      	  AND TCU.USER_ID = B.RESPMAN_ID               
                  AND D.CNTRT_ID = E.CNTRT_ID
                  AND   A.DEL_YN = 'N'
                  AND   E.DEL_YN = 'N'
                  AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                  AND   A.PREV_CNSDREQ_ID IS NULL
                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                  AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                  AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt ) AND CONVERT(DATETIME, :vo.srch_end_dt )+1
                
                UNION ALL
                /** 처리 건수 **/
                 SELECT  DISTINCT 
                    B.RESPMAN_NM,
                    B.RESP_DEPT AS DMSTFRGN_GBN,
                    A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                    0 REQ_JUNG,
                    0 REQ_BU,
                    DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI_JUNG,
                    DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) CHULI_BU,
                    0 REPLY_JUNG,
                    0 REPLY_BU,
                    0 LT
                    
                FROM TN_CLM_CONT_CNSDREQ A,
                     TN_CLM_CONT_CNSDREQ_RESPMAN B,
                     TN_CLM_CONTRACT_DEPTCNSD D,
                     TN_CLM_CONTRACT_MASTER E,
                     TB_COM_USER TCU
                     
                WHERE A.CNSDREQ_ID = D.CNSDREQ_ID 
                  AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                  		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                  			   ELSE 'N' END
		      	  AND TCU.USER_ID = B.RESPMAN_ID                  
                  AND B.CNSDREQ_ID = D.CNSDREQ_ID
                  AND D.CNTRT_ID = E.CNTRT_ID
                  AND A.DEL_YN = 'N'
                  AND E.DEL_YN = 'N'
                  AND D.CNSD_STATUS = 'C04305'
                  AND D.CNSD_DT IS NOT NULL
                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                    AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt ) AND CONVERT(DATETIME, :vo.srch_end_dt )+1
                  AND A.PREV_CNSDREQ_ID IS NULL 
                     
                UNION ALL
                
                /** 회신건수 **/
                SELECT  DISTINCT 
                    B.RESPMAN_NM,
                    B.RESP_DEPT AS DMSTFRGN_GBN,
                    D.CNSDREQ_ID,
                    0 REQ_JUNG,
                    0 REQ_BU,
                    0 CHULI_JUNG,
                    0 CHULI_BU,
                    DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY_JUNG,
                    DBO.DECODE3(B.MAIN_CNSD_YN, 'N', 1, 0) REPLY_BU,
                   0 LT
                   
                FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                     TN_CLM_CONTRACT_DEPTCNSD D,
                     TN_CLM_CONTRACT_MASTER E,
                     TB_COM_USER TCU
                     
                WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                  AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                  		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                  			   ELSE 'N' END
		      	  AND TCU.USER_ID = B.RESPMAN_ID                 
                  AND D.CNTRT_ID = E.CNTRT_ID
                  AND E.DEL_YN = 'N'
                  AND D.CNSD_STATUS = 'C04305'
                  AND D.CNSD_DT IS NOT NULL
                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt ) AND CONVERT(DATETIME, :vo.srch_end_dt )+1
            
                UNION ALL
                
                  /** L/T **/
                 SELECT  DISTINCT 
                        B.RESPMAN_NM,
                        B.RESP_DEPT AS DMSTFRGN_GBN,
                        D.CNSDREQ_ID,
                        0 REQ_JUNG,
                        0 REQ_BU,
                        0 CHULI_JUNG,
                        0 CHULI_BU,
                        0 REPLY_JUNG,
                        0 REPLY_BU,
                        CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                        
                FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                     TN_CLM_CONTRACT_DEPTCNSD D,
                     TN_CLM_CONTRACT_MASTER E,
                     TB_COM_USER TCU
                     
                WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                  AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                  		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                  			   ELSE 'N' END
		      	  AND TCU.USER_ID = B.RESPMAN_ID                  
                  AND D.CNTRT_ID = E.CNTRT_ID
                  AND E.DEL_YN = 'N'
                  AND D.CNSD_STATUS = 'C04305'
                  AND D.CNSD_DT IS NOT NULL
                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt ) AND CONVERT(DATETIME, :vo.srch_end_dt)+1
            
                ) A 
            WHERE 1=1
            #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
            AND A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn                      
            #end 
            
            GROUP BY A.RESPMAN_NM
                ]]>
			</statement>
		</query>

		<!-- 담당자별 통계현황(현재일 기준) - 법률자문 -->
		<query id="las.statistics.personLawToday" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
				SELECT * FROM (
				 SELECT USER_NM AS RESPMAN_NM
				      , CAST(ISNULL(REQ_LAST_WEEK,0) AS NUMERIC) REQ_JUNG1 /** 전주실적 - 의뢰(정) **/
				      , CAST(ISNULL(PRO_LAST_WEEK,0) AS NUMERIC) CHULI_JUNG1 /** 전주실적 - 처리(정) **/
				      , CAST(ISNULL(RES_LAST_WEEK,0) AS NUMERIC) REPLY_JUNG1 /** 전주실적 - 회신(정) **/
				      , CAST(RTRIM(DBO.NUM_FORMAT(ISNULL(LT_LAST_WEEK,0), '99999.9')) AS FLOAT) LT1 /** 전주실적 - L/T **/
				      , 0 REQ_BU1 /** 전주실적 - 의뢰(부) **/
                      , 0 CHULI_BU1 /** 전주실적 - 처리(부) **/
                      , 0 REPLY_BU1 /** 전주실적 - 회신(부) **/                      
				      
				      , CAST(ISNULL(REQ_THIS_WEEK,0) AS NUMERIC) REQ_JUNG2 /** 금주실적 - 의뢰(정) **/
				      , CAST(ISNULL(PRO_THIS_WEEK,0) AS NUMERIC) CHULI_JUNG2 /** 금주실적 - 처리(정) **/
				      , CAST(ISNULL(RES_THIS_WEEK,0) AS NUMERIC) REPLY_JUNG2 /** 금주실적 - 회신(정) **/
				      , CAST(RTRIM(DBO.NUM_FORMAT(ISNULL(LT_THIS_WEEK,0), '99999.9')) AS FLOAT) LT2 /** 금주실적 - L/T **/
				      , 0 REQ_BU2 /** 금주실적 - 의뢰(부) **/
                      , 0 CHULI_BU2 /** 금주실적 - 처리(부) **/
                      , 0 REPLY_BU2 /** 금주실적 - 회신(부) **/                      
				      
				      , CAST(ISNULL(REQ_LAST_MONTH,0) AS NUMERIC) REQ_JUNG3 /** 전월실적 - 의뢰(정) **/
				      , CAST(ISNULL(PRO_LAST_MONTH,0) AS NUMERIC) CHULI_JUNG3 /** 전월실적 - 처리(정) **/
				      , CAST(ISNULL(RES_LAST_MONTH,0) AS NUMERIC) REPLY_JUNG3 /** 전월실적 - 회신(정) **/
				      , CAST(RTRIM(DBO.NUM_FORMAT(ISNULL(LT_LAST_MONTH,0), '99999.9')) AS FLOAT) LT3 /** 전월실적 - L/T **/
				      , 0 REQ_BU3 /** 전월실적 - 의뢰(부) **/
                      , 0 CHULI_BU3 /** 전월실적 - 처리(부) **/
                      , 0 REPLY_BU3 /** 전월실적 - 회신(부) **/
                      
				      , CAST(ISNULL(REQ_THIS_MONTH,0) AS NUMERIC) REQ_JUNG4 /** 금월실적 - 의뢰(정) **/
				      , CAST(ISNULL(PRO_THIS_MONTH,0) AS NUMERIC) CHULI_JUNG4 /** 금월실적 - 처리(정) **/
				      , CAST(ISNULL(RES_THIS_MONTH,0) AS NUMERIC) REPLY_JUNG4 /** 금월실적 - 회신(정) **/
				      , CAST(RTRIM(DBO.NUM_FORMAT(ISNULL(LT_THIS_MONTH,0), '99999.9')) AS FLOAT) LT4 /** 금월실적 - L/T **/
				      , 0 REQ_BU4 /** 금월실적 - 의뢰(부) **/
                      , 0 CHULI_BU4 /** 금월실적 - 처리(부) **/
                      , 0 REPLY_BU4 /** 금월실적 - 회신(부) **/
				      
				      , CAST(ISNULL(REQ_THIS_YEAR,0) AS NUMERIC) REQ_JUNG5 /** 금년실적 - 의뢰(정) **/
				      , CAST(ISNULL(PRO_THIS_YEAR,0) AS NUMERIC) CHULI_JUNG5 /** 금년실적 - 처리(정) **/
				      , CAST(ISNULL(RES_THIS_YEAR,0) AS NUMERIC) REPLY_JUNG5 /** 금년실적 - 회신(정) **/
				      , CAST(RTRIM(DBO.NUM_FORMAT(ISNULL(LT_THIS_YEAR,0), '99999.9')) AS FLOAT)  LT5 /** 금년실적 - L/T **/
				      , 0 REQ_BU5 /** 금년실적 - 의뢰(부) **/
                      , 0 CHULI_BU5 /** 금년실적 - 처리(부) **/
                      , 0 REPLY_BU5 /** 금년실적 - 회신(부) **/
                      
                      ,LT1_SUM, LT2_SUM, LT3_SUM, LT4_SUM, LT5_SUM
				 FROM 
				 (SELECT TCU.USER_ID, TCU.USER_NM, TCU.BLNGT_ORGNZ
				    FROM TB_COM_USER TCU, 
				         (SELECT DISTINCT USER_ID
				            FROM TB_COM_ROLE_USER
				            WHERE ROLE_CD = 'RA02') TCRU
				   WHERE TCU.USER_ID = TCRU.USER_ID
				   	   AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END 
				   ) RESPMAN
				  LEFT OUTER JOIN
				 (SELECT RESPMAN_ID, SUM(REQ_LAST_WEEK) REQ_LAST_WEEK, SUM(PRO_LAST_WEEK) PRO_LAST_WEEK, SUM(RES_LAST_WEEK) RES_LAST_WEEK, DBO.TRUNC(AVG(LT_LAST_WEEK),1) LT_LAST_WEEK, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_LAST_WEEK),0), '99999.99')) LT1_SUM
				       , SUM(REQ_THIS_WEEK) REQ_THIS_WEEK, SUM(PRO_THIS_WEEK) PRO_THIS_WEEK, SUM(RES_THIS_WEEK) RES_THIS_WEEK, DBO.TRUNC(AVG(LT_THIS_WEEK),1) LT_THIS_WEEK, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_THIS_WEEK),0), '99999.99')) LT2_SUM
				       , SUM(REQ_LAST_MONTH) REQ_LAST_MONTH, SUM(PRO_LAST_MONTH) PRO_LAST_MONTH, SUM(RES_LAST_MONTH) RES_LAST_MONTH, DBO.TRUNC(AVG(LT_LAST_MONTH),1) LT_LAST_MONTH, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_LAST_MONTH),0), '99999.99')) LT3_SUM
				       , SUM(REQ_THIS_MONTH) REQ_THIS_MONTH, SUM(PRO_THIS_MONTH) PRO_THIS_MONTH, SUM(RES_THIS_MONTH) RES_THIS_MONTH, DBO.TRUNC(AVG(LT_THIS_MONTH),1) LT_THIS_MONTH, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_THIS_MONTH),0), '99999.99')) LT4_SUM
				       , SUM(REQ_THIS_YEAR) REQ_THIS_YEAR, SUM(PRO_THIS_YEAR) PRO_THIS_YEAR, SUM(RES_THIS_YEAR) RES_THIS_YEAR, DBO.TRUNC(AVG(LT_THIS_YEAR),1) LT_THIS_YEAR, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_THIS_YEAR),0), '99999.99')) LT5_SUM
				   FROM  (
				         SELECT CNSDMAN_ID, RESPMAN_ID, INTNL_PRGRS_STATUS, REG_DT, LT
				              /** 전주실적 **/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND CHAR_REG_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7), 23),'-','')
				                      		AND REPLACE(CONVERT(CHAR(10), ( GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6), 23),'-','')
				                     THEN 1 ELSE 0 END REQ_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7), 23),'-','')
				                      		AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6), 23),'-','')
				                     THEN 1 ELSE 0 END PRO_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7), 23),'-','')
				                       		AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6), 23),'-','')
				                     THEN 1 ELSE 0 END RES_LAST_WEEK
				              , CASE WHEN CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7), 23),'-','') 
				              				AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6), 23),'-','') 
				                     THEN LT ELSE NULL END LT_LAST_WEEK
				              /** 금주실적 **/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND CHAR_REG_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )), 23),'-','')  
				                      		AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6), 23),'-','')
				                     THEN 1 ELSE 0 END REQ_THIS_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )), 23),'-','')  
				                      		AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6), 23),'-','')
				                     THEN 1 ELSE 0 END PRO_THIS_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )), 23),'-','')  
				                      		AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6), 23),'-','')
				                     THEN 1 ELSE 0 END RES_THIS_WEEK
				              , CASE WHEN CHAR_CNSD_DT BETWEEN REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )), 23),'-','')
				              				AND REPLACE(CONVERT(CHAR(10), (GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6), 23),'-','')
				                     THEN LT ELSE NULL END LT_THIS_WEEK
				              /** 전월실적 **/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND YEAR(REG_DT) = YEAR(GETDATE()) AND MONTH(REG_DT) = MONTH(GETDATE())-1 
				                     THEN 1 ELSE 0 END REQ_LAST_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND YEAR(RE_DT) = YEAR(GETDATE()) AND MONTH(RE_DT) = MONTH(GETDATE())-1 
				                     THEN 1 ELSE 0 END PRO_LAST_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND YEAR(RE_DT) = YEAR(GETDATE()) AND MONTH(RE_DT) = MONTH(GETDATE())-1 
				                     THEN 1 ELSE 0 END RES_LAST_MONTH
				              , CASE WHEN YEAR(CNSD_DT) = YEAR(GETDATE()) AND MONTH(CNSD_DT) = MONTH(GETDATE())-1 
				                     THEN LT ELSE NULL END LT_LAST_MONTH     
				              /** 금월실적 **/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                     AND YEAR(REG_DT) = YEAR(GETDATE()) AND MONTH(REG_DT) = MONTH(GETDATE())
				                     THEN 1 ELSE 0 END REQ_THIS_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND YEAR(RE_DT) = YEAR(GETDATE()) AND MONTH(RE_DT) = MONTH(GETDATE())
				                     THEN 1 ELSE 0 END PRO_THIS_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND YEAR(RE_DT) = YEAR(GETDATE()) AND MONTH(RE_DT) = MONTH(GETDATE())
				                     THEN 1 ELSE 0 END RES_THIS_MONTH
				              , CASE WHEN YEAR(CNSD_DT) = YEAR(GETDATE()) AND MONTH(CNSD_DT) = MONTH(GETDATE())
				                     THEN LT ELSE NULL END LT_THIS_MONTH
				              /** 금년실적 **/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND YEAR(REG_DT) = YEAR(GETDATE())
				                     THEN 1 ELSE 0 END REQ_THIS_YEAR
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND YEAR(RE_DT) = YEAR(GETDATE()) 
				                     THEN 1 ELSE 0 END PRO_THIS_YEAR
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND YEAR(RE_DT) = YEAR(GETDATE())
				                     THEN 1 ELSE 0 END RES_THIS_YEAR
				              , CASE WHEN YEAR(CNSD_DT) = YEAR(GETDATE())
				                     THEN LT ELSE NULL END LT_THIS_YEAR    
				         FROM
				             (
				             SELECT A.CNSLT_NO, MIN_HSTRY_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT 
				             	  , REPLACE(CONVERT(CHAR(10), REG_DT, 23),'-','') AS CHAR_REG_DT /*YYYYMMDD*/
				                  , REPLACE(CONVERT(CHAR(10), RE_DT, 23),'-','') AS CHAR_RE_DT /*YYYYMMDD*/
				                  , REPLACE(CONVERT(CHAR(10), CNSD_DT, 23),'-','') AS CHAR_CNSD_DT /*YYYYMMDD*/
				                  , CASE WHEN CNSD_DT IS NOT NULL AND INTNL_PRGRS_STATUS IN ('S03', 'S07') THEN REQ_LT 
				                         ELSE NULL
				                    END LT
				                  , ROW_NUMBER() OVER (ORDER BY REG_DT DESC, A.CNSLT_NO, HSTRY_NO) RN    
				              FROM (SELECT CNSLT_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT, REQ_LT
				                      FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S02','S03','S07')
				                        AND DEL_YN = 'N'
                                        #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
				                        AND DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
				                        #end
				                        AND YEAR(REG_DT) > YEAR(GETDATE()) -2
				                        
				                    )A,
				                    (SELECT CNSLT_NO, MIN(HSTRY_NO) MIN_HSTRY_NO
				                       FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S03','S07')
				                        AND DEL_YN = 'N'
				                        #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
                                        AND DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
                                        #end
				                         AND YEAR(REG_DT) > YEAR(GETDATE()) -2
				                      GROUP BY CNSLT_NO
				                    )B,

				                    ( SELECT  CNSLT_NO
				                                              , CNSLT_TYPE
				                                          FROM  TN_LAS_CONSULT_TYPE
				                                         WHERE  HSTRY_NO = 0 
				                     ) TLCT
				                    
				             WHERE A.CNSLT_NO = B.CNSLT_NO
				             AND A.CNSLT_NO = TLCT.CNSLT_NO
				             
				             #if ($vo.srch_type && $vo.srch_type.equals("P"))
                             	AND TLCT.CNSLT_TYPE = 'A20'
                             #else
                             	AND TLCT.CNSLT_TYPE != 'A20'
                             #end
				             ) TLC,
				             (
				             SELECT CNSLT_NO, RESPMAN_ID
				               FROM TN_LAS_CONSULT_RESPMAN
				              WHERE DEL_YN = 'N'
				             ) TLCR
				        WHERE TLC.CNSLT_NO = TLCR.CNSLT_NO
				       ) SA
				GROUP BY RESPMAN_ID) CONSULT
				ON RESPMAN.USER_ID = CONSULT.RESPMAN_ID
				) TA ORDER BY RESPMAN_NM            
                ]]>
			</statement>
		</query>

		<!-- 담당자별 통계현황(기간별 실적) - 법률자문 -->
		<query id="las.statistics.personLawPeriod" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
 
				 SELECT * FROM (
				 SELECT USER_NM RESPMAN_NM
				      , CAST(ISNULL(REQ_LAST_WEEK,0) AS NUMERIC) REQ_JUNG1 /** 의뢰(정) **/
				      , 0 REQ_BU1  /** 의뢰(부) **/
				      , CAST(ISNULL(PRO_LAST_WEEK,0) AS NUMERIC) CHULI_JUNG1 /** 처리(정) **/
				      , 0 CHULI_BU1 /** 처리(부) **/
				      , CAST(ISNULL(RES_LAST_WEEK,0) AS NUMERIC) REPLY_JUNG1 /** 회신(정) **/
				      , 0 REPLY_BU1 /** 회신(부) **/
				      , CAST(RTRIM(DBO.NUM_FORMAT(ISNULL(LT,0),'99999.9')) AS FLOAT) LT1 /** L/T **/
				      , CAST(LT1_SUM AS FLOAT) AS LT1_SUM
				 FROM
				 (SELECT TCU.USER_ID, TCU.USER_NM, TCU.BLNGT_ORGNZ
				    FROM TB_COM_USER TCU, 
				         (SELECT DISTINCT USER_ID
				            FROM TB_COM_ROLE_USER
				            WHERE ROLE_CD = 'RA02') TCRU
				   WHERE TCU.USER_ID = TCRU.USER_ID
				       AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TCU.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      		       WHEN TCU.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      			   ELSE 'N' END
				   ) RESPMAN
				  LEFT OUTER JOIN
				 (SELECT RESPMAN_ID, SUM(REQ_LAST_WEEK) REQ_LAST_WEEK, SUM(PRO_LAST_WEEK) PRO_LAST_WEEK, SUM(RES_LAST_WEEK) RES_LAST_WEEK, 
				 	DBO.TRUNC(AVG(LT),1) LT,
				 	RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT),0), '99999.99')) LT1_SUM
				   FROM  (
				         SELECT CNSDMAN_ID, RESPMAN_ID, INTNL_PRGRS_STATUS, LT
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02'
				                     THEN 1 ELSE 0 END REQ_LAST_WEEK 
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      
				                      /** 기간 세팅 **/
				                      AND RE_DT >= CONVERT(DATETIME, :vo.srch_start_dt, 112)
				                      AND RE_DT <= CONVERT(DATETIME, :vo.srch_end_dt, 112) + 1
				                     THEN 1 ELSE 0 END PRO_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      
				                      /** 기간 세팅 **/
				                      AND RE_DT >= CONVERT(DATETIME, :vo.srch_start_dt, 112)
				                      AND RE_DT <= CONVERT(DATETIME, :vo.srch_end_dt, 112) + 1
				                     THEN 1 ELSE 0 END RES_LAST_WEEK
				         FROM
				             (
				             SELECT A.CNSLT_NO, MIN_HSTRY_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT
				             	  , REPLACE(CONVERT(CHAR(10), REG_DT, 23),'-','') AS CHAR_REG_DT /*YYYYMMDD*/
				                  , REPLACE(CONVERT(CHAR(10), RE_DT, 23),'-','') AS CHAR_RE_DT /*YYYYMMDD*/
				                  , CASE WHEN CNSD_DT IS NOT NULL AND INTNL_PRGRS_STATUS IN ('S03', 'S07') THEN REQ_LT 
				                         ELSE NULL
				                    END LT
				                  , ROW_NUMBER() OVER (ORDER BY REG_DT DESC, A.CNSLT_NO, HSTRY_NO) RN    
				              FROM (SELECT CNSLT_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT, GRPMGR_RE_YN, REQ_LT
				                      FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S02','S03','S07')
				                        AND DEL_YN = 'N'
				                        
				                        /** 기간 세팅**/
				                      AND REG_DT >= CONVERT(DATETIME, :vo.srch_start_dt , 112)
				                      AND REG_DT <= CONVERT(DATETIME, :vo.srch_end_dt , 112) + 1
				                                             
				                        #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
				                        AND DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
				                        #end
				                    )A,
				                    (SELECT CNSLT_NO, MIN(HSTRY_NO) MIN_HSTRY_NO
				                       FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S03','S07')
				                        AND DEL_YN = 'N'
				                         /** 기간 세팅**/
				                      AND REG_DT >= CONVERT(DATETIME, :vo.srch_start_dt , 112)
				                      AND REG_DT <= CONVERT(DATETIME, :vo.srch_end_dt , 112) + 1
				                        #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
				                        AND DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn  
				                        #end
				                      GROUP BY CNSLT_NO
				                    )B,
				                    
				                    ( SELECT  CNSLT_NO
				                                              , CNSLT_TYPE
				                                          FROM  TN_LAS_CONSULT_TYPE
				                                         WHERE  HSTRY_NO = 0 
				                     ) TLCT
				                    
				             WHERE A.CNSLT_NO = B.CNSLT_NO
				             
				             AND A.CNSLT_NO = TLCT.CNSLT_NO
				             
				             #if ($vo.srch_type && $vo.srch_type.equals("P"))
                             	AND TLCT.CNSLT_TYPE = 'A20'
                             #else
                             	AND TLCT.CNSLT_TYPE != 'A20'
                             #end
				               
				             ) TLC,
				             (
				             SELECT CNSLT_NO, RESPMAN_ID
				               FROM TN_LAS_CONSULT_RESPMAN
				              WHERE DEL_YN = 'N'
				             ) TLCR
				        WHERE TLC.CNSLT_NO = TLCR.CNSLT_NO
				       ) SA 
				GROUP BY RESPMAN_ID) CONSULT
				ON RESPMAN.USER_ID = CONSULT.RESPMAN_ID
				) TA  ORDER BY RESPMAN_NM
             
                ]]>
			</statement>
		</query>

		<!-- 사업부별 통계현황 - 계약 -->
		<query id="las.statistics.deptCntrt" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
 				SELECT COMP_CD AS REQ_DEPT,
                	   	
				       CAST((SUM(REQ)) AS NUMERIC) REQ_TOTAL,
				       CAST((SUM(CHULI)) AS NUMERIC) CHULI_TOTAL,
				       CAST((SUM(REPLY)) AS NUMERIC) REPLY_TOTAL,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY) = 0 THEN 0 
				            ELSE CAST(DBO.TRUNC(SUM(CAST(LT AS FLOAT))/(SUM(CAST(REPLY AS FLOAT))),1) AS FLOAT) END,'99999.9')) LT_TOTAL,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT AS FLOAT)), '99999.99')) LT_TOTAL_SUM,
				      /* 체결목적 */
				      #if($vo.srch_div.equals('T03'))
				      /** 개발/라이선스 **/
				       SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',REQ,'T0303',REQ,0) AS NUMERIC)) REQ_DEV,
				       SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',CHULI,'T0303',CHULI,0) AS NUMERIC)) CHULI_DEV,
				       SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',REPLY,'T0303',REPLY,0) AS NUMERIC)) REPLY_DEV,
				       RTRIM(DBO.NUM_FORMAT(
				       		CASE WHEN SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',REPLY,'T0303',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST( 
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',LT,'T0303',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',REPLY,'T0303',REPLY,0) AS FLOAT))),1) AS FLOAT)
				           	END,'99999.9')) LT_DEV,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE5(CLSFCN1,'T0301',LT,'T0303',LT,0) AS FLOAT)), '99999.99')) LT_DEV_SUM,
				       /** 특허 **/
				       SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',REQ,0) AS NUMERIC)) REQ_IP,
				       SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',CHULI,0) AS NUMERIC)) CHULI_IP,
				       SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',REPLY,0) AS NUMERIC)) REPLY_IP,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',REPLY,0) AS FLOAT))),1) AS FLOAT) 
				            END,'99999.9')) LT_IP,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN1,'T0302',LT,0) AS FLOAT)), '99999.99')) LT_IP_SUM,
				       /** 일반 **/
				       SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,REQ) AS NUMERIC)) REQ_ETC,
				       SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,CHULI) AS NUMERIC)) CHULI_ETC,
				       SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,REPLY) AS NUMERIC)) REPLY_ETC,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,REPLY) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,LT) AS FLOAT))/(SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,REPLY) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_ETC,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE7(CLSFCN1,'T0301',0,'T0302',0,'T0303',0,LT) AS FLOAT)), '99999.99')) LT_ETC_SUM        
				      #end
				      /* 계약단계 */
				      #if($vo.srch_div.equals('T02'))
				       /** 신규계약 **/
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',REQ,0) AS NUMERIC)) REQ_T0201,
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',CHULI,0) AS NUMERIC)) CHULI_T0201,
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',REPLY,0) AS NUMERIC)) REPLY_T0201,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',REPLY,0) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_T0201,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0201',LT,0) AS FLOAT)), '99999.99')) LT_T0201_SUM,
				        /** 변경계약 **/
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',REQ,0) AS NUMERIC)) REQ_T0202,
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',CHULI,0) AS NUMERIC)) CHULI_T0202,
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',REPLY,0) AS NUMERIC)) REPLY_T0202,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',REPLY,0) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_T0202,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0202',LT,0) AS FLOAT)), '99999.99')) LT_T0202_SUM,     
				        /** 해지계약 **/
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',REQ,0) AS NUMERIC)) REQ_T0203,
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',CHULI,0) AS NUMERIC)) CHULI_T0203,
				       SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',REPLY,0) AS NUMERIC)) REPLY_T0203,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',REPLY,0) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_T0203,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN2,'T0203',LT,0) AS FLOAT)), '99999.99')) LT_T0203_SUM   
				      #end
				       /* 비즈니스 단계 */
				      #if($vo.srch_div.equals('T01'))
				       /** NDA **/
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',REQ,0) AS NUMERIC)) REQ_T0101,
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',CHULI,0) AS NUMERIC)) CHULI_T0101,
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',REPLY,0) AS NUMERIC)) REPLY_T0101,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',REPLY,0) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_T0101,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0101',LT,0) AS FLOAT)), '99999.99')) LT_T0101_SUM,
				        /** MOU/LOI **/
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',REQ,0) AS NUMERIC)) REQ_T0102,
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',CHULI,0) AS NUMERIC)) CHULI_T0102,
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',REPLY,0) AS NUMERIC)) REPLY_T0102,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',REPLY,0) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_T0102,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0102',LT,0) AS FLOAT)), '99999.99')) LT_T0102_SUM,     
				        /** 본계약 **/
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',REQ,0) AS NUMERIC)) REQ_T0103,
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',CHULI,0) AS NUMERIC)) CHULI_T0103,
				       SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',REPLY,0) AS NUMERIC)) REPLY_T0103,
				       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',REPLY,0) AS FLOAT)) = 0 THEN 0 
				            ELSE CAST(
				            	DBO.TRUNC(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',LT,0) AS FLOAT))/(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',REPLY,0) AS FLOAT))),1) AS FLOAT)
				            END,'99999.9')) LT_T0103,
				       RTRIM(DBO.NUM_FORMAT(SUM(CAST(DBO.DECODE3(CLSFCN3,'T0103',LT,0) AS FLOAT)), '99999.99')) LT_T0103_SUM   
				      #end
				            
				      
				FROM
				(
				    /* 의뢰 건수 */                               
				    SELECT  CASE WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994240' THEN A.COMP_CD+'/LC1'
	                	   		WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994241' THEN A.COMP_CD+'/LC2'
	                	   		WHEN A.COMP_CD = 'EHQ' THEN A.COMP_CD+'/LC_OTHERS'
	                	   		ELSE A.COMP_CD END AS COMP_CD,
				            D.CNSDREQ_ID,
				            /* 체결목적 */
				            (SELECT CNCLSNPURPS_BIGCLSFCN FROM TN_CLM_CONTRACT_MASTER WHERE CNTRT_ID = D.CNTRT_ID) CLSFCN1,
				            /* 계약단계 */
				            (SELECT DEPTH_CLSFCN FROM TN_CLM_CONTRACT_MASTER WHERE CNTRT_ID = D.CNTRT_ID) CLSFCN2,
				            /* 비즈니스단계 */
				            (SELECT BIZ_CLSFCN FROM TN_CLM_CONTRACT_MASTER WHERE CNTRT_ID = D.CNTRT_ID) CLSFCN3,
				            1 REQ,
				            0 CHULI,
				            0 REPLY,
				            0 LT,
				            A.MN_CNSD_DEPT AS DMSTFRGN_GBN
				      
				      FROM  TN_CLM_CONT_CNSDREQ A,
	                        TN_CLM_CONT_CNSDREQ_RESPMAN B,
	                        TN_CLM_CONTRACT_CNSD D,
	                        TN_CLM_CONTRACT_MASTER E        
	                               
	                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
	                  AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
	                  AND   D.CNTRT_ID = E.CNTRT_ID
	                  AND   A.DEL_YN = 'N'
	                  AND   E.DEL_YN = 'N'
	                  AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
	                  AND   A.PREV_CNSDREQ_ID IS NULL
	                  AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
	                  AND   B.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
	                         
				    UNION ALL
				    
				     /* 처리 건수 */          
				     SELECT  DISTINCT 
				            CASE WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994240' THEN A.COMP_CD+'/LC1'
	                	   		WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994241' THEN A.COMP_CD+'/LC2'
	                	   		WHEN A.COMP_CD = 'EHQ' THEN A.COMP_CD+'/LC_OTHERS'
	                	   		ELSE A.COMP_CD END AS COMP_CD,
				            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
				            /* 체결목적 */
				            E.CNCLSNPURPS_BIGCLSFCN AS CLSFCN1,
				             /* 계약단계 */
				            E.DEPTH_CLSFCN AS CLSFCN2,
				            /* 비즈니스단계 */
				            E.BIZ_CLSFCN AS CLSFCN3,
				            0 REQ,
				            1 CHULI,
				            0 REPLY,
				            0 LT,
				            B.RESP_DEPT AS DMSTFRGN_GBN
				            
				     FROM TN_CLM_CONT_CNSDREQ A,
				          TN_CLM_CONT_CNSDREQ_RESPMAN B,
	                      TN_CLM_CONTRACT_DEPTCNSD D,
	                      TN_CLM_CONTRACT_MASTER E
	                     
	                WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
	                  AND B.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND D.CNTRT_ID = E.CNTRT_ID
	                  AND A.DEL_YN = 'N'
	                  AND E.DEL_YN = 'N'
	                  AND D.CNSD_STATUS = 'C04305'
	                  AND D.CNSD_DT IS NOT NULL
	                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
	                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
	                  
				          
				    UNION ALL
				    
				     /* 회신 건수 */          
				    SELECT  DISTINCT 
				            CASE WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994240' THEN A.COMP_CD+'/LC1'
	                	   		WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994241' THEN A.COMP_CD+'/LC2'
	                	   		WHEN A.COMP_CD = 'EHQ' THEN A.COMP_CD+'/LC_OTHERS'
	                	   		ELSE A.COMP_CD END AS COMP_CD,
				            D.CNSDREQ_ID,
				            /* 체결목적 */
				            E.CNCLSNPURPS_BIGCLSFCN AS CLSFCN1,
				             /* 계약단계 */
				            E.DEPTH_CLSFCN AS CLSFCN2,
				            /* 비즈니스단계 */
				            E.BIZ_CLSFCN AS CLSFCN3,
				            0 REQ,
				            0 CHULI,
				            1 REPLY,
				            0 LT,
				            B.RESP_DEPT AS DMSTFRGN_GBN
				         
				    FROM TN_CLM_CONT_CNSDREQ A,
				         TN_CLM_CONT_CNSDREQ_RESPMAN B,
	                     TN_CLM_CONTRACT_DEPTCNSD D,
	                     TN_CLM_CONTRACT_MASTER E
	                     
	                WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END
	                  AND B.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND D.CNTRT_ID = E.CNTRT_ID
	                  AND E.DEL_YN = 'N'
	                  AND D.CNSD_STATUS = 'C04305'
	                  AND D.CNSD_DT IS NOT NULL
	                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
	                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
	                  
				    UNION ALL
				    
				     /* L/T */        
				     SELECT  DISTINCT 
				            CASE WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994240' THEN A.COMP_CD+'/LC1'
	                	   		WHEN A.COMP_CD = 'EHQ' AND A.REQ_DEPT = 'C10CZ99CZ994241' THEN A.COMP_CD+'/LC2'
	                	   		WHEN A.COMP_CD = 'EHQ' THEN A.COMP_CD+'/LC_OTHERS'
	                	   		ELSE A.COMP_CD END AS COMP_CD,
				            D.CNSDREQ_ID,
				             /* 체결목적 */
				            E.CNCLSNPURPS_BIGCLSFCN AS CLSFCN1,
				             /* 계약단계 */
				            E.DEPTH_CLSFCN AS CLSFCN2,
				            /* 비즈니스단계 */
				            E.BIZ_CLSFCN AS CLSFCN3,
				            0 REQ,
				            0 CHULI,
				            0 REPLY,
				            CAST(D.REQ_LT AS FLOAT) LT,
				            B.RESP_DEPT AS DMSTFRGN_GBN
				            
				    FROM TN_CLM_CONT_CNSDREQ A,
				         TN_CLM_CONT_CNSDREQ_RESPMAN B,
	                     TN_CLM_CONTRACT_DEPTCNSD D,
	                     TN_CLM_CONTRACT_MASTER E
	                     
	                WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END
	                  AND B.CNSDREQ_ID = D.CNSDREQ_ID
	                  AND D.CNTRT_ID = E.CNTRT_ID
	                  AND E.DEL_YN = 'N'
	                  AND D.CNSD_STATUS = 'C04305'
	                  AND D.CNSD_DT IS NOT NULL
	                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
	                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
	                  
				    ) A 
				WHERE 1=1
				#if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
				AND A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn                      
				#end 
				
				GROUP BY A.COMP_CD
				ORDER BY A.COMP_CD DESC 
             
                ]]>
			</statement>
		</query>

		<!-- 사업부별 통계현황 - 법률자문 -->
		<query id="las.statistics.deptLaw" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
				SELECT COMP_CD REQ_DEPT
				      ,CAST(ISNULL(REQ_LAST_WEEK , 0) AS NUMERIC) REQ_TOTAL
				      ,CAST(ISNULL(PRO_LAST_WEEK , 0) AS NUMERIC) CHULI_TOTAL
				      ,CAST(ISNULL(RES_LAST_WEEK , 0) AS NUMERIC) REPLY_TOTAL
				      ,RTRIM(DBO.NUM_FORMAT(ISNULL(REQ_LT,0),'99999.9')) LT_TOTAL
				      ,CAST(LT_TOTAL_SUM AS NUMERIC) AS LT_TOTAL_SUM
				 FROM 

				 
				 (SELECT COMP_CD, SUM(REQ_LAST_WEEK) REQ_LAST_WEEK, SUM(PRO_LAST_WEEK) PRO_LAST_WEEK, 
				 	SUM(RES_LAST_WEEK) RES_LAST_WEEK, DBO.TRUNC(AVG(REQ_LT),1) REQ_LT, 
				 	RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(REQ_LT),0), '99999.99')) LT_TOTAL_SUM
				   FROM  (
				         SELECT CNSDMAN_ID, INTNL_PRGRS_STATUS, COMP_CD, REQ_LT
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02'
				                     THEN 1 ELSE 0 END REQ_LAST_WEEK 
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND RE_DT >= CONVERT(DATETIME, :vo.srch_start_dt , 112)
				                      AND RE_DT <= CONVERT(DATETIME, '20121231' ) + 1
				                     THEN 1 ELSE 0 END PRO_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND RE_DT >= CONVERT(DATETIME, :vo.srch_start_dt , 112)
				                      AND RE_DT <= CONVERT(DATETIME, '20121231' ) + 1
				                     THEN 1 ELSE 0 END RES_LAST_WEEK
				         FROM
				             (
				             SELECT A.COMP_CD,A.CNSLT_NO, MIN_HSTRY_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN
				             	  , CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT
				             	  , REPLACE(CONVERT(CHAR(10), REG_DT, 23),'-','') AS CHAR_REG_DT /*YYYYMMDD*/
				                  , REPLACE(CONVERT(CHAR(10), RE_DT, 23),'-','') AS CHAR_RE_DT /*YYYYMMDD*/
				                  , REQ_LT
				                  , ROW_NUMBER() OVER (ORDER BY REG_DT DESC, A.CNSLT_NO, HSTRY_NO) RN
				              FROM (SELECT CASE WHEN COMP_CD = 'EHQ' AND DEPT_CD = 'C10CZ99CZ994240' THEN COMP_CD+'/LC1'
					                	   		WHEN COMP_CD = 'EHQ' AND DEPT_CD = 'C10CZ99CZ994241' THEN COMP_CD+'/LC2'
					                	   		WHEN COMP_CD = 'EHQ' THEN COMP_CD+'/LC_OTHERS'
					                	   		ELSE COMP_CD END AS COMP_CD,
				              			CNSLT_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT, REQ_LT
				                      FROM TN_LAS_CONSULT SA LEFT OUTER JOIN (SELECT USER_ID, DEPT_CD FROM TB_COM_USER) SB 
				                      ON ISNULL(SA.CNSDMAN_ID,SA.APBTMAN_ID) = SB.USER_ID
				                      WHERE INTNL_PRGRS_STATUS IN ('S02','S03','S07')
				                        AND DEL_YN = 'N'				                     
				                        AND REG_DT >= CONVERT(DATETIME, :vo.srch_start_dt , 112)
				                        AND REG_DT <= CONVERT(DATETIME, :vo.srch_end_dt , 112) + 1
				                        
				                    )A,
				                    (SELECT CNSLT_NO, MIN(HSTRY_NO) MIN_HSTRY_NO
				                       FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S03','S07')
				                        AND DEL_YN = 'N'		  
				                      GROUP BY CNSLT_NO
				                    )B,
				                    
				                     ( SELECT  CNSLT_NO
				                                              , CNSLT_TYPE
				                                          FROM  TN_LAS_CONSULT_TYPE
				                                         WHERE  HSTRY_NO = 0 
				                     ) TLCT
				                    
				             WHERE A.CNSLT_NO = B.CNSLT_NO
				                 AND A.CNSLT_NO = TLCT.CNSLT_NO
				                 AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END
				             #if ($vo.srch_type && $vo.srch_type.equals("P"))
                             	AND TLCT.CNSLT_TYPE = 'A20'
                             #else
                             	AND TLCT.CNSLT_TYPE != 'A20'
                             #end			             	
				             ) TLC
				       ) TA 
				GROUP BY COMP_CD) CONSULT

                ]]>
			</statement>
		</query>

		<!-- 법무팀별 통계현황(현재일 기준) - 계약 -->
		<query id="las.statistics.lawCntrtToday" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
                SELECT TTA.* FROM (
                	SELECT 	CASE WHEN COMP_CD = 'EHQ' AND DEPT_CD IN ('LC1', 'LC2', 'LC_OTHERS') THEN 
	                			COMP_CD + '/' + X.DEPT_CD
	                		ELSE
	                			COMP_CD+ISNULL((SELECT TOP 1 '/'+DEPT_NM_ENG FROM TB_COM_DEPT SA WHERE SA.DEPT_CD=X.DEPT_CD),'/'+X.DEPT_CD)
	                		END	AS REQ_DEPT,
                	   COMP_CD,
                       SUM(REQ1) REQ1,        /** 전주실적 - 의뢰 **/
                       SUM(CHULI1) CHULI1,    /** 전주실적 - 처리 **/
                       SUM(REPLY1) REPLY1,    /** 전주실적 - 회신 **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT1 AS FLOAT)),'99999.99')) LT1_SUM, /** 전주실적 - LT(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY1) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT1)/(SUM(REPLY1)),1) AS FLOAT)
                               END, '99999.9')) LT1,   /** 전주실적 - LT **/
                       
                       SUM(REQ2) REQ2,        /** 금주실적 - 의뢰 **/
                       SUM(CHULI2) CHULI2,    /** 금주실적 - 처리 **/
                       SUM(REPLY2) REPLY2,    /** 금주실적 - 회신 **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT2 AS FLOAT)),'99999.99')) LT2_SUM, /** 금주실적 - LT(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY2) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT2)/(SUM(REPLY2)),1) AS FLOAT)
                               END, '99999.9')) LT2,   /** 금주실적 - LT **/
                       
                       SUM(REQ3) REQ3,        /** 전월실적 - 의뢰 **/
                       SUM(CHULI3) CHULI3,    /** 전월실적 - 처리 **/
                       SUM(REPLY3) REPLY3,    /** 전월실적 - 회신 **/
                       RTRIM(DBO.NUM_FORMAT(SUM(LT3),'99999.99')) LT3_SUM, /** 전월실적 - LT(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY3) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT3)/(SUM(REPLY3)),1) AS FLOAT) 
                               END, '99999.9')) LT3,   /** 전월실적 - L/T **/
                       
                       SUM(REQ4) REQ4,        /** 금월실적 - 의뢰 **/
                       SUM(CHULI4) CHULI4,    /** 금월실적 - 처리 **/
                       SUM(REPLY4) REPLY4,    /** 금월실적 - 회신 **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT4 AS FLOAT)),'99999.99')) LT4_SUM, /** 금월실적 - LT(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY4) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT4)/(SUM(REPLY4)),1) AS FLOAT)
                              END, '99999.9')) LT4,    /** 금월실적 - L/T **/
                       
                       SUM(REQ5) REQ5,        /** 금년실적 - 의뢰 **/
                       SUM(CHULI5) CHULI5,    /** 금년실적 - 처리 **/
                       SUM(REPLY5) REPLY5,    /** 금년실적 - 회신 **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT5 AS FLOAT)),'99999.99')) LT5_SUM, /** 금년실적 - LT(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY5) = 0 THEN 0 
                                    ELSE CAST(DBO.TRUNC(SUM(LT5)/(SUM(REPLY5)),1) AS FLOAT)
                               END, '99999.9')) LT5    /** 금년실적 - L/T **/
                            
                FROM (
                /** 전주 실적 **/
                SELECT DEPT_CD,
                	   COMP_CD,
                	   A.DMSTFRGN_GBN,
                       SUM(REQ) REQ1,
                       SUM(CHULI) CHULI1,
                       SUM(REPLY) REPLY1,
                       SUM(LT) LT1,
                       0 REQ2,
                       0 CHULI2,
                       0 REPLY2,
                       0 LT2,
                       0 REQ3,
                       0 CHULI3,
                       0 REPLY3,
                       0 LT3,
                       0 REQ4,
                       0 CHULI4,
                       0 REPLY4,
                       0 LT4,
                       0 REQ5,
                       0 CHULI5,
                       0 REPLY5,
                       0 LT5
                FROM
                (
                   /** 의뢰 건수 **/                               
                    SELECT  E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                     		B.RESPMAN_NM,
							B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,  
                            D.CNSDREQ_ID,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ,
                            0 CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,    
                          TB_COM_USER F            
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)+1
                      AND   B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
                    
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT
                     		 E.COMP_CD,
                     		 CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                             B.RESPMAN_NM,
                             B.RESPMAN_ID,
                             B.RESP_DEPT AS DMSTFRGN_GBN, 
                            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                            0 REQ,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI,
                            0 REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT
                    		E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT
                     		E.COMP_CD,
                     		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            0 REPLY,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforeweek_s) AND CONVERT(DATETIME, :vo.srch_beforeweek_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    ) A 
                
                GROUP BY A.DEPT_CD,COMP_CD, A.DMSTFRGN_GBN
                
                UNION ALL
                
                /** 금주 실적 **/
                SELECT DEPT_CD,
                	   COMP_CD,
                	   A.DMSTFRGN_GBN,
                       0 REQ1,
                       0 CHULI1,
                       0 REPLY1,
                       0 LT1,        
                       SUM(REQ) REQ2,
                       SUM(CHULI) CHULI2,
                       SUM(REPLY) REPLY2,
                       SUM(LT) LT2,
                       0 REQ3,
                       0 CHULI3,
                       0 REPLY3,
                       0 LT3,
                       0 REQ4,
                       0 CHULI4,
                       0 REPLY4,
                       0 LT4,
                       0 REQ5,
                       0 CHULI5,
                       0 REPLY5,
                       0 LT5
                FROM
                (
                    /** 의뢰 건수 **/                               
                    SELECT  E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                    		B.RESPMAN_NM,
							B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,  
                            D.CNSDREQ_ID,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ,
                            0 CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,
                          TB_COM_USER F             
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
                      AND   B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
                    
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                     		 E.COMP_CD,
                     		 CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                             B.RESPMAN_NM,
                             B.RESPMAN_ID,
                             B.RESP_DEPT AS DMSTFRGN_GBN, 
                            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                            0 REQ,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI,
                            0 REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
                      
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT
                    		E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                     		E.COMP_CD,
                     		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            0 REPLY,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
                    ) A 
                
                GROUP BY A.DEPT_CD,COMP_CD, A.DMSTFRGN_GBN
                
                UNION ALL
                
                /** 전월 실적 **/
                SELECT DEPT_CD,
                	   COMP_CD,
                	   A.DMSTFRGN_GBN,
                       0 REQ1,
                       0 CHULI1,
                       0 REPLY1,
                       0 LT1,  
                       0 REQ2,
                       0 CHULI2,
                       0 REPLY2,
                       0 LT2,
                       SUM(REQ) REQ3,
                       SUM(CHULI) CHULI3,
                       SUM(REPLY) REPLY3,
                       SUM(LT) LT3,
                       0 REQ4,
                       0 CHULI4,
                       0 REPLY4,
                       0 LT4,
                       0 REQ5,
                       0 CHULI5,
                       0 REPLY5,
                       0 LT5
                FROM
                (
                    /** 의뢰 건수 **/                               
                    SELECT  E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                    		B.RESPMAN_NM,
							B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,  
                            D.CNSDREQ_ID,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ,
                            0 CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,    
                          TB_COM_USER F
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)+1
 					  AND   B.RESPMAN_ID = F.USER_ID
 					  #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		                      
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                     		 E.COMP_CD,
                     		 CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                             B.RESPMAN_NM,
                             B.RESPMAN_ID,
                             B.RESP_DEPT AS DMSTFRGN_GBN, 
                            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                            0 REQ,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI,
                            0 REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                    		E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                     		E.COMP_CD,
                     		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            0 REPLY,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_beforemonth_s) AND CONVERT(DATETIME, :vo.srch_beforemonth_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    ) A 
                GROUP BY A.DEPT_CD,COMP_CD, A.DMSTFRGN_GBN
                
                UNION ALL
                
                /** 금월 실적 **/
                SELECT DEPT_CD,
                	   COMP_CD,
                	   A.DMSTFRGN_GBN,
                       0 REQ1,
                       0 CHULI1,
                       0 REPLY1,
                       0 LT1,  
                       0 REQ2,
                       0 CHULI2,
                       0 REPLY2,
                       0 LT2,
                       0 REQ3,
                       0 CHULI3,
                       0 REPLY3,
                       0 LT3,
                       SUM(REQ) REQ4,
                       SUM(CHULI) CHULI4,
                       SUM(REPLY) REPLY4,
                       SUM(LT) LT4,
                       0 REQ5,
                       0 CHULI5,
                       0 REPLY5,
                       0 LT5
                FROM
                (
                    /** 의뢰 건수 **/                               
                    SELECT  E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                    		B.RESPMAN_NM,
							B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,  
                            D.CNSDREQ_ID,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ,
                            0 CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,    
                          TB_COM_USER F
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1
                      AND   B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT
                     		 E.COMP_CD,
                     		 CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                             B.RESPMAN_NM,
                             B.RESPMAN_ID,
                             B.RESP_DEPT AS DMSTFRGN_GBN, 
                            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                            0 REQ,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI,
                            0 REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT 
                    		E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                     		E.COMP_CD,
                     		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            0 REPLY,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    ) A 
               
                GROUP BY DEPT_CD,COMP_CD, A.DMSTFRGN_GBN
                
                UNION ALL
                
                /** 금년 실적 **/
                SELECT DEPT_CD,
                	   COMP_CD,
                       A.DMSTFRGN_GBN,
                       0 REQ1,
                       0 CHULI1,
                       0 REPLY1,
                       0 LT1,  
                       0 REQ2,
                       0 CHULI2,
                       0 REPLY2,
                       0 LT2,
                       0 REQ3,
                       0 CHULI3,
                       0 REPLY3,
                       0 LT3,
                       0 REQ4,
                       0 CHULI4,
                       0 REPLY4,
                       0 LT4,
                       SUM(REQ) REQ5,
                       SUM(CHULI) CHULI5,
                       SUM(REPLY) REPLY5,
                       SUM(LT) LT5
                       
                FROM
                (
                     /** 의뢰 건수 **/                               
                    SELECT  E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                    		B.RESPMAN_NM,
							B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,  
                            D.CNSDREQ_ID,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ,
                            0 CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,    
                          TB_COM_USER F
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101') AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
                      AND   B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                     		 E.COMP_CD,
                     		 CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                             B.RESPMAN_NM,
                             B.RESPMAN_ID,
                             B.RESP_DEPT AS DMSTFRGN_GBN, 
                            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                            0 REQ,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI,
                            0 REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101') AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                   /** 회신 건수 **/
                    SELECT  DISTINCT
                    		E.COMP_CD,
                    		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY,
                            0 LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101') AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT
                     		E.COMP_CD,
                     		CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                     		B.RESPMAN_NM,
                            B.RESPMAN_ID,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            0 REPLY,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,
                         TB_COM_USER F
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101') AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    ) A 
                
                GROUP BY COMP_CD,DEPT_CD,A.DMSTFRGN_GBN
                
                ) X
                GROUP BY X.DEPT_CD,COMP_CD,X.DMSTFRGN_GBN
         	) TTA ORDER BY COMP_CD, REQ_DEPT
                ]]>
			</statement>
		</query>

		<!-- 법무팀별 통계현황(기간 실적) - 계약 -->
		<query id="las.statistics.lawCntrtPeriod" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
                SELECT CASE WHEN COMP_CD = 'EHQ' AND DEPT_CD IN ('LC1', 'LC2', 'LC_OTHERS') THEN 
	                			COMP_CD + '/' + A.DEPT_CD
	                		ELSE
	                			COMP_CD+ISNULL((SELECT TOP 1 '/'+DEPT_NM_ENG FROM TB_COM_DEPT SA WHERE SA.DEPT_CD=A.DEPT_CD),'/'+A.DEPT_CD)
	                		END	AS REQ_DEPT, /** 팀 **/
	                   SUM(REQ) REQ1, /** 의뢰 **/
                       SUM(CHULI) CHULI1, /** 처리 **/
                       SUM(REPLY) REPLY1, /** 회신 **/
                       RTRIM(DBO.NUM_FORMAT(SUM(CAST(LT AS FLOAT)),'99999.99')) LT1_SUM, /** LT(합) **/
                       RTRIM(DBO.NUM_FORMAT(CASE WHEN SUM(REPLY) = 0 THEN 0 
                                         ELSE CAST(ROUND(SUM(LT)/(SUM(REPLY)),2) AS FLOAT) END,'99999.9')) LT1 /** L/T **/
                       
                FROM
                (
                    /** 의뢰 건수 **/                               
                    SELECT  '' AS RESPMAN_NM,
                    		F.COMP_CD,
                    		CASE WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN F.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REQ,
                            0 CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM  TN_CLM_CONT_CNSDREQ A,
                          TN_CLM_CONT_CNSDREQ_RESPMAN B,
                          TN_CLM_CONTRACT_CNSD D,
                          TN_CLM_CONTRACT_MASTER E,                 
                          TB_COM_USER F
                    WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND   D.CNTRT_ID = E.CNTRT_ID
                      AND   A.DEL_YN = 'N'
                      AND   E.DEL_YN = 'N'
                      AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
                      AND   A.PREV_CNSDREQ_ID IS NULL
                      AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
                      AND   B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
                      AND   B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    /** 처리 건수 **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            F.COMP_CD,
                            CASE WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN F.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            A.FST_CNSDREQ_ID AS CNSDREQ_ID,
                            0 REQ,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) CHULI,
                            0 REPLY,
                            0 LT
                        
                    FROM TN_CLM_CONT_CNSDREQ A,
                         TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,                 
                         TB_COM_USER F
                         
                    WHERE A.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND A.DEL_YN = 'N'
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
                
                    UNION ALL
                    
                    /** 회신건수 **/
                    SELECT  DISTINCT
                            B.RESPMAN_NM, 
                            F.COMP_CD,
                            CASE WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN F.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 1, 0) REPLY,
                            0 LT
                           
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,                 
                         TB_COM_USER F
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
                	  AND B.RESPMAN_ID = F.USER_ID
                	  #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    UNION ALL
                    
                      /** L/T **/
                     SELECT  DISTINCT 
                            B.RESPMAN_NM,
                            F.COMP_CD,
                            CASE WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
	                	   		 WHEN F.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
	                	   		 WHEN F.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
	                	   		 ELSE F.DEPT_CD END AS DEPT_CD,
                            B.RESP_DEPT AS DMSTFRGN_GBN,
                            D.CNSDREQ_ID,
                            0 REQ,
                            0 CHULI,
                            0 REPLY,
                            CAST(DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) AS FLOAT) LT
                            
                    FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
                         TN_CLM_CONTRACT_DEPTCNSD D,
                         TN_CLM_CONTRACT_MASTER E,                 
  						 TB_COM_USER F
                         
                    WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
                      AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND E.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN E.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
                      AND D.CNTRT_ID = E.CNTRT_ID
                      AND E.DEL_YN = 'N'
                      AND D.CNSD_STATUS = 'C04305'
                      AND D.CNSD_DT IS NOT NULL
                      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
                      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt , 112) AND CONVERT(DATETIME, :vo.srch_end_dt , 112)+1
                      AND B.RESPMAN_ID = F.USER_ID
                      #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
					  AND B.RESP_DEPT = :vo.srch_dmstfrgn_gbn                      
            		  #end
            		  
                    ) A 
                WHERE 1=1
                
                GROUP BY COMP_CD, DEPT_CD, A.DMSTFRGN_GBN
    
                ]]>
			</statement>
		</query>

		<!-- 법무팀별 통계현황(현재일 기준) - 법무 -->
		<query id="las.statistics.lawLawToday" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
				SELECT CASE WHEN DEPT_CD NOT IN ('LC1', 'LC1', 'LC_OTHERS') THEN 
						COMP_CD+'/'+ISNULL((SELECT TOP 1 DEPT_NM_ENG FROM TB_COM_DEPT SA WHERE SA.DEPT_CD = CONSULT.DEPT_CD),CONSULT.DEPT_CD)
               	   		ELSE COMP_CD+'/'+DEPT_CD END AS REQ_DEPT
				      , ISNULL(REQ_LAST_WEEK,0) REQ1
				      , ISNULL(PRO_LAST_WEEK,0) CHULI1
				      , ISNULL(RES_LAST_WEEK,0) REPLY1
				      , RTRIM(DBO.NUM_FORMAT(ISNULL(LT_LAST_WEEK,0),'99999.9')) LT1
				      
				      , ISNULL(REQ_THIS_WEEK,0) REQ2
				      , ISNULL(PRO_THIS_WEEK,0) CHULI2
				      , ISNULL(RES_THIS_WEEK,0) REPLY2
				      , RTRIM(DBO.NUM_FORMAT(ISNULL(LT_THIS_WEEK,0),'99999.9'))  LT2
				      
				      , ISNULL(REQ_LAST_MONTH,0) REQ3
				      , ISNULL(PRO_LAST_MONTH,0) CHULI3
				      , ISNULL(RES_LAST_MONTH,0) REPLY3
				      , RTRIM(DBO.NUM_FORMAT(ISNULL(LT_LAST_MONTH,0),'99999.9'))  LT3
				      
				      , ISNULL(REQ_THIS_MONTH,0) REQ4
				      , ISNULL(PRO_THIS_MONTH,0) CHULI4
				      , ISNULL(RES_THIS_MONTH,0) REPLY4
				      , RTRIM(DBO.NUM_FORMAT(ISNULL(LT_THIS_MONTH,0),'99999.9'))  LT4
				      
				      , ISNULL(REQ_THIS_YEAR,0) REQ5
				      , ISNULL(PRO_THIS_YEAR,0) CHULI5
				      , ISNULL(RES_THIS_YEAR,0) REPLY5
				      , RTRIM(DBO.NUM_FORMAT(ISNULL(LT_THIS_YEAR,0),'99999.9'))  LT5
				      
				      ,LT1_SUM ,LT2_SUM ,LT3_SUM ,LT4_SUM ,LT5_SUM
				 FROM 
				 (SELECT DMSTFRGN_GBN, DEPT_CD, COMP_CD
				 	   , SUM(REQ_LAST_WEEK) REQ_LAST_WEEK, SUM(PRO_LAST_WEEK) PRO_LAST_WEEK, SUM(RES_LAST_WEEK) RES_LAST_WEEK, DBO.TRUNC(AVG(LT_LAST_WEEK),1) LT_LAST_WEEK, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_LAST_WEEK),0), '99999.99')) LT1_SUM
				       , SUM(REQ_THIS_WEEK) REQ_THIS_WEEK, SUM(PRO_THIS_WEEK) PRO_THIS_WEEK, SUM(RES_THIS_WEEK) RES_THIS_WEEK, DBO.TRUNC(AVG(LT_THIS_WEEK),1) LT_THIS_WEEK, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_THIS_WEEK),0), '99999.99')) LT2_SUM
				       , SUM(REQ_LAST_MONTH) REQ_LAST_MONTH, SUM(PRO_LAST_MONTH) PRO_LAST_MONTH, SUM(RES_LAST_MONTH) RES_LAST_MONTH, DBO.TRUNC(AVG(LT_LAST_MONTH),1) LT_LAST_MONTH, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_LAST_MONTH),0), '99999.99')) LT3_SUM
				       , SUM(REQ_THIS_MONTH) REQ_THIS_MONTH, SUM(PRO_THIS_MONTH) PRO_THIS_MONTH, SUM(RES_THIS_MONTH) RES_THIS_MONTH, DBO.TRUNC(AVG(LT_THIS_MONTH),1) LT_THIS_MONTH, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_THIS_MONTH),0), '99999.99')) LT4_SUM
				       , SUM(REQ_THIS_YEAR) REQ_THIS_YEAR, SUM(PRO_THIS_YEAR) PRO_THIS_YEAR, SUM(RES_THIS_YEAR) RES_THIS_YEAR, DBO.TRUNC(AVG(LT_THIS_YEAR),1) LT_THIS_YEAR, RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(LT_THIS_YEAR),0), '99999.99')) LT5_SUM
				   FROM  (
				         SELECT CNSDMAN_ID,INTNL_PRGRS_STATUS, DMSTFRGN_GBN
				              /*전주실적*/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND CHAR_REG_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7, 23),'-','')
				                      	AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6, 23),'-','')
				                     THEN 1 ELSE 0 END REQ_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7, 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6, 23),'-','')
				                     THEN 1 ELSE 0 END PRO_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7, 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6, 23),'-','')
				                     THEN 1 ELSE 0 END RES_LAST_WEEK
				              , CASE WHEN CHAR_CNSD_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7, 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )-7+6, 23),'-','')
				                     THEN REQ_LT ELSE NULL END LT_LAST_WEEK
				              /*금주실적*/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND CHAR_REG_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 ), 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6, 23),'-','')
				                     THEN 1 ELSE 0 END REQ_THIS_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 ), 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6, 23),'-','')
				                     THEN 1 ELSE 0 END PRO_THIS_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND CHAR_RE_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 ), 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6, 23),'-','')
				                     THEN 1 ELSE 0 END RES_THIS_WEEK
				              , CASE WHEN CHAR_CNSD_DT BETWEEN REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 ), 23),'-','') AND REPLACE(CONVERT(CHAR(10), GETDATE()-( DATEPART(DW,GETDATE()) -2 )+6, 23),'-','')
				                     THEN REQ_LT ELSE NULL END LT_THIS_WEEK
				              /*전월실적*/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                     AND CAST(YEAR(REG_DT) AS VARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(REG_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2))-1 
				                     THEN 1 ELSE 0 END REQ_LAST_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CAST(YEAR(RE_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(RE_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2))-1 
				                     THEN 1 ELSE 0 END PRO_LAST_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                     AND CAST(YEAR(RE_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(RE_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2))-1 
				                     THEN 1 ELSE 0 END RES_LAST_MONTH
				               , CASE WHEN CAST(YEAR(CNSD_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(CNSD_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2))-1 
				                     THEN REQ_LT ELSE NULL END LT_LAST_MONTH     
				              /*금월실적*/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                     AND CAST(YEAR(REG_DT) AS VARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(REG_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2)) 
				                     THEN 1 ELSE 0 END REQ_THIS_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CAST(YEAR(RE_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(RE_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2)) 
				                     THEN 1 ELSE 0 END PRO_THIS_MONTH
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND CAST(YEAR(RE_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(RE_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2)) 
				                     THEN 1 ELSE 0 END RES_THIS_MONTH
				              , CASE WHEN CAST(YEAR(CNSD_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4)) AND CAST(MONTH(CNSD_DT) AS NVARCHAR(2)) = CAST(MONTH(GETDATE()) AS NVARCHAR(2))
				                     THEN REQ_LT ELSE NULL END LT_THIS_MONTH
				              /*금년실적*/
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02' 
				                      AND CAST(YEAR(REG_DT) AS VARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4))
				                     THEN 1 ELSE 0 END REQ_THIS_YEAR
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND CAST(YEAR(RE_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4))
				                     THEN 1 ELSE 0 END PRO_THIS_YEAR
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND CAST(YEAR(RE_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4))
				                     THEN 1 ELSE 0 END RES_THIS_YEAR
				               , CASE WHEN CAST(YEAR(CNSD_DT) AS NVARCHAR(4)) = CAST(YEAR(GETDATE()) AS VARCHAR(4))
				                     THEN REQ_LT ELSE NULL END LT_THIS_YEAR 
				               , DEPT_CD, COMP_CD
				         FROM
				             (
				             SELECT A.CNSLT_NO, MIN_HSTRY_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, A.REG_DT, REQ_LT
				             		, REPLACE(CONVERT(CHAR(10), A.REG_DT, 23),'-','') AS CHAR_REG_DT /*YYYYMMDD*/
				                  	, REPLACE(CONVERT(CHAR(10), RE_DT, 23),'-','') AS CHAR_RE_DT /*YYYYMMDD*/
				                  	, REPLACE(CONVERT(CHAR(10), CNSD_DT, 23),'-','') AS CHAR_CNSD_DT /*YYYYMMDD*/
				                  	, CASE WHEN A.COMP_CD = 'EHQ' AND U1.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
			                	   		WHEN A.COMP_CD = 'EHQ' AND U1.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
			                	   		WHEN A.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
			                	   		ELSE U1.DEPT_CD END AS DEPT_CD
				                  	, ROW_NUMBER() OVER (ORDER BY A.REG_DT DESC, A.CNSLT_NO, HSTRY_NO) RN
				                  	, A.COMP_CD
				              FROM (SELECT COMP_CD,CNSLT_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT, REQ_LT
				                      FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S02','S03','S07')
				                        AND DEL_YN = 'N'				                        
				                        AND CAST(YEAR(REG_DT) AS VARCHAR(4)) > CAST(YEAR(GETDATE()) AS VARCHAR(4)) -2
				                    )A,
				                    (SELECT CNSLT_NO, MIN(HSTRY_NO) MIN_HSTRY_NO
				                       FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S03','S07')
				                        AND DEL_YN = 'N'
				                      AND CAST(YEAR(REG_DT) AS VARCHAR(4)) > CAST(YEAR(GETDATE()) AS VARCHAR(4)) -2
				                      
				                      GROUP BY CNSLT_NO
				                    )B,
				                     ( SELECT  CNSLT_NO
				                                              , CNSLT_TYPE
				                                          FROM  TN_LAS_CONSULT_TYPE
				                                         WHERE  HSTRY_NO = 0 
				                     ) TLCT,
				                     (SELECT CNSLT_NO, MAX(RESPMAN_ID) RESPMAN_ID FROM TN_LAS_CONSULT_RESPMAN GROUP BY CNSLT_NO) RESP,
				                     TB_COM_USER U1
				             WHERE A.CNSLT_NO = B.CNSLT_NO
				             	 AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
				                 AND A.CNSLT_NO = TLCT.CNSLT_NO
				             	 AND A.CNSLT_NO = RESP.CNSLT_NO
				             	 AND RESP.RESPMAN_ID = U1.USER_ID
					             #if ($vo.srch_type && $vo.srch_type.equals("P"))
	                             	AND TLCT.CNSLT_TYPE = 'A20'
	                             #else
	                             	AND TLCT.CNSLT_TYPE != 'A20'
	                             #end
				             
				               #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
							   AND A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn                      
					           #end
				             	
				             ) TLC
				       ) TA
				GROUP BY DMSTFRGN_GBN, COMP_CD, DEPT_CD) CONSULT
				ORDER BY DBO.DECODE6(DMSTFRGN_GBN, 'H', 1, 'F', 2, 'IP', 3)
                ]]>
			</statement>
		</query>

		<!-- 법무팀별 통계현황(기준일자) - 법무 -->
		<query id="las.statistics.lawLawPeriod" isCamelCase="false"
			isDynamic="true">
			<statement>
                <![CDATA[
				SELECT CASE WHEN DEPT_CD NOT IN ('LC1', 'LC2', 'LC_OTHERS') THEN 
						COMP_CD+'/'+ISNULL((SELECT TOP 1 DEPT_NM_ENG FROM TB_COM_DEPT SA WHERE SA.DEPT_CD = CONSULT.DEPT_CD),CONSULT.DEPT_CD)
               	   		ELSE COMP_CD+'/'+DEPT_CD END AS REQ_DEPT
				      , ISNULL(REQ_LAST_WEEK,0) REQ1
				      , ISNULL(PRO_LAST_WEEK,0) CHULI1
				      , ISNULL(RES_LAST_WEEK,0) REPLY1
				      , RTRIM(DBO.NUM_FORMAT(ISNULL(REQ_LT,0),'99999.9')) LT1
				      , LT1_SUM
				      , DEPT_CD, COMP_CD
				 FROM 
				 (SELECT DMSTFRGN_GBN, SUM(REQ_LAST_WEEK) REQ_LAST_WEEK, SUM(PRO_LAST_WEEK) PRO_LAST_WEEK, SUM(RES_LAST_WEEK) RES_LAST_WEEK, DBO.TRUNC(AVG(REQ_LT),1) REQ_LT, 
				 	RTRIM(DBO.NUM_FORMAT(ISNULL(SUM(REQ_LT),0), '99999.99')) LT1_SUM, DEPT_CD, COMP_CD
				   FROM  (
				         SELECT CNSDMAN_ID,INTNL_PRGRS_STATUS, DMSTFRGN_GBN, REQ_LT
				              , CASE WHEN INTNL_PRGRS_STATUS = 'S02'
				                     THEN 1 ELSE 0 END REQ_LAST_WEEK 
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND MIN_HSTRY_NO = HSTRY_NO 
				                      AND CNSDMAN_ID IS NOT NULL 
				                      AND RE_DT >= CONVERT(DATETIME, :vo.srch_start_dt)
				                      AND RE_DT <= CONVERT(DATETIME, :vo.srch_end_dt) + 1
				                     THEN 1 ELSE 0 END PRO_LAST_WEEK
				              , CASE WHEN INTNL_PRGRS_STATUS IN ('S03', 'S07') 
				                      AND CNSDMAN_ID IS NOT NULL  
				                      AND RE_DT >= CONVERT(DATETIME, :vo.srch_start_dt)
				                      AND RE_DT <= CONVERT(DATETIME, :vo.srch_end_dt) + 1
				                     THEN 1 ELSE 0 END RES_LAST_WEEK
				              , DEPT_CD, COMP_CD
				         FROM
				             (
				             SELECT A.CNSLT_NO, MIN_HSTRY_NO, HSTRY_NO, INTNL_PRGRS_STATUS
				             	  , DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT, REQ_LT 
				             	  , REPLACE(CONVERT(CHAR(10), REG_DT, 23),'-','') AS CHAR_REG_DT /*YYYYMMDD*/
				                  , REPLACE(CONVERT(CHAR(10), RE_DT, 23),'-','') AS CHAR_RE_DT /*YYYYMMDD*/
				                  , ROW_NUMBER() OVER (ORDER BY REG_DT DESC, A.CNSLT_NO, HSTRY_NO) RN
				                  , COMP_CD
				                  , CASE WHEN COMP_CD = 'EHQ' AND DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
			                	   		WHEN COMP_CD = 'EHQ' AND DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
			                	   		WHEN COMP_CD = 'EHQ' THEN 'LC_OTHERS'
			                	   		ELSE DEPT_CD END AS DEPT_CD
				              FROM (SELECT COMP_CD,CNSLT_NO, HSTRY_NO, INTNL_PRGRS_STATUS, DMSTFRGN_GBN, CNSDMAN_ID, CNSD_DT, RE_DT, REG_DT, REQ_LT
				                      FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S02','S03','S07')
				                        AND DEL_YN = 'N'
				                      AND REG_DT >= CONVERT(DATETIME, :vo.srch_start_dt)
				                      AND REG_DT <= CONVERT(DATETIME, :vo.srch_end_dt) + 1
				                    )A,
				                    (SELECT CNSLT_NO, MIN(HSTRY_NO) MIN_HSTRY_NO
				                       FROM TN_LAS_CONSULT
				                      WHERE INTNL_PRGRS_STATUS IN ('S03','S07')
				                        AND DEL_YN = 'N'
				                      GROUP BY CNSLT_NO
				                    )B,
				                     ( SELECT  CNSLT_NO
				                                              , CNSLT_TYPE
				                                          FROM  TN_LAS_CONSULT_TYPE
				                                         WHERE  HSTRY_NO = 0 
				                     ) TLCT,
				                     (SELECT CNSLT_NO, MAX(RESPMAN_ID) RESPMAN_ID FROM TN_LAS_CONSULT_RESPMAN GROUP BY CNSLT_NO) RESP,
				                     (SELECT USER_ID, DEPT_CD FROM TB_COM_USER) U1
				             WHERE A.CNSLT_NO = B.CNSLT_NO
				                 AND   'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND A.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
                      				   WHEN A.COMP_CD = :vo.session_comp_cd THEN 'Y' 
                      				   ELSE 'N' END 
				                 AND A.CNSLT_NO = TLCT.CNSLT_NO
				             	 AND A.CNSLT_NO = RESP.CNSLT_NO
				             	 AND RESP.RESPMAN_ID = U1.USER_ID
				             	 
					             #if ($vo.srch_type && $vo.srch_type.equals("P"))
	                             	AND TLCT.CNSLT_TYPE = 'A20'
	                             #else
	                             	AND TLCT.CNSLT_TYPE != 'A20'
	                             #end
				                
				                #if ($vo.srch_dmstfrgn_gbn && !$vo.srch_dmstfrgn_gbn.equals(""))
							    AND A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn                      
					            #end
				             
				             ) TLC
				       ) TA
				GROUP BY DMSTFRGN_GBN, COMP_CD, DEPT_CD) CONSULT
				ORDER BY DBO.DECODE6(DMSTFRGN_GBN, 'H', 1, 'F', 2, 'IP', 3)
                ]]>
			</statement>
		</query>



		<!-- 관련사통계 : 검토의뢰건수 -->

		<!-- 검토의뢰건수(계약검토) 월별 -->
		<query id="las.statistics.listStatisticsConsiderationLasM"
			isCamelCase="false">
			<statement>
            <![CDATA[
	            SELECT  decode(btb.month,'13','계',btb.month) as gubun
						,ISNULL(atb.a1,0) as a1 ,ISNULL(atb.b2,0) as b2 ,ISNULL(atb.c3,0) as c3 ,ISNULL(atb.d4,0) as d4 ,ISNULL(atb.e5,0) as e5
						,ISNULL(atb.f6,0) as f6 ,ISNULL(atb.g7,0) as g7 ,ISNULL(atb.h8,0) as h8 ,ISNULL(atb.i9,0) as i9 ,ISNULL(atb.j10,0) as j10 
						,ISNULL(atb.k11,0) as k11,ISNULL(atb.l12,0) as l12,ISNULL(atb.total,0) as total
				FROM
					(SELECT ISNULL(to_char(cc.reg_dt,'fmmmfm'),13) as month
				    ,count(decode(cc.comp_cd,'M20',0)) as a1
				    ,count(decode(cc.comp_cd,'M40',0)) as b2
				    ,count(decode(cc.comp_cd,'PC3',0)) as c3
				    ,count(decode(cc.comp_cd,'PC2',0)) as d4
				    ,count(decode(cc.comp_cd,'PCO',0)) as e5
				    ,count(decode(cc.comp_cd,'E90',0)) as f6
				    ,count(decode(cc.comp_cd,'PEQ',0)) as g7
				    ,count(decode(cc.comp_cd,'PCB',0)) as h8
				    ,count(decode(cc.comp_cd,'PCC',0)) as i9
				    ,count(decode(cc.comp_cd,'PC9',0)) as j10
				    ,count(decode(cc.comp_cd,'PC6',0)) as k11
				    ,count(decode(cc.comp_cd,'PCJ',0)) as l12
				    ,(count(decode(cc.comp_cd,'M20',0))+ count(decode(cc.comp_cd,'M40',0))
					+ count(decode(cc.comp_cd,'PC3',0)) + count(decode(cc.comp_cd,'PC2',0))
					+ count(decode(cc.comp_cd,'PCO',0)) + count(decode(cc.comp_cd,'E90',0)) 
					+ count(decode(cc.comp_cd,'PEQ',0)) + count(decode(cc.comp_cd,'PCB',0))
					+ count(decode(cc.comp_cd,'PCC',0)) + count(decode(cc.comp_cd,'PC9',0)) 
					+ count(decode(cc.comp_cd,'PC6',0)) + count(decode(cc.comp_cd,'PCJ',0))) as total
				FROM
				  (select min(cnsdreq_id) as cnsdreq_id, cntrt_id from TN_CLM_CONTRACT_CNSD group by cntrt_id) aa, TN_CLM_CONT_CNSDREQ bb, TN_CLM_CONTRACT_MASTER cc
				WHERE bb.cnsdreq_id = aa.cnsdreq_id 
				  AND cc.cntrt_id = aa.cntrt_id
				  AND to_char(cc.reg_dt,'YYYY') = :vo.srch_year
				  AND cc.CNTRT_INFO_GBN NOT IN  ('C05403', 'C05402', 'C05499')/** 구법무시스템이관, 사업부이관 제외 코드 **/
				  AND bb.PRGRS_STATUS NOT IN ('C04201', 'C04225') /** 작성중, 임시저장 **/
				  AND cc.DEL_YN = 'N'
				GROUP BY cube(to_char(cc.reg_dt,'fmmmfm')) 
				) atb,(select rownum as month  connect by level <= 13) btb
				WHERE atb.month(+) = btb.month
				ORDER by  btb.month asc
				]]>
			</statement>
		</query>

		<!-- 검토의뢰건수(계약검토) 주차별 -->
		<query id="las.statistics.listStatisticsConsiderationLasW"
			isCamelCase="false">
			<statement>
				SELECT
				ISNULL2(to_char(to_date(cc.reg_dt),'IW'),to_char(to_date(cc.reg_dt),'IW'),to_char(to_date(cc.reg_dt),'IW')+ '계' ) as gubun
				,count(decode(cc.comp_cd,'M20',0)) as a1
				,count(decode(cc.comp_cd,'M40',0)) as b2
				,count(decode(cc.comp_cd,'PC3',0)) as c3
				,count(decode(cc.comp_cd,'PC2',0)) as d4
				,count(decode(cc.comp_cd,'PCO',0)) as e5
				,count(decode(cc.comp_cd,'E90',0)) as f6
				,count(decode(cc.comp_cd,'PEQ',0)) as g7
				,count(decode(cc.comp_cd,'PCB',0)) as h8
				,count(decode(cc.comp_cd,'PCC',0)) as i9
				,count(decode(cc.comp_cd,'PC9',0)) as j10
				,count(decode(cc.comp_cd,'PC6',0)) as k11
				,count(decode(cc.comp_cd,'PCJ',0)) as l12
				,(count(decode(cc.comp_cd,'M20',0))+
				count(decode(cc.comp_cd,'M40',0))
				+ count(decode(cc.comp_cd,'PC3',0)) +
				count(decode(cc.comp_cd,'PC2',0))
				+ count(decode(cc.comp_cd,'PCO',0)) +
				count(decode(cc.comp_cd,'E90',0))
				+ count(decode(cc.comp_cd,'PEQ',0)) +
				count(decode(cc.comp_cd,'PCB',0))
				+ count(decode(cc.comp_cd,'PCC',0)) +
				count(decode(cc.comp_cd,'PC9',0))
				+ count(decode(cc.comp_cd,'PC6',0)) +
				count(decode(cc.comp_cd,'PCJ',0))) as total
				FROM
				(select min(cnsdreq_id) as cnsdreq_id, cntrt_id from TN_CLM_CONTRACT_CNSD
				group by cntrt_id) aa, TN_CLM_CONT_CNSDREQ bb,
				TN_CLM_CONTRACT_MASTER cc
				WHERE bb.cnsdreq_id = aa.cnsdreq_id
				AND cc.cntrt_id = aa.cntrt_id
				AND to_char(cc.reg_dt,'YYYY') = :vo.srch_year
				AND to_char(to_date(cc.reg_dt),'IW') between :vo.srch_start_y and
				:vo.srch_end_y
				AND cc.CNTRT_INFO_GBN NOT IN ('C05403', 'C05402', 'C05499')/**
				구법무시스템이관, 사업부이관 제외 코드 **/
				AND bb.PRGRS_STATUS NOT IN ('C04201', 'C04225') /** 작성중, 임시저장 **/
				AND cc.DEL_YN = 'N'
				GROUP BY cube(to_char(to_date(cc.reg_dt),'IW'))
			</statement>
		</query>


		<!-- 검토의뢰건수(법률자문) 월별 -->
		<query id="las.statistics.listStatisticsConsiderationLawM"
			isCamelCase="false">
			<statement>
            <![CDATA[
		        SELECT decode(btb.month,'13','계',btb.month) as gubun
					,ISNULL(atb.a1,0) as a1 ,ISNULL(atb.b2,0) as b2 ,ISNULL(atb.c3,0) as c3 ,ISNULL(atb.d4,0) as d4 ,ISNULL(atb.e5,0) as e5
					,ISNULL(atb.f6,0) as f6 ,ISNULL(atb.g7,0) as g7 ,ISNULL(atb.h8,0) as h8 ,ISNULL(atb.i9,0) as i9 ,ISNULL(atb.j10,0) as j10 
					,ISNULL(atb.k11,0) as k11,ISNULL(atb.l12,0) as l12,ISNULL(atb.total,0) as total
				FROM
				(
					SELECT
						ISNULL(to_char(reg_dt,'fmmmfm'),13) AS MONTH ,
						  COUNT(DECODE(comp_cd,'M20',0)) AS a1 ,
						  COUNT(DECODE(comp_cd,'M40',0)) AS b2 ,
						  COUNT(DECODE(comp_cd,'PC3',0)) AS c3 ,
						  COUNT(DECODE(comp_cd,'PC2',0)) AS d4 ,
						  COUNT(DECODE(comp_cd,'PCO',0)) AS e5 ,
						  COUNT(DECODE(comp_cd,'E90',0)) AS f6 ,
						  COUNT(DECODE(comp_cd,'PEQ',0)) AS g7 ,
						  COUNT(DECODE(comp_cd,'PCB',0)) AS h8 ,
						  COUNT(DECODE(comp_cd,'PCC',0)) AS i9 ,
						  COUNT(DECODE(comp_cd,'PC9',0)) AS j10 ,
						  COUNT(DECODE(comp_cd,'PC6',0)) AS k11 ,
						  COUNT(DECODE(comp_cd,'PCJ',0)) AS l12
						 ,(count(decode(comp_cd,'M20',0))+ count(decode(comp_cd,'M40',0))
						+ count(decode(comp_cd,'PC3',0)) + count(decode(comp_cd,'PC2',0))
						+ count(decode(comp_cd,'PCO',0)) + count(decode(comp_cd,'E90',0)) 
						+ count(decode(comp_cd,'PEQ',0)) + count(decode(comp_cd,'PCB',0))
						+ count(decode(comp_cd,'PCC',0)) + count(decode(comp_cd,'PC9',0)) 
						+ count(decode(comp_cd,'PC6',0)) + count(decode(comp_cd,'PCJ',0))) as total
					FROM tn_las_consult 
					WHERE extnl_prgrs_status ='S02'
					AND del_yn='N'
					AND hstry_no=0
					AND CAST(YEAR(REG_DT) AS VARCHAR(4)) = :vo.srch_year
					GROUP BY cube(to_char(reg_dt,'fmmmfm'))
        		) atb,(select rownum as month  connect by level <= 13) btb
				WHERE atb.month(+) = btb.month
				ORDER by  btb.month asc
				]]>
			</statement>
		</query>

		<!-- 검토의뢰건수(법률자문) 주차별 -->
		<query id="las.statistics.listStatisticsConsiderationLawW"
			isCamelCase="false">
			<statement>
				SELECT
				ISNULL2(to_char(to_date(reg_dt),'IW'),to_char(to_date(reg_dt),'IW'),to_char(to_date(reg_dt),'IW')+ '계' ) as gubun ,
				COUNT(DECODE(comp_cd,'M20',0)) AS a1 ,
				COUNT(DECODE(comp_cd,'M40',0)) AS b2 ,
				COUNT(DECODE(comp_cd,'PC3',0)) AS c3 ,
				COUNT(DECODE(comp_cd,'PC2',0)) AS d4 ,
				COUNT(DECODE(comp_cd,'PCO',0)) AS e5 ,
				COUNT(DECODE(comp_cd,'E90',0)) AS f6 ,
				COUNT(DECODE(comp_cd,'PEQ',0)) AS g7 ,
				COUNT(DECODE(comp_cd,'PCB',0)) AS h8 ,
				COUNT(DECODE(comp_cd,'PCC',0)) AS i9 ,
				COUNT(DECODE(comp_cd,'PC9',0)) AS j10 ,
				COUNT(DECODE(comp_cd,'PC6',0)) AS k11 ,
				COUNT(DECODE(comp_cd,'PCJ',0)) AS l12
				,(count(decode(comp_cd,'M20',0))+ count(decode(comp_cd,'M40',0))
				+ count(decode(comp_cd,'PC3',0)) + count(decode(comp_cd,'PC2',0))
				+ count(decode(comp_cd,'PCO',0)) + count(decode(comp_cd,'E90',0))
				+ count(decode(comp_cd,'PEQ',0)) + count(decode(comp_cd,'PCB',0))
				+ count(decode(comp_cd,'PCC',0)) + count(decode(comp_cd,'PC9',0))
				+ count(decode(comp_cd,'PC6',0)) + count(decode(comp_cd,'PCJ',0))) as
				total
				FROM tn_las_consult
				WHERE extnl_prgrs_status ='S02'
				AND del_yn='N'
				AND hstry_no=0
				AND
				CAST(YEAR(REG_DT) AS VARCHAR(4)) = :vo.srch_year
				AND to_char(to_date(reg_dt),'IW') between :vo.srch_start_y and
				:vo.srch_end_y
				GROUP BY cube(to_char(to_date(reg_dt),'IW'))
			</statement>
		</query>

		<!--//END 관련사통계 : 검토의뢰건수 -->


		<!-- 관련사통계 : 전자검토자통계 -->
		<query id="las.statistics.listStatisticsElecReviewer"
			isCamelCase="false" isDynamic="true">
			<statement>
                <![CDATA[
			SELECT bb.user_real_nm,bb.user_real_nm_eng,cc.cd_abbr_nm,cc.cd_abbr_nm_eng,cc.cd_abbr_nm_fra,cc.cd_abbr_nm_deu,cc.cd_abbr_nm_ita,cc.cd_abbr_nm_esp,aa.RESPMAN_ID, REQ1,  REPLY1,  LT1_SUM,
					  LT1,REQ2,REPLY2,LT2_SUM,LT2,REQ3,REPLY3,LT3_SUM,LT3
					FROM
					  (SELECT X.RESPMAN_ID,X.comp_cd,
					    /** 담당자 ID **/
					    SUM(REQ1) REQ1,
					    /** 금주실적 - 의뢰(정) **/
					    SUM(REPLY1) REPLY1,
					    /** 금주실적 - 회신(정) **/
					    TRIM(TO_CHAR(SUM(LT1), '99999.99')) LT1_SUM,
					    /** 금주실적 - L/T(합)
					    **/
					    TRIM(TO_CHAR(
					    CASE
					      WHEN SUM(REPLY1) = 0
					      THEN 0
					      ELSE DBO.TRUNC(SUM(LT1)/(SUM(REPLY1)),1)
					    END, '99999.9')) LT1,
					    /** 금주실적 - LT **/
					    SUM(REQ2) REQ2,
					    /** 금월실적 - 의뢰(정) **/
					    SUM(REPLY2) REPLY2,
					    /** 금월실적 - 회신(정) **/
					    TRIM(TO_CHAR(SUM(LT2), '99999.99')) LT2_SUM,
					    /** 금월실적 - L/T(합) **/
					    TRIM(TO_CHAR(
					    CASE
					      WHEN SUM(REPLY2) = 0
					      THEN 0
					      ELSE DBO.TRUNC(SUM(LT2)/(SUM(REPLY2)),1)
					    END, '99999.9')) LT2,
					    /** 금월실적 - L/T **/
					    SUM(REQ3) REQ3,
					    /** 금년실적 - 의뢰(정) **/
					    SUM(REPLY3) REPLY3,
					    /** 금년실적 - 회신(정)
					    **/
					    TRIM(TO_CHAR(SUM(LT3), '99999.99')) LT3_SUM,
					    /** 금년실적 - L/T(합) **/
					    TRIM(TO_CHAR(
					    CASE
					      WHEN SUM(REPLY3) = 0
					      THEN 0
					      ELSE DBO.TRUNC(SUM(LT3)/(SUM(REPLY3)),1)
					    END, '99999.9')) LT3
					    /** 금년실적 -
					    L/T **/
					  FROM
					    (
					    /******************* 금주 실적 ****************************/
					    SELECT A.RESPMAN_ID,a.comp_cd,
					      SUM(REQ) REQ1,
					      SUM(REPLY) REPLY1,
					      SUM(LT) LT1,
					      0 REQ2,
					      0 REPLY2,
					      0 LT2,
					      0 REQ3,
					      0 REPLY3,
					      0 LT3
					    FROM
					      (
					      /** 의뢰 건수 **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        ISNULL2(B.MAIN_CNSD_YN,1,0) req,
					        0 REPLY,
					        0 LT
					      FROM TN_CLM_CONT_CNSDREQ A,
					        TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_CNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE A.CNSDREQ_ID      = B.CNSDREQ_ID
					      AND TCU.USER_ID         = B.RESPMAN_ID
					      AND D.CNTRT_ID          = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND A.DEL_YN            = 'N'
					      AND E.DEL_YN            = 'N'
					      AND A.PRGRS_STATUS NOT IN ('C04201','C04225')
					        /** 작성중, 임시저장 **/
					      AND A.PREV_CNSDREQ_ID    IS NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')
					        /* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND B.CNSDREQ_ID = D.CNSDREQ_ID
					      AND A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
					      UNION ALL
					      /** 회신 건수 **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        0 REQ,
					        ISNULL2(B.MAIN_CNSD_YN,1,0) REPLY,
					        0 LT
					      FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_DEPTCNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE B.CNSDREQ_ID        = D.CNSDREQ_ID
					      AND TCU.USER_ID           = B.RESPMAN_ID
					      AND D.CNTRT_ID            = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND E.DEL_YN              = 'N'
					      AND D.CNSD_STATUS         = 'C04305'
					      AND D.CNSD_DT            IS NOT NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')
					      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
					      /* 구법무시스템이관,
					      사업부이관 제외 코드 */
					      UNION ALL
					      /** L/T **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        0 REQ,
					        0 REPLY,
					        ISNULL(D.REQ_LT, 0) LT
					      FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_DEPTCNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE B.CNSDREQ_ID        = D.CNSDREQ_ID
					      AND TCU.USER_ID           = B.RESPMAN_ID
					      AND D.CNTRT_ID            = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND E.DEL_YN              = 'N'
					      AND D.CNSD_STATUS         = 'C04305'
					      AND D.CNSD_DT            IS NOT NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관,사업부이관 제외 코드 */
					      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curweek_s) AND CONVERT(DATETIME, :vo.srch_curweek_e)+1
					      ) A
					    WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
					    GROUP BY A.RESPMAN_ID,a.comp_cd
					    UNION ALL
					    /*********************
					    금월 실적 *************************/
					    SELECT A.RESPMAN_ID,a.comp_cd,
					      0 REQ1,
					      0 REPLY1,
					      0 LT1,
					      SUM(REQ) REQ2,
					      SUM(REPLY) REPLY2,
					      SUM(LT) LT2,
					      0 REQ3,
					      0 REPLY3,
					      0 LT3
					    FROM
					      (
					      /** 의뢰 건수 **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        ISNULL2(B.MAIN_CNSD_YN,1,0) req,
					        0 REPLY,
					        0 LT
					      FROM TN_CLM_CONT_CNSDREQ A,
					        TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_CNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE A.CNSDREQ_ID      = B.CNSDREQ_ID
					      AND TCU.USER_ID         = B.RESPMAN_ID
					      AND D.CNTRT_ID          = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND A.DEL_YN            = 'N'
					      AND E.DEL_YN            = 'N'
					      AND A.PRGRS_STATUS NOT IN ('C04201','C04225')
					        /** 작성중, 임시저장 **/
					      AND A.PREV_CNSDREQ_ID    IS NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')
					        /* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1
					      AND B.CNSDREQ_ID = D.CNSDREQ_ID
					      UNION ALL
					      /** 회신 건수 **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        0 REQ,
					        ISNULL2(B.MAIN_CNSD_YN,1,0) REPLY,
					        0 LT
					      FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_DEPTCNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE B.CNSDREQ_ID        = D.CNSDREQ_ID
					      AND TCU.USER_ID           = B.RESPMAN_ID
					      AND D.CNTRT_ID            = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND E.DEL_YN              = 'N'
					      AND D.CNSD_STATUS         = 'C04305'
					      AND D.CNSD_DT            IS NOT NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')
					        /* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1      
					      UNION ALL
					      /** L/T **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        0 REQ,
					        0 REPLY,
					        DECODE(B.MAIN_CNSD_YN, 'Y', D.REQ_LT, 0) LT
					      FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_DEPTCNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE B.CNSDREQ_ID        = D.CNSDREQ_ID
					      AND TCU.USER_ID           = B.RESPMAN_ID
					      AND D.CNTRT_ID            = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND E.DEL_YN              = 'N'
					      AND D.CNSD_STATUS         = 'C04305'
					      AND D.CNSD_DT            IS NOT NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499') /* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_curmonth_s) AND CONVERT(DATETIME, :vo.srch_curmonth_e)+1
					      ) A
					    WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
					    GROUP BY A.RESPMAN_ID,a.comp_cd
					    UNION ALL
					    /******************** 금년 실적*******************************/
					    SELECT A.RESPMAN_ID,a.comp_cd,
					      0 REQ1,
					      0 REPLY1,
					      0 LT1,
					      0 REQ2,
					      0 REPLY2,
					      0 LT2,
					      SUM(REQ) REQ3,
					      SUM(REPLY) REPLY3,
					      SUM(LT) LT3
					    FROM
					      (
					      /** 의뢰 건수 **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        ISNULL2(B.MAIN_CNSD_YN,1,0) req,
					        0 REPLY,
					        0 LT
					      FROM TN_CLM_CONT_CNSDREQ A,
					        TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_CNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE A.CNSDREQ_ID      = B.CNSDREQ_ID
					      AND TCU.USER_ID         = B.RESPMAN_ID
					      AND D.CNTRT_ID          = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND A.DEL_YN            = 'N'
					      AND E.DEL_YN            = 'N'
					      AND A.PRGRS_STATUS NOT IN ('C04201','C04225')
					        /** 작성중, 임시저장 **/
					      AND A.PREV_CNSDREQ_ID    IS NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND A.REQ_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101') AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
					      AND B.CNSDREQ_ID = D.CNSDREQ_ID
					      UNION ALL
					      /** 회신 건수 **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        0 REQ,
					        ISNULL2(B.MAIN_CNSD_YN,1,0) REPLY,
					        0 LT
					      FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_DEPTCNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE B.CNSDREQ_ID        = D.CNSDREQ_ID
					      AND TCU.USER_ID           = B.RESPMAN_ID
					      AND D.CNTRT_ID            = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND E.DEL_YN              = 'N'
					      AND D.CNSD_STATUS         = 'C04305'
					      AND D.CNSD_DT            IS NOT NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')
					        /* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101')
					      AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
					      UNION ALL
					      
					      /** L/T **/
					      SELECT B.RESPMAN_ID,E.comp_cd,
					        B.RESP_DEPT AS DMSTFRGN_GBN,
					        D.CNSDREQ_ID,
					        0 REQ,
					        0 REPLY,
					        ISNULL(D.REQ_LT, 0) LT
					      FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
					        TN_CLM_CONTRACT_DEPTCNSD D,
					        TN_CLM_CONTRACT_MASTER E,
					        TB_COM_USER TCU
					      WHERE B.CNSDREQ_ID        = D.CNSDREQ_ID
					      AND TCU.USER_ID           = B.RESPMAN_ID
					      AND D.CNTRT_ID            = E.CNTRT_ID
					      AND TCU.COMP_CD         = 'C10'
					      AND E.DEL_YN              = 'N'
					      AND D.CNSD_STATUS         = 'C04305'
					      AND D.CNSD_DT            IS NOT NULL
					      AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')
					        /* 구법무시스템이관, 사업부이관 제외 코드 */
					      AND D.CNSD_DT BETWEEN CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '0101') AND CONVERT(DATETIME, CAST(YEAR(GETDATE()) AS VARCHAR(4)) + '1231')+1
					      ) A
					    WHERE A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
					    GROUP BY A.RESPMAN_ID,a.comp_cd
					    ) X
					  GROUP BY X.RESPMAN_ID,X.comp_cd
					  )aa, tb_com_user bb, tb_com_cd cc
					WHERE aa.RESPMAN_ID = bb.user_id
						and cc.cd = aa.comp_cd
						and cc.grp_cd = 'COMP2'
					#if ($vo.session_user_locale.equals("ko"))
						ORDER BY cc.cd_abbr_nm,bb.user_real_nm ASC
					#elseif ($vo.session_user_locale.equals("fr"))
						ORDER BY cc.cd_abbr_nm_fra,bb.user_real_nm_eng ASC
					#elseif ($vo.session_user_locale.equals("de"))
						ORDER BY cc.cd_abbr_nm_deu,bb.user_real_nm_eng ASC
					#elseif ($vo.session_user_locale.equals("it"))
						ORDER BY cc.cd_abbr_nm_ita,bb.user_real_nm_eng ASC
					#elseif ($vo.session_user_locale.equals("es"))
						ORDER BY cc.cd_abbr_nm_esp,bb.user_real_nm_eng ASC
          			#else
          				ORDER BY cc.cd_abbr_nm_eng,bb.user_real_nm_eng ASC
          			#end
					
                ]]>
			</statement>
		</query>


<!-- 관련사통계 : 전자검토자통계 (기간별) -->
        <query id="las.statistics.listStatisticsElecReviewerP" isCamelCase="false" isDynamic="true">
            <statement>
                <![CDATA[   
                     SELECT cc.cd_abbr_nm,cc.cd_abbr_nm_eng,cc.cd_abbr_nm_fra,cc.cd_abbr_nm_deu,cc.cd_abbr_nm_ita,cc.cd_abbr_nm_esp,bb.user_real_nm,bb.user_real_nm_eng 
                     		,aa.REQ as REQ1, aa.REPLY as REPLY1 ,aa.LT1_SUM,aa.LT1
					 FROM
					 (
 						SELECT A.RESPMAN_ID,  /** 담당자 **/
 						A.COMP_CD,
                   		SUM(REQ) REQ,         /** 의뢰(부) **/
                   		SUM(REPLY) REPLY,     /** 회신(부) **/
                   		TRIM(TO_CHAR(SUM(LT),'99999.99')) LT1_SUM,  /** L/T(합) **/
                   		TRIM(TO_CHAR(CASE WHEN SUM(REPLY) = 0 THEN 0 
                        			  	  ELSE DBO.TRUNC(SUM(LT)/(SUM(REPLY)),2) END,'99999.9')) LT1 /** L/T **/
            			FROM
            			(
			                /** 의뢰 건수 **/                               
			                SELECT  B.RESPMAN_ID,E.comp_cd,
			                    B.RESP_DEPT AS DMSTFRGN_GBN,
			                    D.CNSDREQ_ID,
			                    ISNULL2(B.MAIN_CNSD_YN, 1, 0) REQ,
			                    0 REPLY,
			                    0 LT
			                    
			                FROM    TN_CLM_CONT_CNSDREQ A,
			                    TN_CLM_CONT_CNSDREQ_RESPMAN B,
			                    TN_CLM_CONTRACT_CNSD D,
			                    TN_CLM_CONTRACT_MASTER E,
			                    TB_COM_USER TCU
			                                     
			                WHERE   A.CNSDREQ_ID = B.CNSDREQ_ID
			                  AND TCU.COMP_CD ='C10'
					      	  AND TCU.USER_ID = B.RESPMAN_ID               
			                  AND D.CNTRT_ID = E.CNTRT_ID
			                  AND   A.DEL_YN = 'N'
			                  AND   E.DEL_YN = 'N'
			                  AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
			                  AND   A.PREV_CNSDREQ_ID IS NULL
			                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */  
			                  AND   B.CNSDREQ_ID = D.CNSDREQ_ID
			                  AND   A.REQ_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt) AND CONVERT(DATETIME, :vo.srch_end_dt)+1
			                
			                UNION ALL
			                
			                /** 회신건수 **/
			                SELECT  B.RESPMAN_ID,E.comp_cd,
			                    B.RESP_DEPT AS DMSTFRGN_GBN,
			                    D.CNSDREQ_ID,
			                    0 REQ,
			                    ISNULL2(B.MAIN_CNSD_YN, 1, 0) REPLY,
			                   0 LT
			                   
			                FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
			                     TN_CLM_CONTRACT_DEPTCNSD D,
			                     TN_CLM_CONTRACT_MASTER E,
			                     TB_COM_USER TCU
			                     
			                WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
			                  AND TCU.COMP_CD = 'C10'
					      	  AND TCU.USER_ID = B.RESPMAN_ID                 
			                  AND D.CNTRT_ID = E.CNTRT_ID
			                  AND E.DEL_YN = 'N'
			                  AND D.CNSD_STATUS = 'C04305'
			                  AND D.CNSD_DT IS NOT NULL
			                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
			                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt) AND CONVERT(DATETIME, :vo.srch_end_dt)+1
			            
			                UNION ALL
			                
			                  /** L/T **/
			                 SELECT B.RESPMAN_ID,E.comp_cd,
			                        B.RESP_DEPT AS DMSTFRGN_GBN,
			                        D.CNSDREQ_ID,
			                        0 REQ,
			                        0 REPLY,
			                        ISNULL(D.REQ_LT, 0) LT
			                FROM TN_CLM_CONT_CNSDREQ_RESPMAN B,
			                     TN_CLM_CONTRACT_DEPTCNSD D,
			                     TN_CLM_CONTRACT_MASTER E,
			                     TB_COM_USER TCU
			                     
			                WHERE B.CNSDREQ_ID = D.CNSDREQ_ID
			                  AND TCU.COMP_CD = 'C10'
					      	  AND TCU.USER_ID = B.RESPMAN_ID                  
			                  AND D.CNTRT_ID = E.CNTRT_ID
			                  AND E.DEL_YN = 'N'
			                  AND D.CNSD_STATUS = 'C04305'
			                  AND D.CNSD_DT IS NOT NULL
			                  AND E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
			                  AND D.CNSD_DT BETWEEN CONVERT(DATETIME, :vo.srch_start_dt) AND CONVERT(DATETIME, :vo.srch_end_dt)+1
			            
			            ) A 
            	WHERE 1=1
            	AND A.DMSTFRGN_GBN = :vo.srch_dmstfrgn_gbn
            	GROUP BY A.RESPMAN_ID,a.comp_cd
            	)aa , tb_com_user bb, tb_com_cd cc
					WHERE aa.RESPMAN_ID = bb.user_id
						and cc.cd = aa.comp_cd
						and cc.grp_cd = 'COMP2'
				#if ($vo.session_user_locale.equals("ko"))
					ORDER BY cc.cd_abbr_nm,bb.user_real_nm ASC
				#elseif ($vo.session_user_locale.equals("fr"))
					ORDER BY cc.cd_abbr_nm_fra,bb.user_real_nm_eng ASC
				#elseif ($vo.session_user_locale.equals("de"))
					ORDER BY cc.cd_abbr_nm_deu,bb.user_real_nm_eng ASC
				#elseif ($vo.session_user_locale.equals("it"))
					ORDER BY cc.cd_abbr_nm_ita,bb.user_real_nm_eng ASC
				#elseif ($vo.session_user_locale.equals("es"))
					ORDER BY cc.cd_abbr_nm_esp,bb.user_real_nm_eng ASC
          		#else
          			ORDER BY cc.cd_abbr_nm_eng,bb.user_real_nm_eng ASC
          		#end
     			]]>
            </statement>
        </query>
        
        
    <!-- 관련사통계 : 단계별소요시간 -->
        <query id="las.statistics.listStatisticsLeadtimeByStep" isCamelCase="false" isDynamic="true">
            <statement>
                <![CDATA[
					SELECT 	 B.CD COMP_CD
				          	,B.CD_NM COMP_NM
				          	,B.CD_NM_ENG COMP_NM_ENG
				          	,A.REQ_LT
							,A.CNT_LT
							,A.REG_LT
					FROM ( 	SELECT 
								 COMP_CD
								,ROUND (AVG (REQ_LT), 1) REQ_LT
                				,ROUND (AVG (CNT_LT), 1) CNT_LT
                				,ROUND (AVG (REG_LT), 1) REG_LT
           					FROM TN_CLM_CONTRACT_DEPTCNSD
          					WHERE CNSD_DT BETWEEN 	TO_DATE ( :vo.srch_year + '0101', 'YYYY-MM-DD')
                             	               AND 	TO_DATE ( :vo.srch_year + '1231', 'YYYY-MM-DD')
       						GROUP BY COMP_CD
       						)A,
      					( SELECT CD
      							,CD_NM
      							,CD_NM_ENG
         				FROM TB_COM_CD
        				WHERE GRP_CD = 'COMP2'
        				)B
					WHERE A.COMP_CD(+) = B.CD
                ]]>
            </statement>
        </query>

		<!-- 관련사통계 : 단계별소요시간 -->
		<query id="las.statistics.listStatisticsLeadtimeByStep"
			isCamelCase="false" isDynamic="true">
			<statement>
                <![CDATA[
					SELECT 	 B.CD COMP_CD
				          	,B.CD_NM COMP_NM
				          	,B.CD_NM_ENG COMP_NM_ENG
				          	,A.REQ_LT
							,A.CNT_LT
							,A.REG_LT
					FROM ( 	SELECT 
								 CC.COMP_CD
								,ROUND (AVG (REQ_LT), 1) REQ_LT
                				,ROUND (AVG (CNT_LT), 1) CNT_LT
                				,ROUND (AVG (REG_LT), 1) REG_LT
           					FROM TN_CLM_CONTRACT_DEPTCNSD CC,
           						 TN_CLM_CONTRACT_MASTER DD
          					WHERE 	
                           			CC.CNTRT_ID = DD.CNTRT_ID
                           		AND DD.CNTRT_INFO_GBN NOT IN( 'C05403' ,'C05402','C05499')
                           		#if ($vo.srch_month && !$vo.srch_month.equals(""))
									AND	TO_CHAR(CNSD_DT, 'YYYYMM') LIKE :vo.srch_year + CASE WHEN LENGTH(:vo.srch_month) = 1 THEN '0' + :vo.srch_month ELSE :vo.srch_month  END + '%'
                           		#else
                           			AND TO_CHAR(CNSD_DT, 'YYYY') LIKE :vo.srch_year + '%'
                           		#end
       						GROUP BY CC.COMP_CD
       						)A,
      					( SELECT CD
      							,CD_ABBR_NM CD_NM
      							,CD_ABBR_NM_ENG CD_NM_ENG
         				FROM TB_COM_CD
        				WHERE GRP_CD = 'COMP2'
        				)B
					WHERE A.COMP_CD(+) = B.CD
					ORDER BY COMP_CD
                ]]>
			</statement>
		</query>


		<!-- 관련사통계 : 계약체결건수 (월별) -->
		<query id="las.statistics.listStatisticsConsultationM"
			isCamelCase="false" isDynamic="true">
			<statement>
                <![CDATA[

            		SELECT  decode(btb.month,'13','계',btb.month) as gubun
      				,ISNULL(atb.a1,0) as a1 ,ISNULL(atb.b2,0) as b2 ,ISNULL(atb.c3,0) as c3 ,ISNULL(atb.d4,0) as d4 ,ISNULL(atb.e5,0) as e5
      				,ISNULL(atb.f6,0) as f6 ,ISNULL(atb.g7,0) as g7 ,ISNULL(atb.h8,0) as h8 ,ISNULL(atb.i9,0) as i9 ,ISNULL(atb.j10,0) as j10 
      				,ISNULL(atb.k11,0) as k11,ISNULL(atb.l12,0) as l12,ISNULL(atb.total,0) as total
    				FROM
     						(SELECT ISNULL(to_char(cc.reg_dt,'fmmmfm'),13) as month
        							,count(decode(cc.comp_cd,'M20',0)) as a1
        							,count(decode(cc.comp_cd,'M40',0)) as b2
        							,count(decode(cc.comp_cd,'PC3',0)) as c3
        							,count(decode(cc.comp_cd,'PC2',0)) as d4
        							,count(decode(cc.comp_cd,'PCO',0)) as e5
        							,count(decode(cc.comp_cd,'E90',0)) as f6
        							,count(decode(cc.comp_cd,'PEQ',0)) as g7
        							,count(decode(cc.comp_cd,'PCB',0)) as h8
        							,count(decode(cc.comp_cd,'PCC',0)) as i9
        							,count(decode(cc.comp_cd,'PC9',0)) as j10
        							,count(decode(cc.comp_cd,'PC6',0)) as k11
        							,count(decode(cc.comp_cd,'PCJ',0)) as l12
        							,(count(decode(cc.comp_cd,'M20',0))+ count(decode(cc.comp_cd,'M40',0))
     																   + count(decode(cc.comp_cd,'PC3',0)) + count(decode(cc.comp_cd,'PC2',0))
     																   + count(decode(cc.comp_cd,'PCO',0)) + count(decode(cc.comp_cd,'E90',0)) 
    																   + count(decode(cc.comp_cd,'PEQ',0)) + count(decode(cc.comp_cd,'PCB',0))
     																   + count(decode(cc.comp_cd,'PCC',0)) + count(decode(cc.comp_cd,'PC9',0)) 
     																   + count(decode(cc.comp_cd,'PC6',0)) + count(decode(cc.comp_cd,'PCJ',0))) as total
    						FROM
      								(select min(cnsdreq_id) as cnsdreq_id, cntrt_id from TN_CLM_CONTRACT_CNSD group by cntrt_id) aa, TN_CLM_CONT_CNSDREQ bb, TN_CLM_CONTRACT_MASTER cc
    						WHERE 	bb.cnsdreq_id = aa.cnsdreq_id 
      								AND cc.cntrt_id = aa.cntrt_id
      								AND to_char(cc.reg_dt,'YYYY') = :vo.srch_year
      								AND cc.CNTRT_INFO_GBN NOT IN  ('C05403', 'C05402', 'C05499')/** 구법무시스템이관, 사업부이관 제외 코드 **/
      								AND cc.cntrt_status >= 'C02402'
      								AND cc.prcs_depth >= 'C02504'
      								AND cc.depth_status >= 'C02662'
      								AND cc.DEL_YN = 'N'
    				GROUP BY 	cube(to_char(cc.reg_dt,'fmmmfm')) 
    									) atb,(select rownum as month connect by level <= 13) btb
    							WHERE atb.month(+) = btb.month
    				ORDER by  btb.month asc

                ]]>
			</statement>
		</query>


		<!-- 관련사통계 : 계약체결건수 (주차별) -->
		<query id="las.statistics.listStatisticsConsultationW"
			isCamelCase="false" isDynamic="true">
			<statement>
                <![CDATA[
					SELECT 	ISNULL2(to_char(to_date(cc.reg_dt),'IW'),to_char(to_date(cc.reg_dt),'IW'),to_char(to_date(cc.reg_dt),'IW')+ '계' ) as gubun
          					,count(decode(cc.comp_cd,'M20',0)) as a1
          					,count(decode(cc.comp_cd,'M40',0)) as b2
          					,count(decode(cc.comp_cd,'PC3',0)) as c3
          					,count(decode(cc.comp_cd,'PC2',0)) as d4
          					,count(decode(cc.comp_cd,'PCO',0)) as e5
          					,count(decode(cc.comp_cd,'E90',0)) as f6
          					,count(decode(cc.comp_cd,'PEQ',0)) as g7
          					,count(decode(cc.comp_cd,'PCB',0)) as h8
          					,count(decode(cc.comp_cd,'PCC',0)) as i9
          					,count(decode(cc.comp_cd,'PC9',0)) as j10
          					,count(decode(cc.comp_cd,'PC6',0)) as k11
          					,count(decode(cc.comp_cd,'PCJ',0)) as l12
          					,(count(decode(cc.comp_cd,'M20',0))+ count(decode(cc.comp_cd,'M40',0))
       															+ count(decode(cc.comp_cd,'PC3',0)) + count(decode(cc.comp_cd,'PC2',0))
       															+ count(decode(cc.comp_cd,'PCO',0)) + count(decode(cc.comp_cd,'E90',0)) 
       															+ count(decode(cc.comp_cd,'PEQ',0)) + count(decode(cc.comp_cd,'PCB',0))
       															+ count(decode(cc.comp_cd,'PCC',0)) + count(decode(cc.comp_cd,'PC9',0)) 
       															+ count(decode(cc.comp_cd,'PC6',0)) + count(decode(cc.comp_cd,'PCJ',0))) as total
      				FROM
        					(select min(cnsdreq_id) as cnsdreq_id, cntrt_id from TN_CLM_CONTRACT_CNSD group by cntrt_id) aa, TN_CLM_CONT_CNSDREQ bb, TN_CLM_CONTRACT_MASTER cc
      				WHERE 	bb.cnsdreq_id = aa.cnsdreq_id 
        					AND cc.cntrt_id = aa.cntrt_id
        					AND to_char(cc.reg_dt,'YYYY') = :vo.srch_year
                 			AND to_char(to_date(cc.reg_dt),'IW') between :vo.srch_start_y and :vo.srch_end_y
        					AND cc.CNTRT_INFO_GBN NOT IN  ('C05403', 'C05402', 'C05499')/** 구법무시스템이관, 사업부이관 제외 코드 **/
        					AND cc.cntrt_status >= 'C02402'
        					AND cc.prcs_depth >= 'C02504'
        					AND cc.depth_status >= 'C02662'
        					AND cc.DEL_YN = 'N'
      				GROUP BY cube(to_char(to_date(cc.reg_dt),'IW'))

                ]]>
			</statement>
		</query>

  
        
        <!-- 부서별 전사 계약현황 -->
        <query id="las.statistics.listStatisticsContract" isCamelCase="false" isDynamic="true">
            <statement>
                <![CDATA[
					SELECT	'' AS REQ_DEPT
		                	,CASE WHEN :vo.session_user_locale = 'ko' THEN  
								'계'
							WHEN :vo.session_user_locale = 'fr' THEN  
								'TOTAL'
							WHEN :vo.session_user_locale = 'de' THEN  
								'TOTAL' 
							ELSE
								'TOTAL'
							END REQ_DEPT_NM
							,COUNT(A.CNTRT_ID) TOTAL_CNT
							,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0301' THEN 1 ELSE 0 END),0) AS T0301
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0302' THEN 1 ELSE 0 END),0) AS T0302
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0303' THEN 1 ELSE 0 END),0) AS T0303
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0304' THEN 1 ELSE 0 END),0) AS T0304
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0305' THEN 1 ELSE 0 END),0) AS T0305
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0306' THEN 1 ELSE 0 END),0) AS T0306
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0307' THEN 1 ELSE 0 END),0) AS T0307
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0308' THEN 1 ELSE 0 END),0) AS T0308
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0309' THEN 1 ELSE 0 END),0) AS T0309
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0310' THEN 1 ELSE 0 END),0) AS T0310
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0311' THEN 1 ELSE 0 END),0) AS T0311
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0312' THEN 1 ELSE 0 END),0) AS T0312
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0313' THEN 1 ELSE 0 END),0) AS T0313
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0399' THEN 1 ELSE 0 END),0) AS T0399
					FROM    TN_CLM_CONTRACT_MASTER A
					        ,TN_CLM_CONTRACT_CNSD B
					        ,TN_CLM_CONT_CNSDREQ C
					WHERE	A.CNTRT_ID   = B.CNTRT_ID
					AND     B.CNSDREQ_ID = C.CNSDREQ_ID
					AND     C.CNSDREQ_ID = C.FST_CNSDREQ_ID
					AND		C.COMP_CD	 = :vo.session_comp_cd
					AND 	A.DEPTH_STATUS NOT IN ('C02631','C02632','C02636')
					AND     A.CPY_REGDAY BETWEEN DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','01',:vo.srch_month),2,'0') + '01' 
										 AND DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','12',:vo.srch_month),2,'0') + '31'
										 
					UNION ALL
					SELECT  C.REQ_DEPT
				            ,C.REQ_DEPT_NM
				            ,COUNT(A.CNTRT_ID) AS TOTAL_CNT
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0301' THEN 1 ELSE 0 END),0) AS T0301
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0302' THEN 1 ELSE 0 END),0) AS T0302
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0303' THEN 1 ELSE 0 END),0) AS T0303
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0304' THEN 1 ELSE 0 END),0) AS T0304
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0305' THEN 1 ELSE 0 END),0) AS T0305
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0306' THEN 1 ELSE 0 END),0) AS T0306
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0307' THEN 1 ELSE 0 END),0) AS T0307
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0308' THEN 1 ELSE 0 END),0) AS T0308
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0309' THEN 1 ELSE 0 END),0) AS T0309
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0310' THEN 1 ELSE 0 END),0) AS T0310
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0311' THEN 1 ELSE 0 END),0) AS T0311
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0312' THEN 1 ELSE 0 END),0) AS T0312
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0313' THEN 1 ELSE 0 END),0) AS T0313
				            ,ISNULL(SUM(CASE WHEN A.CNCLSNPURPS_BIGCLSFCN = 'T0399' THEN 1 ELSE 0 END),0) AS T0399
					FROM    TN_CLM_CONTRACT_MASTER A
					        ,TN_CLM_CONTRACT_CNSD B
					        ,TN_CLM_CONT_CNSDREQ C
					WHERE	A.CNTRT_ID   = B.CNTRT_ID
					AND     B.CNSDREQ_ID = C.CNSDREQ_ID
					AND     C.CNSDREQ_ID = C.FST_CNSDREQ_ID
					AND		C.COMP_CD	 = :vo.session_comp_cd
					AND 	A.DEPTH_STATUS NOT IN ('C02631','C02632','C02636')
					AND     A.CPY_REGDAY BETWEEN DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','01',:vo.srch_month),2,'0') + '01' 
										 AND DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','12',:vo.srch_month),2,'0') + '31'
										 
					GROUP BY C.REQ_DEPT ,C.REQ_DEPT_NM
                ]]>
            </statement>
        </query>   
        <!-- 부서별 자문현황 -->
        <query id="las.statistics.listStatisticsLaw" isCamelCase="false" isDynamic="true">
            <statement>
                <![CDATA[
                	SELECT	'' AS REQ_DEPT
                	  ,CASE WHEN :vo.session_user_locale = 'ko' THEN  
							'계'
						WHEN :vo.session_user_locale = 'fr' THEN  
							'TOTAL'
						WHEN :vo.session_user_locale = 'de' THEN  
							'TOTAL'
						ELSE
							'TOTAL'
						END REQ_DEPT_NM
					  , SUM(TOTAL_CNT) TOTAL_CNT
				      , SUM(A01) A01
				      , SUM(A02) A02
				      , SUM(A03) A03
				      , SUM(A04) A04
				      , SUM(A05) A05
				      , SUM(A06) A06
				      , SUM(A07) A07
				      , SUM(A08) A08
				      , SUM(A09) A09
				      , SUM(A10) A10
				      , SUM(A11) A11
				      , SUM(A12) A12
				      , SUM(A13) A13
				      , SUM(A14) A14
				      , SUM(A15) A15
				      , SUM(A16) A16
				      , SUM(A17) A17
				      , SUM(A18) A18
				      , SUM(A19) A19
		
				      , SUM(B01) B01
				      , SUM(B02) B02
				      , SUM(B03) B03
				      , SUM(B04) B04
				      , SUM(B05) B05
				      , SUM(B06) B06
				      , SUM(B07) B07
				      , SUM(B08) B08
				      , SUM(B09) B09
				      , SUM(B10) B10
				      , SUM(B11) B11
				      , SUM(B12) B12
				      , SUM(B13) B13
				      , SUM(B14) B14
				  FROM  ( 
                	SELECT	TLC.REG_DEPT AS REQ_DEPT
               				, TLC.REG_DEPT_NM AS REQ_DEPT_NM
                			, COUNT(TLC.CNSLT_NO) AS TOTAL_CNT
                			, SUM(CASE WHEN CNSLT_TYPE = 'A01' THEN 1 ELSE 0 END) AS A01
                			, SUM(CASE WHEN CNSLT_TYPE = 'A02' THEN 1 ELSE 0 END) AS A02
                            , SUM(CASE WHEN CNSLT_TYPE = 'A03' THEN 1 ELSE 0 END) AS A03
                            , SUM(CASE WHEN CNSLT_TYPE = 'A04' THEN 1 ELSE 0 END) AS A04
                            , SUM(CASE WHEN CNSLT_TYPE = 'A05' THEN 1 ELSE 0 END) AS A05
                            , SUM(CASE WHEN CNSLT_TYPE = 'A06' THEN 1 ELSE 0 END) AS A06
                            , SUM(CASE WHEN CNSLT_TYPE = 'A07' THEN 1 ELSE 0 END) AS A07
                            , SUM(CASE WHEN CNSLT_TYPE = 'A08' THEN 1 ELSE 0 END) AS A08
                            , SUM(CASE WHEN CNSLT_TYPE = 'A09' THEN 1 ELSE 0 END) AS A09
                            , SUM(CASE WHEN CNSLT_TYPE = 'A10' THEN 1 ELSE 0 END) AS A10
                            , SUM(CASE WHEN CNSLT_TYPE = 'A11' THEN 1 ELSE 0 END) AS A11
                            , SUM(CASE WHEN CNSLT_TYPE = 'A12' THEN 1 ELSE 0 END) AS A12
                            , SUM(CASE WHEN CNSLT_TYPE = 'A13' THEN 1 ELSE 0 END) AS A13
                            , SUM(CASE WHEN CNSLT_TYPE = 'A14' THEN 1 ELSE 0 END) AS A14
                            , SUM(CASE WHEN CNSLT_TYPE = 'A15' THEN 1 ELSE 0 END) AS A15
                            , SUM(CASE WHEN CNSLT_TYPE = 'A16' THEN 1 ELSE 0 END) AS A16
                            , SUM(CASE WHEN CNSLT_TYPE = 'A17' THEN 1 ELSE 0 END) AS A17
                            , SUM(CASE WHEN CNSLT_TYPE = 'A18' THEN 1 ELSE 0 END) AS A18
                            , SUM(CASE WHEN CNSLT_TYPE = 'A19' THEN 1 ELSE 0 END) AS A19
                            , SUM(CASE WHEN CNSLT_TYPE = 'B01' THEN 1 ELSE 0 END) AS B01
                            , SUM(CASE WHEN CNSLT_TYPE = 'B02' THEN 1 ELSE 0 END) AS B02
                            , SUM(CASE WHEN CNSLT_TYPE = 'B03' THEN 1 ELSE 0 END) AS B03
                            , SUM(CASE WHEN CNSLT_TYPE = 'B04' THEN 1 ELSE 0 END) AS B04
                            , SUM(CASE WHEN CNSLT_TYPE = 'B05' THEN 1 ELSE 0 END) AS B05
                            , SUM(CASE WHEN CNSLT_TYPE = 'B06' THEN 1 ELSE 0 END) AS B06
                            , SUM(CASE WHEN CNSLT_TYPE = 'B07' THEN 1 ELSE 0 END) AS B07
                            , SUM(CASE WHEN CNSLT_TYPE = 'B08' THEN 1 ELSE 0 END) AS B08
                            , SUM(CASE WHEN CNSLT_TYPE = 'B09' THEN 1 ELSE 0 END) AS B09
                            , SUM(CASE WHEN CNSLT_TYPE = 'B10' THEN 1 ELSE 0 END) AS B10
                            , SUM(CASE WHEN CNSLT_TYPE = 'B11' THEN 1 ELSE 0 END) AS B11
                            , SUM(CASE WHEN CNSLT_TYPE = 'B12' THEN 1 ELSE 0 END) AS B12
                            , SUM(CASE WHEN CNSLT_TYPE = 'B13' THEN 1 ELSE 0 END) AS B13
                            , SUM(CASE WHEN CNSLT_TYPE = 'B14' THEN 1 ELSE 0 END) AS B14
					FROM    TN_LAS_CONSULT TLC
					        ,TN_LAS_CONSULT_TYPE TLCT
					WHERE   TLC.CNSLT_NO 	= TLCT.CNSLT_NO
					AND     TLC.COMP_CD		= :vo.session_comp_cd
					AND 	TLC.DEL_YN 		='N'
					AND  	TLC.HSTRY_NO 	= 0
					AND    	TLCT.HSTRY_NO 	= 0
					AND     TLC.EXTNL_PRGRS_STATUS <> 'S01'
					AND 	TLCT.CNSLT_TYPE <> 'A20' /*표준계약서 제외*/
					AND     REPLACE(CONVERT(CHAR(10), TLC.REG_DT, 23),'-','')  /*YYYYMMDD*/
								BETWEEN DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','01',:vo.srch_month),2,'0') + '01'						   
								AND DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','12',:vo.srch_month),2,'0') + '31'
														   
					GROUP BY TLC.REG_DEPT_NM,TLC.REG_DEPT
					) TA
					UNION ALL
					SELECT	TLC.REG_DEPT AS REQ_DEPT
               				, TLC.REG_DEPT_NM AS REQ_DEPT_NM
                			, COUNT(TLC.CNSLT_NO) AS TOTAL_CNT
                			, SUM(CASE WHEN CNSLT_TYPE = 'A01' THEN 1 ELSE 0 END) AS A01
                			, SUM(CASE WHEN CNSLT_TYPE = 'A02' THEN 1 ELSE 0 END) AS A02
                            , SUM(CASE WHEN CNSLT_TYPE = 'A03' THEN 1 ELSE 0 END) AS A03
                            , SUM(CASE WHEN CNSLT_TYPE = 'A04' THEN 1 ELSE 0 END) AS A04
                            , SUM(CASE WHEN CNSLT_TYPE = 'A05' THEN 1 ELSE 0 END) AS A05
                            , SUM(CASE WHEN CNSLT_TYPE = 'A06' THEN 1 ELSE 0 END) AS A06
                            , SUM(CASE WHEN CNSLT_TYPE = 'A07' THEN 1 ELSE 0 END) AS A07
                            , SUM(CASE WHEN CNSLT_TYPE = 'A08' THEN 1 ELSE 0 END) AS A08
                            , SUM(CASE WHEN CNSLT_TYPE = 'A09' THEN 1 ELSE 0 END) AS A09
                            , SUM(CASE WHEN CNSLT_TYPE = 'A10' THEN 1 ELSE 0 END) AS A10
                            , SUM(CASE WHEN CNSLT_TYPE = 'A11' THEN 1 ELSE 0 END) AS A11
                            , SUM(CASE WHEN CNSLT_TYPE = 'A12' THEN 1 ELSE 0 END) AS A12
                            , SUM(CASE WHEN CNSLT_TYPE = 'A13' THEN 1 ELSE 0 END) AS A13
                            , SUM(CASE WHEN CNSLT_TYPE = 'A14' THEN 1 ELSE 0 END) AS A14
                            , SUM(CASE WHEN CNSLT_TYPE = 'A15' THEN 1 ELSE 0 END) AS A15
                            , SUM(CASE WHEN CNSLT_TYPE = 'A16' THEN 1 ELSE 0 END) AS A16
                            , SUM(CASE WHEN CNSLT_TYPE = 'A17' THEN 1 ELSE 0 END) AS A17
                            , SUM(CASE WHEN CNSLT_TYPE = 'A18' THEN 1 ELSE 0 END) AS A18
                            , SUM(CASE WHEN CNSLT_TYPE = 'A19' THEN 1 ELSE 0 END) AS A19
                            , SUM(CASE WHEN CNSLT_TYPE = 'B01' THEN 1 ELSE 0 END) AS B01
                            , SUM(CASE WHEN CNSLT_TYPE = 'B02' THEN 1 ELSE 0 END) AS B02
                            , SUM(CASE WHEN CNSLT_TYPE = 'B03' THEN 1 ELSE 0 END) AS B03
                            , SUM(CASE WHEN CNSLT_TYPE = 'B04' THEN 1 ELSE 0 END) AS B04
                            , SUM(CASE WHEN CNSLT_TYPE = 'B05' THEN 1 ELSE 0 END) AS B05
                            , SUM(CASE WHEN CNSLT_TYPE = 'B06' THEN 1 ELSE 0 END) AS B06
                            , SUM(CASE WHEN CNSLT_TYPE = 'B07' THEN 1 ELSE 0 END) AS B07
                            , SUM(CASE WHEN CNSLT_TYPE = 'B08' THEN 1 ELSE 0 END) AS B08
                            , SUM(CASE WHEN CNSLT_TYPE = 'B09' THEN 1 ELSE 0 END) AS B09
                            , SUM(CASE WHEN CNSLT_TYPE = 'B10' THEN 1 ELSE 0 END) AS B10
                            , SUM(CASE WHEN CNSLT_TYPE = 'B11' THEN 1 ELSE 0 END) AS B11
                            , SUM(CASE WHEN CNSLT_TYPE = 'B12' THEN 1 ELSE 0 END) AS B12
                            , SUM(CASE WHEN CNSLT_TYPE = 'B13' THEN 1 ELSE 0 END) AS B13
                            , SUM(CASE WHEN CNSLT_TYPE = 'B14' THEN 1 ELSE 0 END) AS B14
					FROM    TN_LAS_CONSULT TLC
					        ,TN_LAS_CONSULT_TYPE TLCT
					WHERE   TLC.CNSLT_NO 	= TLCT.CNSLT_NO
					AND     TLC.COMP_CD		= :vo.session_comp_cd
					AND 	TLC.DEL_YN 		='N'
					AND  	TLC.HSTRY_NO 	= 0
					AND    	TLCT.HSTRY_NO 	= 0
					AND     TLC.EXTNL_PRGRS_STATUS <> 'S01'
					AND 	TLCT.CNSLT_TYPE <> 'A20' /*표준계약서 제외*/
					AND     REPLACE(CONVERT(CHAR(10), TLC.REG_DT, 23),'-','')  /*YYYYMMDD*/ 
								BETWEEN DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','01',:vo.srch_month),2,'0') + '01'						   
								AND DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + DBO.FUNCTION_LPAD(DBO.DECODE3(:vo.srch_month,'XXNULL','12',:vo.srch_month),2,'0') + '31'									   
					GROUP BY TLC.REG_DEPT_NM,TLC.REG_DEPT
                ]]>
            </statement>
        </query>   
        <!-- 월별 전사 계약현황 -->
        <query id="las.statistics.listStatisticsContractByMonth" isCamelCase="false" isDynamic="true">
            <statement>
                <![CDATA[
                	SELECT  '' AS REQ_DEPT
                	  		,CASE WHEN :vo.session_user_locale = 'ko' THEN  
								'계'
							WHEN :vo.session_user_locale = 'fr' THEN  
								'TOTAL'
							WHEN :vo.session_user_locale = 'de' THEN  
								'TOTAL' 
							ELSE
								'TOTAL'
							END AS REQ_DEPT_NM
                            ,COUNT(A.CNTRT_ID) AS TOTAL_CNT
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '01' THEN 1 ELSE 0 END) AS  MON_01
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '02' THEN 1 ELSE 0 END) AS  MON_02
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '03' THEN 1 ELSE 0 END) AS  MON_03
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '04' THEN 1 ELSE 0 END) AS  MON_04
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '05' THEN 1 ELSE 0 END) AS  MON_05
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '06' THEN 1 ELSE 0 END) AS  MON_06
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '07' THEN 1 ELSE 0 END) AS  MON_07
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '08' THEN 1 ELSE 0 END) AS  MON_08
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '09' THEN 1 ELSE 0 END) AS  MON_09
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '10' THEN 1 ELSE 0 END) AS  MON_10
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '11' THEN 1 ELSE 0 END) AS  MON_11
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '12' THEN 1 ELSE 0 END) AS  MON_12
                    FROM    TN_CLM_CONTRACT_MASTER A
                            ,TN_CLM_CONTRACT_CNSD B
                            ,TN_CLM_CONT_CNSDREQ C
                    WHERE   A.CNTRT_ID   = B.CNTRT_ID
                    AND     B.CNSDREQ_ID = C.CNSDREQ_ID
                    AND     C.CNSDREQ_ID = C.FST_CNSDREQ_ID
                    AND     C.COMP_CD    = :vo.session_comp_cd
                    AND 	A.DEPTH_STATUS NOT IN ('C02631','C02632','C02636')
                    AND     A.CPY_REGDAY like DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + '%'
					UNION ALL
					SELECT  C.REQ_DEPT
                            ,C.REQ_DEPT_NM
                            ,COUNT(A.CNTRT_ID) AS TOTAL_CNT
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '01' THEN 1 ELSE 0 END) AS  MON_01
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '02' THEN 1 ELSE 0 END) AS  MON_02
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '03' THEN 1 ELSE 0 END) AS  MON_03
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '04' THEN 1 ELSE 0 END) AS  MON_04
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '05' THEN 1 ELSE 0 END) AS  MON_05
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '06' THEN 1 ELSE 0 END) AS  MON_06
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '07' THEN 1 ELSE 0 END) AS  MON_07
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '08' THEN 1 ELSE 0 END) AS  MON_08
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '09' THEN 1 ELSE 0 END) AS  MON_09
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '10' THEN 1 ELSE 0 END) AS  MON_10
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '11' THEN 1 ELSE 0 END) AS  MON_11
                            ,SUM(CASE WHEN RIGHT('0'+CAST(MONTH(C.REQ_DT) AS VARCHAR(2)) ,2) = '12' THEN 1 ELSE 0 END) AS  MON_12
                    FROM    TN_CLM_CONTRACT_MASTER A
                            ,TN_CLM_CONTRACT_CNSD B
                            ,TN_CLM_CONT_CNSDREQ C
                    WHERE   A.CNTRT_ID   = B.CNTRT_ID
                    AND     B.CNSDREQ_ID = C.CNSDREQ_ID
                    AND     C.CNSDREQ_ID = C.FST_CNSDREQ_ID
                    AND     C.COMP_CD    = :vo.session_comp_cd
                    AND 	A.DEPTH_STATUS NOT IN ('C02631','C02632','C02636')
                    AND     A.CPY_REGDAY like DBO.DECODE3(:vo.srch_year,'XXNULL','',:vo.srch_year) + '%'
					GROUP BY C.REQ_DEPT ,C.REQ_DEPT_NM
                ]]>
            </statement>
        </query>     
        
        <!-- 구주 통계1 : 계약-->
		<query id="las.statistics.guju_law1.c" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT *, (CASE WHEN ORG_ACPTDAY IS NOT NULL THEN
		    				LT1 + LT2 + LT3 + LT4 + LT5 + LT6
            	 			/*DBO.COM_REQ_LT(FIRST_REQ_DT,ORG_ACPTDAY,COMP_CD)*/ 
            	 		  ELSE 0 END) LT7 /*최초의뢰~원본등록*/
		    	 FROM (
            	 SELECT TA.*, ISNULL((DBO.LAS_CONT_CNSDREQ_RESPMAN_M(TA.CNSDREQ_ID,',','xx')),'') AS CNSDMANS,
            	 		ISNULL((SELECT TOP 1 DEPT_NM_ENG FROM TB_COM_USER WHERE USER_ID = RESPMAN_ID ),'') CNSD_DEPT_NM,
            	 		(CASE WHEN FIRST_REQ_DT IS NOT NULL THEN REPLACE(CONVERT(CHAR(16), FIRST_REQ_DT, 120),' ','&nbsp;') ELSE '' END) AS FIRST_REQ_DT2, /*YYYY-MM-DD:최초의뢰일*/
            	 		(CASE WHEN RE_DT IS NOT NULL THEN REPLACE(CONVERT(CHAR(16), RE_DT, 120),' ','&nbsp;') ELSE '' END) AS RE_DT2, /*YYYY-MM-DD:회신일*/
            	 		CASE WHEN FIRST_ASGN_DT IS NOT NULL THEN 
            	 			DBO.COM_REQ_LT(FIRST_REQ_DT,FIRST_ASGN_DT,COMP_CD)
            	 		ELSE 0 END LT1, /*담당자배정*/
            	 		
            	 		CASE WHEN LAST_ASGN_DT IS NOT NULL AND RE_DT IS NOT NULL THEN 
            	 			DBO.COM_REQ_LT(LAST_ASGN_DT,RE_DT,COMP_CD) 
            	 		ELSE 0 END LT2, /*담당자배정후 회신*/
            	 			
            	 		CASE WHEN APBT_DT IS NOT NULL THEN 
            	 			DBO.COM_REQ_LT(LAST_REQ_DT,APBT_DT,COMP_CD) /*재의뢰후~최종회신*/
            	 		ELSE 0 END LT3,
            	 		
            	 		CASE WHEN APPROVED IS NOT NULL THEN
            	 			CASE WHEN LAST_ASGN_DT IS NULL THEN 0 
            	 			ELSE DBO.COM_REQ_LT(LAST_ASGN_DT,APPROVED,COMP_CD) END 
            	 		ELSE 0 END LT4, /*최종회신후 체결품의승인*/
            	 		 
            	 		CASE WHEN APPROVED IS NOT NULL AND CPY_REGDAY IS NOT NULL THEN
            	 			DBO.COM_REQ_LT(APPROVED,CPY_REGDAY,COMP_CD) 
            	 		ELSE 0 END LT5, /*체결품의승인~복사본업로드 */
            	 		
            	 		CASE WHEN CPY_REGDAY IS NOT NULL AND ORG_ACPTDAY IS NOT NULL THEN
            	 			DBO.COM_REQ_LT(CPY_REGDAY,ORG_ACPTDAY,COMP_CD) 
            	 		ELSE 0 END LT6 /*복사본업로드~원본등록*/
            	 		
					FROM
						(
				      	SELECT A.CNSDREQ_ID, A.REQ_TITLE, A.REQMAN_NM, A.MN_CNSD_DEPT,A.RE_DT, 'Contract' CNT_TYPE0, 
							CASE WHEN :vo.session_user_locale = 'ko' THEN D.CD_NM
			              	     WHEN :vo.session_user_locale = 'fr' THEN D.CD_NM_FRA
			              	     WHEN :vo.session_user_locale = 'de' THEN D.CD_NM_DEU
			              	     ELSE D.CD_NM_ENG
			                END CNT_TYPE1	,
			                CASE WHEN :vo.session_user_locale = 'ko' THEN E.CD_NM
			              	     WHEN :vo.session_user_locale = 'fr' THEN E.CD_NM_FRA
			              	     WHEN :vo.session_user_locale = 'de' THEN E.CD_NM_DEU
			              	     ELSE E.CD_NM_ENG
			                END CNT_TYPE2, 
			                CASE WHEN :vo.session_user_locale = 'ko' THEN F.CD_NM
			              	     WHEN :vo.session_user_locale = 'fr' THEN F.CD_NM_FRA
			              	     WHEN :vo.session_user_locale = 'de' THEN F.CD_NM_DEU
			              	     ELSE F.CD_NM_ENG
			                END CNT_TYPE3, A.COMP_CD,
							(CASE WHEN LEN(C.CNTRTPERIOD_STARTDAY)=8 AND C.CNTRTPERIOD_STARTDAY <> '00000000' THEN 
								CONVERT(CHAR(10), CONVERT(DATETIME, C.CNTRTPERIOD_STARTDAY, 112) , 23)
							ELSE '' END) CNTRTPERIOD_STARTDAY,
							(CASE WHEN LEN(C.CNTRTPERIOD_ENDDAY)=8 AND C.CNTRTPERIOD_ENDDAY <> '99999999' THEN
								CONVERT(CHAR(10), CONVERT(DATETIME, C.CNTRTPERIOD_ENDDAY, 112) , 23) 
							ELSE '' END) CNTRTPERIOD_ENDDAY,
							C.CNTRT_AMT, B.CNSD_STATUS, B.APBT_DT, 
							REQ_MAX.REQ_DT FIRST_REQ_DT, A.REQ_DT LAST_REQ_DT,
							ISNULL(CONVERT(CHAR(10), CONVERT(DATETIME, A.RE_DEMNDDAY, 112) , 23),'') AS RE_DEMNDDAY, /*YYYY-MM-DD*/
				      		ROW_NUMBER() OVER (ORDER BY REQ_MAX.REQ_DT DESC) AS RM,
				      		ISNULL(A.COMP_CD,'') COMP_NM, REQ_MAX.FIRST_ASGN_DT, REQ_MAX.LAST_ASGN_DT,
				      		C.CPY_REGDAY, C.ORG_ACPTDAY,
							CONVERT(DATETIME, LEFT( G.APPROVED ,8)+' '+	SUBSTRING( G.APPROVED ,9,2)+':'+
                  				SUBSTRING( G.APPROVED ,11,2)+':'+ RIGHT( G.APPROVED ,2) , 20) APPROVED,
                  			REQ_MAX.RESPMAN_ID,	C.CNTRT_OPPNT_NM,
            	 			CAST(COUNT(1) OVER() AS NUMERIC) TOTAL_CNT
            	 			
							FROM 
				      			 (SELECT FST_CNSDREQ_ID, MAX(CNSD_LEVEL) 
				      				AS LVL, MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT, MIN(ASGN_DT) FIRST_ASGN_DT, 
				      				MAX(ASGN_DT) LAST_ASGN_DT, MAX(RESPMAN_ID) RESPMAN_ID
				      				FROM TN_CLM_CONT_CNSDREQ SA
				      					LEFT OUTER JOIN
				      					TN_CLM_CONT_CNSDREQ_RESPMAN SB 
				      					ON SA.CNSDREQ_ID = SB.CNSDREQ_ID AND SA.MN_CNSD_DEPT = SB.RESP_DEPT
				      				 WHERE SA.DEL_YN = 'N' 
				      				 AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND SA.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
				                      		        WHEN SA.COMP_CD = :vo.session_comp_cd THEN 'Y' 
				                      			    ELSE 'N' END	 
				      				GROUP BY SA.FST_CNSDREQ_ID) REQ_MAX
				      			JOIN
				      			TN_CLM_CONT_CNSDREQ A ON A.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID AND A.CNSD_LEVEL = REQ_MAX.LVL
				      			JOIN
								TN_CLM_CONTRACT_CNSD B ON A.CNSDREQ_ID = B.CNSDREQ_ID
								JOIN 
								TN_CLM_CONTRACT_MASTER C ON B.CNTRT_ID = C.CNTRT_ID
								LEFT OUTER JOIN
								TN_COM_CONTRACTTYPE_CD D ON C.BIZ_CLSFCN = D.TYPE_CD
								LEFT OUTER JOIN
								TN_COM_CONTRACTTYPE_CD E ON C.DEPTH_CLSFCN = E.TYPE_CD
								LEFT OUTER JOIN
								TN_COM_CONTRACTTYPE_CD F ON C.CNCLSNPURPS_BIGCLSFCN = F.TYPE_CD
								LEFT OUTER JOIN
								(SELECT TOP 1 SA.REF_KEY, SB.APPROVED 
									FROM TB_COM_START_PROCESS_WSVO SA JOIN TB_COM_ROUTE_WSVO SB 
										ON SA.MODULE_ID = SB.MODULE_ID AND SA.MIS_ID = SB.MIS_ID
									WHERE SA.STATUS IN ('2','5','6') AND SB.ACTIVITY <> '0' ) G 
									ON CHARINDEX(C.CNTRT_ID, G.REF_KEY) > 0
								
								WHERE EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = A.COMP_CD)
								#if ($vo.srch_req_title && !$vo.srch_req_title.equals(""))
									AND A.REQ_TITLE LIKE '%' + :vo.srch_req_title + '%'	
                           		#end 
								
								#if ($vo.srch_requester && !$vo.srch_requester.equals(""))
									AND A.REQMAN_NM LIKE '%' + :vo.srch_requester + '%'	
                           		#end 
                           		
                           		#if ($vo.srch_reviewer && !$vo.srch_reviewer.equals(""))
									AND EXISTS(SELECT 'E' FROM TN_CLM_CONT_CNSDREQ_RESPMAN 
										WHERE CNSDREQ_ID = A.CNSDREQ_ID AND RESPMAN_NM LIKE '%' + :vo.srch_reviewer + '%')	
                           		#end
                           		
                           		#if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
                                  AND  A.REQ_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
                                #end
        
                                #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
                                  AND  A.REQ_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
                                #end	
                                
                                #if ($vo.srch_cntrt_oppnt_nm && !$vo.srch_cntrt_oppnt_nm.equals(""))
                                  AND  C.CNTRT_OPPNT_NM LIKE '%' + :vo.srch_cntrt_oppnt_nm + '%' 
                                #end	
                                
                                #if (($vo.srch_cntrtperiod_startday && !$vo.srch_cntrtperiod_startday.equals("")) ||
                                		($vo.srch_cntrtperiod_endday && !$vo.srch_cntrtperiod_endday.equals("")) )
                                  AND 	1=	(CASE WHEN C.CNTRTPERIOD_STARTDAY IS NOT NULL AND LEN(C.CNTRTPERIOD_STARTDAY)>0 AND
                                  				C.CNTRTPERIOD_ENDDAY IS NOT NULL AND LEN(C.CNTRTPERIOD_ENDDAY)>0 THEN 1 ELSE 0 END )
                                  AND			
                                  		
                                  	 	2=  (  
											CASE	WHEN :vo.srch_cntrtperiod_startday = '' THEN 1
													WHEN C.CNTRTPERIOD_STARTDAY = REPLACE( :vo.srch_cntrtperiod_startday,'-','') THEN 1
													WHEN C.CNTRTPERIOD_STARTDAY > REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 
														CASE WHEN :vo.srch_cntrtperiod_endday = '' THEN 1 
														WHEN C.CNTRTPERIOD_STARTDAY <= REPLACE( :vo.srch_cntrtperiod_endday ,'-','')  THEN 1
														ELSE 0 END
													WHEN C.CNTRTPERIOD_STARTDAY < REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 
														CASE WHEN C.CNTRTPERIOD_ENDDAY >= REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 1
														ELSE 0 END
											END
											+
											CASE	WHEN :vo.srch_cntrtperiod_endday = '' THEN 1
													WHEN C.CNTRTPERIOD_ENDDAY = REPLACE( :vo.srch_cntrtperiod_endday,'-','') THEN 1
													WHEN C.CNTRTPERIOD_ENDDAY > REPLACE( :vo.srch_cntrtperiod_endday,'-','')  THEN 
														CASE WHEN C.CNTRTPERIOD_STARTDAY <= REPLACE( :vo.srch_cntrtperiod_endday ,'-','')  THEN 1
														ELSE 0 END
													WHEN C.CNTRTPERIOD_ENDDAY < REPLACE( :vo.srch_cntrtperiod_endday,'-','')  THEN 
														CASE WHEN :vo.srch_cntrtperiod_startday = '' THEN 1
														WHEN C.CNTRTPERIOD_ENDDAY >= REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 1
														ELSE 0 END
											END
											) 
                                #end	 
											
						) TA 
						WHERE TA.RM BETWEEN :vo.start_index AND :vo.end_index
					) TTA
			      
			]]>
			</statement>
		</query>
        
        <!-- 구주 통계1 엑셀다운로드 : 계약-->
		<query id="las.statistics.guju_law1_excel.c" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT *, (CASE WHEN ORG_ACPTDAY IS NOT NULL THEN
		    				LT1 + LT2 + LT3 + LT4 + LT5 + LT6
            	 			/*DBO.COM_REQ_LT(FIRST_REQ_DT,ORG_ACPTDAY,COMP_CD)*/ 
            	 		  ELSE 0 END) LT7 /*최초의뢰~원본등록*/
		    	 FROM (
            	 SELECT TA.*, ISNULL((DBO.LAS_CONT_CNSDREQ_RESPMAN_M(TA.CNSDREQ_ID,',','xx')),'') AS CNSDMANS,
            	 		ISNULL((SELECT TOP 1 DEPT_NM_ENG FROM TB_COM_USER WHERE USER_ID = RESPMAN_ID ),'') CNSD_DEPT_NM,
            	 		(CASE WHEN FIRST_REQ_DT IS NOT NULL THEN REPLACE(CONVERT(CHAR(16), FIRST_REQ_DT, 120),' ','<BR>') ELSE '' END) AS FIRST_REQ_DT2, /*YYYY-MM-DD:최초의뢰일*/
            	 		(CASE WHEN RE_DT IS NOT NULL THEN REPLACE(CONVERT(CHAR(16), RE_DT, 120),' ','<BR>') ELSE '' END) AS RE_DT2, /*YYYY-MM-DD:회신일*/
            	 		CASE WHEN FIRST_ASGN_DT IS NOT NULL THEN 
            	 			DBO.COM_REQ_LT(FIRST_REQ_DT,FIRST_ASGN_DT,COMP_CD)
            	 		ELSE 0 END LT1, /*담당자배정*/
            	 		
            	 		CASE WHEN LAST_ASGN_DT IS NOT NULL AND RE_DT IS NOT NULL THEN 
            	 			DBO.COM_REQ_LT(LAST_ASGN_DT,RE_DT,COMP_CD) 
            	 		ELSE 0 END LT2, /*담당자배정후 회신*/
            	 			
            	 		CASE WHEN APBT_DT IS NOT NULL THEN 
            	 			DBO.COM_REQ_LT(LAST_REQ_DT,APBT_DT,COMP_CD) /*재의뢰후~최종회신*/
            	 		ELSE 0 END LT3,
            	 		
            	 		CASE WHEN APPROVED IS NOT NULL THEN
            	 			CASE WHEN LAST_ASGN_DT IS NULL THEN 0 
            	 			ELSE DBO.COM_REQ_LT(LAST_ASGN_DT,APPROVED,COMP_CD) END 
            	 		ELSE 0 END LT4, /*최종회신후 체결품의승인*/
            	 		 
            	 		CASE WHEN APPROVED IS NOT NULL AND CPY_REGDAY IS NOT NULL THEN
            	 			DBO.COM_REQ_LT(APPROVED,CPY_REGDAY,COMP_CD) 
            	 		ELSE 0 END LT5, /*체결품의승인~복사본업로드 */
            	 		
            	 		CASE WHEN CPY_REGDAY IS NOT NULL AND ORG_ACPTDAY IS NOT NULL THEN
            	 			DBO.COM_REQ_LT(CPY_REGDAY,ORG_ACPTDAY,COMP_CD) 
            	 		ELSE 0 END LT6 /*복사본업로드~원본등록*/
            	 		
					FROM
						(
				      	SELECT A.CNSDREQ_ID, A.REQ_TITLE, A.REQMAN_NM, A.MN_CNSD_DEPT,A.RE_DT, 'Contract' CNT_TYPE0, 
							CASE WHEN :vo.session_user_locale = 'ko' THEN D.CD_NM
			              	     WHEN :vo.session_user_locale = 'fr' THEN D.CD_NM_FRA
			              	     WHEN :vo.session_user_locale = 'de' THEN D.CD_NM_DEU
			              	     ELSE D.CD_NM_ENG
			                END CNT_TYPE1	, 
			                CASE WHEN :vo.session_user_locale = 'ko' THEN E.CD_NM
			              	     WHEN :vo.session_user_locale = 'fr' THEN E.CD_NM_FRA
			              	     WHEN :vo.session_user_locale = 'de' THEN E.CD_NM_DEU
			              	     ELSE E.CD_NM_ENG
			                END CNT_TYPE2, 
			                CASE WHEN :vo.session_user_locale = 'ko' THEN F.CD_NM
			              	     WHEN :vo.session_user_locale = 'fr' THEN F.CD_NM_FRA
			              	     WHEN :vo.session_user_locale = 'de' THEN F.CD_NM_DEU
			              	     ELSE F.CD_NM_ENG
			                END CNT_TYPE3, A.COMP_CD,
							(CASE WHEN LEN(C.CNTRTPERIOD_STARTDAY)=8 AND C.CNTRTPERIOD_STARTDAY <> '00000000' THEN 
								CONVERT(CHAR(10), CONVERT(DATETIME, C.CNTRTPERIOD_STARTDAY, 112) , 23)
							ELSE '' END) CNTRTPERIOD_STARTDAY,
							(CASE WHEN LEN(C.CNTRTPERIOD_ENDDAY)=8 AND C.CNTRTPERIOD_ENDDAY <> '99999999' THEN
								CONVERT(CHAR(10), CONVERT(DATETIME, C.CNTRTPERIOD_ENDDAY, 112) , 23) 
							ELSE '' END) CNTRTPERIOD_ENDDAY,
							C.CNTRT_AMT, B.CNSD_STATUS, B.APBT_DT, 
							REQ_MAX.REQ_DT FIRST_REQ_DT, A.REQ_DT LAST_REQ_DT,
							ISNULL(CONVERT(CHAR(10), CONVERT(DATETIME, A.RE_DEMNDDAY, 112) , 23),'') AS RE_DEMNDDAY, /*YYYY-MM-DD*/
				      		ROW_NUMBER() OVER (ORDER BY REQ_MAX.REQ_DT DESC) AS RM,
				      		ISNULL(A.COMP_CD,'') COMP_NM, REQ_MAX.FIRST_ASGN_DT, REQ_MAX.LAST_ASGN_DT,
				      		C.CPY_REGDAY, C.ORG_ACPTDAY, 
				      		CONVERT(DATETIME, LEFT( G.APPROVED ,8)+' '+	SUBSTRING( G.APPROVED ,9,2)+':'+
                  				SUBSTRING( G.APPROVED ,11,2)+':'+ RIGHT( G.APPROVED ,2) , 20) APPROVED,
                  			REQ_MAX.RESPMAN_ID,	C.CNTRT_OPPNT_NM,
            	 			CAST(COUNT(1) OVER() AS NUMERIC) TOTAL_CNT
            	 			
							FROM 
				      			 (SELECT FST_CNSDREQ_ID, MAX(CNSD_LEVEL) 
				      				AS LVL, MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT, MIN(ASGN_DT) FIRST_ASGN_DT, 
				      				MAX(ASGN_DT) LAST_ASGN_DT, MAX(RESPMAN_ID) RESPMAN_ID
				      				FROM TN_CLM_CONT_CNSDREQ SA
				      					LEFT OUTER JOIN
				      					TN_CLM_CONT_CNSDREQ_RESPMAN SB 
				      					ON SA.CNSDREQ_ID = SB.CNSDREQ_ID AND SA.MN_CNSD_DEPT = SB.RESP_DEPT
				      				 WHERE SA.DEL_YN = 'N' 
				      				 AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND SA.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
				                      		        WHEN SA.COMP_CD = :vo.session_comp_cd THEN 'Y' 
				                      			    ELSE 'N' END
				      				GROUP BY SA.FST_CNSDREQ_ID) REQ_MAX
				      			JOIN
				      			TN_CLM_CONT_CNSDREQ A ON A.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID AND A.CNSD_LEVEL = REQ_MAX.LVL
				      			JOIN
								TN_CLM_CONTRACT_CNSD B ON A.CNSDREQ_ID = B.CNSDREQ_ID
								JOIN 
								TN_CLM_CONTRACT_MASTER C ON B.CNTRT_ID = C.CNTRT_ID
								LEFT OUTER JOIN
								TN_COM_CONTRACTTYPE_CD D ON C.BIZ_CLSFCN = D.TYPE_CD
								LEFT OUTER JOIN
								TN_COM_CONTRACTTYPE_CD E ON C.DEPTH_CLSFCN = E.TYPE_CD
								LEFT OUTER JOIN
								TN_COM_CONTRACTTYPE_CD F ON C.CNCLSNPURPS_BIGCLSFCN = F.TYPE_CD
								LEFT OUTER JOIN
								(SELECT TOP 1 SA.REF_KEY, SB.APPROVED 
									FROM TB_COM_START_PROCESS_WSVO SA JOIN TB_COM_ROUTE_WSVO SB 
										ON SA.MODULE_ID = SB.MODULE_ID AND SA.MIS_ID = SB.MIS_ID
									WHERE SA.STATUS IN ('2','5','6') AND SB.ACTIVITY <> '0' ) G 
									ON CHARINDEX(C.CNTRT_ID, G.REF_KEY) > 0
								
								WHERE EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = A.COMP_CD)
								#if ($vo.srch_req_title && !$vo.srch_req_title.equals(""))
									AND A.REQ_TITLE LIKE '%' + :vo.srch_req_title + '%'	
                           		#end 
								
								#if ($vo.srch_requester && !$vo.srch_requester.equals(""))
									AND A.REQMAN_NM LIKE '%' + :vo.srch_requester + '%'	
                           		#end 
                           		
                           		#if ($vo.srch_reviewer && !$vo.srch_reviewer.equals(""))
									AND EXISTS(SELECT 'E' FROM TN_CLM_CONT_CNSDREQ_RESPMAN 
										WHERE CNSDREQ_ID = A.CNSDREQ_ID AND RESPMAN_NM LIKE '%' + :vo.srch_reviewer + '%')	
                           		#end 		
                           		
                           		#if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
                                  AND  A.REQ_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
                                #end
        
                                #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
                                  AND  A.REQ_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
                                #end	
                                
                                #if ($vo.srch_cntrt_oppnt_nm && !$vo.srch_cntrt_oppnt_nm.equals(""))
                                  AND  C.CNTRT_OPPNT_NM LIKE '%' + :vo.srch_cntrt_oppnt_nm + '%' 
                                #end	
                                
                                #if (($vo.srch_cntrtperiod_startday && !$vo.srch_cntrtperiod_startday.equals("")) ||
                                		($vo.srch_cntrtperiod_endday && !$vo.srch_cntrtperiod_endday.equals("")) )
                                  AND 	1=	(CASE WHEN C.CNTRTPERIOD_STARTDAY IS NOT NULL AND LEN(C.CNTRTPERIOD_STARTDAY)>0 AND
                                  				C.CNTRTPERIOD_ENDDAY IS NOT NULL AND LEN(C.CNTRTPERIOD_ENDDAY)>0 THEN 1 ELSE 0 END )
                                  AND			
                                  		
                                  	 	2=  (  
											CASE	WHEN :vo.srch_cntrtperiod_startday = '' THEN 1
													WHEN C.CNTRTPERIOD_STARTDAY = REPLACE( :vo.srch_cntrtperiod_startday,'-','') THEN 1
													WHEN C.CNTRTPERIOD_STARTDAY > REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 
														CASE WHEN :vo.srch_cntrtperiod_endday = '' THEN 1 
														WHEN C.CNTRTPERIOD_STARTDAY <= REPLACE( :vo.srch_cntrtperiod_endday ,'-','')  THEN 1
														ELSE 0 END
													WHEN C.CNTRTPERIOD_STARTDAY < REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 
														CASE WHEN C.CNTRTPERIOD_ENDDAY >= REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 1
														ELSE 0 END
											END
											+
											CASE	WHEN :vo.srch_cntrtperiod_endday = '' THEN 1
													WHEN C.CNTRTPERIOD_ENDDAY = REPLACE( :vo.srch_cntrtperiod_endday,'-','') THEN 1
													WHEN C.CNTRTPERIOD_ENDDAY > REPLACE( :vo.srch_cntrtperiod_endday,'-','')  THEN 
														CASE WHEN C.CNTRTPERIOD_STARTDAY <= REPLACE( :vo.srch_cntrtperiod_endday ,'-','')  THEN 1
														ELSE 0 END
													WHEN C.CNTRTPERIOD_ENDDAY < REPLACE( :vo.srch_cntrtperiod_endday,'-','')  THEN 
														CASE WHEN :vo.srch_cntrtperiod_startday = '' THEN 1
														WHEN C.CNTRTPERIOD_ENDDAY >= REPLACE( :vo.srch_cntrtperiod_startday,'-','')  THEN 1
														ELSE 0 END
											END
											)  
                                #end	 
											
						) TA 
					 ) TTA
			      
			]]>
			</statement>
		</query>
		
		<!-- 구주 통계1 : 자문-->
		<query id="las.statistics.guju_law1.l" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT *,	(SELECT
								REPLACE(
										STUFF((	
											SELECT ', ' + CNSLT_TYPENM 
											FROM TN_LAS_CONSULT_TYPE A 
											WHERE CNSLT_NO = TA.CNSLT_NO AND HSTRY_NO = TA.HSTRY_NO
											FOR XML PATH('')
										), 1, 2, '') 
										,',',',') 
							) CNT_TYPE1,
		    	
		    				CASE WHEN RE_DT IS NOT NULL THEN
								LT1 + LT2 + LT3
							ELSE 0 END LT7
		    		FROM (
	            	 SELECT TLC.TITLE AS REQ_TITLE, ISNULL(TLC.REG_NM,'') AS REQMAN_NM, ISNULL(TLC.CNSDMAN_NM,'') CNSDMAN_NM,
							ISNULL(DBO.LAS_CONSULT_RESPMAN(TLC.CNSLT_NO,','),'') AS CNSDMANS,
							ISNULL(RESP.DEPT_NM_ENG,'') CNSD_DEPT_NM, TLC.COMP_CD COMP_NM, 
							'-' CNT_TYPE2, '-' CNT_TYPE3, 0 CNTRT_AMT,
							CONVERT(CHAR(10), MIN_TLC.MIN_REG_DT, 23) AS FIRST_REQ_DT2, /*YYYY-MM-DD:최초의뢰일*/
							RESP.F_RESP_REG_DT,TLC.RE_DT,
							CASE WHEN RESP.F_RESP_REG_DT IS NOT NULL THEN
								DBO.COM_REQ_LT(MIN_TLC.MIN_REG_DT,RESP.F_RESP_REG_DT,TLC.COMP_CD) 
							ELSE 0 END LT1,
							CASE WHEN TLC.RE_DT IS NOT NULL THEN
								DBO.COM_REQ_LT(MIN_TLC.MIN_REG_DT,TLC.RE_DT,TLC.COMP_CD)
							ELSE 0 END LT2,
							CASE WHEN TLC.RE_DT IS NOT NULL THEN
								DBO.COM_REQ_LT(TLC.REG_DT,TLC.RE_DT,TLC.COMP_CD) 
							ELSE 0 END LT3, 
							'-' LT4, '-' LT5, '-' LT6, TLC.CNSLT_NO, TLC.HSTRY_NO,
							ROW_NUMBER() OVER (ORDER BY TLC.REG_DT DESC) AS RM,
							CAST(COUNT(1) OVER() AS NUMERIC) TOTAL_CNT
						FROM TN_LAS_CONSULT TLC
							
							JOIN
							TB_COM_CD TCC ON TLC.EXTNL_PRGRS_STATUS = TCC.CD
						    
							JOIN
							(SELECT MAX(HSTRY_NO) MAX_HSTRY_NO, CNSLT_NO
						        FROM TN_LAS_CONSULT
						        WHERE DEL_YN = 'N'
						        AND INTNL_PRGRS_STATUS NOT IN ('S09','S11')
						        GROUP BY CNSLT_NO) MAX_TLC 
								ON TLC.CNSLT_NO = MAX_TLC.CNSLT_NO AND TLC.HSTRY_NO = MAX_TLC.MAX_HSTRY_NO
							
							JOIN
							(SELECT MIN(REG_DT) MIN_REG_DT, CNSLT_NO
						        FROM TN_LAS_CONSULT
						        WHERE DEL_YN = 'N'
						        GROUP BY CNSLT_NO) MIN_TLC
								ON TLC.CNSLT_NO = MIN_TLC.CNSLT_NO
							
							LEFT OUTER JOIN
							(SELECT CNSLT_NO, MAX(SB.DEPT_NM_ENG) DEPT_NM_ENG,
								MIN(SA.REG_DT) F_RESP_REG_DT
								FROM TN_LAS_CONSULT_RESPMAN SA
								,TB_COM_USER SB
								WHERE SA.RESPMAN_ID = SB.USER_ID  
								GROUP BY CNSLT_NO
								) RESP ON TLC.CNSLT_NO = RESP.CNSLT_NO
							LEFT OUTER JOIN
							(SELECT * FROM TB_COM_CD WHERE GRP_CD='N1_E' )S03 ON TLC.EXTNL_PRGRS_STATUS = S03.CD
						WHERE TLC.DEL_YN   = 'N'
						AND TLC.PUB_YN   = 'Y'
						AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TLC.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
	                      		       WHEN TLC.COMP_CD = :vo.session_comp_cd THEN 'Y' 
	                      			   ELSE 'N' END	 
						AND TCC.GRP_CD   = 'N1_E'
						AND EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = TLC.COMP_CD)			
						#if ($vo.srch_req_title && !$vo.srch_req_title.equals(""))
							AND TLC.TITLE LIKE '%' + :vo.srch_req_title + '%'	
	                    #end 
						
						#if ($vo.srch_requester && !$vo.srch_requester.equals(""))
							AND TLC.REG_NM LIKE '%' + :vo.srch_requester + '%'	
	                    #end 
	                        		
	                    #if ($vo.srch_reviewer && !$vo.srch_reviewer.equals(""))
							AND EXISTS(SELECT 'E' FROM TN_LAS_CONSULT_RESPMAN 
								WHERE CNSLT_NO = TLC.CNSLT_NO AND RESPMAN_NM LIKE '%' + :vo.srch_reviewer + '%')	
	                    #end
	                    
	                    #if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
                          AND  TLC.REG_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
                        #end

                        #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
                          AND  TLC.REG_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
                        #end 			 
											
					) TA 
					WHERE TA.RM BETWEEN :vo.start_index AND :vo.end_index
			      
			]]>
			</statement>
		</query>
		
		
		<!-- 구주 통계1 엑셀 : 자문-->
		<query id="las.statistics.guju_law1_excel.l" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT *,	(SELECT
								REPLACE(
										STUFF((	
											SELECT ', ' + CNSLT_TYPENM 
											FROM TN_LAS_CONSULT_TYPE A 
											WHERE CNSLT_NO = TA.CNSLT_NO AND HSTRY_NO = TA.HSTRY_NO
											FOR XML PATH('')
										), 1, 2, '') 
										,',',',') 
							) CNT_TYPE1,
		    	
		    				CASE WHEN RE_DT IS NOT NULL THEN
								LT1 + LT2 + LT3
							ELSE 0 END LT7
		    		FROM (
	            	 SELECT TLC.TITLE AS REQ_TITLE, ISNULL(TLC.REG_NM,'') AS REQMAN_NM, ISNULL(TLC.CNSDMAN_NM,'') CNSDMAN_NM,
							ISNULL(DBO.LAS_CONSULT_RESPMAN(TLC.CNSLT_NO,','),'') AS CNSDMANS,
							ISNULL(RESP.DEPT_NM_ENG,'') CNSD_DEPT_NM, TLC.COMP_CD COMP_NM, 
							'-' CNT_TYPE2, '-' CNT_TYPE3, 0 CNTRT_AMT,
							CONVERT(CHAR(10), MIN_TLC.MIN_REG_DT, 23) AS FIRST_REQ_DT2, /*YYYY-MM-DD:최초의뢰일*/
							RESP.F_RESP_REG_DT,TLC.RE_DT,
							CASE WHEN RESP.F_RESP_REG_DT IS NOT NULL THEN
								DBO.COM_REQ_LT(MIN_TLC.MIN_REG_DT,RESP.F_RESP_REG_DT,TLC.COMP_CD) 
							ELSE 0 END LT1,
							CASE WHEN TLC.RE_DT IS NOT NULL THEN
								DBO.COM_REQ_LT(MIN_TLC.MIN_REG_DT,TLC.RE_DT,TLC.COMP_CD)
							ELSE 0 END LT2,
							CASE WHEN TLC.RE_DT IS NOT NULL THEN
								DBO.COM_REQ_LT(TLC.REG_DT,TLC.RE_DT,TLC.COMP_CD) 
							ELSE 0 END LT3, 
							'-' LT4, '-' LT5, '-' LT6, TLC.CNSLT_NO, TLC.HSTRY_NO,
							ROW_NUMBER() OVER (ORDER BY TLC.REG_DT DESC) AS RM,
							CAST(COUNT(1) OVER() AS NUMERIC) TOTAL_CNT
						FROM TN_LAS_CONSULT TLC
							
							JOIN
							TB_COM_CD TCC ON TLC.EXTNL_PRGRS_STATUS = TCC.CD
						    
							JOIN
							(SELECT MAX(HSTRY_NO) MAX_HSTRY_NO, CNSLT_NO
						        FROM TN_LAS_CONSULT
						        WHERE DEL_YN = 'N'
						        AND INTNL_PRGRS_STATUS NOT IN ('S09','S11')
						        GROUP BY CNSLT_NO) MAX_TLC 
								ON TLC.CNSLT_NO = MAX_TLC.CNSLT_NO AND TLC.HSTRY_NO = MAX_TLC.MAX_HSTRY_NO
							
							JOIN
							(SELECT MIN(REG_DT) MIN_REG_DT, CNSLT_NO
						        FROM TN_LAS_CONSULT
						        WHERE DEL_YN = 'N'
						        GROUP BY CNSLT_NO) MIN_TLC
								ON TLC.CNSLT_NO = MIN_TLC.CNSLT_NO
							
							LEFT OUTER JOIN
							(SELECT CNSLT_NO, MAX(SB.DEPT_NM_ENG) DEPT_NM_ENG,
								MIN(SA.REG_DT) F_RESP_REG_DT
								FROM TN_LAS_CONSULT_RESPMAN SA
								,TB_COM_USER SB
								WHERE SA.RESPMAN_ID = SB.USER_ID  
								GROUP BY CNSLT_NO
								) RESP ON TLC.CNSLT_NO = RESP.CNSLT_NO
							LEFT OUTER JOIN
							(SELECT * FROM TB_COM_CD WHERE GRP_CD='N1_E' )S03 ON TLC.EXTNL_PRGRS_STATUS = S03.CD
						WHERE TLC.DEL_YN   = 'N'
						AND TLC.PUB_YN   = 'Y'
						AND 'Y' = CASE WHEN :vo.session_comp_cd = 'EHQ' AND TLC.COMP_CD IN ('EHQ','SEUK') THEN 'Y' 
	                      		       WHEN TLC.COMP_CD = :vo.session_comp_cd THEN 'Y' 
	                      			   ELSE 'N' END
						AND TCC.GRP_CD   = 'N1_E'
						AND EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = TLC.COMP_CD)
						AND EXISTS (SELECT * FROM TN_LAS_CONSULT_TYPE TLCT WHERE TLC.CNSLT_NO = TLCT.CNSLT_NO AND TLC.HSTRY_NO = TLCT.HSTRY_NO AND TLCT.CNSLT_TYPE NOT IN ('A20'))			
						#if ($vo.srch_req_title && !$vo.srch_req_title.equals(""))
							AND TLC.TITLE LIKE '%' + :vo.srch_req_title + '%'	
	                    #end 
						
						#if ($vo.srch_requester && !$vo.srch_requester.equals(""))
							AND TLC.REG_NM LIKE '%' + :vo.srch_requester + '%'	
	                    #end 
	                        		
	                    #if ($vo.srch_reviewer && !$vo.srch_reviewer.equals(""))
							AND EXISTS(SELECT 'E' FROM TN_LAS_CONSULT_RESPMAN 
								WHERE CNSLT_NO = TLC.CNSLT_NO AND RESPMAN_NM LIKE '%' + :vo.srch_reviewer + '%')	
	                    #end 	
	                    
	                    #if ($vo.srch_start_dt && !$vo.srch_start_dt.equals(""))
                          AND  TLC.REG_DT >= CONVERT(DATETIME, REPLACE( :vo.srch_start_dt ,'-',''), 112)
                        #end

                        #if ($vo.srch_end_dt && !$vo.srch_end_dt.equals(""))
                          AND  TLC.REG_DT <= CONVERT(DATETIME, REPLACE( :vo.srch_end_dt ,'-',''), 112)+1
                        #end		 
											
					) TA 
				  
			]]>
			</statement>
		</query>
		
		<!-- 구주 기존통계 화면 : 계약-->
		<query id="las.statistics.contlegaladvice.c" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT COMP.CD_NM_ENG COMP_NM , COMP.CD COMP_CD, ISNULL(TOTAL,0) TOTAL, ISNULL(PENDING,0) PENDING, ISNULL(REPLIED,0) REPLIED, 
		    		ISNULL(REREQUEST,0) REREQUEST, ISNULL(HOLDING,0) HOLDING, ISNULL(EXECUTED,0) EXECUTED,
					ISNULL(RETURNED,0) RETURNED, 
					ISNULL(DNP,0) DNP, 
					ISNULL([LEFT BUSINESS],0) [LEFT BUSINESS], 
					ISNULL([Holding(New)],0) [Holding(New)], 
					ISNULL([Pending(Approval)],0) [Pending(Approval)], 
					ISNULL([Holding(Reply)],0) [Holding(Reply)], 
					ISNULL([Approval],0) [Approval], 
					ISNULL([Processing],0) [Processing], 
					ISNULL([Approval Completed],0) [Approval Completed], 
					ISNULL([Approval Rejected],0) [Approval Rejected], 
					ISNULL([Withdrawn],0) [Withdrawn], 
					ISNULL([ETC_TOTAL],0) [ETC_TOTAL] 
				FROM 
					(SELECT * FROM TB_COM_CD WHERE GRP_CD='COMP2') COMP
					LEFT OUTER JOIN	
				    ( SELECT SA.COMP_CD, 
						CAST(ISNULL(SUM(PENDING+REPLIED+REREQUEST+HOLDING+EXECUTED+RETURNED+DNP+[LEFT BUSINESS]+[Holding(New)]+
								[Pending(Approval)]+[Holding(Reply)]+[Approval]+[Processing]+[Approval Completed]+[Approval Rejected]+
								[Withdrawn]
								),0) AS NUMERIC) TOTAL,
						CAST(ISNULL(SUM(
								[Pending(Approval)]+[Holding(Reply)]+[Approval]+[Processing]+[Approval Completed]+[Approval Rejected]+
								[Withdrawn]
								),0) AS NUMERIC) ETC_TOTAL,		
						SUM(PENDING) PENDING,
						SUM(REPLIED) REPLIED, SUM(REREQUEST) REREQUEST, SUM(HOLDING) HOLDING,
						SUM(EXECUTED) EXECUTED,
						SUM(RETURNED) RETURNED,
						SUM(DNP) DNP,
						SUM([LEFT BUSINESS]) [LEFT BUSINESS],
						SUM([Holding(New)]) [Holding(New)],
						SUM([Pending(Approval)]) [Pending(Approval)],
						SUM([Holding(Reply)]) [Holding(Reply)],
						SUM([Approval]) [Approval],
						SUM([Processing]) [Processing],
						SUM([Approval Completed]) [Approval Completed],
						SUM([Approval Rejected]) [Approval Rejected],
						SUM([Withdrawn]) [Withdrawn]

						FROM (
							SELECT 
				            A.COMP_CD,
							ISNULL(CASE WHEN C.SELMS_STATE='S02' THEN 1 ELSE 0 END,0) AS PENDING, /*Pending*/	
							ISNULL(CASE WHEN C.SELMS_STATE='S03' THEN 1 ELSE 0 END,0) AS REPLIED, /*회신*/	 			
							ISNULL(CASE WHEN C.SELMS_STATE='S04' THEN 1 ELSE 0 END,0) AS REREQUEST, /*재의뢰*/
							ISNULL(CASE WHEN C.SELMS_STATE='S05' THEN 1 ELSE 0 END,0) AS HOLDING, /*보류:S05*/
							ISNULL(CASE WHEN C.SELMS_STATE='S06' THEN 1 ELSE 0 END,0) AS EXECUTED, /*계약완료*/
							ISNULL(CASE WHEN C.SELMS_STATE='S07' THEN 1 ELSE 0 END,0) AS RETURNED, /*반려*/
							ISNULL(CASE WHEN C.SELMS_STATE='S19' THEN 1 ELSE 0 END,0) AS DNP, /*DNP : Do Not Proceed*/

							ISNULL(CASE WHEN C.SELMS_STATE='S20' THEN 1 ELSE 0 END,0) AS [LEFT BUSINESS], /*LEFT BUSINESS*/
							ISNULL(CASE WHEN C.SELMS_STATE='S01' THEN 1 ELSE 0 END,0) AS [Holding(New)], /*Holding(New)*/
							ISNULL(CASE WHEN C.SELMS_STATE='S08' THEN 1 ELSE 0 END,0) AS [Pending(Approval)],
							ISNULL(CASE WHEN C.SELMS_STATE='S09' THEN 1 ELSE 0 END,0) AS [Holding(Reply)],
							ISNULL(CASE WHEN C.SELMS_STATE='S13' THEN 1 ELSE 0 END,0) AS [Approval], /*내부품의 (의뢰인)*/
							ISNULL(CASE WHEN C.SELMS_STATE='S14' THEN 1 ELSE 0 END,0) AS [Processing],
							ISNULL(CASE WHEN C.SELMS_STATE='S15' THEN 1 ELSE 0 END,0) AS [Approval Completed],
							ISNULL(CASE WHEN C.SELMS_STATE='S16' THEN 1 ELSE 0 END,0) AS [Approval Rejected],
							ISNULL(CASE WHEN C.SELMS_STATE='S17' THEN 1 ELSE 0 END,0) AS [Withdrawn]

							FROM 
								(SELECT FST_CNSDREQ_ID, MAX(CNSD_LEVEL) 
								AS LVL, MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT, MIN(ASGN_DT) FIRST_ASGN_DT, 
								MAX(ASGN_DT) LAST_ASGN_DT, MAX(RESPMAN_ID) RESPMAN_ID, MAX(SA.COMP_CD) COMP_CD
								FROM TN_CLM_CONT_CNSDREQ SA
								    LEFT OUTER JOIN
								    TN_CLM_CONT_CNSDREQ_RESPMAN SB 
								    ON SA.CNSDREQ_ID = SB.CNSDREQ_ID AND SA.MN_CNSD_DEPT = SB.RESP_DEPT
								    WHERE SA.DEL_YN = 'N'
								GROUP BY SA.FST_CNSDREQ_ID) REQ_MAX  
								JOIN
								TN_CLM_CONT_CNSDREQ A ON A.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID AND A.CNSD_LEVEL = REQ_MAX.LVL
								JOIN
								TN_CLM_CONTRACT_CNSD B ON A.CNSDREQ_ID = B.CNSDREQ_ID
								JOIN 
								(SELECT * FROM TN_CLM_CONTRACT_MASTER WHERE PRCS_DEPTH = 'C02506') C ON B.CNTRT_ID = C.CNTRT_ID
								LEFT OUTER JOIN
								TN_CLM_CONTRACT_DEPTCNSD DEPTCNSD ON A.CNSDREQ_ID = DEPTCNSD.CNSDREQ_ID AND B.CNTRT_ID = DEPTCNSD.CNTRT_ID
								LEFT OUTER JOIN
								(
								SELECT  AUTHREQ.CNTRT_ID
								FROM	 TN_CLM_CONTRACT_AUTHREQ AUTHREQ
								WHERE 	
								 		AUTHREQ.DEL_YN = 'N'
								AND 	AUTHREQ.DEMND_GBN = 'C04601'
								AND 	AUTHREQ.DEMND_STATUS = 'C03702'
								AND 'SY' = CASE WHEN :vo.elUserlYn ='N' THEN
												CASE WHEN :vo.session_auth_apnt_yn <> 'Y' THEN
													CASE WHEN AUTHREQ.TRGTMAN_ID = :vo.session_user_id	THEN 'SY' ELSE 'SN' END
												ELSE 'SY' END
											ELSE 'SY' END /*SKIP 처리시 ELSE부분의 결과값은 AND 조건에 있을때는 SY로 한다.*/	
								GROUP BY AUTHREQ.CNTRT_ID								
								) AUTHREQ ON C.CNTRT_ID  = AUTHREQ.CNTRT_ID
								LEFT OUTER JOIN
								(
								SELECT  AUTHREQ.CNTRT_ID
								FROM	 TN_CLM_CONTRACT_AUTHREQ AUTHREQ
								WHERE 	
								 		AUTHREQ.DEL_YN = 'N'
								AND 	AUTHREQ.DEMND_GBN = 'C04601'
								AND 	AUTHREQ.DEMND_STATUS = 'C03702'
								AND 'SY' = CASE WHEN :vo.session_auth_apnt_yn <> 'Y' THEN
												CASE WHEN AUTHREQ.TRGTMAN_ID = :vo.session_user_id	THEN 'SY' ELSE 'SN' END
											ELSE 'SY' END
								GROUP BY AUTHREQ.CNTRT_ID ) AUTHREQ2 ON C.CNTRT_ID  = AUTHREQ2.CNTRT_ID
								LEFT OUTER JOIN
								(SELECT * FROM TN_CLM_CONT_CNSDREQ_RESPMAN WHERE :vo.top_role  = 'B' AND RESPMAN_ID = :vo.session_user_id ) RESPMAN ON A.CNSDREQ_ID = RESPMAN.CNSDREQ_ID
								WHERE (C.CNTRT_INFO_GBN IN ('C05401', 'C05402', 'C05403')
										OR (C.CNTRT_INFO_GBN IN ('C05404')
											AND c.PRCS_DEPTH IN ('C02504', 'C02505')))
									AND 
									'Y' = CASE WHEN :vo.top_role 	<> 'A' THEN 	
											CASE WHEN :vo.top_role  = 'B' THEN 	
												/*변호사 : DF(1st)제외시키지만, 본인이 의뢰한 건이면 조회가능*/
												CASE WHEN REQ_MAX.LVL = 1 AND c.DEPTH_STATUS ='C02601' THEN 
														CASE WHEN A.REQMAN_ID = :vo.session_user_id THEN 'Y' ELSE 'N' END
													/*변호사 : 본인에게 의뢰된건만 조회*/
													WHEN RESPMAN.RESPMAN_ID = :vo.session_user_id AND (A.MN_CNSD_DEPT = :vo.session_blngt_orgnz OR A.VC_CNSD_DEPT = :vo.session_blngt_orgnz) THEN 'Y'
												ELSE 'N' END
											ELSE /*SQL003 M*/
												CASE WHEN :vo.top_role  <> 'C' AND ( :vo.session_manager_yn <> 'Y' OR :vo.session_support_yn <>'Y')  THEN	/*SQL001 S*/
													CASE WHEN :vo.elUserlYn ='N' THEN /*SQL002 S*/
														/*기존 AND조건의 쿼리부분 START*/
														CASE WHEN AUTHREQ.CNTRT_ID IS NOT NULL
																OR 'SY' = CASE WHEN :vo.session_auth_apnt_yn <> 'Y' THEN
																			CASE WHEN A.REQMAN_ID = :vo.session_user_id THEN 'SY' ELSE 'SN' END
																		  ELSE 'SN' END
																OR 'SY' = CASE WHEN :vo.session_auth_apnt_yn <> 'Y' THEN
																			CASE WHEN c.CNTRT_RESPMAN_ID = :vo.session_user_id THEN 'SY' ELSE 'SN' END
																		  ELSE 'SN' END
																OR 'SY' = CASE WHEN :vo.session_manager_yn = 'Y' THEN
																			CASE WHEN A.REQ_UP_DEPT LIKE '%' + :vo.session_dept_cd + '^%' THEN 'SY' ELSE 'SN' END
																		ELSE 'SN' END /*SKIP 처리시 ELSE부분의 결과값은 OR 조건에 있을때는 SN로 한다.*/	
																OR 'SY' = CASE WHEN :vo.session_auth_apnt_yn= 'Y' THEN
																			CASE WHEN CHARINDEX (''''+A.COMP_CD+'''', :vo.session_auth_comp_cd) > 0 THEN 'SY' ELSE 'SN' END
																		ELSE 'SN' END /*SKIP 처리시 ELSE부분의 결과값은 OR 조건에 있을때는 SN로 한다.*/
																
														THEN 'Y' ELSE 'N' END
														/*기존 AND조건의 쿼리부분 END*/
													ELSE 'Y' END/*SQL002 E*/

												ELSE /*SQL001 M*/
													CASE WHEN :vo.top_role  = 'C' OR (:vo.session_manager_yn='Y' AND :vo.session_support_yn='Y')  THEN	/*SQL005 S*/
														CASE WHEN	AUTHREQ2.CNTRT_ID IS NOT NULL
																	OR 'SY' = CASE WHEN :vo.session_auth_comp_cd <> '' THEN 
																				CASE WHEN CHARINDEX (''''+c.COMP_CD+'''', :vo.session_auth_comp_cd) > 0 THEN 'SY' ELSE 'SN' END
																				ELSE 'SN' END
																			  
																	OR 'SY' = CASE WHEN :vo.session_auth_apnt_yn = 'Y' THEN
																				CASE WHEN CHARINDEX (''''+A.COMP_CD+'''', :vo.session_auth_comp_cd) > 0 THEN 'SY' ELSE 'SN' END
																				ELSE 'SN' END
																				 
																	THEN 'Y' 
														ELSE 'N' END

													ELSE 'Y' END
													
												END
											END
												
										ELSE
									
											CASE WHEN LVL = 1 AND DEPTH_STATUS ='C02601' THEN 
												CASE WHEN A.REQMAN_ID = :vo.session_user_id THEN 'Y' ELSE 'N' END
											ELSE 
												CASE WHEN CHARINDEX( ''''+A.COMP_CD+'''', :vo.session_auth_comp_cd ) > 0 THEN 'Y' ELSE 'N' END
											END 
										END
								) SA
							WHERE EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = SA.COMP_CD)
							GROUP BY COMP_CD
				  ) TA ON COMP.CD = TA.COMP_CD
				  ORDER BY COMP.CD ASC
			]]>
			</statement>
		</query>
		
		
		<!-- 구주 기존통계 화면 : 자문-->
		<query id="las.statistics.contlegaladvice.l" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT COMP.CD COMP_CD,
					CAST(ISNULL(SUM(PENDING+REPLIED+REREQUEST+HOLDING+EXECUTED+RETURNED+[Pending(Approval)]+[Holding(Reply)]+
						[Approval]+[Processing]+[Approval Completed]+[Approval Rejected]+[Withdrawn]),0) AS NUMERIC) TOTAL,
					ISNULL(SUM(PENDING),0) PENDING, ISNULL(SUM(PENDING),0) PENDING,ISNULL(SUM(REPLIED),0) REPLIED, 
					ISNULL(SUM(REREQUEST),0) REREQUEST, ISNULL(SUM(HOLDING),0) HOLDING,
					ISNULL(SUM(EXECUTED),0) EXECUTED,
					ISNULL(SUM(RETURNED),0) RETURNED,
					ISNULL(SUM([Pending(Approval)]),0) [Pending(Approval)],
					ISNULL(SUM([Holding(Reply)]),0) [Holding(Reply)],
					ISNULL(SUM([Approval]),0) [Approval],
					ISNULL(SUM([Processing]),0) [Processing],
					ISNULL(SUM([Approval Completed]),0) [Approval Completed],
					ISNULL(SUM([Approval Rejected]),0) [Approval Rejected],
					ISNULL(SUM([Withdrawn]),0) [Withdrawn],
					'-' DNP, '-' [LEFT BUSINESS],
					CAST(ISNULL(SUM([Pending(Approval)]+[Holding(Reply)]+
						[Approval]+[Processing]+[Approval Completed]+[Approval Rejected]+[Withdrawn]),0) AS NUMERIC) ETC_TOTAL
					FROM 
					(SELECT * FROM TB_COM_CD WHERE GRP_CD='COMP2') COMP
					LEFT OUTER JOIN	
					(SELECT TLC.COMP_CD,TLC.CNSLT_NO,
					
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S02' AND TLC.EXTNL_PRGRS_STATUS = 'S02' THEN 1 ELSE 0 END,0) AS PENDING, /*회신*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S03' AND TLC.EXTNL_PRGRS_STATUS = 'S03' THEN 1 ELSE 0 END,0) AS REPLIED, /*회신*/	 			
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S04' AND TLC.EXTNL_PRGRS_STATUS = 'S04' THEN 1 ELSE 0 END,0) AS REREQUEST, /*재의뢰*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S05' AND TLC.EXTNL_PRGRS_STATUS = 'S05' THEN 1 ELSE 0 END,0) AS HOLDING, /*보류*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S06' AND TLC.EXTNL_PRGRS_STATUS = 'S06' THEN 1 ELSE 0 END,0) AS EXECUTED, /*이행*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S07' AND TLC.EXTNL_PRGRS_STATUS = 'S07' THEN 1 ELSE 0 END,0) AS RETURNED, /*반려*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S08' AND TLC.EXTNL_PRGRS_STATUS = 'S02' THEN 1 ELSE 0 END,0) AS [Pending(Approval)], /*[Pending(Approval)]*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S09' AND TLC.EXTNL_PRGRS_STATUS = 'S02' THEN 1 ELSE 0 END,0) AS [Holding(Reply)], /*[Holding(Reply)]*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S13' AND TLC.EXTNL_PRGRS_STATUS = 'S13' THEN 1 ELSE 0 END,0) AS [Approval], /*[Approval]*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S14' AND TLC.EXTNL_PRGRS_STATUS = 'S14' THEN 1 ELSE 0 END,0) AS [Processing], /*[Processing]*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S15' AND TLC.EXTNL_PRGRS_STATUS = 'S15' THEN 1 ELSE 0 END,0) AS [Approval Completed], /*[Approval Completed]*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S16' AND TLC.EXTNL_PRGRS_STATUS = 'S16' THEN 1 ELSE 0 END,0) AS [Approval Rejected], /*[Approval Rejected]*/
							ISNULL(CASE WHEN TLC.INTNL_PRGRS_STATUS = 'S17' AND TLC.EXTNL_PRGRS_STATUS = 'S17' THEN 1 ELSE 0 END,0) AS [Withdrawn]
						FROM TN_LAS_CONSULT TLC
											 
							JOIN
							(SELECT MAX(HSTRY_NO) MAX_HSTRY_NO, CNSLT_NO
								FROM TN_LAS_CONSULT
								WHERE DEL_YN = 'N'
								AND INTNL_PRGRS_STATUS NOT IN ('S11')
								GROUP BY CNSLT_NO) MAX_TLC 
								ON TLC.CNSLT_NO = MAX_TLC.CNSLT_NO AND TLC.HSTRY_NO = MAX_TLC.MAX_HSTRY_NO
							 
						WHERE TLC.DEL_YN   = 'N'
						AND TLC.PUB_YN   = 'Y'
						AND EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = TLC.COMP_CD)
						AND EXISTS (SELECT * FROM TN_LAS_CONSULT_TYPE TLCT WHERE TLC.CNSLT_NO = TLCT.CNSLT_NO AND TLC.HSTRY_NO = TLCT.HSTRY_NO AND TLCT.CNSLT_TYPE NOT IN ('A20'))
					) TA ON COMP.CD= TA.COMP_CD
					GROUP BY COMP.CD
					ORDER BY COMP.CD ASC
			]]>
			</statement>
		</query>

		<!-- 2014-02-03 Kevin. Request 단계의 Draft Saved, Executed Contract, Admin Replied status의 데이터 추가함. -->
		<!-- SELMSPLUS 통계 화면 : 계약(flag:PC)-->
		<query id="las.statistics.contlegaladvice.pc" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    SELECT COMP.CD_NM_ENG COMP_NM , COMP.CD COMP_CD, 
		    	ISNULL(TOTAL-FIRST_DRAFT, 0) AS TOTAL,
		    	FIRST_DRAFT AS DraftSaved,
				(Review1 - FIRST_DRAFT) Review1,Review2,Review3,Review4,Conclusion1,Conclusion2,Conclusion3,Conclusion4,Registration1,Registration2,
				Execution1,Termination1,Termination2,Termination3,Termination4,Termination5,ADMIN_REPLIED AS AdminReplied,EXECUTED_CONTRACT AS ExecutedContract
				FROM 
					(SELECT * FROM TB_COM_CD WHERE GRP_CD='COMP2') COMP
					LEFT OUTER JOIN	
				    ( SELECT SA.COMP_CD, 
						CAST(ISNULL(SUM(Review1+Review2+Review3+Review4+Conclusion1+Conclusion2+Conclusion3+Conclusion4+
								Registration1+Registration2+Execution1+Termination1+Termination2+Termination3+Termination4+
								Termination5+ADMIN_REPLIED+EXECUTED_CONTRACT
								),0) AS NUMERIC) TOTAL,
						SUM(Review1) Review1,SUM(Review2) Review2,SUM(Review3) Review3,SUM(Review4) Review4,
						SUM(Conclusion1) Conclusion1,SUM(Conclusion2) Conclusion2,SUM(Conclusion3) Conclusion3,SUM(Conclusion4) Conclusion4,
						SUM(Registration1) Registration1,SUM(Registration2) Registration2,SUM(Execution1) Execution1,
						SUM(Termination1) Termination1,SUM(Termination2) Termination2,SUM(Termination3) Termination3,SUM(Termination4) Termination4,
						SUM(Termination5) Termination5, SUM(FIRST_DRAFT) FIRST_DRAFT, SUM(ADMIN_REPLIED) ADMIN_REPLIED, SUM(EXECUTED_CONTRACT) EXECUTED_CONTRACT
						FROM (
							SELECT 
				            A.COMP_CD,
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02501' AND C.DEPTH_STATUS='C02601' THEN 1 ELSE 0 END,0) AS Review1, /*Draft Saved*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02501' AND C.DEPTH_STATUS='C02606' THEN 1 ELSE 0 END,0) AS Review2, /*Review in Progress*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02501' AND C.DEPTH_STATUS='C02607' THEN 1 ELSE 0 END,0) AS Review3, /*DNP*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02501' AND C.DEPTH_STATUS='C02608' THEN 1 ELSE 0 END,0) AS Review4, /*Replied*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02502' AND C.DEPTH_STATUS='C02622' THEN 1 ELSE 0 END,0) AS Conclusion1, /*Approval in Progress*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02502' AND C.DEPTH_STATUS='C02621' THEN 1 ELSE 0 END,0) AS Conclusion2, /*Draft Saved*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02502' AND C.DEPTH_STATUS='C02627' THEN 1 ELSE 0 END,0) AS Conclusion3, /*DNP*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02502' AND C.DEPTH_STATUS='C02624' THEN 1 ELSE 0 END,0) AS Conclusion4, /*Cancel Approval*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02503' AND C.DEPTH_STATUS='C02641' THEN 1 ELSE 0 END,0) AS Registration1, /*Signing*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02503' AND C.DEPTH_STATUS='C02642' THEN 1 ELSE 0 END,0) AS Registration2, /*Hard copy not Delivered*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02504' AND C.DEPTH_STATUS='C02662' THEN 1 ELSE 0 END,0) AS Execution1, /*In Progress*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02505' AND C.DEPTH_STATUS='C02688' THEN 1 ELSE 0 END,0) AS Termination1, /*Cancelled*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02505' AND C.DEPTH_STATUS='C02686' THEN 1 ELSE 0 END,0) AS Termination2, /*Expired*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02505' AND C.DEPTH_STATUS='C02681' THEN 1 ELSE 0 END,0) AS Termination3, /*Will be terminated*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02505' AND C.DEPTH_STATUS='C02682' THEN 1 ELSE 0 END,0) AS Termination4, /*Approval in Progress*/
							ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02505' AND C.DEPTH_STATUS='C02685' THEN 1 ELSE 0 END,0) AS Termination5, /*Extension Review*/
							ISNULL(CASE WHEN A.CNSD_LEVEL = '1'      AND A.PRGRS_STATUS  ='C04201' THEN 1 ELSE 0 END,0) AS FIRST_DRAFT, /*FIRST DRAFT*/
               				ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02501' AND C.DEPTH_STATUS='C02609' THEN 1 ELSE 0 END,0) AS ADMIN_REPLIED, /*Admin Replied*/
               				ISNULL(CASE WHEN C.PRCS_DEPTH = 'C02507' THEN 1 ELSE 0 END,0) AS EXECUTED_CONTRACT, /*Executed Contract*/
							ISNULL(C.CLOSE_YN,'N') AS CLOSE_YN	/* 2014-04-28 Sungwoo */
							FROM 
								(SELECT FST_CNSDREQ_ID, MAX(CNSD_LEVEL) 
								AS LVL, MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT, MIN(ASGN_DT) FIRST_ASGN_DT, 
								MAX(ASGN_DT) LAST_ASGN_DT, MAX(RESPMAN_ID) RESPMAN_ID, MAX(SA.COMP_CD) COMP_CD
								FROM TN_CLM_CONT_CNSDREQ SA
								    LEFT OUTER JOIN
								    TN_CLM_CONT_CNSDREQ_RESPMAN SB 
								    ON SA.CNSDREQ_ID = SB.CNSDREQ_ID AND SA.MN_CNSD_DEPT = SB.RESP_DEPT
								    WHERE SA.DEL_YN = 'N'
								GROUP BY SA.FST_CNSDREQ_ID) REQ_MAX  
								JOIN
								TN_CLM_CONT_CNSDREQ A ON A.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID AND A.CNSD_LEVEL = REQ_MAX.LVL
								JOIN
								TN_CLM_CONTRACT_CNSD B ON A.CNSDREQ_ID = B.CNSDREQ_ID
								JOIN 
								(SELECT * FROM TN_CLM_CONTRACT_MASTER WHERE PRCS_DEPTH NOT IN ('C02506','C02509')) C ON B.CNTRT_ID = C.CNTRT_ID
							) SA
							WHERE EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = SA.COMP_CD)
							AND CLOSE_YN = 'N'
							GROUP BY COMP_CD
				  ) TA ON COMP.CD = TA.COMP_CD
				  ORDER BY   
				  #if ($vo.sort_yn.equals("Y"))		/* 신성우 추가 통계 차트 적용시에 해당 토탈 값을 기준으로 정렬 */
						ISNULL(TOTAL-FIRST_DRAFT, 0) desc,
				  #end
				  COMP.CD ASC
				  
			]]>
			</statement>
		</query>
		
		<!-- SELMSPLUS 통계 화면 : 자문(flag:PL)-->
		<!-- 2014-02-17 Kevin. 일단, 일단 자문 통계 수치가 안 맞는다. SELMS 이관 데이터가 섞여 있어 Not Assigned와 Review In Progress 데이터에 영향을 미친다. -->
		<!-- Sub 쿼리 셋에서 S11 데이터를 Not in 조건으로 주어서 나머지 데이터 숫자가 맞지 않아 이를 주석처리 함. -->
		<query id="las.statistics.contlegaladvice.pl" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	SELECT COMP.CD COMP_CD,
					CAST(ISNULL(SUM(COL1+COL2+COL3+COL4+COL5+COL6),0) AS NUMERIC) TOTAL,
					ISNULL(SUM(COL1),0) COL1,ISNULL(SUM(COL2),0) COL2,ISNULL(SUM(COL3),0) COL3,
					ISNULL(SUM(COL4),0) COL4,ISNULL(SUM(COL5),0) COL5,ISNULL(SUM(COL6),0) COL6
					FROM 
					(SELECT * FROM TB_COM_CD WHERE GRP_CD='COMP2') COMP
					LEFT OUTER JOIN	
					(SELECT COMP_CD,
						ISNULL(CASE WHEN CNSLT_NO LIKE 'H%' AND PRGRS_STATUS100 = 'V01' THEN 1 ELSE 0 END,0) AS COL1, /*Not Assigned*/
						ISNULL(CASE WHEN CNSLT_NO LIKE 'H%' AND PRGRS_STATUS100 = 'V02' THEN 1 ELSE 0 END,0) AS COL2, /*Review in Progress*/
						ISNULL(CASE WHEN PRGRS_STATUS100 = 'S03' THEN 1 ELSE 0 END,0) AS COL3, /*Replied*/
						ISNULL(CASE WHEN PRGRS_STATUS100 = 'S05' THEN 1 ELSE 0 END,0) AS COL4, /*DNP*/
						ISNULL(CASE WHEN PRGRS_STATUS100 = 'S07' THEN 1 ELSE 0 END,0) AS COL5, /*Returned*/
						ISNULL(CASE WHEN PRGRS_STATUS100 = 'S09' THEN 1 ELSE 0 END,0) AS COL6  /*Saved*/
					 FROM	
						(SELECT TLC.COMP_CD,TLC.CNSLT_NO,
								CASE WHEN INTNL_PRGRS_STATUS IN ('S02','S04','S11') THEN
											CASE WHEN INTNL_PRGRS_STATUS = 'S11' THEN 'S09'
												ELSE
													CASE WHEN DBO.LAS_CONSULT_RESPMAN(TLC.CNSLT_NO, ',') IS NOT NULL THEN 'V02'
														ELSE 'V01'
													END
											END
									ELSE INTNL_PRGRS_STATUS
								END AS PRGRS_STATUS100
							
							FROM TN_LAS_CONSULT TLC
								JOIN
								(SELECT MAX(HSTRY_NO) MAX_HSTRY_NO, CNSLT_NO
									FROM TN_LAS_CONSULT
									WHERE DEL_YN = 'N'
									/*AND INTNL_PRGRS_STATUS NOT IN ('S11') 2014-02-17 Kevin*/
									GROUP BY CNSLT_NO) MAX_TLC 
									ON TLC.CNSLT_NO = MAX_TLC.CNSLT_NO AND TLC.HSTRY_NO = MAX_TLC.MAX_HSTRY_NO
								 JOIN
								 TB_COM_CD TCD ON TCD.CD = TLC.INTNL_PRGRS_STATUS
							WHERE TLC.DEL_YN   = 'N'
							AND TLC.PUB_YN   = 'Y'
							AND EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD = TLC.COMP_CD)
							AND EXISTS (SELECT * FROM TN_LAS_CONSULT_TYPE TLCT WHERE TLC.CNSLT_NO = TLCT.CNSLT_NO AND TLC.HSTRY_NO = TLCT.HSTRY_NO AND TLCT.CNSLT_TYPE NOT IN ('A20'))
							AND TCD.GRP_CD   = 'N1_I'
						) SSA) TA ON COMP.CD= TA.COMP_CD
					GROUP BY COMP.CD
					ORDER BY
					#if ($vo.sort_yn.equals("Y"))		/* 신성우 추가 통계 차트 적용시에 해당 토탈 값을 기준으로 정렬 */
						CAST(ISNULL(SUM(COL1+COL2+COL3+COL4+COL5+COL6),0) AS NUMERIC) desc,
				  	#end
					COMP.CD ASC
			]]>
			</statement>
		</query>
		
		<!-- Lapsed time by Request-->
		<query id="las.statistics.listStatisticsLap_time" isCamelCase="false"
			isDynamic="true">
			<statement>
		    <![CDATA[
		    	 SELECT COMP_CD, DEPT_CD, RESPMAN_NM, RESPMAN_ID, MAIN_CNSD_YN, CNSDREQ_ID, REQMAN_NM,
						REQ_TITLE, REQ_DT, F_REPLIED_DT, LAST_REPLIED_DT,
						SUM(REVIEW_IN_PROC) REVIEW_IN_PROC, SUM(F_REPLIED) F_REPLIED,
						SUM(LAST_REPLIED) LAST_REPLIED, SUM(APPROVAL) APPROVAL, SUM(REGISTRATION) REGISTRATION, 
						SUM(EXECUTED) EXECUTED, SUM(TERMINATION) TERMINATION, SUM(HOLDING) HOLDING, 
						SUM(ADM_REPLIED) ADM_REPLIED, SUM(CLOSED) CLOSED, SUM(LT) LT1,
						CASE WHEN COMP_CD IS NULL THEN 4
								WHEN DEPT_CD IS NULL THEN 3
								WHEN LAST_REPLIED_DT IS NOT NULL THEN 2
								ELSE 1 END SRT1
					FROM (
						SELECT COMP_CD, DEPT_CD, RESPMAN_NM, RESPMAN_ID, MAIN_CNSD_YN, CNSDREQ_ID, REQMAN_NM,
							REQ_TITLE, SUM(REVIEW_IN_PROC) REVIEW_IN_PROC, SUM(F_REPLIED) F_REPLIED, 
							SUM(LAST_REPLIED) LAST_REPLIED, SUM(APPROVAL) APPROVAL, SUM(REGISTRATION) REGISTRATION, 
							SUM(EXECUTED) EXECUTED, SUM(TERMINATION) TERMINATION, SUM(HOLDING) HOLDING, 
							SUM(ADM_REPLIED) ADM_REPLIED, SUM(CLOSED) CLOSED, REQ_DT, F_REPLIED_DT,
							LAST_REPLIED_DT, SUM(LT) LT 
							FROM ( 
							SELECT  E.COMP_CD,
									CASE WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994240' THEN 'LC1'
											WHEN E.COMP_CD = 'EHQ' AND F.DEPT_CD = 'C10CZ99CZ994241' THEN 'LC2'
											WHEN E.COMP_CD = 'EHQ' THEN 'LC_OTHERS'
											ELSE ISNULL(F.DEPT_NM_ENG,'') END AS DEPT_CD,
									B.RESPMAN_NM,
									B.RESPMAN_ID,
									DBO.DECODE3(B.MAIN_CNSD_YN, 'Y', 'O', 'S') MAIN_CNSD_YN,
									D.CNSDREQ_ID,
									A.REQMAN_NM,
									A.REQ_TITLE,
									CASE WHEN B.RESPMAN_ID IN (DCNSD.CNSDMAN_ID, DCNSD.APBTMAN_ID ) AND E.DEPTH_STATUS = 'C02606'
											THEN 1 ELSE 0 END REVIEW_IN_PROC,
									ISNULL((SELECT CASE WHEN CNSD_STATUS = 'C04305' THEN 1 ELSE 0 END 
												FROM TN_CLM_CONTRACT_DEPTCNSD 
												WHERE CNSDREQ_ID = A.FST_CNSDREQ_ID
													AND CNTRT_ID = E.CNTRT_ID 
													AND CNSD_DEPT = A.MN_CNSD_DEPT
													AND REQ_MAX.LVL=1 AND A.PRGRS_STATUS = 'C04207' AND (REQ_MAX.LAST_CNSD_YN='N' AND REQ_MAX.PLNDBN_REQ_YN='N')
													AND E.DEPTH_STATUS NOT IN ('C02607','C02627')
												),0) F_REPLIED, 
									CASE WHEN DCNSD.CNSD_STATUS = 'C04305' AND ( A.PRGRS_STATUS = 'C04207' AND (REQ_MAX.LAST_CNSD_YN='Y' OR REQ_MAX.PLNDBN_REQ_YN='Y') )
											  AND E.DEPTH_STATUS NOT IN ('C02607','C02627')	THEN 1 ELSE 0 END LAST_REPLIED,
												
									CASE WHEN E.DEPTH_STATUS NOT IN ('C02607','C02627')	AND A.PRGRS_STATUS = 'C04217' THEN 1 ELSE 0 END APPROVAL, /*체결미확인*/
									CASE WHEN E.DEPTH_STATUS NOT IN ('C02607','C02627')	AND A.PRGRS_STATUS = 'C04218' THEN 1 ELSE 0 END REGISTRATION, /*원본미등록*/
									CASE WHEN E.DEPTH_STATUS NOT IN ('C02607','C02627')	AND A.PRGRS_STATUS >= 'C04219' AND A.PRGRS_STATUS <> 'C04223' THEN 1 ELSE 0 END EXECUTED, /*이행중*/
									CASE WHEN E.DEPTH_STATUS NOT IN ('C02607','C02627')	AND A.PRGRS_STATUS = 'C04223' THEN 1 ELSE 0 END TERMINATION, /*계약종료*/
									CASE WHEN E.DEPTH_STATUS IN ('C02607','C02627') THEN 1 ELSE 0 END HOLDING, /*보류*/
									CASE WHEN E.DEPTH_STATUS NOT IN ('C02607','C02627')	AND A.PRGRS_STATUS = 'C04216' THEN 1 ELSE 0 END ADM_REPLIED, /*반려*/ 
									CASE WHEN E.CLOSE_YN = 'Y' THEN 1 ELSE 0 END CLOSED,
									ISNULL(CAST(CONVERT(CHAR(16),REQ_MAX.REQ_DT,120) AS NVARCHAR),'') REQ_DT,
									ISNULL((	SELECT CASE WHEN CNSD_STATUS = 'C04305' THEN 
														CAST(CONVERT(CHAR(16),CNSD_DT,120) AS NVARCHAR) 
												   END 
												FROM TN_CLM_CONTRACT_DEPTCNSD 
												WHERE CNSDREQ_ID = A.FST_CNSDREQ_ID
													AND CNTRT_ID = E.CNTRT_ID 
													AND CNSD_DEPT = A.MN_CNSD_DEPT
											),  /*여러번 HOLD 하다가 마지막에 회신을 받으면 첫회신은 값이 없게 되므로 마지막 회신이 존재하면 날자를 표시해주기 위해*/
												CASE WHEN DCNSD.CNSD_STATUS = 'C04305' THEN ISNULL(CAST(CONVERT(CHAR(16),DCNSD.CNSD_DT,120) AS NVARCHAR),'') ELSE '' END
											) F_REPLIED_DT, 
									CASE WHEN DCNSD.CNSD_STATUS = 'C04305' AND (REQ_MAX.LAST_CNSD_YN='Y' OR REQ_MAX.PLNDBN_REQ_YN='Y') 
										THEN ISNULL(CAST(CONVERT(CHAR(16),DCNSD.CNSD_DT,120) AS NVARCHAR),'') ELSE '' END LAST_REPLIED_DT,
									CASE WHEN DCNSD.CNSD_STATUS = 'C04305' AND (REQ_MAX.LAST_CNSD_YN='Y' OR REQ_MAX.PLNDBN_REQ_YN='Y') 
										THEN ISNULL([dbo].[COM_REQ_LT](REQ_MAX.REQ_DT,DCNSD2.CNSD_DT,A.COMP_CD),0) ELSE 0 END LT
												
							FROM  TN_CLM_CONT_CNSDREQ A
									JOIN
									TN_CLM_CONT_CNSDREQ_RESPMAN B ON A.CNSDREQ_ID = B.CNSDREQ_ID
									JOIN 
									TN_CLM_CONTRACT_CNSD D ON B.CNSDREQ_ID = D.CNSDREQ_ID
									JOIN
									TN_CLM_CONTRACT_MASTER E ON D.CNTRT_ID = E.CNTRT_ID
									JOIN 
									TB_COM_USER F ON B.RESPMAN_ID = F.USER_ID
									JOIN
									(SELECT FST_CNSDREQ_ID, MAX(CNSD_LEVEL) AS LVL, MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT, MAX(LAST_CNSD_YN) LAST_CNSD_YN
										, MAX(PLNDBN_REQ_YN) PLNDBN_REQ_YN
										FROM TN_CLM_CONT_CNSDREQ
									WHERE DEL_YN = 'N'
									GROUP BY FST_CNSDREQ_ID) REQ_MAX ON A.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID
																		AND A.CNSD_LEVEL = REQ_MAX.LVL             
									LEFT OUTER JOIN
									TN_CLM_CONTRACT_DEPTCNSD DCNSD ON A.CNSDREQ_ID = DCNSD.CNSDREQ_ID 
																	AND E.CNTRT_ID = DCNSD.CNTRT_ID 
																	AND A.MN_CNSD_DEPT = DCNSD.CNSD_DEPT
									LEFT OUTER JOIN
									(SELECT MAX(CNSD_DT) CNSD_DT, FST_CNSDREQ_ID 
										FROM TN_CLM_CONTRACT_DEPTCNSD SA JOIN TN_CLM_CONT_CNSDREQ SB 
										ON SA.CNSDREQ_ID = SB.CNSDREQ_ID
										WHERE SA.CNSD_STATUS = 'C04305'
										GROUP BY FST_CNSDREQ_ID
									) DCNSD2 ON REQ_MAX.FST_CNSDREQ_ID = DCNSD2.FST_CNSDREQ_ID
																				
							WHERE   
								A.DEL_YN = 'N'
								
								#if ($vo.srch_comp_cd && !$vo.srch_comp_cd.equals(""))
									AND   A.COMP_CD = :vo.srch_comp_cd
								#end
								
								AND A.COMP_CD IN ($vo.session_auth_comp_cd)	
								AND   E.DEL_YN = 'N'
								AND   A.PRGRS_STATUS NOT IN ('C04201','C04225') /** 작성중, 임시저장 **/
								AND   E.CNTRT_INFO_GBN NOT IN ( 'C05403' ,'C05402','C05499')/* 구법무시스템이관, 사업부이관 제외 코드  */
								AND   EXISTS (SELECT 'E' FROM TB_COM_CD WHERE GRP_CD='COMP2' AND CD IN (A.COMP_CD) ) 
							) TA
							 
							GROUP BY ROLLUP(COMP_CD, DEPT_CD, RESPMAN_NM, RESPMAN_ID, MAIN_CNSD_YN, CNSDREQ_ID, REQMAN_NM,
											REQ_TITLE, EXECUTED, REQ_DT, F_REPLIED_DT, LAST_REPLIED_DT 
											)
					) TTA                      
					WHERE 'Y' = CASE WHEN COMP_CD IS NULL THEN 'Y'
								WHEN DEPT_CD IS NULL THEN 'Y'
								WHEN LAST_REPLIED_DT IS NOT NULL THEN 'Y'
								ELSE 'N' END
					GROUP BY  COMP_CD, DEPT_CD, RESPMAN_NM, RESPMAN_ID, MAIN_CNSD_YN, CNSDREQ_ID, REQMAN_NM,
							REQ_TITLE, REQ_DT, F_REPLIED_DT, LAST_REPLIED_DT
					ORDER BY ISNULL(COMP_CD, 'ZZZ'), SRT1
			]]>
			</statement>
		</query>
		
		
		<!-- 2014-04-30 Kevin added. To get GERP counterparty contract rate-->
		<query id="las.statistics.gerpContractRateStatisticsDataList" isCamelCase="false" isDynamic="true">
			<statement>
		    <![CDATA[
		    	 EXEC SP_GERP_SELECT_CONTRACT_RATE :vo.Type, :vo.TargetYear, :vo.CompCd, :vo.VendorType
			]]>
			</statement>
		</query>
		
    </queries>
</queryservice>