<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.1.dtd">

<queryservice>
    <queries>
    
<query id="las.lawservice.listEventSub" isCamelCase="false">
  <statement>
    <![CDATA[
               
    	     SELECT *
              FROM ( SELECT rownum RN, t.*, COUNT(1) over() TOTAL_CNT
                     FROM (
		
						     SELECT  A.EVENT_NO
        							,A.EVENT_NM
        							,A.EVENT_GBN1
        							,A.EVENT_GBN2
        							,A.LAWSUIT_TRGT
        							,TO_CHAR(A.REG_DT, 'YYYY-MM-DD') AS REG_DT
        							,A.REG_ID
        							,A.REG_NM
        							,A.DEL_YN
           					
           					FROM TN_LAS_EVENTMNG A

           					WHERE A.DEL_YN = 'N' 
	
           						#if (!$vo.srch_event_no.equals(""))
								     AND A.EVENT_NO = :vo.srch_event_no   
								#end 
								
								#if (!$vo.srch_event_nm.equals(""))
								     AND A.EVENT_NM LIKE '%' + :vo.srch_event_nm    + '%'	 
								#end 
								
								#if (!$vo.srch_kbn1.equals(""))
								     AND A.EVENT_GBN1 = :vo.srch_kbn1 
								         #if (!$vo.srch_kbn2.equals(""))
								              AND A.EVENT_GBN2 = :vo.srch_kbn2                    
								         #end
								#end
								
								#if (!$vo.srch_reg_nm.equals(""))
								     AND A.REG_NM  LIKE '%' + :vo.srch_reg_nm + '%'	 
								#end 
								
								#if (!$vo.srch_start_dt.equals(""))
									AND	A.REG_DT >= date(:vo.srch_start_dt)
			                    #end
			                    
			                    #if (!$vo.srch_end_dt.equals(""))
									AND	A.REG_DT <= date(:vo.srch_end_dt) + 1
			                    #end 
			                    
			                    #if ($vo.srch_order_type.equals("S_EVENT_NM"))
									ORDER BY A.EVENT_NM ASC
			                    #end 
			                    
			                    #if ($vo.srch_order_type.equals("S_REG_DT"))
									ORDER BY A.REG_DT DESC
			                    #end 
           
            				 ) t
            		ORDER BY RN 
            		)
            WHERE RN between :vo.start_index and :vo.end_index     
           
    ]]>
  </statement>
</query>


<query id="las.lawservice.insertEventAccept" isCamelCase="false">
  <statement>
    <![CDATA[

		INSERT INTO TN_LAS_EVENT_ACCEPT (
           
	  ACPT_NO
	 ,EVENT_NO
	 ,ACPTDAY	
	 ,LAWFIRM_ID	
	 ,CLAIMDAY	
	 ,CLAIM_AMT	
	 ,CRRNCY_UNIT	
	 ,CLAIM_CONT	
	 ,INVOICE_NO	
	 ,SRVCSTARTDAY	
	 ,SRVCENDDAY	
	 ,REMIT_AMT	
	 ,REMITPLNDDAY	
	 ,REMITDAY	
	 ,UNPAYDAY	
	 ,REVIEW_YN	
	 ,REVIEW_CONT	
	 ,REG_DT	
	 ,REG_ID	
	 ,REG_NM	
	 ,MOD_DT	
	 ,MOD_ID	
	 ,MOD_NM	
	 ,DEL_YN	
	 ,DEL_DT	
	 ,DEL_ID	
	 ,DEL_NM
	 ,EXRT_APPLYDAY	
	  
       ) VALUES (

	  :vo.acpt_no
	 ,:vo.event_no
	 ,:vo.acptday	
	 ,:vo.lawfirm_id	
	 ,:vo.claimday	
	 ,:vo.claim_amt	
	 ,:vo.crrncy_unit	
	 ,:vo.claim_cont	
	 ,:vo.invoice_no	
	 ,:vo.srvcstartday	
	 ,:vo.srvcendday	
	 ,:vo.remit_amt	
	 ,:vo.remitplndday	
	 ,:vo.remitday	
	 ,:vo.unpayday	
	 ,:vo.review_yn	
	 ,:vo.review_cont	
	 ,SYSDATE	
	 ,:vo.reg_id	
	 ,:vo.reg_nm	
	 ,''	
	 ,''	
	 ,''
	 ,'N'	
	 ,''
	 ,''	
	 ,''
 	 ,:vo.c_dt
)
 
    ]]>
  </statement>
</query>

<query id="las.lawservice.insertEventAcceptLawer" isCamelCase="false">
	<statement>
	    <![CDATA[
		    
				    INSERT INTO TN_LAS_EVENT_ACCEPT_LAWYER (
				               LWR_NO	
				             , SEQNO		
				             , EVENT_NO	
				             , ACPT_NO	
				             , REG_DT	
				             , REG_ID	
				             , REG_NM	
				
				        ) VALUES (
				          			 :vo.lwr_no
				          			,(SELECT	ISNULL(MAX(SEQNO),0) + 1 FROM	TN_LAS_EVENT_ACCEPT_LAWYER WHERE LWR_NO = :vo.lwr_no )
				          			,:vo.event_no 
				          			,:vo.acpt_no
				         			, SYSDATE
				          			,:vo.reg_id
				          			,:vo.reg_nm
				        )
		        
	    ]]>
	</statement>
</query>

<query id="las.lawservice.getMaxAcptNo" isCamelCase="false">
  <statement>
    <![CDATA[
    
          SELECT  (TO_CHAR(SYSDATE,'YYYY') + ISNULL(LPAD(MAX(TO_NUMBER(RIGHT(ACPT_NO,4))) + 1,4,'0'),'0001')) AS ACPT_NO
          FROM	TN_LAS_EVENT_ACCEPT WHERE ACPT_NO LIKE TO_CHAR(SYSDATE,'YYYY')+'%'
          
    ]]>
  </statement>
</query>

<query id="las.lawservice.insertAcceptSrvCost" isCamelCase="false">
  <statement>
    <![CDATA[
   
				INSERT INTO TN_LAS_EVENT_ACCEPT_SRVCCOST 
				
				(
				  
					 ACPT_NO
					,INTNL_DEPT_CD
					,GRP_DEPT_CD
					,DEPT_NM
					,TOTAMT	
					,SRVC_AMT	
					,ADDTNL_AMT
					,DC_RATE	
					,PLND_REMIT_AMT	
					,USD_AMT	
					,TOT_REMIT_AMT
					,REMITDAY	
					,REG_DT	
					,REG_ID	
					,REG_NM	
					,MOD_DT	
					,MOD_ID	
					,MOD_NM	
					,EVENT_NO	
					
					) VALUES (
					
					 :vo.acpt_no
					,:vo.intnl_dept_cd
					,:vo.grp_dept_cd
					,:vo.dept_nm
					,:vo.totamt 
					,:vo.srvc_amt	
					,:vo.addtnl_amt
					,:vo.dc_rate	
					,:vo.plnd_remit_amt	
					,:vo.usd_amt	
					,:vo.tot_remit_amt
					,:vo.remitday	
					,SYSDATE	
					,:vo.reg_id	
					,:vo.reg_nm	
					,''	
					,''
					,''
					,:vo.event_no	
					        
			)
			   
    ]]>
  </statement>
</query>

<query id="las.lawservice.detailEventAccept" isCamelCase="false">
  <statement>
    <![CDATA[
         
       SELECT 
       			A.ACPT_NO                               											,
       			A.EVENT_NO                              											,
              	B.EVENT_NM                              											,
              	B.LAWSUIT_TRGT                          											,
              	B.EVENT_GBN1	                          											,
              	B.EVENT_GBN2	                          											,
              	D.LAWSUIT_TRGT_NM																	,
              	A.LAWFIRM_ID	                        											,
              	C.LAWFIRM_NM	                        											,
              	A.REG_NM                                											,
              	TO_CHAR(TO_DATE(TRIM(A.ACPTDAY),'YYYY-MM-DD'),'YYYY-MM-DD') AS ACPTDAY				,
              	A.INVOICE_NO																		,
              	A.CRRNCY_UNIT																		,
              	TO_CHAR(TO_DATE(TRIM(A.CLAIMDAY),'YYYY-MM-DD'),'YYYY-MM-DD') AS CLAIMDAY			,
				A.CLAIM_AMT																			,
				A.CLAIM_CONT																		,                	
              	TO_CHAR(TO_DATE(TRIM(A.SRVCSTARTDAY), 'YYYY-MM-DD'),'YYYY-MM-DD') AS SRVCSTARTDAY	,
              	TO_CHAR(TO_DATE(TRIM(A.SRVCENDDAY), 'YYYY-MM-DD'),'YYYY-MM-DD') AS SRVCENDDAY		,
              	A.REMIT_AMT																			,
              	TO_CHAR(TO_DATE(TRIM(A.REMITPLNDDAY), 'YYYY-MM-DD'),'YYYY-MM-DD') AS REMITPLNDDAY	,
              	TO_CHAR(TO_DATE(TRIM(A.REMITDAY), 'YYYY-MM-DD'),'YYYY-MM-DD') AS REMITDAY			,
				TO_CHAR(TO_DATE(TRIM(A.UNPAYDAY), 'YYYY-MM-DD'),'YYYY-MM-DD') AS UNPAYDAY			,
              	A.REVIEW_YN																			,
              	A.REVIEW_CONT																		,             
				TO_CHAR(A.REG_DT, 'YYYY-MM-DD') AS REG_DT											, 
				A.REG_ID                                  											,
				A.REG_NM                                  											,
				A.DEL_YN																			,
				TO_CHAR(TO_DATE(A.REMITDAY,'YYYY-MM-DD') - TO_DATE(A.ACPTDAY,'YYYY-MM-DD')) AS SPERIOD ,
              	TO_CHAR(TO_DATE(A.EXRT_APPLYDAY,'YYYY-MM-DD'),'YYYY-MM-DD') AS EXRT_APPLYDAY,
              	ISNULL(UNPAYDAY,EXRT_APPLYDAY) AS SHIFTDAY																	
				              
       FROM   	TN_LAS_EVENT_ACCEPT A
       		  	,(SELECT EVENT_NO, EVENT_NM, LAWSUIT_TRGT, EVENT_GBN1 ,EVENT_GBN2 FROM TN_LAS_EVENTMNG ) B
       		  	,(SELECT LAWFIRM_ID, LAWFIRM_NM FROM TN_LAS_LAWFIRMMNG ) C
       		  	,(SELECT CD, CD_NM AS LAWSUIT_TRGT_NM FROM TB_COM_CD WHERE GRP_CD = '105' ) D
       
       WHERE  	A.ACPT_NO = :vo.acpt_no
       	AND   	A.EVENT_NO = B.EVENT_NO(+) 
       	AND   	A.LAWFIRM_ID = C.LAWFIRM_ID(+) 
       	AND   	B.LAWSUIT_TRGT = D.CD(+)  


    ]]>
  </statement>
</query>


<query id="las.lawservice.detailEventAcceptSrvCost" isCamelCase="false">
  <statement>
    <![CDATA[

 	    SELECT 
       			ACPT_NO,
       			EVENT_NO,
              	INTNL_DEPT_CD,
              	GRP_DEPT_CD,
              	DEPT_NM,
              	TOTAMT,
              	SRVC_AMT,
              	ADDTNL_AMT,
              	DC_RATE,
              	PLND_REMIT_AMT,
              	USD_AMT,
              	TOT_REMIT_AMT,
              	REMITDAY											
				              
       FROM   	TN_LAS_EVENT_ACCEPT_SRVCCOST
       
       WHERE  	ACPT_NO = :vo.acpt_no
       
    ]]>
  </statement>
</query>

<query id="las.lawservice.listEventAcceptLawyer" isCamelCase="false">
  <statement>
    <![CDATA[
			
			SELECT 
					 A.LWR_NO 
					,B.LWR_NM 
			FROM 
					TN_LAS_EVENT_ACCEPT_LAWYER A
					, TN_LAS_LAWYERMNG B
			WHERE
					A.LWR_NO = B.LWR_NO(+)
					AND A.EVENT_NO = :vo.event_no

    ]]>
  </statement>
</query>

<query id="las.lawservice.modifyEventAccept" isCamelCase="false">
  <statement>
    <![CDATA[
         
 		 UPDATE 		TN_LAS_EVENT_ACCEPT
          
				 SET
				
				 EVENT_NO       = :vo.event_no
				,ACPTDAY	     = :vo.acptday	
				,LAWFIRM_ID	 = :vo.lawfirm_id	
				,CLAIMDAY	     = :vo.claimday	
				,CLAIM_AMT	     = :vo.claim_amt	
				,CRRNCY_UNIT	 = :vo.crrncy_unit	
				,CLAIM_CONT	 = :vo.claim_cont	
				,INVOICE_NO	 = :vo.invoice_no	
				,SRVCSTARTDAY	 = :vo.srvcstartday	
				,SRVCENDDAY	 = :vo.srvcendday	
				,REMIT_AMT	     = :vo.remit_amt	
				,REMITPLNDDAY	 = :vo.remitplndday	
				,REMITDAY	     = :vo.remitday	
				,UNPAYDAY	     = :vo.unpayday	
				,REVIEW_YN	     = :vo.review_yn	
				,REVIEW_CONT	 = :vo.review_cont	
				,MOD_DT	     = SYSDATE	
				,MOD_ID	     = :vo.mod_id		
				,MOD_NM	     = :vo.mod_nm
				             
		  WHERE			ACPT_NO = :vo.acpt_no

    ]]>
  </statement>
</query>

<query id="las.lawservice.deleteEventAcceptSrvCost" isCamelCase="false">
  <statement>
    <![CDATA[

                UPDATE  TN_LAS_EVENT_ACCEPT
                   SET  DEL_YN = 'Y' 
	        	      , DEL_DT = SYSDATE 
    	        	  , DEL_ID = :vo.del_id
        	     	  , DEL_NM = :vo.del_nm 
                 WHERE  ACPT_NO = :vo.acpt_no
           
    ]]>
  </statement>
</query>

<query id="las.lawservice.getLawyerList" isCamelCase="false">
  <statement>
    <![CDATA[
       
           SELECT LWR_NO ,
                  LWR_NM
           FROM   TN_LAS_LAWYERMNG
           WHERE  DEL_YN = 'N' 

    ]]>
  </statement>
</query>

<query id="las.lawservice.checkInvoiceNo" isCamelCase="false">
  <statement>
    <![CDATA[
       
           SELECT COUNT(INVOICE_NO) AS INVOICE_NO  
           FROM   TN_LAS_EVENT_ACCEPT
           WHERE  EVENT_NO = :vo.event_no 
           AND INVOICE_NO = :vo.invoice_no

    ]]>
  </statement>
</query>

<query id="las.lawservice.srchInvoiceNo" isCamelCase="false">
  <statement>
    <![CDATA[
         
       SELECT 
       			ACPT_NO         
			              
       FROM   	TN_LAS_EVENT_ACCEPT 
       
       WHERE  	DEL_YN = 'N'
       	AND		INVOICE_NO = :vo.invoice_no
       	AND		EVENT_NO = :vo.event_no

    ]]>
  </statement>
</query>

<query id="las.lawservice.checkRateAjax" isCamelCase="false">
  <statement>
    <![CDATA[
       
	  		 SELECT 
					  count(*) AS CHECK_RATE_CNT 
			          ,MAX(DECODE(CURRENCY, 'USD' , ARRATE , 0)) AS USRATE
			          ,MAX(DECODE(CURRENCY, :vo.crrncy_unit , ARRATE,0)) AS EXRATE  
			   FROM   TN_INF_GTNE_CURRENCY  
	        WHERE     	      
	           		 CURRENCY IN ( :vo.crrncy_unit , 'USD' )  AND C_DT = :vo.c_dt

    ]]>
  </statement>
</query>

<query id="las.lawservice.updateRemitday" isCamelCase="false">
  <statement>
    <![CDATA[

                UPDATE   TN_LAS_EVENT_ACCEPT
                   SET   REMITDAY = :vo.remitday 
                    	,MOD_DT	     = SYSDATE	
 						,MOD_ID	     = :vo.mod_id		
 						,MOD_NM	     = :vo.mod_nm
                 WHERE   ACPT_NO = :vo.acpt_no
           
    ]]>
  </statement>
</query>

<query id="las.lawservice.updateReviewYn" isCamelCase="false">
  <statement>
    <![CDATA[

                UPDATE   TN_LAS_EVENT_ACCEPT
                   SET   REVIEW_YN = :vo.review_yn
                   	  	,REVIEW_CONT = :vo.review_cont
                   	  	,MOD_DT	     = SYSDATE	
 						,MOD_ID	     = :vo.mod_id		
 						,MOD_NM	     = :vo.mod_nm
                 WHERE   ACPT_NO = :vo.acpt_no
           
    ]]>
  </statement>
</query>

<query id="las.lawservice.updateRemitInit" isCamelCase="false">
  <statement>
    <![CDATA[

                UPDATE  TN_LAS_EVENT_ACCEPT
                   SET   UNPAYDAY = ''
                   	  	,REMIT_AMT = ''
                   	  	,MOD_DT	     = SYSDATE	
 						,MOD_ID	     = :vo.mod_id		
						,MOD_NM	     = :vo.mod_nm
                 WHERE   ACPT_NO = :vo.acpt_no
           
    ]]>
  </statement>
</query>

<query id="las.lawservice.updateUnpayday" isCamelCase="false">
  <statement>
    <![CDATA[

                UPDATE  TN_LAS_EVENT_ACCEPT
                   SET   UNPAYDAY = :vo.unpayday		
                   	  	,REMIT_AMT = :vo.tot_remit_amt       
                   	  	,MOD_DT	     = SYSDATE	
 						,MOD_ID	     = :vo.mod_id		
						,MOD_NM	     = :vo.mod_nm
                 WHERE   ACPT_NO = :vo.acpt_no
           
    ]]>
  </statement>
</query>

<query id="las.lawservice.updateRemitAmt" isCamelCase="false">
  <statement>
    <![CDATA[
   
				UPDATE 	TN_LAS_EVENT_ACCEPT_SRVCCOST 

				SET

						 PLND_REMIT_AMT	= :vo.plnd_remit_amt	     
						,USD_AMT	    = :vo.usd_amt	         
						,TOT_REMIT_AMT  = :vo.tot_remit_amt       
						,REMITDAY	    = :vo.remitday	         
						,MOD_DT	   		= SYSDATE	 
						,MOD_ID	   		= :vo.mod_id	 
						,MOD_NM	   		= :vo.mod_nm	 
				
				WHERE   ACPT_NO = :vo.acpt_no
				AND 	INTNL_DEPT_CD = :vo.intnl_dept_cd

   
    ]]>
  </statement>
</query>

<query id="las.lawservice.modifyEventAcceptSrvCost" isCamelCase="false">
  <statement>
    <![CDATA[
   
				UPDATE 	TN_LAS_EVENT_ACCEPT_SRVCCOST 

				SET
						 TOTAMT = :vo.totamt
  						,SRVC_AMT = :vo.srvc_amt
  						,ADDTNL_AMT = :vo.addtnl_amt
  						,DC_RATE = :vo.dc_rate
						,PLND_REMIT_AMT	= :vo.plnd_remit_amt	     
						,USD_AMT	    = :vo.usd_amt	         
						,TOT_REMIT_AMT  = :vo.tot_remit_amt       
						,REMITDAY	    = :vo.remitday	         
						,MOD_DT	   		= SYSDATE	 
						,MOD_ID	   		= :vo.mod_id	 
						,MOD_NM	   		= :vo.mod_nm	 
				
				WHERE   ACPT_NO = :vo.acpt_no
				AND 	INTNL_DEPT_CD = :vo.intnl_dept_cd

   
    ]]>
  </statement>
</query>

    </queries>
</queryservice>