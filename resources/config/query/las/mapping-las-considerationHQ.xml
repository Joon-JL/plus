<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.1.dtd">

<queryservice>
    <queries>
    	
    	<query id="las.contractmanager.listConsiderationHQ" isCamelCase="false" comment="HQ 검토의뢰 목록" >
		  <statement>
		    <![CDATA[
			SELECT 
				Z1.CNSDREQ_ID
			     , Z1.CNTRT_ID
			     , REQ_TITLE
			     , REQMAN_NM
			     , CASE WHEN CHARINDEX('(', REQ_DEPT_NM ) > 0 THEN SUBSTRING(REQ_DEPT_NM, 1, CHARINDEX('(', REQ_DEPT_NM )-1) + '<BR>' + SUBSTRING(REQ_DEPT_NM, CHARINDEX('(', REQ_DEPT_NM ),LEN(REQ_DEPT_NM))
			                                             ELSE REQ_DEPT_NM
			       END AS REQ_DEPT_NM
			     , REQ_DEPT_NM AS REQ_DEPT_NM_1
			     , REPLACE(REQ_DT, ' ', '<BR>') AS REQ_DT
			     , REQ_DT AS REQ_DT_1
			     , PLNDBN_REQ_YN
			     , RM
			     , MN_CNSD_DEPT
			     , PRCS_DEPTH
			     , DEPTH_STATUS
			     , CNTRT_OPPNT_NM
			     , TYPE_NM
			     , REPLACE(TYPE_NM,'<BR>','') AS TYPE_NM_1
			     , CAST(TOTAL_CNT AS NUMERIC) TOTAL_CNT
			     , PRCS_DEPTH_NM
			     , DEPTH_STATUS_NM
			     , CASE WHEN :vo.session_user_locale = 'ko' THEN
			     			 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + '완료)'
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + '요청)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + '요청)'
			                                     END
			                                END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '<BR>(반려)'
			                      ELSE LAW_STATUS_NM
			                 END
			            WHEN :vo.session_user_locale = 'fr' THEN
			     			 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Compléter)'
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Demander)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Demander)'
			                                     END
			                                END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '<BR>(Refuser)'
			                      ELSE LAW_STATUS_NM
			                 END
			            WHEN :vo.session_user_locale = 'de' THEN
			     			 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Abschließen)'
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Antrag)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Antrag)'
			                                     END
			                                END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '<BR>(Ablehnen)'
			                      ELSE LAW_STATUS_NM
			                 END
			            ELSE
			                 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Complete)'
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Request)'
			                                     END
			                                ELSE 
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '<BR>(' + ISNULL(VC_CNSD_DEPT_NM,'') + 'Request)'
			                                END
			                           END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '<BR>(Reject)'
			                      ELSE LAW_STATUS_NM
			                 END
			       END AS LAW_STATUS_NM
			     , CASE WHEN :vo.session_user_locale = 'ko' THEN
			     			 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + '완료)'
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + '요청)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + '요청)'
			                                     END
			                                END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '(반려)'
			                      ELSE LAW_STATUS_NM
			                 END
			            WHEN :vo.session_user_locale = 'fr' THEN
			     			 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Compléter)'
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Demander)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Demander)'
			                                     END
			                                END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '(Refuser)'
			                      ELSE LAW_STATUS_NM
			                 END
			            WHEN :vo.session_user_locale = 'de' THEN
			     			 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Abschließen)'
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Antrag)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Antrag)'
			                                     END
			                                END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '(Ablehnen)'
			                      ELSE LAW_STATUS_NM
			                 END
			            ELSE
			                 CASE WHEN LAW_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR LAW_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Complete)'
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Request)'
			                                     END
			                                ELSE 
			                                     CASE WHEN IP_STATUS = 'C04305' THEN LAW_STATUS_NM
			                                          ELSE LAW_STATUS_NM + '(' + VC_CNSD_DEPT_NM + 'Request)'
			                                END
			                           END
			                      WHEN LAW_STATUS_NEW = 'C04225' AND MAX(Z2.SEQNO) IS NOT NULL THEN LAW_STATUS_NM + '(Reject)'
			                      ELSE LAW_STATUS_NM
			                 END
			       END AS LAW_STATUS_NM_1
			     , CASE WHEN :vo.session_user_locale = 'ko' THEN
			     			 CASE WHEN IP_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR IP_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN IP_STATUS_NM
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + '요청)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + '완료)'
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + '요청)'
			                                     END
			                           END
			                      WHEN IP_STATUS_NEW = 'C04225' AND MAX(Z3.SEQNO) IS NOT NULL THEN IP_STATUS_NM + '<BR>(반려)'
			                      ELSE IP_STATUS_NM
			                 END 
			            WHEN :vo.session_user_locale = 'fr' THEN
			     			 CASE WHEN IP_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR IP_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN IP_STATUS_NM
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Demander)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Compléter)'
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Demander)'
			                                     END
			                           END
			                      WHEN IP_STATUS_NEW = 'C04225' AND MAX(Z3.SEQNO) IS NOT NULL THEN IP_STATUS_NM + '<BR>(Refuser)'
			                      ELSE IP_STATUS_NM
			                 END
			            WHEN :vo.session_user_locale = 'de' THEN
			     			 CASE WHEN IP_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR IP_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN IP_STATUS_NM
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Antrag)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Abschließen)'
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Antrag)'
			                                     END
			                           END
			                      WHEN IP_STATUS_NEW = 'C04225' AND MAX(Z3.SEQNO) IS NOT NULL THEN IP_STATUS_NM + '<BR>(Ablehnen)'
			                      ELSE IP_STATUS_NM
			                 END
			            ELSE
			                 CASE WHEN IP_STATUS_NEW IN ('C04204') AND (VC_DEMND_YN = 'Y' OR IP_STATUS = 'C04305') THEN
			                           CASE WHEN MN_CNSD_DEPT IN ('A00000003') THEN
			                                     CASE WHEN LAW_STATUS = 'C04305' THEN IP_STATUS_NM
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Request)'
			                                     END
			                                ELSE
			                                     CASE WHEN IP_STATUS = 'C04305' THEN IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Complete)'
			                                          ELSE IP_STATUS_NM + '<BR>(' + VC_CNSD_DEPT_NM + 'Request)'
			                                     END
			                           END
			                      WHEN IP_STATUS_NEW = 'C04225' AND MAX(Z3.SEQNO) IS NOT NULL THEN IP_STATUS_NM + '<BR>(Reject)'
			                      ELSE IP_STATUS_NM
			                 END
			       END AS IP_STATUS_NM
			     , MN_CNSD_DEPT_NM
			     , LAW_STATUS
			     , IP_STATUS
			     , LVL
			     , VC_DEMND_YN
			     , VC_CNSD_DEPT
			     , VC_CNSD_DEPT_NM
			     , CNTRT_CNT
			     , CNTRT_RESPMAN_NM
			     , CNTRT_RESP_DEPT_NM
			     , PRGRS_STATUS
			     , CASE WHEN PRGRS_STATUS IN ('C04206', 'C04209', 'C04202', 'C04203', 'C04208', 'C04209') THEN PRGRS_STATUS_NM
			            ELSE
			                 CASE WHEN :vo.session_user_locale = 'ko' THEN
			                 		   CASE WHEN PLNDBN_REQ_YN = 'Y' THEN PRGRS_STATUS_NM + '<BR>(최종)'
			                                ELSE PRGRS_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + '차)'
			                           END
			                      ELSE
			                           CASE WHEN PLNDBN_REQ_YN = 'Y' THEN PRGRS_STATUS_NM + '<BR>(Final)'
			                                ELSE
			                                     CASE WHEN LVL = '1' THEN PRGRS_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'st)'
			                                          WHEN LVL = '2' THEN PRGRS_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'nd)'
			                                          WHEN LVL = '3' THEN PRGRS_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'rd)'
			                                          ELSE PRGRS_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'th)'
			                                     END 
			                           END
			                 END
			       END AS PRGRS_STATUS_NM
			       /* 엑셀다운로드 용 */
			       , CASE WHEN PRGRS_STATUS IN ('C04206', 'C04209', 'C04202', 'C04203', 'C04208', 'C04209') THEN PRGRS_STATUS_NM
			            ELSE
			                 CASE WHEN :vo.session_user_locale = 'ko' THEN
			                 		   CASE WHEN PLNDBN_REQ_YN = 'Y' THEN PRGRS_STATUS_NM + '(최종)'
			                                ELSE PRGRS_STATUS_NM + '(' + CAST(LVL AS NVARCHAR) + '차)'
			                           END
			                      ELSE
			                           CASE WHEN PLNDBN_REQ_YN = 'Y' THEN PRGRS_STATUS_NM + '(Final)'
			                                ELSE
			                                     CASE WHEN LVL = '1' THEN PRGRS_STATUS_NM + '(' + CAST(LVL AS NVARCHAR) + 'st)'
			                                          WHEN LVL = '2' THEN PRGRS_STATUS_NM + '(' + CAST(LVL AS NVARCHAR) + 'nd)'
			                                          WHEN LVL = '3' THEN PRGRS_STATUS_NM + '(' + CAST(LVL AS NVARCHAR) + 'rd)'
			                                          ELSE PRGRS_STATUS_NM + '(' + CAST(LVL AS NVARCHAR) + 'th)'
			                                     END
			                           END
			                 END
			       END AS PRGRS_STATUS_NM_1
			       
			     , HQ_CNSD_STATUS AS HQ_CNSD_STATUS
			    , CASE WHEN HQ_CNSD_STATUS IN ('C16201', 'C16202',  'C16204', 'C16205', 'C16206') THEN HQ_CNSD_STATUS_NM
			            ELSE
                            CASE WHEN LVL = '1' THEN HQ_CNSD_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'st)'
			                                          WHEN LVL = '2' THEN HQ_CNSD_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'nd)'
			                                          WHEN LVL = '3' THEN HQ_CNSD_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'rd)'
			                    ELSE HQ_CNSD_STATUS_NM + '<BR>(' + CAST(LVL AS NVARCHAR) + 'th)'
			                END 
			       END AS HQ_CNSD_STATUS_NM
			       

			       
			     , CNTRT_INFO_GBN
			     , SUBSTRING(MAX(LAW_RESPMAN_NM), 1,LEN(MAX(LAW_RESPMAN_NM))) AS LAW_RESPMAN_NM
			     , CASE WHEN MAX(ISNULL(LAW_RESPMAN_CNT, 0)) > 2 THEN SUBSTRING(SUBSTRING(MAX(LAW_RESPMAN_NM), 1,LEN(MAX(LAW_RESPMAN_NM))), 1, CHARINDEX(',',SUBSTRING(MAX(LAW_RESPMAN_NM), 1,LEN(MAX(LAW_RESPMAN_NM))))-1)
			            ELSE REPLACE(SUBSTRING(MAX(LAW_RESPMAN_NM), 1,LEN(MAX(LAW_RESPMAN_NM))), ', ', '<BR>')
			       END AS LAW_RESPMAN_FNM
			     , MAX(ISNULL(LAW_RESPMAN_CNT, 0))-1 AS LAW_RESPMAN_CNT
		  
			  
			     , (SELECT  CASE WHEN :vo.session_user_locale = 'ko' THEN BB.CD_ABBR_NM 
			     				 WHEN :vo.session_user_locale = 'fr' THEN BB.CD_ABBR_NM_FRA
			     				 WHEN :vo.session_user_locale = 'de' THEN BB.CD_ABBR_NM_DEU
			     				 ELSE BB.CD_ABBR_NM_ENG END 
			     	FROM	TN_CLM_CONTRACT_MASTER AA
			     			,TB_COM_CD BB
			        WHERE	1=1
			        AND		AA.CNTRT_ID = Z1.CNTRT_ID
			        AND		BB.GRP_CD = 'COMP2'
			        AND		AA.COMP_CD = BB.CD
			        ) COMP_NM
			     , SOLO_YN
			     , MARK_NUM
			     , CASE WHEN Z1.CLOSE_YN = 'Y' THEN 'Closed' 
			     		  ELSE ''
			      END AS CLOSE_YN
			     
			     , SUBSTRING(MAX(HQ_RESPMAN_NM), 1,LEN(MAX(HQ_RESPMAN_NM))) AS HQ_RESPMAN_NM
			     , CASE WHEN MAX(ISNULL(RESP_NUM_HQ, 0)) > 2 THEN SUBSTRING(SUBSTRING(MAX(HQ_RESPMAN_NM), 1,LEN(MAX(HQ_RESPMAN_NM))), 1, CHARINDEX(',',SUBSTRING(MAX(HQ_RESPMAN_NM), 1,LEN(MAX(HQ_RESPMAN_NM))))-1)
			            ELSE REPLACE(SUBSTRING(MAX(HQ_RESPMAN_NM), 1,LEN(MAX(HQ_RESPMAN_NM))), ', ', '<BR>')
			       END AS HQ_RESPMAN_FNM		
			     , MAX(ISNULL(RESP_NUM_HQ, 0))-1 AS RESP_NUM_HQ 	     
			     
			     , HQ_CNSDREQ_ID 
			     , HQ_CNSD_LEVEL
			      
			  FROM (
			  
			  		SELECT * FROM DBO.[LAS.CONTRACTMANAGER.LISTCONSIDERATION_HQ](
			  			:vo.session_user_locale ,
						:vo.session_blngt_orgnz ,
						:vo.srch_start_dt ,
						:vo.srch_end_dt ,
						:vo.session_user_id ,
						:vo.user_id ,
						:vo.page_flag ,
						:vo.srch_req_title ,
						:vo.srch_cnsd_cont ,
						:vo.srch_orgnz ,
						:vo.srch_reqman_nm ,
						:vo.srch_owner_dept ,
						:vo.srch_respman_nm ,
						:vo.srch_hq_reqman_nm ,
						:vo.sElComp ,
						:vo.session_auth_comp_cd ,
						:vo.srch_solo_yn ,
						:vo.top_role ,
						:vo.srch_cntrt_oppnt_nm ,
						:vo.srch_biz_depth ,
						:vo.srch_cnclsnpurps ,
						:vo.srch_type_cd ,
						:vo.srch_prgrs_status ,
						:vo.srch_prgrs_status_hq ,
						:vo.srch_law_status ,
						:vo.srch_ip_status ,
						:vo.start_index ,
						:vo.end_index,
						:vo.session_related_products
						) 
			       ) Z1 LEFT OUTER JOIN
			     TH_CLM_CONTRACT_DEPTCNSDREJCT Z2 
			     ON Z1.CNSDREQ_ID = Z2.CNSDREQ_ID
			   		AND Z1.CNTRT_ID = Z2.CNTRT_ID
			   		AND Z1.MN_CNSD_DEPT = Z2.CNSD_DEPT
			     
			     LEFT OUTER JOIN
			     TH_CLM_CONTRACT_DEPTCNSDREJCT Z3
			 	 ON Z1.CNSDREQ_ID = Z3.CNSDREQ_ID
			   		AND Z1.CNTRT_ID = Z3.CNTRT_ID
			   		AND Z1.MN_CNSD_DEPT = Z3.CNSD_DEPT
		   		
			 GROUP BY Z1.CNSDREQ_ID ,Z1.CNTRT_ID, REQ_TITLE ,REQMAN_NM ,REQ_DEPT_NM ,REQ_DT ,PLNDBN_REQ_YN, RM
			        , MN_CNSD_DEPT ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,TYPE_NM
			        , PRCS_DEPTH_NM ,DEPTH_STATUS_NM ,LAW_STATUS_NM ,IP_STATUS_NM ,MN_CNSD_DEPT_NM
			        , LAW_STATUS ,IP_STATUS ,LVL ,VC_DEMND_YN ,VC_CNSD_DEPT ,VC_CNSD_DEPT_NM
			        , CNTRT_CNT ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,PRGRS_STATUS ,PRGRS_STATUS_NM
			        , CNTRT_INFO_GBN ,LAW_STATUS_NEW ,IP_STATUS_NEW, SOLO_YN, TOTAL_CNT, MARK_NUM, CLOSE_YN,HQ_CNSD_STATUS,HQ_CNSD_STATUS_NM, HQ_CNSDREQ_ID , HQ_CNSD_LEVEL
			 ORDER BY RM ASC
            ]]>
            </statement>
        </query>
        
        
        
        <query id="las.contractmanager.detailConsiderationHQ" isCamelCase="false" comment="HQ 검토의뢰 상세 ">
		  <statement>
		    <![CDATA[
							SELECT 							
										HQ_CNSDREQ_ID   ,
										CNSDREQ_ID  ,
										CNTRT_ID  ,
										CNSD_LEVEL ,

										CASE CNSD_LEVEL%2 
											WHEN 0 THEN 'Y' 
											ELSE  'N'
										END AS HQ_RESP_YN,
										
										CASE WHEN HQ_CNSD_STATUS IN ('C16203' , 'C16206' ) THEN 'MODIFY' /* 배정완료, 반려시 */		
											ELSE 'DOWNLOAD'
										END AS EDIT_VIEW,
										
										CASE 
													WHEN CNSD_LEVEL%2 = 1 THEN 
													 		CNSD_LEVEL + 1
													ELSE  
															CNSD_LEVEL
										END AS NEXT_LEVEL ,
										
										CASE 
													WHEN CNSD_LEVEL%2 = 1 THEN 
													 		CNSD_LEVEL 
													ELSE  
															CNSD_LEVEL - 1
										END AS CNSD_LEVEL_REQ ,										
										
										COMP_CD  ,
										COMP_NM ,  
										PREV_HQ_CNSDREQ_ID ,  
										HQ_REQ_TITLE , 
										HQ_CNSD_DEMND_CONT , 
										REQMAN_ID  ,
										REQMAN_NM ,  
										REQ_DEPT ,  
										REQ_DEPT_NM , 
										REQ_DT , 
										REBFR_APPRVL_YN , 
										RE_DT , 
										PRODUCT_GBN ,  
										HQ_CNSDMAN_ID ,
										HQ_CNSDMAN_NM , 
										HQ_CNSD_DT , 
										HQ_CNSD_STATUS ,
										HQ_CNSD_OPNN ,
										HQ_CE_CNSDMAN_ID , 
										HQ_CE_CNSDMAN_NM , 
										HQ_CE_CNSD_DT ,
										HQ_CE_CNSD_OPNN , 
										HQ_IM_CNSDMAN_ID , 
										HQ_IM_CNSDMAN_NM , 
										HQ_IM_CNSD_DT ,
										HQ_IM_CNSD_OPNN , 
										HQ_NOT_CNSDMAN_ID , 
										HQ_NOT_CNSDMAN_NM ,  
										HQ_NOT_CNSD_DT ,
										HQ_NOT_CNSD_OPNN ,  
										HQ_APBTMAN_ID ,  
										HQ_APBTMAN_NM , 
										HQ_APBT_DT,
										HQ_REL_PRO,
										HQ_APBT_OPNN,
										HQ_REJ_OPNN,
										
										CE_RESP_YN,
										IM_RESP_YN, 
										HQ_APBT_MEMO
												
							FROM  
							
										TN_CLM_HQ_CONT_CNSDREQ 
							
							WHERE 
								
								HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
								
								AND 		CNSD_LEVEL = :vo.cnsd_level
								
							/*	AND 		CNSD_LEVEL = ( SELECT MAX(CNSD_LEVEL) FROM TN_CLM_HQ_CONT_CNSDREQ WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id )  */ 
        		
        		     ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.listRespmanHQ" isCamelCase="false" comment="담당자 리스트 ">
		  <statement>
		    <![CDATA[
		    
		    SELECT 
				C.RESPMAN_ID AS LIST_RESPMAN_ID, 				
				
				/* DECODE(C.MAIN_CNSD_YN, 'Y', '[正]', 'N', '[副]') + A.USER_NM AS LIST_RESPMAN_NM, */
				CASE 		    	
	    			 WHEN :vo.session_user_locale = 'en' THEN 
	    				CASE 
							WHEN C.MAIN_CNSD_YN = 'Y' THEN '[O]' + A.USER_NM_ENG 
							ELSE   '[S]' + A.USER_NM_ENG 
						END			  
					ELSE
						CASE 
							WHEN C.MAIN_CNSD_YN = 'Y' THEN '[O]' + A.USER_NM_ENG 
							ELSE   '[S]' + A.USER_NM_ENG 
						END	  			
	    		END AS LIST_RESPMAN_NM,
	    		
	    		/* DECODE(C.MAIN_CNSD_YN, 'Y', '[正]', 'N', '[副]') + A.USER_NM_ENG AS LIST_RESPMAN_NM_ENG */
	    		CASE 
					WHEN C.MAIN_CNSD_YN = 'Y' THEN '[O]' + A.USER_NM_ENG 
					ELSE   '[S]' + A.USER_NM_ENG 
				END	AS LIST_RESPMAN_NM_ENG	
				
			FROM 
				TB_COM_USER A,
				TN_CLM_HQ_CONT_CNSDREQ B,
				TN_CLM_HQ_CONT_CNSDREQ_RESPMAN C
			WHERE A.USER_ID = C.RESPMAN_ID
			 AND B.CNSD_LEVEL = (SELECT MAX(CNSD_LEVEL)  FROM TN_CLM_HQ_CONT_CNSDREQ WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id )
			  AND C.HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
			  AND B.HQ_CNSDREQ_ID = C.HQ_CNSDREQ_ID
			
			ORDER BY C.MAIN_CNSD_YN DESC		    		    
		
		    ]]>
		  </statement>
		</query>
        
        
        <query id="las.contractmanager.popRespmanHQ" isCamelCase="false" comment="담당자 리스트[팝업] ">
		  <statement>
		    <![CDATA[
						SELECT 
				A.USER_ID AS RESPMAN_ID, 
				A.RELATED_PRODUCTS,
				
				CASE 
	    			WHEN  A.RELATED_PRODUCTS = 'RP0201' THEN 'CE'    
	    			WHEN  A.RELATED_PRODUCTS = 'RP0202' THEN 'IM'    								    			
	    			ELSE  ''
	    		END AS RELATED_PRODUCTS_NM,
	    		
				A.USER_NM_ENG AS RESPMAN_NM_ENG,				

				CASE 
	    			WHEN A.USER_NM = '' THEN A.USER_NM_ENG		    						    			
	    			ELSE  A.USER_NM
	    		END AS RESPMAN_NM,
				A.USER_NM_ENG AS RESPMAN_NM_ENG,
				
				J.CD AS RESPMAN_DIVISION_CD,				
			
				CASE 	
	    			WHEN J.CD_NM_ENG = '' THEN J.CD_NM
	    			ELSE  J.CD_NM_ENG 
	    		END AS RESPMAN_DIVISION_NM,				
				J.CD_NM_ENG AS RESPMAN_DIVISION_NM_ENG,
				
				CASE 	
	    			WHEN A.JIKGUP_NM_ENG = '' THEN A.JIKGUP_NM		    						    			
	    			ELSE A.JIKGUP_NM_ENG 
	    		END AS RESPMAN_JIKGUP_NM,	
				
				A.JIKGUP_NM_ENG AS RESPMAN_JIKGUP_NM_ENG,
			
				ISNULL(D.CNSDREQ_CNT, 0) AS DAY_CNT,
				ISNULL(E.CNSDREQ_CNT, 0) AS WEEK_CNT,
				ISNULL(F.CNSDREQ_CNT, 0) AS MONTH_CNT,
				ISNULL(G.CNSDREQ_CNT, 0) AS YEAR_CNT,
				COUNT(H.HQ_CNSDREQ_ID) AS CNSD_CNT,

				CASE WHEN C.RESPMAN_ID IS NOT NULL AND C.RESPMAN_ID <> '' THEN 'Y' ELSE 'N' END  AS CHECK_YN,				
				C.MAIN_CNSD_YN,
				
				CASE WHEN 'en' = 'ko' THEN
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN '正' WHEN C.MAIN_CNSD_YN = 'N' THEN '副' END
				WHEN 'en' = 'fr' THEN
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN 'O' WHEN C.MAIN_CNSD_YN = 'N' THEN 'S' END
				WHEN 'en' = 'de' THEN
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN 'O' WHEN C.MAIN_CNSD_YN = 'N' THEN 'S' END
				ELSE
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN 'O' WHEN C.MAIN_CNSD_YN = 'N' THEN 'S' END
				END AS MAIN_CNSD_YN_DP
				
				,B.ROLE_CD
			
			FROM 
				TB_COM_USER A 
				JOIN
				TB_COM_ROLE_USER B 
				ON  A.USER_ID = B.USER_ID

				LEFT OUTER  JOIN
				(SELECT * FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id ) C
				ON A.USER_ID = C.RESPMAN_ID

				LEFT OUTER JOIN		  	(
				
					SELECT A.RESPMAN_ID, 
				 			COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
					 FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN A,
				 		  TN_CLM_HQ_CONT_CNSDREQ B
					 WHERE REPLACE(CONVERT(CHAR(10), A.ASGN_DT, 23),'-','') = REPLACE(CONVERT(CHAR(10), GETDATE(), 23),'-','') /*YYYYMMDD*/
					   AND A.MAIN_CNSD_YN = 'Y'
					   AND A.HQ_CNSDREQ_ID = B.HQ_CNSDREQ_ID
					 GROUP BY A.RESPMAN_ID
				
				) D ON A.USER_ID = D.RESPMAN_ID

				 LEFT OUTER JOIN (
				 
					 SELECT A.RESPMAN_ID, 
				 			COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
					 FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN A,
				 		  TN_CLM_HQ_CONT_CNSDREQ B
					 WHERE A.ASGN_DT BETWEEN dbo.GREATES ( CONVERT(VARCHAR, YEAR(GETDATE())) + '0101' ,  CONVERT(VARCHAR, REPLACE(CONVERT(DATE, DATEADD(D, -7, GETDATE())), '-', ''))  )
										 AND REPLACE(CONVERT(VARCHAR, GETDATE(), 23),'-','')
					   AND A.MAIN_CNSD_YN = 'Y'
					   AND A.HQ_CNSDREQ_ID = B.HQ_CNSDREQ_ID
					 GROUP BY A.RESPMAN_ID
					 
				) E ON A.USER_ID = E.RESPMAN_ID

				LEFT OUTER JOIN (
						
					SELECT A.RESPMAN_ID, 
				 				COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
					FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN A,
				 		TN_CLM_HQ_CONT_CNSDREQ B
					WHERE A.ASGN_DT BETWEEN dbo.GREATES ( CONVERT(VARCHAR, YEAR(GETDATE())) + '0101' ,  CONVERT(VARCHAR, REPLACE(CONVERT(DATE, DATEADD(D, -1, GETDATE())), '-', ''))  )
										AND REPLACE(CONVERT(VARCHAR, GETDATE(), 23),'-','')
					AND A.MAIN_CNSD_YN = 'Y'
					AND A.HQ_CNSDREQ_ID = B.HQ_CNSDREQ_ID
					GROUP BY A.RESPMAN_ID
				
				) F ON A.USER_ID = F.RESPMAN_ID

				 LEFT OUTER JOIN
				 (SELECT RESPMAN_ID, 
				 		 COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
				 FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN A,
				 	  TN_CLM_HQ_CONT_CNSDREQ B
				 WHERE A.ASGN_DT BETWEEN dbo.GREATES ( CONVERT(VARCHAR, YEAR(GETDATE())) + '0101' ,  CONVERT(VARCHAR, REPLACE(CONVERT(DATE, DATEADD(D, -12, GETDATE())), '-', ''))  )
				                     AND REPLACE(CONVERT(VARCHAR, GETDATE(), 23),'-','')
				   AND A.MAIN_CNSD_YN = 'Y'
				   AND A.HQ_CNSDREQ_ID = B.HQ_CNSDREQ_ID
				 GROUP BY A.RESPMAN_ID) G
				 ON A.USER_ID = G.RESPMAN_ID

				 LEFT OUTER JOIN (
					
					SELECT A.RESPMAN_ID, A.RESP_DEPT, A.HQ_CNSDREQ_ID
				    FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN A 
					
						LEFT OUTER JOIN TN_CLM_HQ_CONT_CNSDREQ I ON A.HQ_CNSDREQ_ID = I.HQ_CNSDREQ_ID
				   WHERE 
				   
			  		  (I.HQ_CNSD_STATUS IS NULL OR I.HQ_CNSD_STATUS IN ('C16202', 'C16203'))
					  				 
				   GROUP BY A.RESPMAN_ID, A.RESP_DEPT, A.HQ_CNSDREQ_ID
				 
				) H ON A.USER_ID = H.RESPMAN_ID

				   LEFT OUTER JOIN
				   (SELECT * FROM TB_COM_CD WHERE SYS_CD = 'LAS' 
								
				   ) J 
				   ON A.RESP_OPERDIV = J.CD				 
			
			WHERE B.SYS_CD = 'LAS'
			
			   AND  B.ROLE_CD = 'HQ02'  
			   				
			    #if($vo.hq_rel_pro.equals("RP010"))
					AND A.RELATED_PRODUCTS = 'RP0201'
			   #end 
			   
			   #if($vo.hq_rel_pro.equals("RP020"))
					AND A.RELATED_PRODUCTS = 'RP0202'
			   #end 
			   
			   #if($vo.hq_rel_pro.equals("RP030"))
					AND A.RELATED_PRODUCTS IN ('RP0201' , 'RP0202' )
			   #end 
			 
			   #if($vo.hq_rel_pro.equals("RP040"))
					AND A.RELATED_PRODUCTS IN ('RP0201' , 'RP0202' )
			   #end 

			   #if($vo.hq_rel_pro.equals("DS"))
					AND A.RELATED_PRODUCTS = 'RP0203' 
			   #end 
		
		GROUP BY A.USER_ID, A.USER_NM, A.USER_NM_ENG
				, A.DIVISION_NM, A.DIVISION_NM_ENG
				, A.JIKGUP_NM, A.JIKGUP_NM_ENG
				, J.CD, J.CD_NM, J.CD_NM_ENG, J.CD_ORDER
				, D.CNSDREQ_CNT, E.CNSDREQ_CNT, F.CNSDREQ_CNT, G.CNSDREQ_CNT
				, C.RESPMAN_ID, C.MAIN_CNSD_YN, A.USER_SRT, B.ROLE_CD, A.RELATED_PRODUCTS
			
			 #if($vo.hq_rel_pro.equals("RP030") || $vo.hq_rel_pro.equals("RP040") )
				
				 #if($vo.session_related_products.equals("RP0201"))
						ORDER BY  J.CD_ORDER, A.RELATED_PRODUCTS, A.USER_SRT
				 #end 
				 
				 #if($vo.session_related_products.equals("RP0202"))
						ORDER BY  J.CD_ORDER, A.RELATED_PRODUCTS DESC, A.USER_SRT
				 #end 
			 
			 #end 
			 
			 #if($vo.hq_rel_pro.equals("RP010") || $vo.hq_rel_pro.equals("RP020") )
					ORDER BY  J.CD_ORDER, A.USER_SRT			 
			 #end 
		
		
		
		    ]]>
		  </statement>
		</query>
		
		 <query id="las.contractmanager.deleteRespmanHQ" isCamelCase="false" comment="HQ 검토의뢰_담당자 삭제">
            <statement>
	            <![CDATA[
		            
		            DELETE TN_CLM_HQ_CONT_CNSDREQ_RESPMAN
		            WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
		            /* AND RESP_DEPT = :vo.session_blngt_orgnz */
	            
	            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.insertRespmanHQ" isCamelCase="false" comment="HQ 검토의뢰_담당자 입력">
            <statement>
            <![CDATA[
			
				INSERT INTO TN_CLM_HQ_CONT_CNSDREQ_RESPMAN  
							(
									RESPMAN_ID ,
									HQ_CNSDREQ_ID ,
									CNSD_LEVEL ,
									RESP_DEPT ,
									ASGN_DT ,
									ASGNMAN_ID ,
									ASGNMAN_NM ,
									RESPMAN_NM ,
									RESPMAN_JIKGUP_NM ,
									MAIN_CNSD_YN ,
									APBT_MEMO 
					        ) VALUES (					          
					             :vo.list_respmanHQ_id
					           , :vo.hq_cnsdreq_id
							   , :vo.cnsd_level
							   , 'HQ'
					          ,  GETDATE()
					          ,  :vo.mod_id
					          ,  :vo.mod_nm
							  ,  (SELECT USER_NM FROM TB_COM_USER WHERE USER_ID = :vo.list_respmanHQ_id)
					          ,  (SELECT GRP_JIKGUP_NM FROM TB_COM_USER WHERE USER_ID = :vo.list_respmanHQ_id)
					          ,  CASE :vo.list_respmanHQ_id
					              WHEN :vo.main_man_id THEN 'Y'
					            ELSE
					              'N'
					            END
					          ,:vo.apbt_memo
					        )
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.updateHQstatus2" isCamelCase="false" comment="HQ 검토의뢰상태 갱신">
            <statement>
            <![CDATA[           	        
        
        					UPDATE 	TN_CLM_HQ_CONT_CNSDREQ 
        						SET		HQ_CNSD_STATUS = :vo.hq_cnsd_status ,
        									CE_RESP_YN = :vo.ce_resp_yn,
        									IM_RESP_YN = :vo.im_resp_yn,
        									HQ_APBT_MEMO = :vo.hq_apbt_memo
        									
								WHERE  
											HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
								AND 		CNSD_LEVEL = :vo.cnsd_level 
            ]]>
            </statement>
        </query>
        
          <query id="las.contractmanager.updateHQstatus" isCamelCase="false" comment="HQ 검토의뢰상태 갱신">
            <statement>
            <![CDATA[           	        
        
        					UPDATE 	TN_CLM_HQ_CONT_CNSDREQ 
        						SET		HQ_CNSD_STATUS = :vo.hq_cnsd_status
        									
        									
								WHERE  
											HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
								AND 		CNSD_LEVEL = :vo.cnsd_level 
            ]]>
            </statement>
        </query>
        
         <!-- Admin replied  테이블 에 리턴 사유 및 리턴자 ID 저장 -->        
         <query id="las.contractmanager.set_rtn_reason_hq" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
		    		INSERT INTO TN_CLM_HQ_CONT_CNSDREQ_ADMRETURN
							           (HQ_CNSDREQ_ID
							           ,CNSD_LEVEL
							           ,RET_SEQNO
							           ,RET_STARTDAY
							           ,RET_ENDDAY
							           ,RET_CAUSE
							           ,REG_ID
							           ,REG_NM
							           ,REG_DT
							           ,MOD_ID
							           ,MOD_NM
							           ,MOD_DT
							           )
    							VALUES
						           (
						           	 :vo.hq_cnsdreq_id    		
						           , :vo.cnsd_level + 1
						           , (SELECT ISNULL(MAX(RET_SEQNO),'0') + 1 AS SEQNO FROM TN_CLM_HQ_CONT_CNSDREQ_ADMRETURN WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id   )
						           ,''
						           ,''
						           ,:vo.rtn_cont
						           ,:vo.session_user_id
						           ,:vo.session_user_nm
						           ,GETDATE()
						           ,''
						           ,''
						           ,''	
									)
                ]]>
            </statement>
        </query>
       
       <query id="las.contractmanager.HQ_APPR" isCamelCase="false" comment="HQ ADMIN 승인 의견 저장">
            <statement>
            <![CDATA[           	        
        
        					UPDATE 	TN_CLM_HQ_CONT_CNSDREQ 
        						SET		        						
        									HQ_APBTMAN_ID = :vo.session_user_id,
											HQ_APBTMAN_NM = :vo.session_user_nm,
											HQ_APBT_DT = GETDATE(),
											HQ_APBT_OPNN = :vo.rtn_cont,
											
											HQ_REJMAN_ID = '',
											HQ_REJMAN_NM = '',
											HQ_REJ_OPNN = ''

								WHERE  
											HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
								AND 		CNSD_LEVEL = :vo.cnsd_level 
            ]]>
            </statement>
        </query>
      
       <query id="las.contractmanager.HQ_REJECT" isCamelCase="false" comment="HQ ADMIN 반려 의견 저장 ">
            <statement>
            <![CDATA[           	        
        
        					UPDATE 	TN_CLM_HQ_CONT_CNSDREQ 
        						SET		        						
        									HQ_REJMAN_ID = :vo.session_user_id,
											HQ_REJMAN_NM = :vo.session_user_nm,
											HQ_REJ_DT = GETDATE(),
											HQ_REJ_OPNN = :vo.rtn_cont,
											
											HQ_APBTMAN_ID = '' ,
											HQ_APBTMAN_NM = '' ,
											HQ_APBT_DT = GETDATE(),
											HQ_APBT_OPNN = '' 

								WHERE  
											HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
								AND 		CNSD_LEVEL = :vo.cnsd_level 
            ]]>
            </statement>
        </query>
 
       <query id="las.contractmanager.getNextCnsdLevel" isCamelCase="false" comment="next seq 조회">
            <statement>
            <![CDATA[           	        
        
        				SELECT ISNULL(MAX(CNSD_LEVEL),0) + 1 AS NEXT_CNSD_LEVEL FROM TN_CLM_HQ_CONT_CNSDREQ WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
        	
        	 ]]>
            </statement>
        </query>
        
        
         <query id="las.contractmanager.insertNewHqRow" isCamelCase="false" comment="회신">
            <statement>
            <![CDATA[           	
        
						        INSERT INTO TN_CLM_HQ_CONT_CNSDREQ
						
								 SELECT 
								     HQ_CNSDREQ_ID 
						           , CNSDREQ_ID 
						           , CNTRT_ID 
						           , (SELECT MAX(CNSD_LEVEL) + 1 
						                FROM TN_CLM_HQ_CONT_CNSDREQ 
						               WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id  ) AS CNSD_LEVEL
								   , COMP_CD 
						           , COMP_NM 
						           , PREV_HQ_CNSDREQ_ID 
						           , HQ_REQ_TITLE 
						           , HQ_CNSD_DEMND_CONT
						           , REQMAN_ID
						           , REQMAN_NM 
						           , REQ_DEPT
						           , REQ_DEPT_NM 
						           , REQ_DT 
						           , REBFR_APPRVL_YN
						           , RE_DT 
						           , PRODUCT_GBN 
						           , HQ_CNSDMAN_ID
						           , HQ_CNSDMAN_NM 
						           , HQ_CNSD_DT 
						           , HQ_CNSD_STATUS
						           , :vo.rtn_cont   AS RTN_CONT
						           
						           	#if($vo.hq_rel_pro.equals("RP010"))
							         
							           , :vo.session_user_id /* HQ_CE_CNSDMAN_ID */ AS HQ_CE_CNSDMAN_ID
							           , :vo.session_user_nm /* HQ_CE_CNSDMAN_NM */ AS HQ_CE_CNSDMAN_NM
							           , GETDATE() /* HQ_CE_CNSD_DT    */ AS HQ_CE_CNSD_DT
							           , :vo.hq_ce_cnsd_opnn /* HQ_CE_CNSD_OPNN  */ AS HQ_CE_CNSD_OPNN
							            
							           , '' /* HQ_IM_CNSDMAN_ID  */ AS HQ_IM_CNSDMAN_ID
							           , '' /* HQ_IM_CNSDMAN_NM  */ AS HQ_IM_CNSDMAN_NM
							           , '' /* HQ_IM_CNSD_DT     */ AS HQ_IM_CNSD_DT
							           , '' /* HQ_IM_CNSD_OPNN   */ AS HQ_IM_CNSD_OPNN
							           
							           , '' /* HQ_NOT_CNSDMAN_ID  */ AS HQ_NOT_CNSDMAN_ID
							           , '' /* HQ_NOT_CNSDMAN_NM  */ AS HQ_NOT_CNSDMAN_NM
							           , '' /* HQ_NOT_CNSD_DT     */ AS HQ_NOT_CNSD_DT
							           , '' /* HQ_NOT_CNSD_OPNN   */ AS HQ_NOT_CNSD_OPNN
			  									  						
			  						#end 
			  						
			  						#if($vo.hq_rel_pro.equals("RP020"))
			  						
			  						   , '' /* HQ_CE_CNSDMAN_ID */ AS HQ_CE_CNSDMAN_ID
							           , '' /* HQ_CE_CNSDMAN_NM */ AS HQ_CE_CNSDMAN_NM
							           , '' /* HQ_CE_CNSD_DT    */ AS HQ_CE_CNSD_DT
							           , '' /* HQ_CE_CNSD_OPNN  */ AS HQ_CE_CNSD_OPNN
							         
							           , :vo.session_user_id /* HQ_IM_CNSDMAN_ID */ AS HQ_IM_CNSDMAN_ID
							           , :vo.session_user_nm /* HQ_IM_CNSDMAN_NM */ AS HQ_IM_CNSDMAN_NM
							           , GETDATE() /* HQ_IM_CNSD_DT    */ AS HQ_IM_CNSD_DT
							           , :vo.hq_im_cnsd_opnn /* HQ_IM_CNSD_OPNN  */ AS HQ_IM_CNSD_OPNN
							           
							           , '' /* HQ_NOT_CNSDMAN_ID  */ AS HQ_NOT_CNSDMAN_ID
							           , '' /* HQ_NOT_CNSDMAN_NM  */ AS HQ_NOT_CNSDMAN_NM
							           , '' /* HQ_NOT_CNSD_DT     */ AS HQ_NOT_CNSD_DT
							           , '' /* HQ_NOT_CNSD_OPNN   */ AS HQ_NOT_CNSD_OPNN
			  									  						
			  						#end
			  						
			  						#if($vo.hq_rel_pro.equals("RP030"))
			  						
							           , :vo.session_user_id /* HQ_CE_CNSDMAN_ID */ AS HQ_CE_CNSDMAN_ID
							           , :vo.session_user_nm /* HQ_CE_CNSDMAN_NM */ AS HQ_CE_CNSDMAN_NM
							           , GETDATE() /* HQ_CE_CNSD_DT    */ AS HQ_CE_CNSD_DT
							           , :vo.hq_ce_cnsd_opnn /* HQ_CE_CNSD_OPNN  */ AS HQ_CE_CNSD_OPNN
							         
							           , :vo.session_user_id /* HQ_IM_CNSDMAN_ID */ AS HQ_IM_CNSDMAN_ID
							           , :vo.session_user_nm /* HQ_IM_CNSDMAN_NM */ AS HQ_IM_CNSDMAN_NM
							           , GETDATE() /* HQ_IM_CNSD_DT    */ AS HQ_IM_CNSD_DT
							           , :vo.hq_im_cnsd_opnn /* HQ_IM_CNSD_OPNN  */ AS HQ_IM_CNSD_OPNN
							           
							           , '' /* HQ_NOT_CNSDMAN_ID  */ AS HQ_NOT_CNSDMAN_ID
							           , '' /* HQ_NOT_CNSDMAN_NM  */ AS HQ_NOT_CNSDMAN_NM
							           , '' /* HQ_NOT_CNSD_DT     */ AS HQ_NOT_CNSD_DT
							           , '' /* HQ_NOT_CNSD_OPNN   */ AS HQ_NOT_CNSD_OPNN
			  									  						 
			  						#end  
			  						
			  						#if($vo.hq_rel_pro.equals("RP040"))
			  						
			  						   , '' /* HQ_CE_CNSDMAN_ID */ AS HQ_CE_CNSDMAN_ID
							           , '' /* HQ_CE_CNSDMAN_NM */ AS HQ_CE_CNSDMAN_NM
							           , '' /* HQ_CE_CNSD_DT    */ AS HQ_CE_CNSD_DT
							           , '' /* HQ_CE_CNSD_OPNN  */ AS HQ_CE_CNSD_OPNN
							           
							           , '' /* HQ_IM_CNSDMAN_ID  */ AS HQ_IM_CNSDMAN_ID
							           , '' /* HQ_IM_CNSDMAN_NM  */ AS HQ_IM_CNSDMAN_NM
							           , '' /* HQ_IM_CNSD_DT     */ AS HQ_IM_CNSD_DT
							           , '' /* HQ_IM_CNSD_OPNN   */ AS HQ_IM_CNSD_OPNN
							           
							           , :vo.session_user_id /* HQ_NOT_CNSDMAN_ID */ AS HQ_NOT_CNSDMAN_ID
							           , :vo.session_user_nm /* HQ_NOT_CNSDMAN_NM */ AS HQ_NOT_CNSDMAN_NM
							           , GETDATE() /* HQ_NOT_CNSD_DT    */ AS HQ_NOT_CNSD_DT
							           , :vo.hq_not_cnsd_opnn /* HQ_NOT_CNSD_OPNN  */ AS HQ_NOT_CNSD_OPNN
			  						
			  						#end  
			  						
			  						/* admin reply */ 
			  						
			  						#if($vo.hq_rel_pro.equals("ADMIN_REPLY"))  
			  						
			  						   , '' /* HQ_CE_CNSDMAN_ID */ AS HQ_CE_CNSDMAN_ID
							           , '' /* HQ_CE_CNSDMAN_NM */ AS HQ_CE_CNSDMAN_NM
							           , '' /* HQ_CE_CNSD_DT    */ AS HQ_CE_CNSD_DT
							           , '' /* HQ_CE_CNSD_OPNN  */ AS HQ_CE_CNSD_OPNN
							           
							           , '' /* HQ_IM_CNSDMAN_ID  */ AS HQ_IM_CNSDMAN_ID
							           , '' /* HQ_IM_CNSDMAN_NM  */ AS HQ_IM_CNSDMAN_NM
							           , '' /* HQ_IM_CNSD_DT     */ AS HQ_IM_CNSD_DT
							           , '' /* HQ_IM_CNSD_OPNN   */ AS HQ_IM_CNSD_OPNN
							           
							           , '' /* HQ_NOT_CNSDMAN_ID  */ AS HQ_NOT_CNSDMAN_ID
							           , '' /* HQ_NOT_CNSDMAN_NM  */ AS HQ_NOT_CNSDMAN_NM
							           , '' /* HQ_NOT_CNSD_DT     */ AS HQ_NOT_CNSD_DT
							           , '' /* HQ_NOT_CNSD_OPNN   */ AS HQ_NOT_CNSD_OPNN
			  						
			  						#end
						           
						           , HQ_APBTMAN_ID
						           , HQ_APBTMAN_NM 
						           , HQ_APBT_DT 
						           , HQ_APBT_OPNN 
						           
						           , SYS_LAST_GBN
						           , GETDATE()  /* REG_DT */ 
						           , :vo.session_user_id  /* REG_ID */ 
						           , :vo.session_user_nm  /* REG_NM */ 
						           , GETDATE() /* MOD_DT */
						           , '' /* MOD_ID */
						           , ''  /* MOD_NM */
						           , HQ_REL_PRO 
						           , FST_CNSDREQ_ID
						           , FAST_TRACK_DEV 
						           , HQ_REJMAN_ID
						           , HQ_REJMAN_NM 
						           , HQ_REJ_DT 
						           , HQ_REJ_OPNN
						           , '0' AS CE_RESP_YN
						           , '0' AS IM_RESP_YN
						           , '' AS HQ_APBT_MEMO
								  
								  FROM 
										TN_CLM_HQ_CONT_CNSDREQ 
								  WHERE 
										HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
									AND 
										CNSD_LEVEL = :vo.cnsd_level
				
			 ]]>
            </statement>
        </query>
        
          <query id="las.contractmanager.countHqRow" isCamelCase="false" comment="임시저장구분">
            <statement>
            <![CDATA[        
            
            				SELECT
										 HQ_CNSDREQ_ID,
										 MAX(CNSD_LEVEL) % 2 AS  MODE_LEVEL ,
										 CASE MAX(CNSD_LEVEL) % 2 WHEN 0 THEN 'UPDATE'
											 	 ELSE 'INSERT'
										 END AS WMODE
							FROM 
											TN_CLM_HQ_CONT_CNSDREQ 
							WHERE	
											HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
												
							GROUP BY HQ_CNSDREQ_ID
            
            	 ]]>
            </statement>
        </query>
        
        
        <query id="las.contractmanager.saveHqRow" isCamelCase="false" comment="임시저장">
            <statement>
            <![CDATA[           	
				  
				  UPDATE TN_CLM_HQ_CONT_CNSDREQ 
				  
				  SET 
				  
				  						  MOD_DT =  GETDATE()  /* REG_DT */ 
						           		, MOD_ID = :vo.session_user_id  /* REG_ID */ 
						          	 	, MOD_NM = :vo.session_user_nm  /* REG_NM */ 
				  
			           					#if($vo.hq_rel_pro.equals("RP010"))
							         
							           , HQ_CE_CNSDMAN_ID =  :vo.session_user_id /* HQ_CE_CNSDMAN_ID */
							           , HQ_CE_CNSDMAN_NM =  :vo.session_user_nm /* HQ_CE_CNSDMAN_NM */
							           , HQ_CE_CNSD_DT = GETDATE() /* HQ_CE_CNSD_DT    */
							           , HQ_CE_CNSD_OPNN = :vo.hq_ce_cnsd_opnn /* HQ_CE_CNSD_OPNN  */
							           
							           , HQ_IM_CNSDMAN_ID = '' /* HQ_IM_CNSDMAN_ID  */
							           , HQ_IM_CNSDMAN_NM = '' /* HQ_IM_CNSDMAN_NM  */
							           , HQ_IM_CNSD_DT = '' /* HQ_IM_CNSD_DT     */
							           , HQ_IM_CNSD_OPNN = '' /* HQ_IM_CNSD_OPNN   */
							           
							           , HQ_NOT_CNSDMAN_ID =  '' /* HQ_NOT_CNSDMAN_ID  */
							           , HQ_NOT_CNSDMAN_NM =  '' /* HQ_NOT_CNSDMAN_NM  */
							           , HQ_NOT_CNSD_DT = '' /* HQ_NOT_CNSD_DT     */
							           , HQ_NOT_CNSD_OPNN =  '' /* HQ_NOT_CNSD_OPNN   */
			  									  						
			  						#end 
			  						
			  						#if($vo.hq_rel_pro.equals("RP020"))
			  						
			  						   , HQ_CE_CNSDMAN_ID = '' /* HQ_CE_CNSDMAN_ID */
							           , HQ_CE_CNSDMAN_NM = '' /* HQ_CE_CNSDMAN_NM */
							           , HQ_CE_CNSD_DT    = '' /* HQ_CE_CNSD_DT    */
							           , HQ_CE_CNSD_OPNN  = '' /* HQ_CE_CNSD_OPNN  */
							         
							           , HQ_IM_CNSDMAN_ID = :vo.session_user_id /* HQ_IM_CNSDMAN_ID */
							           , HQ_IM_CNSDMAN_NM = :vo.session_user_nm /* HQ_IM_CNSDMAN_NM */
							           , HQ_IM_CNSD_DT = GETDATE() /* HQ_IM_CNSD_DT    */
							           , HQ_IM_CNSD_OPNN = :vo.hq_im_cnsd_opnn /* HQ_IM_CNSD_OPNN  */
							           
							           , HQ_NOT_CNSDMAN_ID = '' /* HQ_NOT_CNSDMAN_ID  */
							           , HQ_NOT_CNSDMAN_NM = '' /* HQ_NOT_CNSDMAN_NM  */
							           , HQ_NOT_CNSD_DT    = '' /* HQ_NOT_CNSD_DT     */
							           , HQ_NOT_CNSD_OPNN  = '' /* HQ_NOT_CNSD_OPNN   */
			  									  						
			  						#end
			  						
			  						#if($vo.hq_rel_pro.equals("RP030"))
			  						
							           , HQ_CE_CNSDMAN_ID = :vo.session_user_id /* HQ_CE_CNSDMAN_ID */
							           , HQ_CE_CNSDMAN_NM = :vo.session_user_nm /* HQ_CE_CNSDMAN_NM */
							           , HQ_CE_CNSD_DT = GETDATE() /* HQ_CE_CNSD_DT    */
							           , HQ_CE_CNSD_OPNN = :vo.hq_ce_cnsd_opnn /* HQ_CE_CNSD_OPNN  */
							         
							           , HQ_IM_CNSDMAN_ID = :vo.session_user_id /* HQ_IM_CNSDMAN_ID */
							           , HQ_IM_CNSDMAN_NM = :vo.session_user_nm /* HQ_IM_CNSDMAN_NM */
							           , HQ_IM_CNSD_DT = GETDATE() /* HQ_IM_CNSD_DT    */
							           , HQ_IM_CNSD_OPNN = :vo.hq_im_cnsd_opnn /* HQ_IM_CNSD_OPNN  */
							           
							           , HQ_NOT_CNSDMAN_ID = '' /* HQ_NOT_CNSDMAN_ID  */
							           , HQ_NOT_CNSDMAN_NM = '' /* HQ_NOT_CNSDMAN_NM  */
							           , HQ_NOT_CNSD_DT    = '' /* HQ_NOT_CNSD_DT     */
							           , HQ_NOT_CNSD_OPNN  = '' /* HQ_NOT_CNSD_OPNN   */
			  									  						
			  						#end  
			  						
			  						#if($vo.hq_rel_pro.equals("RP040"))
			  						
			  						   , HQ_CE_CNSDMAN_ID = '' /* HQ_CE_CNSDMAN_ID */
							           , HQ_CE_CNSDMAN_NM = '' /* HQ_CE_CNSDMAN_NM */
							           , HQ_CE_CNSD_DT    = '' /* HQ_CE_CNSD_DT    */
							           , HQ_CE_CNSD_OPNN  = '' /* HQ_CE_CNSD_OPNN  */
							           
							           , HQ_IM_CNSDMAN_ID = '' /* HQ_IM_CNSDMAN_ID  */
							           , HQ_IM_CNSDMAN_NM = '' /* HQ_IM_CNSDMAN_NM  */
							           , HQ_IM_CNSD_DT    = '' /* HQ_IM_CNSD_DT     */
							           , HQ_IM_CNSD_OPNN  = '' /* HQ_IM_CNSD_OPNN   */
							           
							           , HQ_NOT_CNSDMAN_ID = :vo.session_user_id /* HQ_NOT_CNSDMAN_ID */
							           , HQ_NOT_CNSDMAN_NM = :vo.session_user_nm /* HQ_NOT_CNSDMAN_NM */
							           , HQ_NOT_CNSD_DT = GETDATE() /* HQ_NOT_CNSD_DT    */
							           , HQ_NOT_CNSD_OPNN = :vo.hq_not_cnsd_opnn /* HQ_NOT_CNSD_OPNN  */
			  						
			  						#end  
			  						
			  						#if( "$!vo.hq_cnsd_status" != "")
			  							,HQ_CNSD_STATUS = :vo.hq_cnsd_status
			  						#end
			  						
			  						
			  					WHERE	
											HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id
									AND 
											CNSD_LEVEL = :vo.cnsd_level           
            				
			 ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.historyHq" isCamelCase="false" comment="HQ검토이력">
            <statement>
            <![CDATA[      
            
							SELECT 
											  HQ_CNSD_STATUS
											, HQ_CNSDREQ_ID
											, CNSD_LEVEL
											
											, CASE 
														WHEN CNSD_LEVEL%2 = 1 THEN 
															'REQ'
														WHEN CNSD_LEVEL%2 = 0 AND HQ_CNSD_STATUS = 'C16207' THEN 	
															'ADMIN_REPLY'
														WHEN CNSD_LEVEL%2 = 0 AND HQ_CNSD_STATUS != 'C16207' THEN 	
												  			'RESP'
												  		ELSE 
												  			''
											  END AS CONT_TYPE	
											  
											 , CASE 
														WHEN CNSD_LEVEL%2 = 0 AND HQ_CNSD_STATUS = 'C16207' THEN 	
															'[ADMIN REPLY]'
														ELSE
														
															CASE 
																	WHEN CNSD_LEVEL = 1 THEN 
																		 '[' + Cast(Cast(cnsd_level AS INT) AS NVARCHAR) 
																		 + 'st HQ Request' 
																		 + ']' 
																		 WHEN cnsd_level = 2 THEN 
																		 '[' + Cast(Cast(cnsd_level AS INT)/2 AS NVARCHAR) 
																		 + 'st HQ Review' 
																		 + ']'
																		 WHEN cnsd_level = 3 THEN 
																		'[' + Cast(Cast(cnsd_level/2 + 1 AS INT) AS NVARCHAR) 
																		 + 'nd HQ Request' 
																		 + ']' 
																	WHEN cnsd_level = 4 THEN 
																	     '[' + Cast(Cast(cnsd_level AS INT)/2 AS NVARCHAR) 
																	     + 'nd HQ Review' 
																	     + ']'
																	WHEN cnsd_level = 5 THEN 
																	     '[' + Cast(Cast(cnsd_level/2 + 1 AS INT) AS NVARCHAR) 
																	      + 'rd HQ Request' 
																	      + ']' 
																	WHEN cnsd_level = 6 THEN 
																	     '[' + Cast(Cast(cnsd_level AS INT)/2 AS NVARCHAR) 
																	     + 'rd HQ Review' 
																	     + ']'
																	     ELSE
																			CASE WHEN CNSD_LEVEL%2 = 1 THEN 
																			   '[' + Cast(Cast(cnsd_level/2 + 1 AS INT) AS NVARCHAR) 
																				 + 'st HQ Request' 
																				 + ']' 
																			ELSE 
																				  '[' + Cast(Cast(cnsd_level AS INT)/2 AS NVARCHAR) 
																				 + 'st HQ Review' 
																				 + ']'
																			END
																	END 
														
											END AS CR_FLAN_NM
									
											, CNTRT_ID
											, CNSDREQ_ID
											, HQ_REL_PRO
											, HQ_REQ_TITLE
											, HQ_CNSD_DEMND_CONT
											, REQMAN_ID
											, REQMAN_NM
											, CONVERT(CHAR(10), REQ_DT , 23)   AS REQ_DT	
											
											, HQ_REQ_TITLE AS  TITLE 
									
											, CASE 										
												WHEN CNSD_LEVEL%2 = 1 THEN 										
													HQ_CNSD_DEMND_CONT 										
												ELSE 		
												
													CASE 
															WHEN HQ_CNSD_STATUS = 'C16207' THEN 	
																HQ_CNSD_OPNN
															ELSE 															
																	 CASE 										
																		WHEN HQ_REL_PRO = 'RP010' THEN 										
																			HQ_CE_CNSD_OPNN 
																		WHEN HQ_REL_PRO = 'RP020' THEN 			
																			HQ_IM_CNSD_OPNN
																		WHEN HQ_REL_PRO = 'RP030' THEN 		
																			HQ_CE_CNSD_OPNN  										
																		ELSE 		
																			HQ_NOT_CNSD_OPNN
																	 END
													END
											  END AS CONT
									
											, HQ_IM_CNSD_OPNN AS CONT2
									
											, CASE 
														WHEN CNSD_LEVEL%2 = 1 THEN 										
															REQMAN_NM 										
														ELSE 		
														
															CASE 
																	WHEN HQ_CNSD_STATUS = 'C16207' THEN 	
																		REG_NM
																	ELSE 
														
																		CASE 										
																			WHEN HQ_REL_PRO = 'RP010' THEN 										
																				HQ_CE_CNSDMAN_NM 
																			WHEN HQ_REL_PRO = 'RP020' THEN 			
																				HQ_IM_CNSDMAN_NM
																			WHEN HQ_REL_PRO = 'RP030' THEN 		
																				HQ_CE_CNSDMAN_NM   								
																			ELSE 		
																				HQ_NOT_CNSDMAN_NM
																		END 
																			
															END													
											  END AS MAN_NM
													  
											, HQ_IM_CNSDMAN_NM AS MAN_NM2
											
											, CASE 			
														WHEN CNSD_LEVEL%2 = 1 THEN 
														       CONVERT(CHAR(10), REQ_DT , 23)   													  										
														ELSE 				
																CASE 
																		WHEN HQ_CNSD_STATUS = 'C16207' THEN 							
																			 CONVERT(CHAR(10), REG_DT , 23)   			 										
																		ELSE 	
																				CASE 										
																					WHEN HQ_REL_PRO = 'RP010' THEN 		
																						CONVERT(CHAR(10), HQ_CE_CNSD_DT , 23) 
																					WHEN HQ_REL_PRO = 'RP020' THEN 	
																						CONVERT(CHAR(10), HQ_IM_CNSD_DT , 23) 
																					WHEN HQ_REL_PRO = 'RP030' THEN 		
																						CONVERT(CHAR(10), HQ_CE_CNSD_DT , 23) 								  								
																					ELSE 		
																						CONVERT(CHAR(10), HQ_NOT_CNSD_DT , 23) 
																				END  
																END
																							
											  END AS REG_DT
											  
											 , CONVERT(CHAR(10), HQ_IM_CNSD_DT , 23)  AS REG_DT2
											 
											 , 	CASE 										
													WHEN HQ_REL_PRO = 'RP030' THEN 										
															DBO.LAS_CONT_CNSDREQ_HQ_ATTACH( CNTRT_ID , HQ_CNSDREQ_ID ,  CONVERT(VARCHAR, CNSD_LEVEL )  , 'H0200101' ) 
													ELSE 		
															DBO.LAS_CONT_CNSDREQ_HQ_ATTACH( CNTRT_ID , HQ_CNSDREQ_ID ,  CONVERT(VARCHAR, CNSD_LEVEL )  , '' )
												END  AS ATTATCH__CONT	
												
											,	CASE 										
													WHEN HQ_REL_PRO = 'RP030' THEN 										
															DBO.LAS_CONT_CNSDREQ_HQ_ATTACH( CNTRT_ID , HQ_CNSDREQ_ID ,  CONVERT(VARCHAR, CNSD_LEVEL )  , 'H0200102' )
													ELSE 		
															''
												END  AS ATTATCH__CONT2							
											
							FROM 
											TN_CLM_HQ_CONT_CNSDREQ
							
							WHERE 
											CNTRT_ID = :vo.cntrt_id
							AND			
											CNSDREQ_ID = :vo.cnsdreq_id

							ORDER  BY CNSDREQ_ID,   CNSD_LEVEL
	           
            	 ]]>
            </statement>
        </query>     
        
        <query id="las.contractmanager.HQmailcont" isCamelCase="false" comment="메일발송문구">
            <statement>
            <![CDATA[              
        
					        SELECT 
										  C.REQ_TITLE
										, DBO.COM_USER_INFO(C.REQMAN_ID, 'H') AS REQMAN_NM
										, 'HQ Not Assigned' AS HQ_CNSD_STATUS 
										, CASE WHEN :vo.session_user_locale= 'ko' THEN B.CNTRT_NM ELSE ISNULL(B.CNTRT_NM_EN, B.CNTRT_NM) END AS CNTRT_NM
										, CONVERT(CHAR(10), A.REQ_DT , 23)   AS REQ_DT	
										, DBO.COM_USER_INFO(A.REQMAN_ID, 'H') AS SUB_REQMAN_NM
										, (SELECT dbo.LAS_CONT_CNSDREQ_RESPMAN_M_O_HQ( :vo.hq_cnsdreq_id ,', ', :vo.session_user_locale )) AS HQ_RESPMAN_NM
										, CONVERT(CHAR(10), GETDATE() , 23)   AS RESP_DT
										, DBO.COM_USER_INFO(:vo.session_user_id , 'H') AS SESSION_MAN_NM	
							FROM 
										TN_CLM_HQ_CONT_CNSDREQ A
										JOIN TN_CLM_CONTRACT_MASTER B ON (A.CNTRT_ID = B.CNTRT_ID) 
										JOIN TN_CLM_CONT_CNSDREQ C ON (A.CNSDREQ_ID = C.CNSDREQ_ID )
							WHERE 
										A.HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id

							AND 		A.CNSD_LEVEL = ( SELECT MAX(CNSD_LEVEL) FROM TN_CLM_HQ_CONT_CNSDREQ WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id )  
            
                	 ]]>
            </statement>
        </query>     

        
        <query id="las.contractmanager.getRESPMANaddr" isCamelCase="false" comment="배정자메일주소취득">
            <statement>
            <![CDATA[              
        
							SELECT USER_ID, EMAIL FROM TB_COM_USER 
							WHERE USER_ID IN 	( SELECT RESPMAN_ID FROM  TN_CLM_HQ_CONT_CNSDREQ_RESPMAN WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id )
            
                	 ]]>
            </statement>
        </query>   
        
         <query id="las.contractmanager.getREQMANaddr" isCamelCase="false" comment="의뢰자메일주소취득">
            <statement>
            <![CDATA[    
							SELECT USER_ID, EMAIL FROM TB_COM_USER 
							WHERE USER_ID IN 	( SELECT REQMAN_ID FROM  TN_CLM_HQ_CONT_CNSDREQ WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id )            
                	 ]]>
            </statement>
        </query>    

        		
    </queries>
</queryservice>