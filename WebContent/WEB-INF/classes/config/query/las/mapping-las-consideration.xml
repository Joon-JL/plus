<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.1.dtd">

<queryservice>
    <queries>
    
    	<query id="las.contractmanager.listConsideration_mark" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
    			UPDATE 
    					TN_CLM_CONTRACT_MASTER 
    					SET MARK_NUM = :vo.mark_num
				WHERE 
						CNTRT_ID = :vo.mark_cntrt_id    			
                ]]>
            </statement>
        </query>
        
        <!-- 계약 마스터 테이블에 Admin replied 상태 값 갱신-->        
        <query id="las.contractmanager.rtn_cnsd" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
					UPDATE 
								TN_CLM_CONTRACT_MASTER 
								SET DEPTH_STATUS = 'C02609'  
				     WHERE 
						CNTRT_ID = :vo.cntrt_id    			
						
                ]]>
            </statement>
        </query>
        
         <!-- 의뢰 테이블에 Admin replied 상태 값 갱신-->        
        <query id="las.contractmanager.rtn_cnsd_req" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
					UPDATE 
								TN_CLM_CONT_CNSDREQ 
								SET PRGRS_STATUS = 'C04226'  
				     WHERE 
						CNSDREQ_ID = :vo.cnsdreq_id    					
						
                ]]>
            </statement>
        </query>
        
        <!-- Admin replied  테이블 에 리턴 사유 및 리턴자 ID 저장 -->        
         <query id="las.contractmanager.set_rtn_reason" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
		    		INSERT INTO TN_CLM_CONT_CNSDREQ_ADMRETURN
							           (CNSDREQ_ID
							           ,RET_SEQNO
							           ,RET_STARTDAY
							           ,RET_ENDDAY
							           ,RET_CAUSE
							           ,REG_ID
							           ,REG_NM
							           ,REG_DT
							           ,MOD_ID
							           ,MOD_NM
							           ,MOD_DT
							           )
    							VALUES
						           (
						           	 :vo.cnsdreq_id    		
						           , (SELECT ISNULL(MAX(RET_SEQNO),'0') + 1 AS SEQNO FROM TN_CLM_CONT_CNSDREQ_ADMRETURN WHERE CNSDREQ_ID = :vo.cnsdreq_id   )
						           ,''
						           ,''
						           ,:vo.rtn_cont
						           ,:vo.session_user_id
						           ,:vo.session_user_nm
						           ,GETDATE()
						           ,''
						           ,''
						           ,''	
									)
                ]]>
            </statement>
        </query>
                
        
         <!-- 계약 마스터 테이블에 CLOSE 사유 조회 팝업 -->        
         <query id="las.contractmanager.close_rtn_view" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
					SELECT  
								A.CLOSE_CONT
							 , 	A.CLOSE_REG_DT
							 , 	A.CLOSE_REG_ID
							 , CONVERT(CHAR(10), A.CLOSE_REG_DT, 23) AS REG_DT 
							 , B.DEPT_NM + '/' + B.JIKGUP_NM + '/' + B.USER_NM AS REG_NM
							
					FROM 
								TN_CLM_CONTRACT_MASTER A,
								TB_COM_USER B

								WHERE A.CNTRT_ID = :vo.cntrt_id    			
								AND B.USER_ID = A.CLOSE_REG_ID
   			
						
                ]]>
            </statement>
        </query>
        
         <!-- 계약 마스터 테이블에 CLOSE 상태값 저장 -->        
         <query id="las.contractmanager.close_cnsd" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
					UPDATE 	TN_CLM_CONTRACT_MASTER 
								SET CLOSE_YN = 'Y' 
								, CLOSE_CONT = :vo.close_cont
								, CLOSE_REG_DT = GETDATE()
								, CLOSE_REG_ID = :vo.session_user_id
								, MOD_DT = GETDATE()
				     WHERE 
						CNTRT_ID = :vo.cntrt_id    			
						
                ]]>
            </statement>
        </query>
    
    	<query id="las.contractmanager.listConsideration" isCamelCase="false">
		  <statement>
		    <![CDATA[	
		    
		    	/* SELECT 06 */	  
			    SELECT A.* FROM 
				( 		
					/* SELECT 05 */	  
				    SELECT 
							ROW_NUMBER () OVER ( ORDER BY REQ_DT DESC) AS RM, LAW_RESPMAN_NM AS LAW_RESPMAN_FNM, 
							
							  CASE
								WHEN PRGRS_STATUS IN ('C04206', 'C04209', 'C04202', 'C04203', 'C04208', 'C04209') THEN PRGRS_STATUS_NM_B
								ELSE CASE
									WHEN PLNDBN_REQ_YN = 'Y' THEN PRGRS_STATUS_NM_B + '<BR>(Final)'
									ELSE CASE
										WHEN LVL = '1' THEN PRGRS_STATUS_NM_B + '<BR>(' + CAST(LVL AS nvarchar) + 'st)'
										WHEN
										  LVL = '2' THEN PRGRS_STATUS_NM_B + '<BR>(' + CAST(LVL AS nvarchar) + 'nd)'
										WHEN LVL = '3' THEN PRGRS_STATUS_NM_B + '<BR>(' + CAST(LVL AS nvarchar) + 'rd)'
										ELSE PRGRS_STATUS_NM_B + '<BR>(' +
										  CAST(LVL AS nvarchar) + 'th)'
									  END
								  END
							  END AS PRGRS_STATUS_NM,
							  CASE
								WHEN PRGRS_STATUS IN ('C04206', 'C04209', 'C04202', 'C04203', 'C04208', 'C04209') THEN PRGRS_STATUS_NM_B
								ELSE CASE
									WHEN PLNDBN_REQ_YN = 'Y' THEN PRGRS_STATUS_NM_B + '(Final)'
									ELSE CASE
										WHEN LVL = '1' THEN PRGRS_STATUS_NM_B + '('
										  + CAST(LVL AS nvarchar) + 'st)'
										WHEN LVL = '2' THEN PRGRS_STATUS_NM_B + '(' + CAST(LVL AS nvarchar)
										  + 'nd)'
										WHEN LVL = '3' THEN PRGRS_STATUS_NM_B + '(' + CAST(LVL AS nvarchar) + 'rd)'
										ELSE PRGRS_STATUS_NM_B
										  + '(' + CAST(LVL AS nvarchar) + 'th)'
									  END
								  END
							  END AS PRGRS_STATUS_NM_1,
							CAST(COUNT(1) OVER () AS numeric) AS TOTAL_CNT,
							A.*  							
							FROM 
							( 			
							/* SELECT 04 */	    
							SELECT  
									CNSDREQ_ID,	CNTRT_ID, A.REQ_TITLE, A.REQMAN_NM, A.REQ_DEPT_NM, A.REQ_DEPT_NM_1, A.REQ_DT, A.REQ_DT_1,
									A.PLNDBN_REQ_YN, 
									A.MN_CNSD_DEPT, A.PRCS_DEPTH, A.DEPTH_STATUS, A.CNTRT_OPPNT_NM,
									A.TYPE_NM, A.TYPE_NM_1, 				
									/*CAST( COUNT(1) OVER() AS NUMERIC) AS TOTAL_CNT,*/
									A.PRCS_DEPTH_NM, A.DEPTH_STATUS_NM,
									
									CASE 
										WHEN A.LAW_STATUS_NM = 'C04224' THEN 'Not Assigned'
										WHEN A.LAW_STATUS_NM = 'C04225' THEN 'Saved'
										WHEN A.LAW_STATUS_NM = 'C04204' THEN 'Review in Progress'
										WHEN A.LAW_STATUS_NM = 'C04206' THEN 'Require Reassign'
										WHEN A.LAW_STATUS_NM = 'C04207' THEN 'Replied'
										WHEN A.LAW_STATUS_NM = 'C04210' THEN 'Holding'
									END AS LAW_STATUS_NM,
								
									LAW_STATUS_NM AS LAW_STATUS_NM_1, IP_STATUS_NM, A.MN_CNSD_DEPT_NM, A.LAW_STATUS,
									A.IP_STATUS, A.LVL, A.VC_DEMND_YN, A.VC_CNSD_DEPT, A.VC_CNSD_DEPT_NM, A.CNTRT_CNT, A.CNTRT_RESPMAN_NM,
									A.CNTRT_RESP_DEPT_NM, A.PRGRS_STATUS, 
																		
									CASE 
									WHEN 'en'  = 'ko' THEN 
									( SELECT CD_NM FROM TB_COM_CD WHERE CD = A.PRGRS_STATUS) 			
									WHEN 'en'  = 'fr' THEN 
									( SELECT CD_NM_FRA FROM TB_COM_CD WHERE CD = A.PRGRS_STATUS) 			
									WHEN 'en'  = 'de' THEN 
									( SELECT CD_NM_DEU FROM TB_COM_CD WHERE CD = A.PRGRS_STATUS) 	
									ELSE
									( SELECT CD_NM_ENG FROM TB_COM_CD WHERE CD = A.PRGRS_STATUS) 	
									END
									AS PRGRS_STATUS_NM_B,
									
									  CNTRT_INFO_GBN, 
									  [dbo].[LAS_GET_RESPMAN_NMS](CNSDREQ_ID) AS LAW_RESPMAN_NM,	
									  0 AS LAW_RESPMAN_CNT,
							
									  '' AS IP_RESPMAN_NM, '' IP_RESPMAN_FNM, 0 AS IP_RESPMAN_CNT, COMP_CD COMP_NM,
									  SOLO_YN, MARK_NUM, CASE WHEN CLOSE_YN = 'Y' THEN 'Closed' ELSE '' END AS CLOSE_YN, 
									  HQ_CNSD_STATUS, 
									CASE 
										WHEN 'C16201' = HQ_CNSD_STATUS THEN '<br>(HQ Review)' 
										WHEN 'C16202' = HQ_CNSD_STATUS THEN '<br>(HQ Review)' 
										WHEN 'C16203' = HQ_CNSD_STATUS THEN '<br>(HQ Review)' 
										WHEN 'C16204' = HQ_CNSD_STATUS THEN '<br>(HQ Review)' 
										WHEN 'C16205' = HQ_CNSD_STATUS THEN '<br>(HQ Replied)' 
										WHEN 'C16206' = HQ_CNSD_STATUS THEN '<br>(HQ Review)' 
										WHEN 'C16207' = HQ_CNSD_STATUS THEN '<br>(HQ Admin Replied)' 
										ELSE HQ_CNSD_STATUS 
									END AS HQ_CNSD_STATUS_NM
								  				  
						
							FROM (
										/* SELECT 03 */
										SELECT 					
												T.CNSDREQ_ID, CNTRT_ID, REQ_TITLE, REQMAN_NM, REQ_DEPT_NM, 
												PLNDBN_REQ_YN, MN_CNSD_DEPT, PRCS_DEPTH, DEPTH_STATUS, 
												CNTRT_OPPNT_NM, TYPE_NM, TYPE_NM_1, 
								
												PRCS_DEPTH_NM, DEPTH_STATUS_NM,
												CASE 
													WHEN LS6 IS NULL THEN 
														CASE WHEN LS4 IS NULL THEN 				
															CASE WHEN LS1 IS NULL THEN 
																CASE WHEN LS3 IS NULL THEN							
																	CASE WHEN LS2 IS NULL THEN LS5
																	ELSE LS2 END
																ELSE LS3 END
															ELSE LS1 END
														ELSE LS4 END
													ELSE LS6		
												 END AS LAW_STATUS_NM, 
										
												'' IP_STATUS_NM, '' MN_CNSD_DEPT_NM , 
												CASE WHEN CNSD_DEPT = 'A00000003' THEN '' ELSE CNSD_STATUS END AS LAW_STATUS,
												CASE WHEN CNSD_DEPT = 'A00000003' THEN CNSD_STATUS ELSE '' END AS IP_STATUS,
												LVL, VC_DEMND_YN, VC_CNSD_DEPT, '' VC_CNSD_DEPT_NM, 1 AS CNTRT_CNT, 
												CNTRT_RESPMAN_NM, CNTRT_RESP_DEPT_NM, 
												
												/*PRGRS_STATUS, */
												
												CASE WHEN PRGRS_STATUS = 'C04209' THEN PRGRS_STATUS                                 /* 구법무이관이면 그대로 유지 */
													WHEN DEPTH_STATUS = 'C02607' OR HOLD.CNSDREQ_ID IS NOT NULL THEN 'C04210'        /* 검토의뢰의 보류만 보류로 유지 */
													WHEN DEPTH_STATUS = 'C02603' AND PRCS_DEPTH = 'C02502' THEN 'C04207'           /* 계약체결의 Drop은 회신으로 유지 */
																			WHEN DEPTH_STATUS = 'C02609' THEN 'C02609'									   /* Admin Replied */
													ELSE PRGRS_STATUS
												END AS PRGRS_STATUS,								
								
												REQ_DEPT_NM AS REQ_DEPT_NM_1,
												REQ_DT, REQ_DT_1,  CLOSE_YN,
										 										 
												  MN_RESPMAN_APNT_YN,
												  CNTRT_INFO_GBN, COMP_CD, SOLO_YN, MARK_NUM ,
								
												(
													SELECT MAX(HQ_CNSD_STATUS) FROM TN_CLM_HQ_CONT_CNSDREQ 
													WHERE  CNSDREQ_ID = T.CNSDREQ_ID
												) AS HQ_CNSD_STATUS								
										 
										FROM 
										(
												/* SELECT 02 */
												SELECT	
														A.CNSDREQ_ID, A.CNTRT_ID, A.REQ_TITLE, A.REQMAN_NM,
														A.REQ_DEPT_NM			
														, A.PLNDBN_REQ_YN		
														, MN_CNSD_DEPT, VC_CNSD_DEPT
														, CNTRT_OPPNT_NM
														, TYPE_NM, REPLACE(TYPE_NM,'<BR>','') AS TYPE_NM_1
														, PRCS_DEPTH_NM
														, DEPTH_STATUS_NM
															, REPLACE(A.REQ_DT, ' ', '<BR>') AS REQ_DT , A.REQ_DT AS REQ_DT_1 
														, [dbo].[LAS_GET_RESPMAN_NMS](A.CNSDREQ_ID) AS LAW_RESPMAN_NM
														, A.CLOSE_YN
								
														, RESPMAN_ID
														, PRCS_DEPTH, DEPTH_STATUS,  CNSD_STATUS
														, CNTRT_INFO_GBN, COMP_CD, SOLO_YN, MARK_NUM 
										
														, CASE WHEN PRGRS_STATUS IN ('C04211','C04212','C04213','C04214','C04215','C04216','C04217','C04218','C04219','C04220','C04221','C04222','C04223') /* 회신이후(체결/등록/이행/종료) 상태이면 회신으로 대체 */
																			THEN 'C04207'
																		WHEN PRGRS_STATUS IN ('C04203') /* 의뢰 상태는 주관부서의 담당자 배정에 따라 검토상태로 변경 */
																			THEN CASE WHEN MN_RESPMAN_APNT_YN = 'Y' THEN 'C04204'
																						ELSE 'C04203'
																				END
																		ELSE PRGRS_STATUS
																	END AS PRGRS_STATUS
								
								
														, CNSD_LEVEL AS LVL
														, VC_DEMND_YN
														, CNTRT_RESPMAN_NM, CNTRT_RESP_DEPT_NM
														, MN_RESPMAN_APNT_YN
										
														, CASE 
															WHEN :vo.session_blngt_orgnz = A.MN_CNSD_DEPT THEN A.MN_CNSD_DEPT
															WHEN :vo.session_blngt_orgnz = A.VC_CNSD_DEPT THEN A.VC_CNSD_DEPT
															ELSE ''
														  END AS CNSD_DEPT
								
								
														, CASE 
															WHEN  A.RESPMAN_ID IS NULL THEN 
																CASE 
																	WHEN A.PRCS_DEPTH = 'C02501' AND (A.DEPTH_STATUS = 'C02607' OR A.DEPTH_STATUS = 'C02609') THEN  NULL 
																	WHEN A.PRCS_DEPTH = 'C02503' AND A.DEPTH_STATUS = 'C02647' THEN NULL
																	ELSE 'C04224'
																END 
															ELSE NULL
														  END AS LS1 /* Not Assigned */
										  
														, CASE 
															WHEN A.PRGRS_STATUS = 'C04204' AND A.CNSD_STATUS <> 'C04302' THEN 'C04204' ELSE NULL
														  END AS LS2 /*  Review in progress */
										  
														 , CASE
															WHEN A.PRCS_DEPTH = 'C02501' AND A.CNSD_STATUS = 'C04302' THEN  'C04225' ELSE NULL
														  END AS LS3 /* Draft Saved */
										  
														 , CASE
															WHEN A.PRGRS_STATUS = 'C04206'  THEN  'C04206' ELSE NULL
															END AS LS4 /*  Require Reassign */
											
														 , CASE
															WHEN A.RESPMAN_ID IS NOT NULL THEN				
																CASE WHEN A.PRGRS_STATUS = 'C04204' THEN NULL ELSE 'C04207' END	
															ELSE NULL
															END AS LS5 /*  ReplieD */
											
														 , CASE
															WHEN A.PRCS_DEPTH = 'C02501' AND (A.DEPTH_STATUS = 'C02607' OR A.DEPTH_STATUS = 'C02647') THEN 'C04210' 
															WHEN A.PRCS_DEPTH = 'C02503' AND A.DEPTH_STATUS = 'C02607' THEN 'C04210' 
															ELSE NULL
															END AS  LS6 /*  HO */
																		
												FROM 
												(	
													/* SELECT 01 */
													SELECT 
															A.CNSDREQ_ID, A.CNTRT_ID, REQ.REQ_TITLE, REQ.REQMAN_NM,
															REQ.REQ_DEPT_NM, REQ.REQ_DEPT_NM AS REQ_DEPT_NM_1		
															, 
															(
											
																 SELECT 
																		/*CONVERT(NVARCHAR, cast(REQ.RE_DT as datetime), 20) REQ_DT*/
																		CONVERT(CHAR(16),MIN(ISNULL(ACPT_DT, REQ.REG_DT)),120) AS REQ_DT /*YYYY-MM-DD HH24:MI*/
																 FROM 
																 (
																	select MIN(CNSDREQ_ID) CNSDREQ_ID from TN_CLM_CONTRACT_CNSD
																	where CNTRT_ID= A.CNTRT_ID
																 ) REV LEFT JOIN TN_CLM_CONT_CNSDREQ REQ ON REV.CNSDREQ_ID = REQ.CNSDREQ_ID
								
															) AS REQ_DT,
								
															REQ.PLNDBN_REQ_YN, REQ.MN_CNSD_DEPT, REQ.VC_CNSD_DEPT, M.PRCS_DEPTH, M.DEPTH_STATUS, REQ.MN_RESPMAN_APNT_YN,
															M.CNTRT_OPPNT_NM, M.CNTRT_RESPMAN_NM, M.CNTRT_RESP_DEPT_NM											
															
															, CASE WHEN :vo.session_user_locale  = 'ko' THEN
																		CASE WHEN CNCLSNPURPS_BIGCLSFCN IN ('T0301', 'T0303') THEN '개발/<BR>라이선스'
																			WHEN CNCLSNPURPS_BIGCLSFCN IN ('T0302')          THEN '특허'
																			ELSE '일반'
																		END
																											 
																ELSE
																		CASE WHEN CNCLSNPURPS_BIGCLSFCN IN ('T0301', 'T0303') THEN 'Development/<BR>License'
																			WHEN CNCLSNPURPS_BIGCLSFCN IN ('T0302')          THEN 'Patent'
																			ELSE 'General'
																		END
															END AS TYPE_NM
													
															, (SELECT CD_NM_ENG FROM TB_COM_CD WHERE CD=M.PRCS_DEPTH) AS PRCS_DEPTH_NM
															, (SELECT CD_NM_ENG FROM TB_COM_CD WHERE CD=M.DEPTH_STATUS) AS DEPTH_STATUS_NM								
															, B.RESPMAN_ID										
															, 
																CASE 
																WHEN M.CLOSE_YN = 'Y' THEN 'Y'
																ELSE 'N'
																END AS CLOSE_YN								
								
															, REQ.PRGRS_STATUS , REV.CNSD_STATUS, REQ.CNSD_LEVEL , 
															CASE WHEN REQ.VC_CNSD_DEMND_DT IS NULL THEN 'N' ELSE 'Y' END AS VC_DEMND_YN,
														M.CNTRT_INFO_GBN, M.COMP_CD, M.SOLO_YN, M.MARK_NUM 
													FROM  /* SELECT 01 */
													(
														SELECT MAX(CNSDREQ_ID) CNSDREQ_ID, B.CNTRT_ID
														FROM
														(
															SELECT   CNTRT_ID FROM TN_CLM_CONTRACT_CNSD
															/* WHERE RESPMAN_ID = :vo.session_user_id */
															WHERE COMP_CD = :vo.session_comp_cd
														) A LEFT JOIN TN_CLM_CONTRACT_CNSD B ON A.CNTRT_ID = B.CNTRT_ID
														/*where 1=1 and CNSDREQ_ID = 'H20150427270' */
														GROUP BY B.CNTRT_ID
													) A 
													LEFT OUTER JOIN TN_CLM_CONT_CNSDREQ_RESPMAN B ON A.CNSDREQ_ID = B.CNSDREQ_ID 
													/*Legal Admin only BUT ALWAYS */
													AND B.MAIN_CNSD_YN = 'Y'
													LEFT JOIN TN_CLM_CONTRACT_CNSD REV ON A.CNSDREQ_ID = REV.CNSDREQ_ID
													LEFT JOIN TN_CLM_CONT_CNSDREQ REQ ON A.CNSDREQ_ID = REQ.CNSDREQ_ID
													LEFT JOIN TN_CLM_CONTRACT_MASTER M ON A.CNTRT_ID = M.CNTRT_ID
													WHERE 1=1
													AND M.DEL_YN <> 'Y'
													AND M.COMP_CD = :vo.session_comp_cd
													AND M.PRCS_DEPTH IN ('C02501','C02502','C02503','C02504','C02505')
													AND M.CNTRT_INFO_GBN = 'C05401'
													
													/* Except Draft Saved by Others */
													AND 'Y' = 
														CASE
															WHEN REQ.PRGRS_STATUS = 'C04201' AND REQ.CNSDREQ_ID = REQ.FST_CNSDREQ_ID AND REQMAN_ID <> :vo.session_user_id THEN 'N' 
								
														ELSE 'Y'
														END	
									
													AND  A.CNSDREQ_ID NOT LIKE 'F%'
													
													#if (!$vo.srch_biz_depth.equals(""))
													AND M.BIZ_CLSFCN = :vo.srch_biz_depth 
													#end				
													#if ("$!vo.srch_cntrt_no"!="")
													AND M.CNTRT_NO = :vo.srch_cntrt_no 
													#end				
													
												)  A  /* SELECT 02 */
												WHERE 1=1
												/*AND REQ_DT BETWEEN '2014-05-15 00:00:00' AND '2015-05-15 23:59:59' */			
												
												/* Request Date s */
												AND 'Y' = CASE 
													WHEN :vo.srch_start_dt = '' THEN 
														CASE
															WHEN REQ_DT >= CONVERT(NVARCHAR, cast(DATEADD(Year, -1, GETDATE())   as datetime), 20) THEN 'Y' 
															ELSE 'N'
															END
													WHEN :vo.srch_start_dt <> '' THEN 
														CASE
															WHEN REQ_DT >= CONVERT(NVARCHAR, cast( :vo.srch_start_dt  as datetime), 20) THEN 'Y' 
															ELSE 'N'
															END
													ELSE 'Y'
													END
												/* Request Date e */
												AND 'Y' = CASE 
													WHEN :vo.srch_end_dt = '' THEN 
														CASE
															WHEN REQ_DT <= CONVERT(NVARCHAR, cast(getdate() as datetime), 20) THEN 'Y' 
															ELSE 'N'
															END
													WHEN :vo.srch_end_dt <> '' THEN 
														CASE
															WHEN REQ_DT <= CONVERT(NVARCHAR, cast(DATEADD(DAY, 1, :vo.srch_end_dt)   as datetime), 20) THEN 'Y'  
															
															ELSE 'N'
															END
													ELSE 'Y'
													END
								
										)  T /* SELECT 03 */
										LEFT OUTER JOIN (SELECT	DISTINCT CNSDREQ_ID FROM TN_CLM_CONT_CNSDREQ_HOLD) HOLD ON T.CNSDREQ_ID = HOLD.CNSDREQ_ID
								
										WHERE 1=1
								) A /* SELECT 04 */
								WHERE 1=1
								
								#if (!$vo.srch_law_status.equals(""))
								AND LAW_STATUS_NM = :vo.srch_law_status
								#end
								
								#if (!$vo.srch_prgrs_status.equals(""))
								AND PRGRS_STATUS = :vo.srch_prgrs_status
								#end
								
								#if (!$vo.srch_req_title.equals(""))
								AND REQ_TITLE LIKE UPPER(:vo.srch_req_title) + '%'	
								#end
								/*
								#if (!$vo.srch_cnsd_cont.equals(""))
								AND REQ_TITLE LIKE UPPER(:vo.srch_cnsd_cont) + '%'	
								#end
								*/
								/*
								#if (!$vo.srch_start_dt.equals(""))
								AND REQ_DT >= CONVERT(NVARCHAR, cast(DATEADD(Year, -1, GETDATE())   as datetime), 20)
								#else
								AND REQ_DT >= CONVERT(NVARCHAR, :vo.srch_start_dt, 20)
								#end
								
								#if (!$vo.srch_end_dt.equals(""))
								AND REQ_DT <= CONVERT(NVARCHAR, cast(GETDATE()   as datetime), 20)
								#else
								AND REQ_DT <= CONVERT(NVARCHAR, :vo.srch_end_dt, 20)
								#end
								*/
								
								#if (!$vo.srch_reqman_nm.equals(""))
								AND REQMAN_NM LIKE  :vo.srch_reqman_nm + '%'	
								#end
															
								#if (!$vo.srch_closed_yn.equals(""))
								AND CLOSE_YN = :vo.srch_closed_yn
								#end
									
								#if (!$vo.srch_cntrt_oppnt_nm.equals(""))
								AND CNTRT_OPPNT_NM  LIKE UPPER(:vo.srch_cntrt_oppnt_nm) + '%'	
								#end
					
				) A /* SELECT 05 */
				WHERE 1=1
				#if (!$vo.srch_respman_nm.equals(""))
				AND LAW_RESPMAN_NM LIKE   '%' + :vo.srch_respman_nm + '%'	
				#end
			) A /* SELECT 06 */
			WHERE 1=1
			AND RM >= :vo.start_index AND RM <= :vo.end_index
			
            ]]>
            </statement>
        </query>

        <query id="las.contractmanager.listCnsdReqTConsideration" isCamelCase="false" comment="전사계약List_의뢰기준">
		  <statement>
		    <![CDATA[
SELECT CNSDREQ_ID ,REQ_TITLE ,REQMAN_NM ,REQ_DT ,CNTRT_CNT
      ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,MN_CNSD_DEPT
      ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN
      ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM
      ,SUBSTR(MAX(RESPMAN_NM_STR), 2) AS RESPMAN_NM_STR
      ,CASE WHEN MAX(ISNULL(RESP_NUM, 0)) > 2
                 THEN SUBSTR(SUBSTR(MAX(RESPMAN_NM_STR), 2), 1, POSSTR(SUBSTR(MAX(RESPMAN_NM_STR), 2), ',')-1)
                 ELSE SUBSTR(MAX(RESPMAN_NM_STR), 2)
       END AS RESPMAN_FNM
      ,MAX(ISNULL(RESP_NUM, 0))-1 AS RESPMAN_CNT
  FROM (
         SELECT CNSDREQ_ID ,REQ_TITLE ,REQMAN_NM ,REQ_DT ,CNTRT_CNT
               ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,MN_CNSD_DEPT
               ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN
               ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM ,RESPMAN_NM
               ,RESP_NUM ,(select dbo.LAS_CONT_CNSDREQ_RESPMAN_M(CNSDREQ_ID,', ','xx')) AS RESPMAN_NM_STR 
           FROM (
                  SELECT CNSDREQ_ID ,REQ_TITLE ,REQMAN_NM ,REQ_DT ,CNTRT_CNT
                        ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,MN_CNSD_DEPT
                        ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN
                        ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM ,RESPMAN_NM
                        ,ROW_NUMBER() OVER(PARTITION BY CNSDREQ_ID ORDER BY RESPMAN_SRT ASC, RESPMAN_NM ASC) AS RESP_NUM
                    FROM (
                           SELECT N.CNSDREQ_ID ,N.REQ_TITLE ,N.REQMAN_NM ,N.REQ_DT ,N.CNTRT_CNT
                                 ,N.PRCS_DEPTH ,N.DEPTH_STATUS ,N.CNTRT_OPPNT_NM ,N.MN_CNSD_DEPT
                                 ,N.CNTRT_RESPMAN_NM ,N.CNTRT_RESP_DEPT_NM ,N.CNTRT_INFO_GBN
                                 ,N.RN ,N.TOTAL_CNT ,N.PRCS_DEPTH_NM ,N.DEPTH_STATUS_NM
                                 ,CASE WHEN O.RESP_DEPT = N.MN_CNSD_DEPT
                                            THEN ISNULL(TCU.USER_SRT, 9999)
                                            ELSE ISNULL(TCU.USER_SRT, 9999) + 10000
                                  END AS RESPMAN_SRT
                                 ,O.RESPMAN_NM
                             FROM (
                                    SELECT H.CNSDREQ_ID ,H.REQ_TITLE ,H.REQMAN_NM ,H.REQ_DT ,H.CNTRT_CNT
                                          ,H.PRCS_DEPTH ,H.DEPTH_STATUS ,H.CNTRT_OPPNT_NM ,H.MN_CNSD_DEPT
                                          ,H.CNTRT_RESPMAN_NM ,H.CNTRT_RESP_DEPT_NM ,H.CNTRT_INFO_GBN
                                          ,H.RN ,H.TOTAL_CNT
                                          ,CASE WHEN :vo.session_user_locale = 'ko' THEN I.CD_NM 
                                          	    WHEN :vo.session_user_locale = 'fr' THEN I.CD_NM_FRA
                                          	    WHEN :vo.session_user_locale = 'de' THEN I.CD_NM_DEU
                                           ELSE I.CD_NM_ENG END AS PRCS_DEPTH_NM
                                          ,CASE WHEN :vo.session_user_locale = 'ko' THEN J.CD_NM
                                          		WHEN :vo.session_user_locale = 'fr' THEN J.CD_NM_FRA
                                          	    WHEN :vo.session_user_locale = 'de' THEN J.CD_NM_DEU
                                           ELSE J.CD_NM_ENG END
                                           +
                                           CASE WHEN H.DEPTH_STATUS IN ('C02606', 'C02608')
                                           			THEN 
                                           				CASE WHEN :vo.session_user_locale = 'ko' THEN
                                           					CASE WHEN H.PLNDBN_REQ_YN = 'Y'
                                           							THEN '(최종)'
                                           							ELSE '(' + H.LVL + '차)'
                                           				 	END
                                           				 ELSE
                                           				 	CASE WHEN H.PLNDBN_REQ_YN = 'Y'
                                           							THEN '(Final)'
                                           							ELSE 
                                           								CASE WHEN H.LVL = '1' THEN '(' + H.LVL + 'st)'
                                           									 WHEN H.LVL = '2' THEN '(' + H.LVL + 'nd)'
                                           									 WHEN H.LVL = '3' THEN '(' + H.LVL + 'rd)'
                                           									 ELSE '(' + H.LVL + 'th)'
                                           								END
                                           				 	END
                                           				 END
                                           			ELSE ''
                                           END 
                                           AS DEPTH_STATUS_NM
                                      FROM (
                                             SELECT CNSDREQ_ID ,REQ_TITLE ,REQMAN_NM ,REQ_DT ,CNTRT_CNT
                                                   ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,MN_CNSD_DEPT, VC_CNSD_DEPT
                                                   ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN
                                                   ,PLNDBN_REQ_YN, LVL
                                                   ,ROWNUM AS RN ,COUNT(1) OVER() AS TOTAL_CNT
                                               FROM (
                                                      SELECT C.CNSDREQ_ID ,C.REQ_TITLE ,C.REQMAN_NM ,C.REQ_DT ,D.CNTRT_CNT
                                                            ,E.PRCS_DEPTH ,E.DEPTH_STATUS ,E.CNTRT_OPPNT_NM ,C.MN_CNSD_DEPT, C.VC_CNSD_DEPT
                                                            ,E.CNTRT_RESPMAN_NM ,E.CNTRT_RESP_DEPT_NM ,E.CNTRT_INFO_GBN
                                                            ,C.PLNDBN_REQ_YN, C.LVL
                                                        FROM (
                                                               SELECT CNSDREQ_ID ,REQ_TITLE ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT, VC_CNSD_DEPT, PLNDBN_REQ_YN, LVL
                                                                 FROM (
                                                                        SELECT A.CNSDREQ_ID ,A.REQ_TITLE ,B.ACPT_DT ,A.MN_CNSD_DEPT, A.VC_CNSD_DEPT
                                                                              ,REPLACE(CONVERT(CHAR(10), B.ACPT_DT, 23),'-','') AS REQ_DT 
                                                                              ,A.REQMAN_NM
                                                                              ,CASE WHEN (B.COWORK IS NULL AND D.CNCLSNPURPS_BIGCLSFCN <> 'T0302') THEN 'N' ELSE 'Y' END AS COWORK_FLAG
                                                                              ,A.PLNDBN_REQ_YN, B.LVL
                                                                          FROM TN_CLM_CONT_CNSDREQ A
                                                                              ,(
SELECT A.CNSD_LEVEL AS LVL,
	   A.CNSDREQ_ID,
	   B.VC_CNSD_DEPT AS COWORK,
	   B.ACPT_DT
  FROM TN_CLM_CONT_CNSDREQ A,
			(SELECT FST_CNSDREQ_ID,
              MAX(CNSD_LEVEL) AS CNSD_LEVEL,
              MAX(VC_CNSD_DEPT) AS VC_CNSD_DEPT,
							MIN(ISNULL(ACPT_DT, REG_DT)) AS ACPT_DT
          FROM TN_CLM_CONT_CNSDREQ
				WHERE PRGRS_STATUS <> 'C04201'
				  AND DEL_YN = 'N'
        GROUP BY FST_CNSDREQ_ID) B
 WHERE A.FST_CNSDREQ_ID = B.FST_CNSDREQ_ID
   AND A.CNSD_LEVEL = B.CNSD_LEVEL
   AND A.DEL_YN = 'N'
                                                                               ) B
                                                                               ,TB_COM_USER C
                                                                               ,TN_CLM_CONTRACT_CNSD CNSD
                                                                               ,TN_CLM_CONTRACT_MASTER D
                                                                         WHERE A.DEL_YN = 'N'
                                                                           AND A.CNSDREQ_ID = B.CNSDREQ_ID
                                                                           AND A.CNSDREQ_ID = CNSD.CNSDREQ_ID
                                                                           AND CNSD.CNTRT_ID = D.CNTRT_ID
                                                                           AND C.USER_ID = :vo.user_id
                                                                           AND DBO.DECODE5(C.RESP_OPERDIV, 'C06099', C.BLNGT_ORGNZ, 'C06299', C.BLNGT_ORGNZ, A.REQ_OPERDIV) = A.REQ_OPERDIV
#if (!$vo.srch_review_title.equals(""))
                                                                           AND UPPER(A.REQ_TITLE) LIKE '%' + UPPER(:vo.srch_review_title) + '%'		-- 의뢰명 검색
#end
#if (!$vo.srch_reqman_nm.equals(""))
                                                                           AND UPPER(A.REQMAN_NM) = UPPER(:vo.srch_reqman_nm)							-- 의뢰자 검색
#end
#if (!$vo.srch_start_reqday.equals(""))
                                                                           AND REPLACE(CONVERT(CHAR(10), B.ACPT_DT, 23),'-','') >= :vo.srch_start_reqday	-- 의뢰일 검색(시작일)
#end
#if (!$vo.srch_end_reqday.equals(""))
                                                                           AND REPLACE(CONVERT(CHAR(10), B.ACPT_DT, 23),'-','') <= :vo.srch_end_reqday		-- 의뢰일 검색(종료일)
#end
#if (!$vo.srch_cnsdman_nm.equals(""))
                                                                           AND A.CNSDREQ_ID IN (														-- 검토자 검색
                                                                                                 SELECT CNSDREQ_ID
                                                                                                   FROM TN_CLM_CONT_CNSDREQ_RESPMAN
                                                                                                  WHERE UPPER(RESPMAN_NM) = UPPER(:vo.srch_cnsdman_nm)
                                                                                                  GROUP BY CNSDREQ_ID
                                                                                               )
#end
                                                                      )
#if ($vo.session_blngt_orgnz.equals("A00000003"))
                                                                WHERE COWORK_FLAG = 'Y'		-- IP센터는 의뢰이력중에서 IP센터가 검토 한 것만 추출
#end
                                                             ) C
                                                            ,(
                                                               SELECT CCC.CNSDREQ_ID ,MIN(CCC.CNTRT_ID) AS CNTRT_ID, COUNT(CCC.CNTRT_ID) AS CNTRT_CNT	-- 의뢰건별 첫번째 계약만 추출 (주계약)
                                                                 FROM TN_CLM_CONTRACT_CNSD CCC
                                                                     ,TN_CLM_CONTRACT_MASTER CCM
                                                                WHERE CCC.CNTRT_ID = CCM.CNTRT_ID
                                                                  AND CCM.DEL_YN = 'N'
                                                                  --AND CCM.CNTRT_STATUS < 'C02406'
                                                                  AND (CCM.CNTRT_INFO_GBN IN ('C05401', 'C05403')
                                                                       OR (CCM.CNTRT_INFO_GBN IN ('C05404')
                                                                           AND CCM.PRCS_DEPTH IN ('C02504', 'C02505')))
                                                                GROUP BY CCC.CNSDREQ_ID
                                                             ) D
                                                            ,(
                                                               SELECT CNTRT_ID ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM
                                                                     ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN
                                                                 FROM TN_CLM_CONTRACT_MASTER
                                                                WHERE DEL_YN = 'N'
                                                                  --AND DEPTH_STATUS > 'C02602'
                                                                  --AND CNTRT_STATUS < 'C02406'
                                                                  AND (CNTRT_INFO_GBN IN ('C05401', 'C05403')
                                                                       OR (CNTRT_INFO_GBN IN ('C05404')
                                                                           AND PRCS_DEPTH IN ('C02504', 'C02505')))
#if (!$vo.srch_oppnt_cd.equals(""))
                                                                  AND CNTRT_OPPNT_CD = :vo.srch_oppnt_cd						-- 거래 상대방 검색
#end
#if (!$vo.srch_resp_dept.equals(""))
                                                                  AND CNTRT_RESP_UP_DEPT LIKE '%' + :vo.srch_resp_dept + '^%'	-- 계약 담당부서 검색
#end
#if (!$vo.srch_respman_nm.equals(""))
                                                                  AND UPPER(CNTRT_RESPMAN_NM) = UPPER(:vo.srch_respman_nm)		-- 계약 담당자 검색
#end
#if (!$vo.srch_step.equals(""))
                                                                  AND PRCS_DEPTH = :vo.srch_step								-- 단계 검색
#end
#if (!$vo.srch_state.equals(""))
                                                                  AND DEPTH_STATUS = :vo.srch_state								-- 상태 검색
#end
#if (!$vo.srch_if_sys_cd.equals(""))
                                                                  AND IF_SYS_CD = :vo.srch_if_sys_cd							-- 연계시스템 검색
#end
                                                             ) E
                                                       WHERE C.CNSDREQ_ID = D.CNSDREQ_ID
                                                         AND D.CNTRT_ID = E.CNTRT_ID
                                                       ORDER BY C.ACPT_DT DESC
                                                    )
                                           ) H
                                          ,TB_COM_CD I
                                          ,TB_COM_CD J
                                     WHERE H.RN BETWEEN :vo.start_index AND :vo.end_index
                                       AND H.PRCS_DEPTH = I.CD
                                       AND H.DEPTH_STATUS = J.CD
                                  ) N
                                 ,TN_CLM_CONT_CNSDREQ_RESPMAN O
                                 ,TB_COM_USER TCU
                            WHERE N.CNSDREQ_ID = O.CNSDREQ_ID(+)
                              AND O.RESPMAN_ID = TCU.USER_ID(+)
                         )
                )
          START WITH RESP_NUM = 1
         CONNECT BY PRIOR RESP_NUM = RESP_NUM - 1
                AND PRIOR CNSDREQ_ID = CNSDREQ_ID
       )
 GROUP BY CNSDREQ_ID ,REQ_TITLE ,REQMAN_NM ,REQ_DT ,CNTRT_CNT
         ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,MN_CNSD_DEPT
         ,CNTRT_RESPMAN_NM ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN
         ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM
 ORDER BY RN ASC
            ]]>
            </statement>
        </query>


        
        <query id="las.contractmanager.listContractTConsideration" isCamelCase="false" comment="전사계약List">
		  <statement>
		    <![CDATA[
SELECT CNSDREQ_ID ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT
      ,CNTRT_ID ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,CNTRT_RESPMAN_NM
      ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN ,CNTRT_NM ,CNTRT_CNCLSNDAY
      ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM
      ,SUBSTR(MAX(RESPMAN_NM_STR), 2) AS RESPMAN_NM_STR
      ,CASE WHEN MAX(ISNULL(RESP_NUM, 0)) > 2
                 THEN SUBSTR(SUBSTR(MAX(RESPMAN_NM_STR), 2), 1, POSSTR(SUBSTR(MAX(RESPMAN_NM_STR), 2), ',')-1)
                 ELSE SUBSTR(MAX(RESPMAN_NM_STR), 2)
       END AS RESPMAN_FNM
      ,MAX(ISNULL(RESP_NUM, 0))-1 AS RESPMAN_CNT,
       BIZ_CLSFCN
  FROM (
         SELECT CNSDREQ_ID ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT
               ,CNTRT_ID ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,CNTRT_RESPMAN_NM
               ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN ,CNTRT_NM ,CNTRT_CNCLSNDAY, BIZ_CLSFCN
               ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM ,RESPMAN_NM
               ,RESP_NUM ,(select dbo.LAS_CONT_CNSDREQ_RESPMAN_M(CNSDREQ_ID,', ','xx')) AS RESPMAN_NM_STR 
           FROM (
                  SELECT CNSDREQ_ID ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT
                        ,CNTRT_ID ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,CNTRT_RESPMAN_NM
                        ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN ,CNTRT_NM ,CNTRT_CNCLSNDAY, BIZ_CLSFCN
                        ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM ,RESPMAN_NM
                        ,ROW_NUMBER() OVER(PARTITION BY CNTRT_ID, CNSDREQ_ID ORDER BY RESPMAN_SRT ASC, RESPMAN_NM ASC) AS RESP_NUM
                    FROM (
                           SELECT N.CNSDREQ_ID ,N.ACPT_DT ,N.REQ_DT ,N.REQMAN_NM ,N.MN_CNSD_DEPT
                                 ,N.CNTRT_ID ,N.PRCS_DEPTH ,N.DEPTH_STATUS ,N.CNTRT_OPPNT_NM ,N.CNTRT_RESPMAN_NM
                                 ,N.CNTRT_RESP_DEPT_NM ,N.CNTRT_INFO_GBN ,N.CNTRT_NM ,N.CNTRT_CNCLSNDAY, N.BIZ_CLSFCN
                                 ,N.RN ,N.TOTAL_CNT ,N.PRCS_DEPTH_NM ,N.DEPTH_STATUS_NM
                                 ,CASE WHEN O.RESP_DEPT = N.MN_CNSD_DEPT
                                            THEN ISNULL(TCU.USER_SRT, 9999)
                                            ELSE ISNULL(TCU.USER_SRT, 9999) + 10000
                                  END AS RESPMAN_SRT
                                 ,O.RESPMAN_NM
                             FROM (
                                    SELECT H.CNSDREQ_ID ,H.ACPT_DT ,H.REQ_DT ,H.REQMAN_NM ,H.MN_CNSD_DEPT
                                          ,H.CNTRT_ID ,H.PRCS_DEPTH ,H.DEPTH_STATUS ,H.CNTRT_OPPNT_NM ,H.CNTRT_RESPMAN_NM
                                          ,H.CNTRT_RESP_DEPT_NM ,H.CNTRT_INFO_GBN ,H.CNTRT_NM ,H.CNTRT_CNCLSNDAY, H.BIZ_CLSFCN
                                          ,H.RN ,H.TOTAL_CNT
                                          ,CASE WHEN :vo.session_user_locale = 'ko' THEN I.CD_NM 
                                          		WHEN :vo.session_user_locale = 'fr' THEN I.CD_NM_FRA
                                          	    WHEN :vo.session_user_locale = 'de' THEN I.CD_NM_DEU
                                           ELSE I.CD_NM_ENG END AS PRCS_DEPTH_NM
                                          ,CASE WHEN :vo.session_user_locale = 'ko' THEN J.CD_NM
                                          		WHEN :vo.session_user_locale = 'fr' THEN J.CD_NM_FRA
                                          	    WHEN :vo.session_user_locale = 'de' THEN J.CD_NM_DEU
                                           ELSE J.CD_NM_ENG END
                                           +
                                           CASE WHEN H.DEPTH_STATUS IN ('C02606', 'C02608')
                                           			THEN 
                                           				CASE WHEN :vo.session_user_locale = 'ko' THEN
                                           					CASE WHEN H.PLNDBN_REQ_YN = 'Y'
                                           							THEN '(최종)'
                                           							ELSE '(' + H.LVL + '차)'
                                           				 	END
                                           				 ELSE
                                           				 	CASE WHEN H.PLNDBN_REQ_YN = 'Y'
                                           							THEN '(Final)'
                                           							ELSE 
                                           								CASE WHEN H.LVL = '1' THEN '(' + H.LVL + 'st)'
																			 WHEN H.LVL = '2' THEN '(' + H.LVL + 'nd)'
																			 WHEN H.LVL = '3' THEN '(' + H.LVL + 'rd)'
																			 ELSE '(' + H.LVL + 'th)'
																		END
                                           				 	END
                                           				 END
                                           			ELSE ''
                                           END 
                                           AS DEPTH_STATUS_NM
                                      FROM (
                                             SELECT CNSDREQ_ID ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT, VC_CNSD_DEPT
                                                   ,CNTRT_ID ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,CNTRT_RESPMAN_NM
                                                   ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN ,CNTRT_NM ,CNTRT_CNCLSNDAY, BIZ_CLSFCN
                                                   ,PLNDBN_REQ_YN ,LVL
                                                   ,ROWNUM AS RN ,COUNT(1) OVER() AS TOTAL_CNT
                                               FROM (
                                                      SELECT C.CNSDREQ_ID ,C.ACPT_DT ,C.REQ_DT ,C.REQMAN_NM ,C.MN_CNSD_DEPT, C.VC_CNSD_DEPT
                                                            ,E.CNTRT_ID ,E.PRCS_DEPTH ,E.DEPTH_STATUS ,E.CNTRT_OPPNT_NM ,E.CNTRT_RESPMAN_NM
                                                            ,E.CNTRT_RESP_DEPT_NM ,E.CNTRT_INFO_GBN ,E.CNTRT_NM ,E.CNTRT_CNCLSNDAY, E.BIZ_CLSFCN
                                                            ,C.PLNDBN_REQ_YN ,C.LVL
                                                        FROM (
                                                               SELECT CNSDREQ_ID ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT, VC_CNSD_DEPT, PLNDBN_REQ_YN ,LVL
                                                                 FROM (
                                                                        SELECT A.CNSDREQ_ID ,B.ACPT_DT ,A.MN_CNSD_DEPT, A.VC_CNSD_DEPT
                                                                              ,REPLACE(CONVERT(CHAR(10), B.ACPT_DT, 23),'-','') AS REQ_DT  
                                                                              ,A.REQMAN_NM
                                                                              ,CASE WHEN (B.COWORK IS NULL AND D.CNCLSNPURPS_BIGCLSFCN <> 'T0302') THEN 'N' ELSE 'Y' END AS COWORK_FLAG
                                                                              ,A.PLNDBN_REQ_YN ,B.LVL
                                                                          FROM TN_CLM_CONT_CNSDREQ A
                                                                              ,(
																				SELECT A.CNSD_LEVEL AS LVL,
																					   A.CNSDREQ_ID,
																					   B.VC_CNSD_DEPT AS COWORK,
																					   B.ACPT_DT
																				  FROM TN_CLM_CONT_CNSDREQ A,
																							(SELECT FST_CNSDREQ_ID,
																				              MAX(CNSD_LEVEL) AS CNSD_LEVEL,
																				              MAX(VC_CNSD_DEPT) AS VC_CNSD_DEPT,
																											MIN(ISNULL(ACPT_DT, REG_DT)) AS ACPT_DT
																				          FROM TN_CLM_CONT_CNSDREQ
																								WHERE PRGRS_STATUS <> 'C04201'
																								  AND DEL_YN = 'N'
																				        GROUP BY FST_CNSDREQ_ID) B
																				 WHERE A.FST_CNSDREQ_ID = B.FST_CNSDREQ_ID
																				   AND A.CNSD_LEVEL = B.CNSD_LEVEL
																				   AND A.DEL_YN = 'N'
                                                                               ) B
                                                                               ,TB_COM_USER C
                                                                               ,TN_CLM_CONTRACT_CNSD CNSD
                                                                               ,TN_CLM_CONTRACT_MASTER D
                                                                         WHERE A.DEL_YN = 'N'
                                                                           AND A.CNSDREQ_ID = B.CNSDREQ_ID
                                                                           AND C.USER_ID = :vo.user_id
                                                                           AND A.CNSDREQ_ID = CNSD.CNSDREQ_ID
                                                                           AND CNSD.CNTRT_ID = D.CNTRT_ID
                                                                           AND DBO.DECODE5(C.RESP_OPERDIV, 'C06099', C.BLNGT_ORGNZ, 'C06299', C.BLNGT_ORGNZ, A.REQ_OPERDIV) = A.REQ_OPERDIV
#if (!$vo.srch_start_reqday.equals(""))
                                                                           AND REPLACE(CONVERT(CHAR(10), B.ACPT_DT, 23),'-','') >= :vo.srch_start_reqday	-- 의뢰일 검색(시작일)
#end
#if (!$vo.srch_end_reqday.equals(""))
                                                                           AND REPLACE(CONVERT(CHAR(10), B.ACPT_DT, 23),'-','') <= :vo.srch_end_reqday		-- 의뢰일 검색(종료일)
#end
#if (!$vo.srch_cnsdman_nm.equals(""))
                                                                           AND		A.CNSDREQ_ID IN ( SELECT SA.CNSDREQ_ID 
																									FROM TN_CLM_CONT_CNSDREQ_RESPMAN SA, TB_COM_USER SB
																									WHERE SA.RESPMAN_ID = SB.USER_ID	
																									AND ( UPPER(SB.USER_NM) LIKE '%' + UPPER( :vo.srch_cnsdman_nm ) + '%'
																											OR UPPER(SB.USER_NM_ENG) LIKE '%' + UPPER( :vo.srch_cnsdman_nm ) + '%' )
																									UNION ALL
																									SELECT CNSDREQ_ID
																									FROM TN_CLM_CONT_CNSDREQ_RESPMAN SA 
																									WHERE 	
																									NOT EXISTS ( SELECT 'NO' FROM TB_COM_USER WHERE USER_ID = SA.RESPMAN_ID) 
																									AND UPPER(RESPMAN_NM) LIKE '%' + :vo.srch_cnsdman_nm + '%'
																									)                    
#end
                                                                      )
#if ($vo.session_blngt_orgnz.equals("A00000003"))
                                                                WHERE COWORK_FLAG = 'Y'		-- IP센터는 의뢰이력중에서 IP센터가 검토 한 것만 추출
#end
                                                             ) C
                                                            ,(
                                                               SELECT CCC.CNSDREQ_ID ,CCM.CNTRT_ID ,CCM.PRCS_DEPTH ,CCM.DEPTH_STATUS ,CCM.CNTRT_OPPNT_NM
                                                                     ,CCM.CNTRT_RESPMAN_NM ,CCM.CNTRT_RESP_DEPT_NM ,CCM.CNTRT_INFO_GBN ,CCM.CNTRT_NM ,CCM.CNTRT_CNCLSNDAY,CCM.BIZ_CLSFCN
                                                                 FROM TN_CLM_CONTRACT_MASTER CCM
                                                                     ,TN_CLM_CONTRACT_CNSD CCC
                                                                WHERE CCM.DEL_YN = 'N'
                                                                  --AND CCM.DEPTH_STATUS > 'C02602'
                                                                  --AND CCM.CNTRT_STATUS < 'C02406'
                                                                  AND (CCM.CNTRT_INFO_GBN IN ('C05401', 'C05403')
                                                                       OR (CCM.CNTRT_INFO_GBN IN ('C05404')
                                                                           AND CCM.PRCS_DEPTH IN ('C02504', 'C02505')))
                                                                  AND CCC.CNTRT_ID = CCM.CNTRT_ID
#if (!$vo.srch_review_title.equals(""))
                                                                  AND UPPER(CCM.CNTRT_NM) LIKE '%' + UPPER(:vo.srch_review_title) + '%'	-- 계약명 검색
#end
#if (!$vo.srch_resp_dept.equals(""))
                                                                  AND CCM.CNTRT_RESP_DEPT LIKE '%' + :vo.srch_resp_dept + '^%'			-- 계약 담당부서 검색
#end
#if (!$vo.srch_respman_nm.equals(""))
                                                                  
                                                                  AND 'Y' = CASE WHEN UPPER(CCM.CNTRT_RESPMAN_NM)  LIKE '%' + UPPER( :vo.srch_respman_nm ) + '%' THEN 'Y'
																				WHEN 
																				ISNULL((SELECT CASE WHEN UPPER(USER_NM) LIKE '%' + UPPER( :vo.srch_respman_nm ) + '%' THEN 'Y'
																			  		WHEN UPPER(USER_NM_ENG) LIKE '%' + UPPER( :vo.srch_respman_nm ) + '%' THEN 'Y'
																			  		ELSE 'N' END
																					FROM TB_COM_USER WHERE USER_ID = CCM.CNTRT_RESPMAN_ID),'N') = 'Y' THEN 'Y'
																				ELSE 'N' END
#end
#if (!$vo.srch_oppnt_cd.equals(""))
                                                                  AND CCM.CNTRT_OPPNT_CD = :vo.srch_oppnt_cd								-- 거래 상대방 검색
#end
#if (!$vo.srch_step.equals(""))
                                                                  AND CCM.PRCS_DEPTH = :vo.srch_step										-- 단계 검색
#end
#if (!$vo.srch_state.equals(""))
                                                                  AND CCM.DEPTH_STATUS = :vo.srch_state										-- 상태 검색
#end
#if (!$vo.srch_biz_clsfcn.equals(""))
                                                                  AND CCM.BIZ_CLSFCN = :vo.srch_biz_clsfcn									-- 비즈니스단계 검색
#end
#if (!$vo.srch_cnclsnpurps_bigclsfcn.equals(""))
                                                                  AND CCM.CNCLSNPURPS_BIGCLSFCN = :vo.srch_cnclsnpurps_bigclsfcn			-- 체결목적 검색
#end

#if (!$vo.srch_start_cnlsnday.equals(""))
                                                                  AND CCM.CNTRT_CNCLSNDAY >= :vo.srch_start_cnlsnday						-- 체결일 검색(시작일)
#end
#if (!$vo.srch_end_cnlsnday.equals(""))
                                                                  AND CCM.CNTRT_CNCLSNDAY <= :vo.srch_end_cnlsnday							-- 체결일 검색(종료일)
#end
#if (!$vo.srch_if_sys_cd.equals(""))
                                                                  AND CCM.IF_SYS_CD = :vo.srch_if_sys_cd									-- 연계시스템 검색
#end
                                                             ) E
                                                       WHERE C.CNSDREQ_ID = E.CNSDREQ_ID
                                                       ORDER BY C.ACPT_DT DESC
                                                    )
                                           ) H
                                          ,TB_COM_CD I
                                          ,TB_COM_CD J
                                     WHERE H.RN BETWEEN :vo.start_index AND :vo.end_index
                                       AND H.PRCS_DEPTH = I.CD
                                       AND H.DEPTH_STATUS = J.CD
                                  ) N LEFT OUTER JOIN
                                 TN_CLM_CONT_CNSDREQ_RESPMAN O ON N.CNSDREQ_ID = O.CNSDREQ_ID
                                 LEFT OUTER JOIN
                                 TB_COM_USER TCU ON O.RESPMAN_ID = TCU.USER_ID
                         )
                )
          START WITH RESP_NUM = 1
         CONNECT BY PRIOR RESP_NUM = RESP_NUM - 1
                AND PRIOR CNSDREQ_ID = CNSDREQ_ID
       )
 GROUP BY CNSDREQ_ID ,ACPT_DT ,REQ_DT ,REQMAN_NM ,MN_CNSD_DEPT
         ,CNTRT_ID ,PRCS_DEPTH ,DEPTH_STATUS ,CNTRT_OPPNT_NM ,CNTRT_RESPMAN_NM
         ,CNTRT_RESP_DEPT_NM ,CNTRT_INFO_GBN ,CNTRT_NM ,CNTRT_CNCLSNDAY
         ,RN ,TOTAL_CNT ,PRCS_DEPTH_NM ,DEPTH_STATUS_NM, BIZ_CLSFCN
 ORDER BY RN ASC
            ]]>
            </statement>
        </query>
        
		<query id="las.contractmanager.listConsiderationPop" isCamelCase="false" comment="상대회사관련 계약건 팝업 ">
            <statement>
            <![CDATA[
	            SELECT *
	              FROM(   SELECT rownum RN, t.*, COUNT(1) over() TOTAL_CNT
			                FROM ( SELECT  C.CNSDREQ_ID
			                			  ,A.CNTRT_ID
										  ,A.CNTRT_NM
										  ,D.REQMAN_NM
										  ,C.CNSDMAN_NM
										  ,TO_CHAR(D.REQ_DT, 'yyyy-MM-dd') REG_DT
									FROM  TN_CLM_CONTRACT_MASTER A
										 ,TN_CLM_CONTRACT_CNSD C
										 ,TN_CLM_CONT_CNSDREQ D
										 #if(!($vo.top_role.equals("RA00") + $vo.top_role.equals("RA01")))
										 	,TN_CLM_CONT_CNSDREQ_RESPMAN E
										 #end
                                    WHERE A.REGION_GBN = DBO.DECODE5(:vo.session_blngt_orgnz, 'A00000001', 'C01801', 'A00000002', 'C01802', A.REGION_GBN)
									#if (!$vo.srch_cntrt_nm.equals(""))
										AND UPPER(A.CNTRT_NM) LIKE '%' + UPPER(:vo.srch_cntrt_nm) + '%'
									#end
										AND UPPER(A.CNTRT_OPPNT_NM) LIKE '%' + UPPER(:vo.cntrt_oppnt_nm) + '%'
		                            #if(!($vo.top_role.equals("RA00") + $vo.top_role.equals("RA01")))
		                            	AND E.RESPMAN_ID = :vo.user_id
	                                    AND E.RESP_DEPT = :vo.blngt_orgnz
	                                    AND C.CNSDREQ_ID = E.CNSDREQ_ID
		                            #end
									AND A.CNTRT_ID = C.CNTRT_ID
									AND C.CNSDREQ_ID = D.CNSDREQ_ID 
									AND C.CNSDREQ_ID <> :vo.cnsdreq_id
									AND (D.MN_CNSD_DEPT = :vo.blngt_orgnz OR D.VC_CNSD_DEPT = :vo.blngt_orgnz)
									AND D.PRGRS_STATUS <> 'C04201'
                                    AND D.PRGRS_STATUS <> 'C04202'
                                    GROUP BY   C.CNSDREQ_ID
				                			  ,A.CNTRT_ID
											  ,A.CNTRT_NM
											  ,D.REQMAN_NM
											  ,C.CNSDMAN_NM
											  ,TO_CHAR(D.REQ_DT, 'yyyy-MM-dd')
	                             ) t
	            		ORDER BY RN 
	            		)
	            WHERE RN between ISNULL(:vo.start_index_pop,1) and ISNULL(:vo.end_index_pop,1)
            ]]>
            </statement>
        </query>
        
		<query id="las.contractmanager.detailConsideration" isCamelCase="false" comment="검토의뢰 보기 ">
		  <statement>
		    <![CDATA[
			    SELECT ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID DESC) AS RN
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.BIZ_CLSFCN ) AS BIZ_CLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.DEPTH_CLSFCN ) AS DEPTH_CLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNCLSNPURPS_BIGCLSFCN ) AS CNCLSNPURPS_BIGCLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNCLSNPURPS_MIDCLSFCN ) AS CNCLSNPURPS_MIDCLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNTRT_TRGT ) AS CNTRT_TRGT_NM 
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				      				WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				       				ELSE CD_NM_ENG END FROM TB_COM_CD WHERE CD = A.PAYMENT_GBN ) AS PAYMENT_GBN_NM 
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				      				WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				       				ELSE CD_NM_ENG END FROM TB_COM_CD WHERE CD = A.BFHDCSTN_APBT_MTHD ) AS BFHDCSTN_APBT_MTHD_NM 
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				      				WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				       				ELSE CD_NM_ENG END FROM TB_COM_CD WHERE CD = A.CNTRT_OPPNT_TYPE ) AS CNTRT_OPPNT_TYPE_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				      				WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				       				ELSE CD_NM_ENG END FROM TB_COM_CD WHERE CD = A.LOAC ) AS LOAC_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				      				WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				       				ELSE CD_NM_ENG END FROM TB_COM_CD WHERE CD = A.DSPT_RESOLT_MTHD ) AS DSPT_RESOLT_MTHD_NM	
				      ,CASE
							WHEN :vo.session_user_locale = 'fr' THEN
								CASE WHEN depth_status= 'C02603' THEN 'ABANDONNER le contrat' + CONVERT(VARCHAR, ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID) ) ELSE 'Contrats' + CONVERT(VARCHAR, ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID) ) END
							WHEN :vo.session_user_locale = 'de' THEN
								CASE WHEN depth_status= 'C02603' THEN 'Vertrag ablegen' + CONVERT(VARCHAR, ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID) ) ELSE 'Vertrag' + CONVERT(VARCHAR, ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID) ) END
							ELSE
								CASE WHEN depth_status= 'C02603' THEN 'DROP Contract' + CONVERT(VARCHAR, ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID) ) ELSE 'Contract' + CONVERT(VARCHAR, ROW_NUMBER() OVER(ORDER BY A.CNSDREQ_ID) ) END
							END AS TAB_NM
				      ,A.*
				      ,(SELECT OFFICE_TEL_NO FROM TB_COM_USER WHERE USER_ID = A.REQMAN_ID) AS REQMAN_TEL
				     ,CASE WHEN A.RESP_ID = A.CNSDREQ_ID THEN 'Y' 
				     ELSE 'N' 
				     END SEC_RESP_YN
					,CASE WHEN (SELECT COUNT(RESPMAN_ID) FROM TN_CLM_CONT_CNSDREQ_RESPMAN WHERE CNSDREQ_ID = A.CNSDREQ_ID AND RESP_DEPT = A.MN_CNSD_DEPT AND A.PRGRS_STATUS IN ('C04202', 'C04203', 'C04204', 'C04206') 
				    		AND RESPMAN_ID = :vo.user_id) = 1 THEN 
				    			CASE WHEN A.PLNDBN_REQ_YN = 'Y' THEN 'Y' ELSE 'N' END 
				   			ELSE 'N' END RESP_USER_DIV 
					,MARK_NUM
					,CLOSE_YN
					,PRCS_DEPTH	
					,A.BIZ_CLSFCN AS BIZ_CD
					,A.DEPTH_CLSFCN AS DEPTH_CD
					,A.CNCLSNPURPS_BIGCLSFCN AS CNSL_BIG_CD
					,A.CNSL_MID_CD2 AS CNSL_MID_CD2
					,A.TOP30 AS TOP30
					,A.CONT_KIND_TYPE AS CONT_KIND_TYPE
					,A.HQ_REQ_YN AS HQ_REQ_YN
					,A.CONT_DRAFT AS CONT_DRAFT
					,A.TOP_30_CUS AS TOP_30_CUS
					,A.RELATED_PRODUCTS AS RELATED_PRODUCTS
					,(select GERP_CD from TN_CLM_CUSTOMER  where CUSTOMER_CD= A.cntrt_oppnt_cd) GERP_CD
					,A.SYS_NM
					,A.CNTRT_TRGT AS CNTRT_TRGT_CD
					,A.CHECK_LIST_YN	
				FROM 
				    (SELECT  A.CNSDREQ_ID
							,A.MN_CNSD_DEPT
							,A.MN_RESPMAN_APNT_YN
							,A.VC_CNSD_DEPT
							,A.VC_CNSD_DEMND_DT
							,A.VC_CNSD_DEMND_CONT AS VC_CNSD_DEMND_CONT
							,A.VC_RESPMAN_APNT_YN
							,A.DMSTFRGN_GBN
							,A.DRAFT_DEMND_YN
							,A.PLNDBN_REQ_YN
							,A.LAST_CNSD_YN
							,A.PREV_CNSDREQ_ID
							,A.REQ_TITLE
							,A.REQMAN_ID
							,A.REQMAN_NM
							,A.REQ_DEPT
							,A.REQ_DEPT_NM
							,CONVERT(varchar(19), A.REQ_DT, 23) AS REQ_DT
							,SUBSTRING(A.RE_DEMNDDAY,1,4) + '-' + SUBSTRING(A.RE_DEMNDDAY,5,2) + '-' + SUBSTRING(A.RE_DEMNDDAY,7,2) AS RE_DEMNDDAY
							,A.LASTBN_CHGE_YN
							,CASE 
								WHEN A.LASTBN_CHGE_YN = 'Y' THEN 'YES' 
								WHEN A.LASTBN_CHGE_YN = 'N' THEN 'NO' 
								ELSE ''
							END LASTBN_CHGE_YN_NM
							,A.CNSD_DEMND_CONT
							,A.PRGRS_STATUS
							,A.REBFR_APPRVL_YN
							,A.CNSD_LEVEL
							,CONVERT(varchar(19), A.RE_DT, 120) AS RE_DT
							,A.PUB_YN
							,A.REG_DT
							,A.REG_ID
							,A.REG_NM
							,A.MOD_DT
							,A.MOD_ID
							,A.MOD_NM
							,A.DEL_YN
							,A.DEL_DT
							,A.DEL_ID
							,A.DEL_NM
							,A.REQ_OPERDIV
							,A.REQ_UP_DEPT
							,A.REQMAN_JIKGUP_NM
							,A.ACPT_DT
							,A.PLNDBN_CHGE_CONT
							,A.CNSD_HOLD_CAUSE
							,A.FST_REQ_DEPT
							,A.FST_REQ_UP_DEPT
							,A.REQ_INTNL_DEPT_CD
							,A.FAST_TRACK_DIV
							,A.SYS_NM
							,B.CNTRT_ID
							,ISNULL(B.CNTRT_NM_EN, B.CNTRT_NM) AS CNTRT_NM
				    		,CASE 
				    			WHEN HOLD.CNSDREQ_ID IS NULL THEN B.DEPTH_STATUS 
				    			WHEN HOLD.CNSDREQ_ID = '' THEN B.DEPTH_STATUS
				    			ELSE 'C02603'
				    		END AS DEPTH_STATUS	
                 			,B.BIZ_CLSFCN
                 			,B.DEPTH_CLSFCN
                 			,B.CNCLSNPURPS_BIGCLSFCN
                 			,B.CNCLSNPURPS_MIDCLSFCN
                 			,B.CNTRT_TRGT
                 			,B.PAYMENT_GBN
                 			,B.BFHDCSTN_APBT_MTHD
                 			,B.BFHDCSTN_MTNMAN_NM
	  						,B.BFHDCSTN_APBTMAN_NM
	  						,B.CNTRTPERIOD_STARTDAY
	  						,B.CNTRTPERIOD_ENDDAY
	  						,B.CNTRT_NO
	  						,B.CNTRT_TRGT_DET
	  						,B.CNTRT_UNTPRC_EXPL
	  						,B.CNTRT_OPPNT_NM
					  		,B.CNTRT_OPPNT_RPRSNTMAN
					  		,B.CNTRT_OPPNT_TYPE
					  		,B.PSHDBKGRND_PURPS
					  		,B.ANTCPTNEFCT
					  		,B.PAYMENT_COND
					  		,B.ETC_MAIN_CONT
					  		,B.OBLGT_LMT
					  		,B.SPCL_COND
					  		,B.LOAC_ETC
					  		,B.DSPT_RESOLT_MTHD
					  		,B.DSPT_RESOLT_MTHD_DET
					  		,B.SECRET_KEEPPERIOD
					  		,B.CNTRT_RESPMAN_ID
					  		,B.CNTRT_RESPMAN_NM
					  		,B.CNTRT_RESP_DEPT_NM
					  		,B.CNTRT_RESPMAN_JIKGUP_NM
					  		,B.CNTRT_OPPNT_CD
					  		,B.BFHDCSTN_APBTMAN_JIKGUP_NM
					  		,B.BFHDCSTN_APBT_DEPT_NM
					  		,B.BFHDCSTN_MTNMAN_JIKGUP_NM
					  		,B.BFHDCSTN_MTN_DEPT_NM
					  		,B.CRRNCY_UNIT
					  		,B.LOAC
					  		,B.AUTO_RNEW_YN
					  		,B.cnclsnpurps_midclsfcn_etc
					  		,B.SOLO_YN
					  		,B.MARK_NUM
					  	    ,B.CLOSE_YN 
					  	    ,(SELECT CD_NM FROM TB_COM_CD WHERE SYS_CD ='LAS' AND GRP_CD ='SOC01' AND CD=B.CONT_DRAFT) AS CONT_DRAFT 
			       			,(SELECT CD_NM FROM TB_COM_CD WHERE SYS_CD ='LAS' AND GRP_CD ='C056' AND CD=B.TOP_30_CUS ) AS TOP_30_CUS
			       			,(SELECT CD_NM FROM TB_COM_CD WHERE SYS_CD ='LAS' AND GRP_CD ='RP01' AND CD=B.RELATED_PRODUCTS ) AS RELATED_PRODUCTS
						    ,CASE 
				    			WHEN A.VC_CNSD_DEMND_DT IS NULL THEN ''				    			
				    			ELSE CONVERT(varchar(19), A.VC_CNSD_DEMND_DT, 120)
				    		END AS REQ_CNSD_DEMND_DT	
						    
						    ,C.CNSD_STATUS
						    ,C.CNSDMAN_ID
						    ,CASE 
				    			WHEN CNSDMAN.COMP_CD =  'C10' THEN 
				    				CASE 
				    					WHEN :vo.session_user_locale = 'ko' THEN CNSDMAN.USER_NM				    			
				    					ELSE CNSDMAN.USER_NM_ENG
				    				END				    			
				    			ELSE dbo.COM_USER_INFO(C.CNSDMAN_ID, 'H')
				    		END AS CNSDMAN_INFO	
						    ,(SELECT CD_NM FROM TB_COM_CD WHERE GRP_CD = 'C042' AND CD = A.PRGRS_STATUS) AS PRGRS_STATUS_NM
						    ,CASE 
						    	WHEN D.DEMND_DT IS NULL THEN '' 
						    	ELSE CONVERT(varchar(19), D.DEMND_DT, 120) 
						    END AS REQ_DEMND_DT
						    ,CASE 
						    	WHEN D.HNDL_DT IS NULL THEN '' 
						    	ELSE CONVERT(varchar(19), D.HNDL_DT, 120) 
						    END AS RES_HNDL_DT
				    		
				    		,dbo.COM_USER_INFO(D.DEMNDMAN_ID, 'H') AS REQ_DEMNDMAN_NM
				    		,dbo.COM_USER_INFO(D.HNDLMAN_ID, 'H') AS RES_HNDLMAN_NM
				    		,D.DEMND_CAUSE AS REQ_DEMND_CAUSE
				    		,D.HNDL_CAUSE AS RES_HNDL_CAUSE
						    ,D.TRANS_STATUS AS TRANS_STATUS
				            ,C.CNSD_OPNN
				            ,C.CNSD_MEMO
				            ,E.APBT_MEMO
	  						,E.AUTO_APBT_YN
	  						,CONVERT(VARCHAR, CONVERT(datetime, B.BFHDCSTN_APBTDAY, 23), 23) AS CHG_BFHDCSTN_APBTDAY 
							,CASE 
								WHEN ISNULL(B.cntrt_amt,0) = 0 THEN '' 
								ELSE CONVERT(VARCHAR(50), CAST(B.cntrt_amt AS MONEY), 1) 
							END AS CNTRT_AMT_CHG
	  						,RESP.CNSDREQ_ID RESP_ID
	  						,B.PRCS_DEPTH
	  						,B.CONT_DRAFT AS CONT_KIND_TYPE
	  						,B.CNCLSNPURPS_BIGCLSFCN AS CNSL_BIG_CD2
	  						,B.CNCLSNPURPS_MIDCLSFCN AS CNSL_MID_CD2
	  						,B.TOP_30_CUS AS TOP30
	  						,( SELECT DISTINCT MAX(B.HQ_REQ_YN) 
	  						     FROM TN_CLM_CONT_CNSDREQ A
	  						     JOIN TN_CLM_CONTRACT_CNSD B ON A.CNSDREQ_ID = B.CNSDREQ_ID
	  						    WHERE A.CNSDREQ_ID =  :vo.cnsdreq_id
	  						  ) AS HQ_REQ_YN
	  						,B.SYS_NM AS MSYS_NM
	  						,B.CHECK_LIST_YN
				    FROM TN_CLM_CONT_CNSDREQ A
				    INNER JOIN TN_CLM_CONTRACT_CNSD C
                    ON A.CNSDREQ_ID = C.CNSDREQ_ID
                    INNER JOIN TN_CLM_CONTRACT_MASTER B
                    ON  B.CNTRT_ID = C.CNTRT_ID
				    LEFT OUTER JOIN TN_CLM_CONT_CNSDREQ_TRANSFER D
				    ON	C.CNSDREQ_ID = D.CNSDREQ_ID
				    LEFT OUTER JOIN TN_CLM_CONT_CNSDREQ_RESPMAN E
				    ON	C.CNSDREQ_ID = E.CNSDREQ_ID
				    LEFT OUTER JOIN TN_CLM_CONT_CNSDREQ_HOLD HOLD
				    ON	A.CNSDREQ_ID = HOLD.CNSDREQ_ID
				    AND	HOLD.HOLD_SEQNO = '1'
				    
				    LEFT OUTER JOIN (SELECT B.CNSDREQ_ID
									FROM TN_CLM_CONT_CNSDREQ_RESPMAN B, TN_COM_SEC_MNG_COMP C
									WHERE B.CNSDREQ_ID = 'H201304255590'
									AND B.RESPMAN_ID = C.USER_ID
									GROUP BY B.CNSDREQ_ID ) RESP
					ON  A.CNSDREQ_ID = RESP.CNSDREQ_ID
					LEFT OUTER JOIN TB_COM_USER CNSDMAN
				    ON	C.CNSDMAN_ID = CNSDMAN.USER_ID
				    WHERE 1=1 
				    AND A.CNSDREQ_ID = :vo.cnsdreq_id
				    AND A.DEL_YN = 'N'
				    AND B.DEL_YN = 'N'
				    ) A
				WHERE 1=1
				
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.detailConsiderationCnsdInfo" isCamelCase="false" comment="검토의뢰 요약 정보[검토이력 사용]">
		  <statement>
		    <![CDATA[
			    SELECT DECODE(A.VC_CNSD_DEPT, :vo.blngt_orgnz, 'VC', 'MN') AS DEPT_DIV
			      FROM TN_CLM_CONT_CNSDREQ A,
			           (SELECT CNSDREQ_ID,
			            	   CNTRT_ID,
			            	   CNSD_DEPT,
			            	   APBT_OPNN 
			              FROM TN_CLM_CONTRACT_DEPTCNSD B
			     WHERE A.CNSDREQ_ID = :vo.cnsdreq_id
			     	   A.CNSDREQ_ID = B.CNSDREQ_ID(+)
			     	   B.CNTRT_ID = :vo.cntrt_id
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.contractCnsdrejct" isCamelCase="false" comment="A.계약별_부서검토반려 ">
		  <statement>
		    <![CDATA[
		        SELECT 	CNSD_STATUS,
		        	   	(SELECT CD_NM FROM TB_COM_CD WHERE GRP_CD = 'C043' AND CD = CNSD_STATUS) AS CNSD_STATUS_NM,
		        	   	APBTMAN_NM AS APBTMAN_NM,
		        	   	APBT_DT,
		        	   	APBT_OPNN AS APBT_OPNN,
		        	   	(SELECT REJCT_OPNN
				  		   FROM TH_CLM_CONTRACT_CNSDREJCT
				 		  WHERE (CNSDREQ_ID, CNTRT_ID, SEQNO) IN  (SELECT CNSDREQ_ID, CNTRT_ID, MAX(SEQNO) AS SEQNO
																				FROM TH_CLM_CONTRACT_CNSDREJCT
																			   WHERE CNSDREQ_ID = :vo.cnsdreq_id
																				 AND CNTRT_ID = :vo.cntrt_id
																			   GROUP BY CNSDREQ_ID, CNTRT_ID)) AS REJCT_OPNN
		          FROM TN_CLM_CONTRACT_CNSD 
		         WHERE CNSDREQ_ID = :vo.cnsdreq_id
				   AND CNTRT_ID = :vo.cntrt_id
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.contractDeptcnsdrejct" isCamelCase="false" comment="B.계약별_부서검토반려 ">
		  <statement>
		    <![CDATA[
		        SELECT 	CNSD_STATUS,
		        	   	(SELECT CD_NM FROM TB_COM_CD WHERE GRP_CD = 'C043' AND CD = CNSD_STATUS) AS CNSD_STATUS_NM,
		        	   	APBTMAN_NM AS APBTMAN_NM,
		        	   	APBT_DT,
		        	   	APBT_OPNN,
		        	   	APBT_MEMO,
		        	   	(SELECT REJCT_OPNN
                           FROM TH_CLM_CONTRACT_DEPTCNSDREJCT A
                          WHERE CNSDREQ_ID IN (  SELECT CNSDREQ_ID
                                                   FROM TH_CLM_CONTRACT_DEPTCNSDREJCT B
                                                  WHERE CNSDREQ_ID = :vo.cnsdreq_id
                                                    AND CNTRT_ID = :vo.cntrt_id
                                                    AND CNSD_DEPT = :vo.blngt_orgnz
                                               GROUP BY CNSDREQ_ID ) 
		                    AND CNTRT_ID IN (  SELECT   CNTRT_ID
                                                   FROM TH_CLM_CONTRACT_DEPTCNSDREJCT B
                                                  WHERE CNSDREQ_ID = :vo.cnsdreq_id
                                                    AND CNTRT_ID = :vo.cntrt_id
                                                    AND CNSD_DEPT = :vo.blngt_orgnz
                                               GROUP BY CNTRT_ID ) 
		                    AND CNSD_DEPT IN (  SELECT  CNSD_DEPT
                                                   FROM TH_CLM_CONTRACT_DEPTCNSDREJCT B
                                                  WHERE CNSDREQ_ID = :vo.cnsdreq_id
                                                    AND CNTRT_ID = :vo.cntrt_id
                                                    AND CNSD_DEPT = :vo.blngt_orgnz
                                               GROUP BY CNSD_DEPT ) 
		                    AND SEQNO  IN(  SELECT      MAX (SEQNO) AS SEQNO
                                                   FROM TH_CLM_CONTRACT_DEPTCNSDREJCT B
                                                  WHERE CNSDREQ_ID = :vo.cnsdreq_id
                                                    AND CNTRT_ID = :vo.cntrt_id
                                                    AND CNSD_DEPT = :vo.blngt_orgnz
                                                )   ) AS REJCT_OPNN
		          FROM TN_CLM_CONTRACT_DEPTCNSD
		         WHERE CNSDREQ_ID = :vo.cnsdreq_id
				   AND CNTRT_ID = :vo.cntrt_id
				   AND CNSD_DEPT = :vo.blngt_orgnz
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.popRespman" isCamelCase="false" comment="담당자 리스트[팝업] ">
		  <statement>
		    <![CDATA[
			SELECT 
				A.USER_ID AS RESPMAN_ID, 

				CASE 
	    			WHEN A.USER_NM = '' THEN A.USER_NM_ENG		    						    			
	    			ELSE  A.USER_NM
	    		END AS RESPMAN_NM,
				A.USER_NM_ENG AS RESPMAN_NM_ENG,
				
				J.CD AS RESPMAN_DIVISION_CD,				
				CASE 	
	    			WHEN J.CD_NM_ENG = '' THEN J.CD_NM
	    			ELSE  J.CD_NM_ENG 
	    		END AS RESPMAN_DIVISION_NM,				
				J.CD_NM_ENG AS RESPMAN_DIVISION_NM_ENG,
				
				CASE 	
	    			WHEN A.JIKGUP_NM_ENG = '' THEN A.JIKGUP_NM		    						    			
	    			ELSE A.JIKGUP_NM_ENG 
	    		END AS RESPMAN_JIKGUP_NM,	
				
				A.JIKGUP_NM_ENG AS RESPMAN_JIKGUP_NM_ENG,
				ISNULL(D.CNSDREQ_CNT, 0) AS DAY_CNT,
				ISNULL(E.CNSDREQ_CNT, 0) AS WEEK_CNT,
				ISNULL(F.CNSDREQ_CNT, 0) AS MONTH_CNT,
				ISNULL(G.CNSDREQ_CNT, 0) AS YEAR_CNT,
				COUNT(H.CNSDREQ_ID) AS CNSD_CNT,
				
				CASE WHEN C.RESPMAN_ID IS NOT NULL AND C.RESPMAN_ID <> '' THEN 'Y' ELSE 'N' END  AS CHECK_YN,				
				C.MAIN_CNSD_YN,
				CASE WHEN :vo.session_user_locale = 'ko' THEN
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN '正' WHEN C.MAIN_CNSD_YN = 'N' THEN '副' END
				WHEN :vo.session_user_locale = 'fr' THEN
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN 'O' WHEN C.MAIN_CNSD_YN = 'N' THEN 'S' END
				WHEN :vo.session_user_locale = 'de' THEN
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN 'O' WHEN C.MAIN_CNSD_YN = 'N' THEN 'S' END
				ELSE
					CASE WHEN C.MAIN_CNSD_YN = 'Y' THEN 'O' WHEN C.MAIN_CNSD_YN = 'N' THEN 'S' END
				END AS MAIN_CNSD_YN_DP
				,B.ROLE_CD
			FROM 
				TB_COM_USER A 
				JOIN
				TB_COM_ROLE_USER B 
				ON  A.USER_ID = B.USER_ID

				LEFT OUTER JOIN
				(SELECT * FROM TN_CLM_CONT_CNSDREQ_RESPMAN WHERE CNSDREQ_ID = :vo.cnsdreq_id AND RESP_DEPT = :vo.blngt_orgnz) C
				ON A.USER_ID = C.RESPMAN_ID

				LEFT OUTER JOIN
			  	(SELECT A.RESPMAN_ID, 
				 		COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
				 FROM TN_CLM_CONT_CNSDREQ_RESPMAN A,
				 	  TN_CLM_CONT_CNSDREQ B
				 WHERE REPLACE(CONVERT(CHAR(10), A.ASGN_DT, 23),'-','') = REPLACE(CONVERT(CHAR(10), GETDATE(), 23),'-','') 
				   AND A.MAIN_CNSD_YN = 'Y'
				   AND A.CNSDREQ_ID = B.CNSDREQ_ID
				 GROUP BY A.RESPMAN_ID) D 
				 ON A.USER_ID = D.RESPMAN_ID

				 LEFT OUTER JOIN
				(SELECT A.RESPMAN_ID, 
				 		COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
				 FROM TN_CLM_CONT_CNSDREQ_RESPMAN A,
				 	  TN_CLM_CONT_CNSDREQ B
				 WHERE A.ASGN_DT BETWEEN dbo.GREATES ( CONVERT(VARCHAR, YEAR(GETDATE())) + '0101' ,  CONVERT(VARCHAR, REPLACE(CONVERT(DATE, DATEADD(D, -7, GETDATE())), '-', ''))  )
				                     AND REPLACE(CONVERT(VARCHAR, GETDATE(), 23),'-','')
				   AND A.MAIN_CNSD_YN = 'Y'
				   AND A.CNSDREQ_ID = B.CNSDREQ_ID
				 GROUP BY A.RESPMAN_ID) E
				 ON A.USER_ID = E.RESPMAN_ID

				 LEFT OUTER JOIN
				 (SELECT A.RESPMAN_ID, 
				 		 COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
				 FROM TN_CLM_CONT_CNSDREQ_RESPMAN A,
				 	  TN_CLM_CONT_CNSDREQ B
				 WHERE A.ASGN_DT BETWEEN dbo.GREATES ( CONVERT(VARCHAR, YEAR(GETDATE())) + '0101' ,  CONVERT(VARCHAR, REPLACE(CONVERT(DATE, DATEADD(D, -1, GETDATE())), '-', ''))  )
				                     AND REPLACE(CONVERT(VARCHAR, GETDATE(), 23),'-','')
				   AND A.MAIN_CNSD_YN = 'Y'
				   AND A.CNSDREQ_ID = B.CNSDREQ_ID
				 GROUP BY A.RESPMAN_ID) F
				 ON A.USER_ID = F.RESPMAN_ID

				 LEFT OUTER JOIN
				 (SELECT RESPMAN_ID, 
				 		 COUNT(B.FST_CNSDREQ_ID) AS CNSDREQ_CNT
				 FROM TN_CLM_CONT_CNSDREQ_RESPMAN A,
				 	  TN_CLM_CONT_CNSDREQ B
				 WHERE A.ASGN_DT BETWEEN dbo.GREATES ( CONVERT(VARCHAR, YEAR(GETDATE())) + '0101' ,  CONVERT(VARCHAR, REPLACE(CONVERT(DATE, DATEADD(D, -12, GETDATE())), '-', ''))  )
				                     AND REPLACE(CONVERT(VARCHAR, GETDATE(), 23),'-','')
				   AND A.MAIN_CNSD_YN = 'Y'
				   AND A.CNSDREQ_ID = B.CNSDREQ_ID
				 GROUP BY A.RESPMAN_ID) G
				 ON A.USER_ID = G.RESPMAN_ID

				 LEFT OUTER JOIN
				 (SELECT A.RESPMAN_ID, A.RESP_DEPT, A.CNSDREQ_ID
				    FROM TN_CLM_CONT_CNSDREQ_RESPMAN A LEFT OUTER JOIN
            			 (SELECT SA.* FROM TN_CLM_CONT_CNSDREQ SA JOIN
								(SELECT FST_CNSDREQ_ID, MAX(CNSD_LEVEL) AS CNSD_LEVEL
								FROM TN_CLM_CONT_CNSDREQ
								WHERE PRGRS_STATUS <> 'C04201'
									AND DEL_YN = 'N'
								GROUP BY FST_CNSDREQ_ID) SB 
								ON SA.FST_CNSDREQ_ID=SB.FST_CNSDREQ_ID AND SA.CNSD_LEVEL = SB.CNSD_LEVEL
						  ) B ON A.CNSDREQ_ID = B.CNSDREQ_ID
						 JOIN
				 	  	 TN_CLM_CONTRACT_CNSD C ON B.CNSDREQ_ID = C.CNSDREQ_ID
						 JOIN
				 	  	 TN_CLM_CONTRACT_MASTER D ON C.CNTRT_ID = D.CNTRT_ID
						 LEFT OUTER JOIN
				 		 TN_CLM_CONTRACT_DEPTCNSD I ON A.CNSDREQ_ID = I.CNSDREQ_ID AND A.RESP_DEPT = I.CNSD_DEPT
				   WHERE 
           			 D.DEPTH_STATUS = 'C02606'
					 AND 'Y' = CASE WHEN A.RESP_DEPT = B.MN_CNSD_DEPT THEN B.MN_RESPMAN_APNT_YN 
									WHEN A.RESP_DEPT = B.VC_CNSD_DEPT THEN B.VC_RESPMAN_APNT_YN END 
					 AND B.DEL_YN = 'N'
               		 AND B.PRGRS_STATUS < 'C04207'
               		 AND B.REQ_OPERDIV IS NOT NULL
			  		 AND (I.CNSD_STATUS IS NULL OR I.CNSD_STATUS IN ('C04301', 'C04302', 'C04303'))
					 AND NOT EXISTS (SELECT 1
                                       FROM TN_CLM_CONT_CNSDREQ_HOLD
                                      WHERE CNSDREQ_ID = B.CNSDREQ_ID
                                        AND HOLD_SEQNO = '1')
				   GROUP BY A.RESPMAN_ID, A.RESP_DEPT, A.CNSDREQ_ID) H
				   ON A.USER_ID = H.RESPMAN_ID

				   LEFT OUTER JOIN
				   (SELECT * FROM TB_COM_CD WHERE SYS_CD = 'LAS' 
								AND GRP_CD = CASE WHEN :vo.blngt_orgnz = 'A00000001' THEN 'C060'
												WHEN  :vo.blngt_orgnz = 'A00000002' THEN 'C062' 
												WHEN  :vo.blngt_orgnz = 'A00000003' THEN 'C063' ELSE '' END
				   ) J 
				   ON A.RESP_OPERDIV = J.CD

				   LEFT OUTER JOIN
				   TN_COM_SEC_MNG_COMP K 
				   ON A.USER_ID = K.USER_ID
			WHERE B.SYS_CD = 'LAS'
			  #if(!$vo.session_auth_comp_cd.equals(""))
			   
			    AND  A.COMP_CD IN ($vo.session_auth_comp_cd) 
			    AND  B.ROLE_CD = 'RA02'  
			   #end 
		GROUP BY A.USER_ID, A.USER_NM, A.USER_NM_ENG, A.BLNGT_ORGNZ, J.CD, J.CD_NM, J.CD_NM_ENG, J.CD_ORDER
				,A.DIVISION_NM, A.DIVISION_NM_ENG, A.JIKGUP_NM, A.JIKGUP_NM_ENG
				,D.CNSDREQ_CNT, E.CNSDREQ_CNT, F.CNSDREQ_CNT, G.CNSDREQ_CNT
				,C.RESPMAN_ID, C.MAIN_CNSD_YN, A.USER_SRT, B.ROLE_CD
		ORDER BY J.CD_ORDER, A.USER_SRT
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.listApbtMemo" isCamelCase="false" comment="그룹장 메세지 ">
		  <statement>
		    <![CDATA[
			SELECT A.FAST_TRACK_DIV,
				   B.APBT_MEMO,
				   ISNULL(B.AUTO_APBT_YN, 'Y') AS AUTO_APBT_YN
				   ,(SELECT SOLO_YN 
				       FROM TN_CLM_CONTRACT_MASTER 
				      WHERE CNTRT_ID = :vo.cntrt_id ) AS SOLO_YN
			  FROM TN_CLM_CONT_CNSDREQ A
  LEFT OUTER JOIN (SELECT * FROM TN_CLM_CONT_CNSDREQ_RESPMAN WHERE RESP_DEPT = :vo.blngt_orgnz ) B ON A.CNSDREQ_ID = B.CNSDREQ_ID 
			 WHERE A.CNSDREQ_ID = :vo.cnsdreq_id
			   
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.listRespman" isCamelCase="false" comment="담당자 리스트 ">
		  <statement>
		    <![CDATA[
			SELECT 
				C.RESPMAN_ID AS LIST_RESPMAN_ID, 				
				
				
				CASE 		    	
	    			WHEN :vo.session_user_locale = 'en' THEN 
	    				CASE 
							WHEN C.MAIN_CNSD_YN = 'Y' THEN '[O]' + A.USER_NM_ENG 
							ELSE   '[S]' + A.USER_NM_ENG 
						END			  
					ELSE
						CASE 
							WHEN C.MAIN_CNSD_YN = 'Y' THEN '[O]' + A.USER_NM_ENG 
							ELSE   '[S]' + A.USER_NM_ENG 
						END	  			
	    		END AS LIST_RESPMAN_NM,
	    		
	    		
	    		CASE 
					WHEN C.MAIN_CNSD_YN = 'Y' THEN '[O]' + A.USER_NM_ENG 
					ELSE   '[S]' + A.USER_NM_ENG 
				END	AS LIST_RESPMAN_NM_ENG	
				
			FROM 
				TB_COM_USER A,
				TN_CLM_CONT_CNSDREQ B,
				TN_CLM_CONT_CNSDREQ_RESPMAN C
			WHERE A.USER_ID = C.RESPMAN_ID
			  AND B.CNSDREQ_ID = :vo.cnsdreq_id
			  AND 
			      CASE B.MN_CNSD_DEPT
			        WHEN C.RESP_DEPT THEN MN_RESPMAN_APNT_YN
			      ELSE
			         CASE B.VC_CNSD_DEPT
			           WHEN C.RESP_DEPT THEN VC_RESPMAN_APNT_YN
			         ELSE 
			           'N'
			         END
			      END = 'Y'
			  AND B.CNSDREQ_ID = C.CNSDREQ_ID
			  AND C.RESP_DEPT = :vo.blngt_orgnz
			ORDER BY C.MAIN_CNSD_YN DESC
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.listRespmanSub" isCamelCase="false" comment="담당자 리스트[협업부서] ">
		  <statement>
		    <![CDATA[
			SELECT 
				C.RESPMAN_ID AS LIST_RESPMAN_ID, 
				DECODE(C.MAIN_CNSD_YN, 'Y', '[L]', 'N', '[M]') + A.USER_NM AS LIST_RESPMAN_NM,
				DECODE(C.MAIN_CNSD_YN, 'Y', '[L]', 'N', '[M]') + A.USER_NM_ENG AS LIST_RESPMAN_NM_ENG
			FROM 
				TB_COM_USER A,
				TN_CLM_CONT_CNSDREQ B,
				TN_CLM_CONT_CNSDREQ_RESPMAN C
			WHERE A.USER_ID = C.RESPMAN_ID
			  AND B.CNSDREQ_ID = :vo.cnsdreq_id
			  AND DECODE(B.MN_CNSD_DEPT, C.RESP_DEPT, MN_RESPMAN_APNT_YN, DECODE(B.VC_CNSD_DEPT, C.RESP_DEPT, VC_RESPMAN_APNT_YN)) = 'Y'
			  AND B.CNSDREQ_ID = C.CNSDREQ_ID
			  AND C.RESP_DEPT <> :vo.blngt_orgnz
			ORDER BY C.MAIN_CNSD_YN DESC
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.listRelationman" isCamelCase="false" comment="관련자 리스트 ">
		  <statement>
		    <![CDATA[
		    SELECT DISTINCT TRGTMAN_NM  + '/' + TRGTMAN_JIKGUP_NM + '/' + TRGTMAN_DEPT_NM AS RELATION_MAN  
		    
				    , TRGTMAN_ID
					, TRGTMAN_NM
					, TRGTMAN_JIKGUP_NM
					, TRGTMAN_DEPT_NM
		    
		      FROM TN_CLM_CONTRACT_AUTHREQ
		     WHERE DEL_YN = 'N'
		       AND DEMND_GBN = 'C04601'
		       AND DEMND_STATUS = 'C03702'
		       AND CNTRT_ID IN (													
					#foreach ($master_cntrt_id in $vo.master_cntrt_ids) 
						#if ($velocityCount	== 1 ) 
							'$master_cntrt_id'
						#else 
							, '$master_cntrt_id'
						#end 
					#end
					)
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.detailContractMaster" isCamelCase="false" comment="마스터테이블정보 가져오기">
		  <statement>
		    <![CDATA[
			    SELECT ROW_NUMBER() OVER(ORDER BY C.CNSDREQ_ID) AS RN
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.BIZ_CLSFCN ) AS BIZ_CLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.DEPTH_CLSFCN ) AS DEPTH_CLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNCLSNPURPS_BIGCLSFCN ) AS CNCLSNPURPS_BIGCLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNCLSNPURPS_MIDCLSFCN ) AS CNCLSNPURPS_MIDCLSFCN_NM
				      ,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	ELSE CD_NM_ENG
			               	   END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNTRT_TRGT ) AS CNTRT_TRGT_NM				      
				      ,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.PAYMENT_GBN ) AS PAYMENT_GBN_NM 
				      ,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.BFHDCSTN_APBT_MTHD ) AS BFHDCSTN_APBT_MTHD_NM
				      ,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.CNTRT_OPPNT_TYPE ) AS CNTRT_OPPNT_TYPE_NM
				      ,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.LOAC ) AS LOAC_NM
				      ,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.DSPT_RESOLT_MTHD ) AS DSPT_RESOLT_MTHD_NM	
				      ,(SELECT CD_NM FROM TB_COM_CD WHERE SYS_CD='LAS' AND GRP_CD='C021' AND CD=SEAL_MTHD) AS SEAL_MTHD_NM 
					  ,C.CNSDREQ_ID
					  ,C.MN_CNSD_DEPT
					  ,C.MN_RESPMAN_APNT_YN
					  ,C.VC_CNSD_DEPT
					  ,C.VC_CNSD_DEMND_DT
					  ,C.VC_CNSD_DEMND_CONT
					  ,C.VC_RESPMAN_APNT_YN
					  ,C.DMSTFRGN_GBN
					  ,C.DRAFT_DEMND_YN
					  ,C.PLNDBN_REQ_YN
					  ,C.LAST_CNSD_YN
					  ,C.PREV_CNSDREQ_ID
					  ,C.REQ_TITLE
					  ,C.REQMAN_ID
					  ,C.REQMAN_NM
					  ,C.REQ_DEPT
					  ,C.REQ_DEPT_NM
					  ,C.REQ_DT
					  ,C.RE_DEMNDDAY
					  ,C.LASTBN_CHGE_YN
					  ,C.PRGRS_STATUS
					  ,C.REBFR_APPRVL_YN
					  ,C.RE_DT
					  ,C.PUB_YN
					  ,C.REG_DT
					  ,C.REG_ID
					  ,C.REG_NM
					  ,C.MOD_DT
					  ,C.MOD_ID
					  ,C.MOD_NM
					  ,C.DEL_YN
					  ,C.DEL_DT
					  ,C.DEL_ID
					  ,C.DEL_NM
					  ,C.REQ_OPERDIV
					  ,C.REQ_UP_DEPT
					  ,C.REQMAN_JIKGUP_NM
					  
					  , '(' + CONVERT(VARCHAR, ISNULL(C.ACPT_DT, C.REG_DT)) + ')' AS ACPT_DT
					  ,C.PLNDBN_CHGE_CONT
					  ,C.CNSD_HOLD_CAUSE
					  ,C.FST_REQ_DEPT
					  ,C.FST_REQ_UP_DEPT
					  ,C.REQ_INTNL_DEPT_CD
					  ,C.CNSD_DEMND_CONT
					  ,C.SYS_NM
					  ,C.CNSD_LEVEL
					  ,C.FST_CNSDREQ_ID
					  ,C.FAST_TRACK_DIV
		              ,D.CNSD_OPNN
		              ,D.CNSD_MEMO
		              ,D.CNSD_STATUS
		              ,dbo.COM_USER_INFO(D.CNSDMAN_ID, 'H') AS CNSDMAN_INFO
		              
		              , CASE ((SELECT COUNT(RESPMAN_ID) 
		                         FROM TN_CLM_CONT_CNSDREQ_RESPMAN 
		                        WHERE CNSDREQ_ID = C.CNSDREQ_ID 
		                          AND RESP_DEPT = C.MN_CNSD_DEPT 
		                          AND C.PRGRS_STATUS IN ('C04202', 'C04203', 'C04204', 'C04206') 
		                          AND RESPMAN_ID = :vo.user_id))
		                 WHEN 1 THEN 
		                           CASE C.PLNDBN_REQ_YN
		                             WHEN 'Y' THEN 'Y'
		                           ELSE
		                             'N'
		                           END
		                  ELSE
		                    'N'
		                 END  AS RESP_USER_DIV 
					  ,A.*
					  
					  , CONVERT(VARCHAR, A.BFHDCSTN_APBTDAY, 23) AS CHG_BFHDCSTN_APBTDAY
					  
					  , 0 AS CNTRT_AMT_CHG
					  ,(SELECT COUNT(A.CNTRT_ID) AS CNTRT_CNT 
					      FROM TN_CLM_CONTRACT_CNSD A,
					           TN_CLM_CONTRACT_MASTER B
					     WHERE A.CNSDREQ_ID = :vo.cnsdreq_id
					       AND A.CNTRT_ID = B.CNTRT_ID
					       AND B.DEL_YN = 'N'
					       AND B.DEPTH_STATUS != 'C02603') AS CNTRT_CNT
					  ,(SELECT COUNT(A.CNTRT_ID)+1 
					      FROM TN_CLM_CONTRACT_DEPTCNSD A,
							   TN_CLM_CONTRACT_MASTER B
					     WHERE CNSDREQ_ID = :vo.cnsdreq_id
					       AND CNSD_DEPT = :vo.blngt_orgnz
					       AND A.CNTRT_ID = B.CNTRT_ID
					       AND B.DEL_YN = 'N'
					       AND B.DEPTH_STATUS != 'C02603') AS DEPT_CNSD_CNT
					  ,E.APBT_MEMO
					  ,E.AUTO_APBT_YN
				FROM TN_CLM_CONTRACT_MASTER A
		             ,TN_CLM_CONT_CNSDREQ C
		             RIGHT OUTER JOIN TN_CLM_CONT_CNSDREQ_RESPMAN E ON C.CNSDREQ_ID = E.CNSDREQ_ID 
		             ,TN_CLM_CONTRACT_CNSD D
				WHERE 1=1
			        AND C.CNSDREQ_ID = D.CNSDREQ_ID			        
			        AND C.CNSDREQ_ID = :vo.cnsdreq_id
			        AND A.CNTRT_ID = D.CNTRT_ID			       
					AND A.CNTRT_ID = :vo.cntrt_id
					
					
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.listCompletionAttachInfo" isCamelCase="false" comment="결재용첨부파일리스트">
			<statement>
		    <![CDATA[
		    SELECT	TRIM(FILETYPE) FILETYPE, FILECNT, FILE_ID, ORG_FILE_NM, TRIM(REF_KEY) REF_KEY, CNSDREQ_ID
		      FROM  (
					   	SELECT 'cntrt' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , '' CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120201'
						   AND REF_KEY = :vo.cntrt_id + '@' + :vo.cnsdreq_id
						   AND DEL_YN = 'N'
						UNION ALL  
					    SELECT 'etc' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , '' CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120208'
						   AND REF_KEY = :vo.cntrt_id + '@' + :vo.cnsdreq_id
						   AND DEL_YN = 'N'
						 UNION ALL  
						SELECT 'etc2' AS FILETYPE
						     , COUNT(1) OVER() AS FILECNT
						     , FILE_ID
						     , ORG_FILE_NM
						     , REF_KEY
						     , '' CNSDREQ_ID
						 FROM TN_COM_ATTACH 
					    WHERE FILE_BIGCLSFCN = 'F012'
						  AND FILE_MIDCLSFCN = 'F01202'
						  AND FILE_SMLCLSFCN = 'F0120205'
						  AND REF_KEY = :vo.cntrt_id + '@' + :vo.cnsdreq_id
						  AND DEL_YN = 'N'
						UNION ALL  
						SELECT 'cmplt' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , '' CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01204'
						  -- AND FILE_SMLCLSFCN = ''
						   AND REF_KEY = :vo.cntrt_id + '@' + :vo.cnsdreq_id
						   AND DEL_YN = 'N'
						UNION ALL
						SELECT 'info' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , '' CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01201'
						   AND FILE_SMLCLSFCN = 'F0120101'
						   AND REF_KEY = :vo.cntrt_id
						   AND DEL_YN = 'N'
						UNION ALL
						SELECT 'hisConsultCntrt' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , SUBSTR(REF_KEY, LOCATE('@',REF_KEY)+1,LENGTH(REF_KEY)) CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120201'
						   AND REF_KEY IN (
			                                SELECT TRIM(:vo.cntrt_id + '@' + A.CNSDREQ_ID)
			                                  FROM  TN_CLM_CONT_CNSDREQ A
			                                                    WHERE A.PRGRS_STATUS IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C042' )
			                                                      AND A.DEL_YN = 'N'
			                                                START WITH  CNSDREQ_ID = :vo.cnsdreq_id
			                                          CONNECT BY PRIOR  PREV_CNSDREQ_ID = CNSDREQ_ID
			                                                  ORDER BY  REG_DT               
			                               )
						   AND DEL_YN = 'N'
						UNION ALL
						SELECT 'hisConsultOther' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , SUBSTR(REF_KEY, LOCATE('@',REF_KEY)+1,LENGTH(REF_KEY)) CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120205'
						   AND REF_KEY IN (
			                                SELECT TRIM(:vo.cntrt_id + '@' + A.CNSDREQ_ID)
			                                  FROM  TN_CLM_CONT_CNSDREQ A
			                                                    WHERE A.PRGRS_STATUS IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C042' )
			                                                      AND A.DEL_YN = 'N'
			                                                START WITH  CNSDREQ_ID = :vo.cnsdreq_id
			                                          CONNECT BY PRIOR  PREV_CNSDREQ_ID = CNSDREQ_ID
			                                                  ORDER BY  REG_DT               
			                               )
						   AND DEL_YN = 'N'
						UNION ALL			   
						SELECT 'hisConsultAppend' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , SUBSTR(REF_KEY, LOCATE('@',REF_KEY)+1,LENGTH(REF_KEY)) CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120208'
						   AND REF_KEY IN (
			                                SELECT TRIM(:vo.cntrt_id + '@' + A.CNSDREQ_ID)
			                                  FROM  TN_CLM_CONT_CNSDREQ A
			                                                    WHERE A.PRGRS_STATUS IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C042' )
			                                                      AND A.DEL_YN = 'N'
			                                                START WITH  CNSDREQ_ID = :vo.cnsdreq_id
			                                          CONNECT BY PRIOR  PREV_CNSDREQ_ID = CNSDREQ_ID
			                                                  ORDER BY  REG_DT               
			                               )
						   AND DEL_YN = 'N'
						UNION ALL			   
						SELECT 'hisReplyCntrt' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , SUBSTR(REF_KEY, LOCATE('@',REF_KEY)+1,LENGTH(REF_KEY)) CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120202'
						   AND REF_KEY IN (  SELECT	 TRIM(:vo.cntrt_id + '@' + A.CNSDREQ_ID)
						   					   FROM  TN_CLM_CONTRACT_CNSD A, TN_CLM_CONTRACT_MASTER B, TN_CLM_CONT_CNSDREQ C
									          WHERE  A.CNTRT_ID = B.CNTRT_ID
									            AND  A.CNSDREQ_ID = C.CNSDREQ_ID
									            AND  A.CNTRT_ID =:vo.cntrt_id
									            AND  A.CNSD_STATUS = 'C04305'
						   				   )
						   AND DEL_YN = 'N'
						UNION ALL			   
						SELECT 'hisReplyAppend' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , SUBSTR(REF_KEY, LOCATE('@',REF_KEY)+1,LENGTH(REF_KEY)) CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01202'
						   AND FILE_SMLCLSFCN = 'F0120209'
						   AND REF_KEY IN (  SELECT	 TRIM(:vo.cntrt_id + '@' + A.CNSDREQ_ID)
						   					   FROM  TN_CLM_CONTRACT_CNSD A, TN_CLM_CONTRACT_MASTER B, TN_CLM_CONT_CNSDREQ C
									          WHERE  A.CNTRT_ID = B.CNTRT_ID
									            AND  A.CNSDREQ_ID = C.CNSDREQ_ID
									            AND  A.CNTRT_ID =:vo.cntrt_id
									            AND  A.CNSD_STATUS = 'C04305'
						   				   )
						   AND DEL_YN = 'N'
						UNION ALL			   
						SELECT 'hisApprove' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , '' CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01203'
						   AND FILE_SMLCLSFCN = ''
						   AND REF_KEY IN (	SELECT	TRIM(A.CNTRT_ID)
						   					  FROM  TN_CLM_CONTRACT_CNSD A, TB_COM_START_PROCESS_WSVO B, TB_COM_ROUTE_WSVO C, TB_COM_CD D
										     WHERE  A.CNSDREQ_ID = :vo.cnsdreq_id
										       AND  A.CNTRT_ID = :vo.cntrt_id
										       AND  A.CNSDREQ_ID = B.REF_KEY	
										       AND  B.MIS_ID = C.MIS_ID
										       AND  B.MODULE_ID = C.MODULE_ID
										       AND  B.APPRVL_CLSFCN IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C030' )
										       AND  D.GRP_CD = 'SECFW_APPROVAL_ACTIVITY'
										       AND  D.CD=C.ACTIVITY
										  ORDER BY  CREATE_DATE DESC,  SEQUENCE
						   				   )
						   AND DEL_YN = 'N'
						UNION ALL			   
						SELECT 'hisSign' AS FILETYPE
						      , COUNT(1) OVER() AS FILECNT
						      , FILE_ID
						      , ORG_FILE_NM
						      , REF_KEY
						      , '' CNSDREQ_ID
						  FROM TN_COM_ATTACH 
						 WHERE FILE_BIGCLSFCN = 'F012'
						   AND FILE_MIDCLSFCN = 'F01203'
						   AND FILE_SMLCLSFCN = ''
						   AND REF_KEY IN (	SELECT	TRIM(A.CNTRT_ID)
						   					  FROM  TN_CLM_CONTRACT_MASTER A, 
											        ( SELECT  CNTRT_ID, DLAY_SEQNO, CHGEBFR_CNCLSN_PLNDDAY, CHGEAFT_CNCLSN_PLNDDAY, DLAY_CAUSE
											            FROM  ( SELECT  CNTRT_ID, DLAY_SEQNO, CHGEBFR_CNCLSN_PLNDDAY, CHGEAFT_CNCLSN_PLNDDAY, DLAY_CAUSE
											                      FROM  TN_CLM_CONTRACT_CNCLSNDLAY 
											                     WHERE  CNTRT_ID = :vo.cntrt_id
											                       AND  DEL_YN = 'N'
											                  ORDER BY DLAY_SEQNO DESC
											                  )
											           WHERE  ROWNUM = 1
											        ) B
											 WHERE  A.CNTRT_ID = B.CNTRT_ID
						   				   )
						   AND DEL_YN = 'N'
					)
		      ]]>
		  	</statement>
		</query>
		
		<query id="las.contractmanager.listTypeSpclinfoCntr" isCamelCase="false" comment="특화정보 가져오기 [계약관리]">
		  <statement>
		    <![CDATA[
		    SELECT C.CNCLSNPURPS_BIGCLSFCN
                 , C.CNCLSNPURPS_MIDCLSFCN
           	  	 , C.CNTRT_ID 
                 , D.ATTR_SEQNO
                 , D.ATTR_CD
                 , B.CRTN_DEPTH
                 , A.MNDTRY_YN
                 , CASE WHEN :vo.session_user_locale = 'ko'  THEN B.ATTR_NM
                        WHEN :vo.session_user_locale IS NULL THEN B.ATTR_NM 
                                         ELSE B.ATTR_NM_ENG
                    END 		   AS ATTR_NM 
                 , B.PRNT_SRT       AS PRNT_SRT                 
      			 , D.ATTR_CONT
             FROM TN_CLM_TYPE_SPCLINFO A
                  , TN_CLM_SPECIAL_ATTR B
                  , TN_CLM_CONTRACT_MASTER C
                  , TN_CLM_CONT_TYPE_SPCLINFO D
            WHERE A.ATTR_SEQNO = B.ATTR_SEQNO
              AND A.USE_YN = 'Y'
              AND B.CRTN_DEPTH <= 'C04005'
              AND A.CNCLSNPURPS_BIGCLSFCN = C.CNCLSNPURPS_BIGCLSFCN
              AND A.CNCLSNPURPS_MIDCLSFCN = C.CNCLSNPURPS_MIDCLSFCN
              AND A.ATTR_SEQNO = D.ATTR_SEQNO
			  AND C.CNTRT_ID = D.CNTRT_ID
              AND C.CNTRT_ID = :vo.cntrt_id
			  AND A.ATTR_SEQNO IN ('11', '9', '5')
         ORDER BY B.CRTN_DEPTH, B.PRNT_SRT
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.listTypeSpclinfoCnsd" isCamelCase="false" comment="특화속성 가져오기 [법무]">
		  <statement>
		    <![CDATA[
		    SELECT C.CNCLSNPURPS_BIGCLSFCN
                 , C.CNCLSNPURPS_MIDCLSFCN
           	  	 , C.CNTRT_ID 
                 , D.ATTR_SEQNO
                 , D.ATTR_CD
                 , B.CRTN_DEPTH
                 , A.MNDTRY_YN
                 , CASE WHEN :vo.session_user_locale = 'ko'  THEN B.ATTR_NM
                        WHEN :vo.session_user_locale IS NULL THEN B.ATTR_NM 
                                         ELSE B.ATTR_NM_ENG
                    END 		   AS ATTR_NM 
                 , B.PRNT_SRT       AS PRNT_SRT                 
      			 , D.ATTR_CONT
             FROM TN_CLM_TYPE_SPCLINFO A
                  , TN_CLM_SPECIAL_ATTR B
                  , TN_CLM_CONTRACT_MASTER C
                  , TN_CLM_CONT_TYPE_SPCLINFO D
            WHERE A.ATTR_SEQNO = B.ATTR_SEQNO
              AND A.USE_YN = 'Y'
              AND B.CRTN_DEPTH <= 'C04005'
              AND A.CNCLSNPURPS_BIGCLSFCN = C.CNCLSNPURPS_BIGCLSFCN
              AND A.CNCLSNPURPS_MIDCLSFCN = C.CNCLSNPURPS_MIDCLSFCN
              AND A.ATTR_SEQNO = D.ATTR_SEQNO
			  AND C.CNTRT_ID = D.CNTRT_ID
              AND C.CNTRT_ID = :vo.cntrt_id
			  AND A.ATTR_SEQNO IN ('1', '2', '3', '4', '6', '7', '8', '10')
         ORDER BY B.CRTN_DEPTH, B.PRNT_SRT
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.deleteRelationContract" isCamelCase="false" comment="연관계약">
			<statement>
		    <![CDATA[
		         DELETE
		           FROM TN_CLM_RELATION_CONTRACT  
		         WHERE 1=1
		         	AND CNTRT_ID = :vo.cntrt_id		         	
		         	#if (!$vo.parent_cntrt_id.equals(""))
		         		AND PARENT_CNTRT_ID = :vo.parent_cntrt_id
		         	#end 
		    ]]>
		  	</statement>
		</query>
		
		<query id="las.contractmanager.insertRelationContract" isCamelCase="false" comment="연관계약">
		  	<statement>
		    <![CDATA[
		         INSERT INTO TN_CLM_RELATION_CONTRACT         
		         (
		         	CNTRT_ID
					,PARENT_CNTRT_ID
					,REL_TYPE
					,EXPL
					,REL_DEFN
					,REG_DT
					,REG_ID
					,REG_NM 
		         )VALUES(
		         	:vo.cntrt_id
					,:vo.parent_cntrt_id
					,:vo.rel_type   
					,:vo.expl
					,:vo.rel_defn 
		         	,GETDATE()
				    ,:vo.session_user_id
				    ,:vo.session_user_nm
		         )
		    ]]>
		  	</statement>
		</query>
		
		<query id="las.contractmanager.listRelationContract" isCamelCase="false" comment="연관계약 ">
			<statement>
		    <![CDATA[
		    		   
		   		SELECT A.CNTRT_ID 
					     , A.PARENT_CNTRT_ID 
					     , A.REL_TYPE 
					     , CASE WHEN :vo.session_user_locale = 'ko' THEN D.CD_NM
                		        WHEN :vo.session_user_locale = 'fr' THEN D.CD_NM_FRA
						   ELSE D.CD_NM_ENG
				  	       END AS REAL_TYPE_NM 
					     , A.REL_DEFN 
					     , A.EXPL 
					     , A.REG_ID 
					     , A.REG_NM 
					     , A.REG_DT 
					     , C.CNTRT_NM AS PARENT_CNTRT_NM
					     , F.REQ_TITLE 
					     , MAX(F.CNSDREQ_ID) AS CNSDREQ_ID	
					  FROM TN_CLM_RELATION_CONTRACT A  
					     , TN_CLM_CONTRACT_MASTER C 
					     , TB_COM_CD D
					     , TN_CLM_CONTRACT_CNSD E
					     , TN_CLM_CONT_CNSDREQ F
					 WHERE 1=1 
					   AND A.PARENT_CNTRT_ID = C.CNTRT_ID 
					   AND A.REL_TYPE = D.CD
					   AND C.CNTRT_ID = E.CNTRT_ID
					   AND E.CNSDREQ_ID = F.CNSDREQ_ID
					   AND A.CNTRT_ID = :vo.cntrt_id
					#if (!$vo.parent_cntrt_id.equals("")) 
					   AND A.PARENT_CNTRT_ID = :vo.parent_cntrt_id					
					#end					
					GROUP BY A.CNTRT_ID 
					     , A.PARENT_CNTRT_ID 
					     , A.REL_TYPE 
						 ,D.CD_NM_ENG
						 , A.REL_DEFN 
					     , A.EXPL 
					     , A.REG_ID 
					     , A.REG_NM 
					     , A.REG_DT 
					     , C.CNTRT_NM
						 , F.REQ_TITLE 
						 , D.CD_NM
						 , D.CD_NM_FRA
						 , D.CD_NM_ENG
					ORDER BY A.REL_TYPE ASC
		    ]]>
			</statement>
		</query>
		
		<query id="las.contractmanager.listRelationContract_1114" isCamelCase="false" comment="연관계약  1114 이후로 안씀">
		  <statement>
		    <![CDATA[
		       	SELECT A.CNTRT_ID
                , A.PARENT_CNTRT_ID
                , A.REL_TYPE
                , D.CD_NM  AS REAL_TYPE_NM
                , CASE WHEN :vo.session_user_locale = 'ko' THEN
                	DECODE(A.REL_DEFN, NULL, '', A.REL_DEFN + ' 계약')
                  WHEN :vo.session_user_locale = 'fr' THEN
                	DECODE(A.REL_DEFN, NULL, '', A.REL_DEFN + ' Contrats')
                  WHEN :vo.session_user_locale = 'de' THEN
                	DECODE(A.REL_DEFN, NULL, '', A.REL_DEFN + ' Vertrag')
                  ELSE
                  	DECODE(A.REL_DEFN, NULL, '', A.REL_DEFN + ' Contract')
                  END AS REL_DEFN
                , A.EXPL
                , A.REG_ID
                , A.REG_NM
                , A.REG_DT
                --, DECODE(B.CNTRT_NM, NULL, '', B.CNTRT_NM + '의') AS CNTRT_NM
                --, DECODE(C.CNTRT_NM, NULL, '', C.CNTRT_NM + '은') AS PARENT_CNTRT_NM
                , CASE WHEN :vo.session_user_locale = 'ko' THEN 
                	DECODE(B.CNTRT_NM, NULL, '', B.CNTRT_NM + '의')
                  ELSE
                  	DECODE(B.CNTRT_NM, NULL, '', B.CNTRT_NM + 'of')
                  END AS CNTRT_NM
                , CASE WHEN :vo.session_user_locale = 'ko' THEN
                	DECODE(C.CNTRT_NM, NULL, '', C.CNTRT_NM + '은') 
                  ELSE
                 	DECODE(C.CNTRT_NM, NULL, '', C.CNTRT_NM + 'is')
                  END AS PARENT_CNTRT_NM
          FROM TN_CLM_RELATION_CONTRACT A
              , TN_CLM_CONTRACT_MASTER B
              , TN_CLM_CONTRACT_MASTER C
              , TB_COM_CD D
          WHERE 1=1
            AND A.CNTRT_ID = B.CNTRT_ID
            AND A.PARENT_CNTRT_ID = C.CNTRT_ID
            AND A.REL_TYPE = D.CD            
            AND A.CNTRT_ID = :vo.cntrt_id            
            ORDER BY A.REL_TYPE ASC	
		       				
		    ]]>
		  </statement>
		</query>
        
        <query id="las.contractmanager.makeTransSeqno" isCamelCase="false" comment="계약관리_계약_검토의뢰-이관 테이블의  신규 TRANS_SEQNO 리턴">
            <statement>
            <![CDATA[
            SELECT ISNULL((SELECT MAX(TRANS_SEQNO)+1 AS nextTransSeqno
					  	  FROM TN_CLM_CONT_CNSDREQ_TRANSFER
					 	 WHERE CNSDREQ_ID = :vo.cnsdreq_id),1) AS nextTransSeqno
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.approvalOpnnCnsd" isCamelCase="false" comment="계약관리_계약별_검토 - C04305 최종 검토완료">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONTRACT_CNSD
               SET CNSD_STATUS = :vo.cnsd_status
               	  ,APBTMAN_ID = :vo.mod_id
               	  ,APBTMAN_NM = :vo.mod_nm
               	  ,APBT_DT = GETDATE()
               	  ,APBT_OPNN = :vo.apbt_opnn
               	
				  ,MOD_DT = GETDATE()
				  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
			 WHERE 1=1
			 AND CNSDREQ_ID = :vo.cnsdreq_id
			                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
            ]]>
            </statement>
        </query>
        
		<query id="las.contractmanager.approvalOpnnDeptCnsdinsert" isCamelCase="false" comment="계약관리_계약별_부서검토  - 승인 - insert">
			<statement>
    		<![CDATA[
        	 	INSERT INTO TN_CLM_CONTRACT_DEPTCNSD
        	 		(
	        	 		CNSDREQ_ID
						, CNTRT_ID
						, CNSD_DEPT
						, COMP_CD
						, COMP_NM
						, CNSDMAN_ID
						, CNSDMAN_NM
						, CNSD_DT
						, CNSD_OPNN	
						, MAIN_MATR_CONT
               	    	, APBTMAN_ID
               	    	, APBTMAN_NM
               	    	, APBT_DT
               	    	, APBT_OPNN
						, CNSD_STATUS
						, REQ_LT
        	 		) VALUES (
        	 		 :vo.cnsdreq_id
        	 		,:vo.master_cntrt_id
        	 		,:vo.cnsd_dept
        	 		,:vo.session_comp_cd
        	 		,:vo.session_comp_nm
        	 		,:vo.deptcnsd_cnsdman_id 
        	 		,:vo.deptcnsd_cnsdman_nm
        	 		,GETDATE()
        	 		
        	 	#if ($vo.active_cntrt_id.equals($vo.master_cntrt_id))
        	 		,:vo.deptcnsd_cnsd_opnn
        	 		,:vo.main_matr_cont
        	 	#else
        	 		,''
        	 		,''
        	 	#end
        	 		
				#if ($vo.top_role.equals("RA01") + $vo.top_role.equals("RB01"))
               	    ,:vo.mod_id
               	    ,:vo.mod_nm
               	    ,GETDATE()
               	    ,:vo.apbt_opnn
				#else
        	 		,''
        	 		,''
        	 		,''
        	 		,''
				#end
					,:vo.cnsd_status
				#if ($vo.cnsd_status.equals("C04305"))
               	    ,(dbo.COM_REQ_LT((SELECT REQ_DT FROM TN_CLM_CONT_CNSDREQ WHERE CNSDREQ_ID = :vo.cnsdreq_id),GETDATE(), :vo.session_comp_cd ))
				#else
        	 		,''
				#end	
        	 		)
		    ]]>
			</statement>
		</query>
		
        <query id="las.contractmanager.approvalOpnnDeptCnsd" isCamelCase="false" comment="계약관리_계약별_부서검토  - 승인- update">
            <statement>
            <![CDATA[
              UPDATE TN_CLM_CONTRACT_DEPTCNSD
        	    SET 
        	    	CNSD_STATUS = :vo.cnsd_status
        	    	#if ($vo.top_role.equals("RA02") + $vo.page_div.equals("RESP"))
						,CNSDMAN_ID = :vo.deptcnsd_cnsdman_id
						,CNSDMAN_NM = :vo.deptcnsd_cnsdman_nm
						,CNSD_DT = GETDATE()
						#if ($vo.active_cntrt_id.equals($vo.master_cntrt_id))
							,CNSD_OPNN = :vo.deptcnsd_cnsd_opnn
							,MAIN_MATR_CONT = :vo.main_matr_cont
						#end
						#if ($vo.cnsd_status.equals("C04305"))
	               	    ,REQ_LT = dbo.COM_REQ_LT((SELECT REQ_DT FROM TN_CLM_CONT_CNSDREQ WHERE CNSDREQ_ID = :vo.cnsdreq_id),GETDATE(), COMP_CD)
						#end	
					#end 
					#if ($vo.top_role.equals("RA01") + $vo.top_role.equals("RB01"))
	               	  ,APBTMAN_ID = :vo.mod_id
	               	  ,APBTMAN_NM = :vo.mod_nm
	               	  ,APBT_DT = GETDATE()
	               	  ,APBT_OPNN = :vo.apbt_opnn
					#end
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
               AND CNTRT_ID = :vo.master_cntrt_id
			   AND CNSD_DEPT = :vo.cnsd_dept
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.changeCnsdreqStatus" isCamelCase="false" comment="계약관리_계약_검토의뢰 - 진행상태 변경">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONT_CNSDREQ
               SET PRGRS_STATUS = CASE WHEN :vo.chg_prgrs_status IN ('C04206', 'C04205', 'C04207') 
               								THEN :vo.chg_prgrs_status 
               								ELSE CASE WHEN (MN_RESPMAN_APNT_YN = 'Y' OR VC_RESPMAN_APNT_YN = 'Y') 
               												THEN 'C04204' 
               												ELSE 'C04203' 
               									 END
               					  END
				  ,MOD_DT = GETDATE()
				  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
				#if ($vo.chg_prgrs_status.equals("C04207"))
				  ,RE_DT = GETDATE()
				#end
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.changeContractCnsdStatus" isCamelCase="false" comment="계약관리_계약별_검토 - 검토상태 변경">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONTRACT_CNSD
               SET CNSD_STATUS = :vo.cnsd_status
				  ,MOD_DT = GETDATE()
				  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.changeContractDeptCnsdStatus" isCamelCase="false" comment="계약관리_계약별_부서검토 - 검토상태 변경">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONTRACT_DEPTCNSD
               SET CNSD_STATUS = :vo.cnsd_status
                   #if ($vo.cnsd_status.equals("C04305"))
               	    ,REQ_LT = dbo.COM_REQ_LT((SELECT REQ_DT FROM TN_CLM_CONT_CNSDREQ WHERE CNSDREQ_ID = :vo.cnsdreq_id),GETDATE(),COMP_CD)
				   #end	
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
			   AND CNSD_DEPT = :vo.cnsd_dept
            ]]>
            </statement>
        </query>
        
         <query id="las.contractmanager.changeMasterStatus" isCamelCase="false" comment="계약관리_계약_마스터 단계상태 변경">
            <statement>
            <![CDATA[
            UPDATE	TN_CLM_CONTRACT_MASTER
               SET	DEPTH_STATUS = :vo.chg_depth_status
               #if (!$vo.solo_yn.equals("")) 
               		,SOLO_YN	= :vo.solo_yn
               #end
			 WHERE DEPTH_STATUS NOT IN ('C02603', 'C02607')
			   AND CNTRT_ID = :vo.master_cntrt_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.changeMasterStatusAsign" isCamelCase="false" comment="계약관리_계약_마스터 단계상태 변경_배정시에만">
            <statement>
            <![CDATA[
            UPDATE	TN_CLM_CONTRACT_MASTER
               SET	DEPTH_STATUS = :vo.chg_depth_status
               #if (!$vo.solo_yn.equals("")) 
               		,SOLO_YN	= :vo.solo_yn
               #end
			 WHERE DEPTH_STATUS NOT IN ('C02603', 'C02607', 'C02608')
			   AND CNTRT_ID = :vo.master_cntrt_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.approvalOpnnMaster" isCamelCase="false" comment="계약관리_계약_마스터  준거법, 분쟁해결방법 변경">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONTRACT_MASTER
               SET  LOAC = :vo.loac
               	   ,LOAC_ETC = :vo.loac_etc
               	   ,DSPT_RESOLT_MTHD = ISNULL( :vo.dspt_resolt_mthd , '' )
               	   ,DSPT_RESOLT_MTHD_DET =  ISNULL(  :vo.dspt_resolt_mthd_det )
			 WHERE CNTRT_ID = :vo.cntrt_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.applyTrans" isCamelCase="false" comment="이관요청,이관불필요(처리일자  입력)">
            <statement>
            <![CDATA[
			INSERT INTO TN_CLM_CONT_CNSDREQ_TRANSFER  
						(
							 CNSDREQ_ID
							,TRANS_SEQNO
							,DEMND_DT
						#if ($vo.trnsf_trans_status.equals("C03804"))
							,HNDL_DT
						#end
							,DEMNDMAN_ID
							,DEMNDMAN_NM
							,DEMND_CAUSE
							,TRANS_STATUS
							,CHGEBFR_CNSD_DEPT
							,CHGEAFT_CNSD_DEPT
				        ) VALUES (
				           :vo.cnsdreq_id
				          ,:vo.param_seqno
				          ,GETDATE()
						#if ($vo.trnsf_trans_status.equals("C03804"))
						  ,GETDATE()
						#end
				          ,:vo.mod_id
				          ,:vo.mod_nm
				          ,:vo.trnsf_demnd_cause
				          ,:vo.trnsf_trans_status
				          ,:vo.mn_cnsd_dept
				          ,:vo.blngt_orgnz
				        )
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.transLawDeptTransfer" isCamelCase="false" comment="법무부서 이관_TN_CLM_CONT_CNSDREQ_TRANSFER UPDATE">
            <statement>
            <![CDATA[
			UPDATE TN_CLM_CONT_CNSDREQ_TRANSFER
               SET CHGEBFR_CNSD_DEPT = :vo.cngebfr_cnsd_dept
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
			   AND TRANS_STATUS = 'C03801'
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.transLawDeptContractCnsd" isCamelCase="false" comment="계약관리_계약별_검토(TN_CLM_CONTRACT_CNSD) 테이블 UPDATE">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONTRACT_CNSD
               SET CNSDMAN_ID = ''
               	  ,CNSDMAN_NM = ''
               	  ,CNSD_DT = ''
               	  ,CNSD_MEMO = ''
               	  ,CNSD_OPNN = ''
               	  ,APBTMAN_ID = ''
               	  ,APBTMAN_NM = ''
               	  ,APBT_DT = ''
               	  ,APBT_OPNN = ''
               	  ,CNSD_STATUS = 'C04301'
				  ,MOD_DT = GETDATE()
				  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.transLawDept" isCamelCase="false" comment="법무부서 이관">
            <statement>
            <![CDATA[
			UPDATE TN_CLM_CONT_CNSDREQ
               SET MOD_DT = GETDATE()
				  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
               	  ,DMSTFRGN_GBN = DECODE(VC_CNSD_DEPT, 'H', 'F', 'F', 'H', DMSTFRGN_GBN)
			#if ($vo.blngt_orgnz.equals($vo.mn_cnsd_dept))
				  ,MN_CNSD_DEPT = DECODE(MN_CNSD_DEPT, 'A00000001', 'A00000002', 'A00000002', 'A00000001', MN_CNSD_DEPT)
				  ,MN_RESPMAN_APNT_YN = DECODE(MN_CNSD_DEPT, 'A00000001', 'N', 'A00000002', 'N', MN_RESPMAN_APNT_YN)
				  ,PRGRS_STATUS = (CASE WHEN PRGRS_STATUS IN ('C04202', 'C04206')
				  					    THEN PRGRS_STATUS
				  					    ELSE 'C04203'
				  				   END)
			#else
				 ,VC_CNSD_DEPT = DECODE(VC_CNSD_DEPT, 'A00000001', 'A00000002', 'A00000002', 'A00000001', VC_CNSD_DEPT)
				 ,VC_RESPMAN_APNT_YN = DECODE(VC_CNSD_DEPT, 'A00000001', 'N', 'A00000002', 'N', VC_RESPMAN_APNT_YN)
			#end
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.applyResp" isCamelCase="false" comment="검토요청">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONT_CNSDREQ
               SET VC_CNSD_DEPT = (SELECT CASE WHEN :vo.blngt_orgnz IN ('A00000001', 'A00000002')
               										THEN 'A00000003'
               										ELSE CASE WHEN :vo.dmstfrgn_gbn = 'H' THEN 'A00000001'
               												  WHEN :vo.dmstfrgn_gbn = 'F' THEN 'A00000002' 
               												  ELSE 'A00000001'
               											 END
               							  END
                                     FROM TN_CLM_CONT_CNSDREQ
                                    WHERE CNSDREQ_ID = :vo.cnsdreq_id)
               	  ,VC_CNSD_DEMND_CONT = :vo.vc_cnsd_demnd_cont
               	  ,VC_CNSD_DEMND_DT = GETDATE()
               	  ,VC_RESPMAN_APNT_YN = (SELECT DECODE(COUNT(CNSDREQ_ID), 0, 'N', 'Y') FROM TN_CLM_CONT_CNSDREQ_RESPMAN
										 WHERE CNSDREQ_ID = :vo.cnsdreq_id
										   AND RESP_DEPT =   (SELECT CASE WHEN :vo.blngt_orgnz IN ('A00000001', 'A00000002')
							               										THEN 'A00000003'
							               										ELSE CASE WHEN :vo.dmstfrgn_gbn = 'H' THEN 'A00000001'
							               										          WHEN :vo.dmstfrgn_gbn = 'F' THEN 'A00000002'
							               											      ELSE 'A00000001'
							               											 END
							               							  END
							                                     FROM TN_CLM_CONT_CNSDREQ
							                                    WHERE CNSDREQ_ID = :vo.cnsdreq_id))
					,PRGRS_STATUS = (SELECT DECODE(PRGRS_STATUS, 'C04202', 'C04203', PRGRS_STATUS) FROM TN_CLM_CONT_CNSDREQ WHERE CNSDREQ_ID = :vo.cnsdreq_id)					                                    
			 WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.approveTrans" isCamelCase="false" comment="이관승인(검토의뢰)">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONT_CNSDREQ
               SET PRGRS_STATUS = CASE WHEN (VC_RESPMAN_APNT_YN = 'Y' OR MN_RESPMAN_APNT_YN = 'Y') THEN 'C04204' ELSE 'C04203' END
               	  ,MN_CNSD_DEPT = :vo.vc_cnsd_dept
               	  ,VC_CNSD_DEPT = :vo.mn_cnsd_dept
               	  ,MN_RESPMAN_APNT_YN = VC_RESPMAN_APNT_YN
               	  ,VC_RESPMAN_APNT_YN = MN_RESPMAN_APNT_YN
				  ,MOD_DT = GETDATE()
				  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.updateApproveTrans" isCamelCase="false" comment="이관승인(검토의뢰_이관)">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONT_CNSDREQ_TRANSFER
               SET TRANS_STATUS = :vo.trnsf_trans_status
               	  ,HNDL_CAUSE = :vo.trnsf_hndl_cause
               	  ,HNDL_DT = GETDATE()
               	  ,HNDLMAN_ID = :vo.mod_id
				  ,HNDLMAN_NM = :vo.mod_nm
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
               AND TRANS_SEQNO = (SELECT MAX(TRANS_SEQNO)
               						FROM TN_CLM_CONT_CNSDREQ_TRANSFER
               					   WHERE CNSDREQ_ID = :vo.cnsdreq_id)
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.deleteRespman" isCamelCase="false" comment="검토의뢰_담당자 삭제">
            <statement>
            <![CDATA[
            DELETE TN_CLM_CONT_CNSDREQ_RESPMAN
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
               AND RESP_DEPT = :vo.session_blngt_orgnz
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.deleteContractCnsdrejct" isCamelCase="false" comment="계약관리_계약별_검토반려_이력 삭제">
            <statement>
            <![CDATA[
            DELETE TH_CLM_CONTRACT_CNSDREJCT
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.deleteContractDeptcnsd" isCamelCase="false" comment="계약관리_계약별_부서검토 삭제">
            <statement>
            <![CDATA[
            DELETE TN_CLM_CONTRACT_DEPTCNSD
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
               AND CNSD_DEPT = :vo.blngt_orgnz
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.deleteContractDeptcnsdrejct" isCamelCase="false" comment="계약관리_계약별_부서검토 삭제">
            <statement>
            <![CDATA[
            DELETE TH_CLM_CONTRACT_DEPTCNSDREJCT
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
               AND CNSD_DEPT = :vo.blngt_orgnz
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.insertRespman" isCamelCase="false" comment="검토의뢰_담당자 입력">
            <statement>
            <![CDATA[
			INSERT INTO TN_CLM_CONT_CNSDREQ_RESPMAN  
						(
							 CNSDREQ_ID
							,RESPMAN_ID
							,RESP_DEPT
							,RESPMAN_NM
							,RESPMAN_JIKGUP_NM
							,ASGN_DT
							,ASGNMAN_ID
							,ASGNMAN_NM
							,MAIN_CNSD_YN
							,APBT_MEMO
							,AUTO_APBT_YN
				        ) VALUES (
				           :vo.cnsdreq_id
				          ,:vo.list_respman_id
				          
				          , CASE :vo.session_blngt_orgnz
				              WHEN NULL THEN 'A00000001'
				              WHEN ''      THEN 'A00000001'
				            ELSE
				              :vo.session_blngt_orgnz
				            END
				          ,(SELECT USER_NM FROM TB_COM_USER WHERE USER_ID = :vo.list_respman_id)
				          ,(SELECT GRP_JIKGUP_NM FROM TB_COM_USER WHERE USER_ID = :vo.list_respman_id)
				          ,GETDATE()
				          ,:vo.mod_id
				          ,:vo.mod_nm
				          
				          , CASE :vo.list_respman_id
				              WHEN :vo.main_man_id THEN 'Y'
				            ELSE
				              'N'
				            END
				          ,:vo.apbt_memo
				          ,:vo.auto_apbt_yn
				        )
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.modifyRespmanCnsdreq" isCamelCase="false" comment="법무담당자 지정">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONT_CNSDREQ
               SET 
                 
               	  
               	  PRGRS_STATUS = CASE WHEN (SELECT PRGRS_STATUS FROM TN_CLM_CONT_CNSDREQ  WHERE CNSDREQ_ID = :vo.cnsdreq_id ) <> 'C04207' THEN :vo.chg_prgrs_status ELSE 'C04207' END
               	  
               	  ,MOD_DT = GETDATE()
               	  ,MOD_ID = :vo.mod_id
				  ,MOD_NM = :vo.mod_nm
				 #if($vo.list_respman_id.equals(""))
             	  ,MN_RESPMAN_APNT_YN = 
             	                        CASE :vo.session_blngt_orgnz
             	                          WHEN mn_cnsd_dept THEN 'N'
             	                        ELSE
             	                          MN_RESPMAN_APNT_YN
             	                        END
				  ,VC_RESPMAN_APNT_YN = 
				                        CASE :vo.session_blngt_orgnz
				                          WHEN vc_cnsd_dept THEN 'N'
				                        ELSE
				                          VC_RESPMAN_APNT_YN
				                        END
				 #else
             	  ,MN_RESPMAN_APNT_YN = 
             	                        CASE :vo.session_blngt_orgnz
             	                          WHEN mn_cnsd_dept THEN 'Y'
             	                        ELSE
             	                          MN_RESPMAN_APNT_YN
             	                        END
				  ,VC_RESPMAN_APNT_YN = 
				                        CASE :vo.session_blngt_orgnz
				                          WHEN vc_cnsd_dept THEN 'Y'
				                        ELSE
				                          VC_RESPMAN_APNT_YN
				                        END
				 #end
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
             	
            ]]>
            </statement>
        </query>
        
        <query id="las.contractmanager.updateFastTrackDiv" isCamelCase="false" comment="FAST_TRACK_DIV UPDATE">
            <statement>
            <![CDATA[
            UPDATE TN_CLM_CONT_CNSDREQ
               SET FAST_TRACK_DIV = DECODE(:vo.fast_track_div, '', FAST_TRACK_DIV, :vo.fast_track_div),
                   ACPT_DT = DECODE(:vo.fast_track_div, 'Y', GETDATE(), 'N', GETDATE(), ACPT_DT),
                   VC_CNSD_DEPT = DECODE(:vo.fast_track_div, 'Y', '', VC_CNSD_DEPT)
             WHERE CNSDREQ_ID = :vo.cnsdreq_id
            ]]>
            </statement>
        </query>
        
         <query id="las.contractmanager.countConsiderationHQ_cnt" isCamelCase="false" >
            <statement>
            <![CDATA[
             	SELECT *
             	FROM DBO.[LAS.CONTRACTMANAGER.LISTCONSIDERATION_HQ_CNT](
			  			:vo.session_user_locale ,
						:vo.session_blngt_orgnz ,
						:vo.srch_start_dt ,
						:vo.srch_end_dt ,
						:vo.session_user_id ,
						:vo.session_user_id ,
						:vo.page_flag ,
						:vo.srch_req_title ,
						:vo.srch_cnsd_cont ,
						:vo.srch_orgnz ,
						:vo.srch_reqman_nm ,
						:vo.srch_owner_dept ,
						:vo.srch_respman_nm ,
						:vo.srch_hq_reviewer_nm , 
						:vo.sElComp ,
						:'' ,
						:vo.srch_solo_yn ,
						:vo.top_role ,
						:vo.srch_cntrt_oppnt_nm ,
						:vo.srch_biz_depth ,
						:vo.srch_cnclsnpurps ,
						:vo.srch_type_cd ,
						:vo.srch_prgrs_status ,
						:vo.srch_prgrs_status_hq,
						:vo.session_related_products
						) 
            ]]>
            </statement>
        </query>
				
        <query id="las.contractmanager.countConsideration" isCamelCase="false">
		  	<statement>
		    <![CDATA[		    
		    	
				SELECT  UNASSIGN_CNT+CONSIDER_CNT AS TOTAL_CNT,
						UNASSIGN_CNT, CONSIDER_CNT, CLOSED_CNT, RESIGN_CNT, TEMPSAVE_CNT, 0 AS PENDDING_CNT, 0 AS TRANSFER_CNT, CCED_CNT
				FROM
				(
					SELECT 
							/*T.RESPMAN_ID, T.PRCS_DEPTH, T.DEPTH_STATUS, T.CLOSE_YN, T.PRGRS_STATUS, T.CNSD_STATUS, T.REQ_DT, T.CNSDREQ_ID, T.REQ_TITLE*/
							SUM(
								CASE 
									WHEN RESPMAN_ID = 'N' AND IS_HOLD = 'N' AND T.CLOSE_YN = 'N' THEN 1 ELSE 0
								END
							) AS UNASSIGN_CNT,
										
							SUM(
								CASE 
									WHEN RESPMAN_ID = 'Y' AND PRGRS_STATUS = 'C04204' AND CNSD_STATUS <> 'C04302' AND IS_HOLD = 'N' AND T.CLOSE_YN = 'N'  THEN 1 ELSE 0
								END
							) AS CONSIDER_CNT,		
						
							SUM(
								CASE 
									WHEN T.CLOSE_YN = 'Y'  THEN 1 ELSE 0
								END
							) AS CLOSED_CNT,
						
							SUM(
								CASE 
									WHEN PRGRS_STATUS = 'C04206' AND IS_HOLD = 'N' AND T.CLOSE_YN = 'N' THEN 1 ELSE 0
								END
							) AS RESIGN_CNT,

							SUM(
								CASE
									WHEN PRCS_DEPTH = 'C02501' AND CNSD_STATUS = 'C04302' THEN 1 ELSE 0 /* Admin's draft saved */
								END
							) AS TEMPSAVE_CNT,
						
							(
									SELECT COUNT(A.CNSDREQ_ID)
									FROM
									(
										
										SELECT A.CNSDREQ_ID, A.CNTRT_ID
										FROM 
										(
											SELECT MAX(B.CNSDREQ_ID) CNSDREQ_ID, A.CNTRT_ID 
											FROM TN_CLM_CONTRACT_AUTHREQ A LEFT JOIN TN_CLM_CONTRACT_CNSD B ON A.CNTRT_ID = B.CNTRT_ID AND B.COMP_CD = :vo.session_comp_cd
											WHERE TRGTMAN_ID = :vo.session_user_id AND DEL_YN='N' AND DEMND_GBN = 'C04601' AND DEMND_STATUS = 'C03702'
											GROUP BY A.CNTRT_ID
										) A 
										INNER JOIN TN_CLM_CONTRACT_MASTER M ON A.CNTRT_ID = M.CNTRT_ID 
										INNER JOIN TN_CLM_CONT_CNSDREQ Q ON A.CNSDREQ_ID = Q.CNSDREQ_ID
										
										WHERE (M.CLOSE_YN = 'N' OR M.CLOSE_YN = '' OR M.CLOSE_YN IS NULL)		
										/* Except Draft Saved by Others */
										AND 'Y' = 
											CASE
												WHEN PRGRS_STATUS = 'C04201' AND Q.CNSDREQ_ID = FST_CNSDREQ_ID AND REQMAN_ID <> :vo.session_user_id THEN 'N'
											ELSE 'Y'
											END
																								
										/* Except Draft Saved by Others 
										AND 'Y' = 
											CASE
												WHEN M.PRCS_DEPTH = 'C02501' AND M.DEPTH_STATUS = 'C02601' AND Q.PREV_CNSDREQ_ID IS NULL  
												THEN 'N'
											ELSE 'Y'
											END
										*/
											
									) A 
									/* the Below 3 lines are for Revewers and Legal Admins Only, Not for Requesters */
									/*
									LEFT JOIN TN_CLM_CONT_CNSDREQ_RESPMAN B ON A.CNSDREQ_ID = B.CNSDREQ_ID
									LEFT JOIN TN_CLM_CONT_CNSDREQ C ON A.CNSDREQ_ID = c.CNSDREQ_ID
									WHERE RESPMAN_ID = :vo.session_user_id
									*/
							) AS CCED_CNT

					FROM (
						SELECT	
								A.*
						FROM
						(	
							SELECT 
									CASE WHEN B.RESPMAN_ID IS NULL THEN 'N' ELSE 'Y' END  AS RESPMAN_ID ,
									M.PRCS_DEPTH, M.DEPTH_STATUS, 
									CASE WHEN M.CLOSE_YN = 'Y' THEN 'Y' ELSE 'N' END AS CLOSE_YN, 
									REQ.PRGRS_STATUS, 
									REV.CNSD_STATUS, 
									REQ.REQ_TITLE,
									(			
										 SELECT CONVERT(NVARCHAR, CAST(REQ_DT as datetime), 20) REQ_DT
										 FROM 
										 (
											SELECT MIN(CNSDREQ_ID) CNSDREQ_ID from TN_CLM_CONTRACT_CNSD
											WHERE CNTRT_ID= A.CNTRT_ID
										 ) REV LEFT JOIN TN_CLM_CONT_CNSDREQ REQ ON REV.CNSDREQ_ID = REQ.CNSDREQ_ID

									) AS REQ_DT,
									A.CNSDREQ_ID,
									[dbo].[LAS_GET_RESPMAN_NMS](A.CNSDREQ_ID) AS LAW_RESPMAN_NM,
									CASE 
										WHEN PRCS_DEPTH = 'C02501' AND DEPTH_STATUS = 'C02607' THEN 'Y'		/* holding */
										WHEN PRCS_DEPTH = 'C02501' AND DEPTH_STATUS = 'C02609' THEN 'Y'		/* admin replied */
										WHEN PRCS_DEPTH = 'C02503' AND DEPTH_STATUS = 'C02647' THEN 'Y'		/* holding */
										ELSE 'N'
									END AS IS_HOLD

							FROM
							(
								SELECT MAX(CNSDREQ_ID) CNSDREQ_ID, B.CNTRT_ID
								FROM
								(
									SELECT   CNTRT_ID FROM TN_CLM_CONTRACT_CNSD
									/* WHERE RESPMAN_ID = 'M081114111045C100053'  */
									WHERE COMP_CD = :vo.session_comp_cd
								) A LEFT JOIN TN_CLM_CONTRACT_CNSD B ON A.CNTRT_ID = B.CNTRT_ID
								GROUP BY B.CNTRT_ID
							) A 
							LEFT OUTER JOIN TN_CLM_CONT_CNSDREQ_RESPMAN B ON A.CNSDREQ_ID = B.CNSDREQ_ID 
							/*Legal Admin only BUT ALWAYS */
							AND B.MAIN_CNSD_YN = 'Y'
							LEFT JOIN TN_CLM_CONTRACT_CNSD REV ON A.CNSDREQ_ID = REV.CNSDREQ_ID
							LEFT JOIN TN_CLM_CONT_CNSDREQ REQ ON A.CNSDREQ_ID = REQ.CNSDREQ_ID
							LEFT JOIN TN_CLM_CONTRACT_MASTER M ON A.CNTRT_ID = M.CNTRT_ID
							/* Requester only*/
							#if ($vo.top_role.equals("RA01") || $vo.top_role.equals("RB01") || $vo.top_role.equals("RA02") ) 
							#else
							/*AND M.REG_ID = :vo.session_user_id */
							#end
							WHERE 1=1
							AND M.COMP_CD = :vo.session_comp_cd
							AND M.DEL_YN <> 'Y'
							AND M.PRCS_DEPTH IN ('C02501','C02502','C02503','C02504','C02505')
							AND M.CNTRT_INFO_GBN = 'C05401'
					
							/* Except Draft Saved by Others */
							AND 'Y' = 
								CASE
									WHEN REQ.PRGRS_STATUS = 'C04201' AND REQ.CNSDREQ_ID = REQ.FST_CNSDREQ_ID AND REQMAN_ID <> :vo.session_user_id THEN 'N' 

								ELSE 'Y'
								END	
					
							AND  A.CNSDREQ_ID NOT LIKE 'F%'				
									
							/* 24/Jun/15 by JOON S */
							
							/* Requester only*/
							#if ($vo.top_role.equals("RA01") || $vo.top_role.equals("RB01") || $vo.top_role.equals("RA02") ) 
							#else
							AND M.CNTRT_ID IN 
								(
									SELECT DISTINCT CNTRT_ID
									FROM
									(
										SELECT M.CNTRT_ID
										FROM TN_CLM_CONTRACT_MASTER M LEFT JOIN TN_CLM_CONTRACT_AUTHREQ AUTH ON M.CNTRT_ID = AUTH.CNTRT_ID
										WHERE 1=1
										AND AUTH.TRGTMAN_ID = :vo.session_user_id
										UNION ALL
										SELECT CNTRT_ID FROM TN_CLM_CONTRACT_MASTER WHERE REG_ID = :vo.session_user_id or CNTRT_RESPMAN_ID =:vo.session_user_id
									) A
								)	
							#end							
							/* 24/Jun/15 by JOON E */																							
																										
						)  A
						WHERE 1=1
						#if ($vo.top_role.equals("RA01") || $vo.top_role.equals("RB01") || $vo.top_role.equals("RA02") ) 
						AND REQ_DT >= CONVERT(NVARCHAR, cast(cast(DATEADD(Year, -1, GETDATE())   as date) as datetime), 20)
						AND REQ_DT < CONVERT(NVARCHAR, cast(cast(DATEADD(DAY, 1, GETDATE())   as date) as datetime), 20)
						#else
						#end
						/*
						AND REQ_DT >= CONVERT(NVARCHAR, cast(DATEADD(Year, -1, GETDATE())   as datetime), 20)						
						AND REQ_DT <= CONVERT(NVARCHAR, cast(getdate() as datetime), 20)
						*/
						
						#if ($vo.top_role.equals("RA02") )
						AND LAW_RESPMAN_NM LIKE '%' + :vo.session_user_nm  + '%'	
						#end

					)  T
				) A
		    
		    
		    ]]>
		  	</statement>
		</query>
		
		
        <query id="las.contractmanager.countContractMngNew" isCamelCase="false">
        	<statement>
        		
        		
		SELECT SUM(ORGRCV_CNT) ORGRCV_CNT, SUM(AUTOEXP_CNT) AUTOEXP_CNT, SUM(AFTERCONREG_CNT) AFTERCONREG_CNT, SUM(STDCONT_CNT) STDCONT_CNT
		FROM
		(
			SELECT COUNT(M.CNTRT_NO) AS ORGRCV_CNT, 0 as AUTOEXP_CNT, 0 AS AFTERCONREG_CNT, 0 AS STDCONT_CNT
			FROM TN_CLM_CONTRACT_MASTER M
			WHERE 1=1
			AND M.COMP_CD = :vo.session_comp_cd
			AND M.CNTRT_INFO_GBN = 'C05401'
			AND M.prcs_depth ='C02503'
			AND M.DEPTH_STATUS = 'C02642'
			AND LEN(M.CNTRT_NO) > 0
			AND (M.CLOSE_YN IS NULL OR M.CLOSE_YN = 'N' )
			AND M.DEL_YN = 'N'

			UNION ALL

			SELECT 0 AS ORGRCV_CNT, 0 as AUTOEXP_CNT, COUNT(M.CNTRT_NO) AS AFTERCONREG_CNT, 0 AS STDCONT_CNT
			FROM TN_CLM_CONTRACT_MASTER M
			WHERE 1=1
			AND M.COMP_CD = :vo.session_comp_cd
			AND M.CNTRT_INFO_GBN = 'C05404'
			AND M.prcs_depth = 'C02502'
			AND M.DEPTH_STATUS = 'C02636'
			AND LEN(M.CNTRT_NO) > 0
			AND (M.CLOSE_YN IS NULL OR M.CLOSE_YN = 'N' )
			AND M.DEL_YN = 'N'


			UNION ALL
			SELECT 0 AS ORGRCV_CNT, COUNT(M.CNTRT_NO) as AUTOEXP_CNT, 0 AS AFTERCONREG_CNT, 0 AS STDCONT_CNT
			FROM TN_CLM_CONTRACT_MASTER M
			WHERE 1=1
			AND M.COMP_CD = :vo.session_comp_cd
			AND M.CNTRT_INFO_GBN = 'C05401'
			AND M.prcs_depth = 'C02505'
			AND M.DEPTH_STATUS = 'C02685'
			AND M.CNTRT_STATUS = 'C02402'
			AND LEN(M.CNTRT_NO) > 0
			AND (M.CLOSE_YN IS NULL OR M.CLOSE_YN = 'N' )
			AND M.DEL_YN = 'N'
		) T
						
        	</statement>
		</query>
		
        <query id="las.contractmanager.countContractMng" isCamelCase="false">
		 	<statement>
		    <![CDATA[
			SELECT TA.CNT AS ORGRCV_CNT,TA1.CNT AS AUTOEXP_CNT,TA2.CNT AS AFTERCONREG_CNT,TA3.CNT AS STDCONT_CNT,SUM(TA.CNT+TA1.CNT+TA2.CNT+TA3.CNT) AS TOTAL_CNT FROM
			(
			SELECT COUNT(*) AS cnt
			FROM
			  (SELECT REQ.CNSDREQ_ID
			  FROM TN_CLM_CONT_CNSDREQ REQ,
			    (SELECT FST_CNSDREQ_ID,
			      MAX(CNSD_LEVEL)          AS LVL,
			      MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT
			    FROM TN_CLM_CONT_CNSDREQ
			    WHERE DEL_YN = 'N'
			    GROUP BY FST_CNSDREQ_ID
			    ) REQ_MAX
			  WHERE REQ.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID
			  AND REQ.CNSD_LEVEL       = REQ_MAX.LVL
			  AND REQ.DEL_YN           = 'N'
			  AND ( REQ.CNSDREQ_ID    IN
			    (SELECT DISTINCT CNSD.CNSDREQ_ID
			    FROM TN_CLM_CONTRACT_CNSD CNSD,
			      TN_CLM_CONTRACT_AUTHREQ AUTHREQ
			    WHERE CNSD.CNTRT_ID      = AUTHREQ.CNTRT_ID
			    AND AUTHREQ.DEL_YN       = 'N'
			    AND AUTHREQ.DEMND_GBN    = 'C04601'
			    AND AUTHREQ.DEMND_STATUS = 'C03702'
			    AND AUTHREQ.TRGTMAN_ID   = :vo.session_user_id
			    )
			  OR REQ.COMP_CD = :vo.session_comp_cd)
			  ) X,
			  (SELECT A1.CNSDREQ_ID ,
			    A1.CNTRT_ID
			  FROM
			    (SELECT CNSDREQ_ID,
			      MIN(CNTRT_ID)   AS CNTRT_ID,
			      COUNT(CNTRT_ID) AS CNTRT_CNT
			    FROM
			      (SELECT CNSD.CNSDREQ_ID,
			        MASTER.CNTRT_ID,
			        MASTER.CNTRT_NM
			      FROM TN_CLM_CONTRACT_CNSD CNSD,
			        TN_CLM_CONTRACT_MASTER MASTER
			      WHERE CNSD.CNTRT_ID        = MASTER.CNTRT_ID
			      AND MASTER.DEL_YN          = 'N'
			      AND MASTER.CNTRT_INFO_GBN IN ('C05401','C05404')
			      AND MASTER.CNTRT_STATUS    < 'C02406'
			      AND MASTER.COMP_CD         = :vo.session_comp_cd
			      AND MASTER.DEPTH_STATUS    = 'C02642'
			      ) SA
			    GROUP BY CNSDREQ_ID
			    ) A1 ,
			    TN_CLM_CONTRACT_MASTER A2
			  WHERE A1.CNTRT_ID = A2.CNTRT_ID
			  AND (A2.CLOSE_YN IS NULL OR A2.CLOSE_YN = 'N' )
			  ) Y
			WHERE X.CNSDREQ_ID = Y.CNSDREQ_ID
			) ta,
			                ( SELECT count(*) as cnt
			                  FROM (SELECT REQ.CNSDREQ_ID
			                          FROM TN_CLM_CONT_CNSDREQ REQ,
			                               (SELECT FST_CNSDREQ_ID,
			                                       MAX(CNSD_LEVEL) AS CNSD_LEVEL,
			                                       MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT
			                                  FROM TN_CLM_CONT_CNSDREQ
			                                 WHERE DEL_YN = 'N'
			                                 GROUP BY FST_CNSDREQ_ID) REQ_MAX
			                         WHERE REQ.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID
			                           AND REQ.CNSD_LEVEL = REQ_MAX.CNSD_LEVEL
			                           AND REQ.DEL_YN = 'N'  ) X,
			                       (SELECT CNSDREQ_ID
			                          FROM (SELECT CNSD.CNSDREQ_ID,
			                                       MASTER.CNTRT_ID,
			                                       MASTER.CNTRT_NM,
			                                       MASTER.CNTRT_NO
			                                  FROM TN_CLM_CONTRACT_CNSD CNSD,
			                                       TN_CLM_CONTRACT_MASTER MASTER,
			                                       TH_CLM_ORG_MNG HIS
			                                 WHERE CNSD.CNTRT_ID = MASTER.CNTRT_ID
			                                   AND CNSD.CNTRT_ID = HIS.CNTRT_ID
			                                   AND MASTER.DEL_YN = 'N'
			                                   AND MASTER.CNTRT_STATUS  = 'C02402'
			                                   AND MASTER.PRCS_DEPTH    = 'C02505'
			                                   AND MASTER.DEPTH_STATUS  = 'C02685'
			                                   AND MASTER.COMP_CD   = :vo.session_comp_cd
			                                   AND HIS.GUBUN = 'R'  ) SB
			                         GROUP BY CNSDREQ_ID ) Y
			                 WHERE X.CNSDREQ_ID = Y.CNSDREQ_ID
			        ) ta1,
			                (SELECT count(*) as cnt
			                FROM (SELECT REQ.CNSDREQ_ID
			                      FROM TN_CLM_CONT_CNSDREQ REQ,
			                           (SELECT FST_CNSDREQ_ID,
			                                   MAX(CNSD_LEVEL) AS LVL,
			                                   MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT
			                              FROM TN_CLM_CONT_CNSDREQ
			                             WHERE DEL_YN = 'N'
			                             GROUP BY FST_CNSDREQ_ID) REQ_MAX
			                     WHERE REQ.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID
			                       AND REQ.CNSD_LEVEL = REQ_MAX.LVL
			                       AND REQ.DEL_YN = 'N') X,
			                   (SELECT CNSD.CNSDREQ_ID
			                      FROM TN_CLM_CONTRACT_CNSD CNSD,
			                           TN_CLM_CONTRACT_MASTER MASTER
			                     WHERE CNSD.CNTRT_ID        = MASTER.CNTRT_ID
			                       AND MASTER.DEL_YN        = 'N'
			                       AND MASTER.CNTRT_STATUS  = 'C02401'
			                       AND MASTER.PRCS_DEPTH    = 'C02502'
			                       AND MASTER.DEPTH_STATUS  = 'C02636'
			                       AND MASTER.CNTRT_INFO_GBN = 'C05404'
			                       AND MASTER.COMP_CD   =:vo.session_comp_cd) Y
			                WHERE X.CNSDREQ_ID = Y.CNSDREQ_ID
			       )ta2,
			                (SELECT count(*) as cnt
			                FROM (SELECT REQ.CNSDREQ_ID
			                      FROM TN_CLM_CONT_CNSDREQ REQ,
			                           (SELECT FST_CNSDREQ_ID,
			                                   MAX(CNSD_LEVEL) AS LVL,
			                                   MIN(ISNULL(REQ_DT, REG_DT)) AS REQ_DT
			                              FROM TN_CLM_CONT_CNSDREQ
			                             WHERE DEL_YN = 'N'
			                             GROUP BY FST_CNSDREQ_ID) REQ_MAX
			                     WHERE REQ.FST_CNSDREQ_ID = REQ_MAX.FST_CNSDREQ_ID
			                       AND REQ.CNSD_LEVEL = REQ_MAX.LVL
			                       AND REQ.DEL_YN = 'N'
			                       AND ( REQ.CNSDREQ_ID IN (SELECT DISTINCT CNSD.CNSDREQ_ID
			                                      FROM TN_CLM_CONTRACT_CNSD CNSD,
			                                           TN_CLM_CONTRACT_AUTHREQ AUTHREQ
			                                     WHERE CNSD.CNTRT_ID = AUTHREQ.CNTRT_ID
			                                       AND AUTHREQ.DEL_YN       = 'N'
			                                       AND AUTHREQ.DEMND_GBN    = 'C04601'
			                                       AND AUTHREQ.DEMND_STATUS = 'C03702'
			                                       AND AUTHREQ.TRGTMAN_ID   = :vo.session_user_id )
			                               OR REQ.COMP_CD    =:vo.session_comp_cd ) ) X,
			                   (SELECT A1.CNSDREQ_ID
			                      FROM (SELECT CNSDREQ_ID,
			                                   MIN(CNTRT_ID) AS CNTRT_ID,
			                                   COUNT(CNTRT_ID) AS CNTRT_CNT
			                              FROM (SELECT CNSD.CNSDREQ_ID,
			                                           MASTER.CNTRT_ID,
			                                           MASTER.CNTRT_NM
			                                      FROM TN_CLM_CONTRACT_CNSD CNSD,
			                                           TN_CLM_CONTRACT_MASTER MASTER
			                                     WHERE CNSD.CNTRT_ID = MASTER.CNTRT_ID
			                                       AND MASTER.DEL_YN = 'N'
			                                       AND LEN(MASTER.CNSLT_NO) > 0
			                                       AND DEPTH_STATUS = 'C02602'
			                                       AND (MASTER.CNTRT_INFO_GBN IN ('C05401')
			                                                OR (MASTER.CNTRT_INFO_GBN IN ('C05404')
			                                                       AND MASTER.PRCS_DEPTH IN ('C02504','C02505'))) ) SC
			                             GROUP BY CNSDREQ_ID ) A1 ,
			                           TN_CLM_CONTRACT_MASTER A2
			                     WHERE A1.CNTRT_ID = A2.CNTRT_ID ) Y
			                WHERE X.CNSDREQ_ID = Y.CNSDREQ_ID
			        )ta3
			        group by ta.cnt,ta1.cnt,ta2.cnt,ta3.cnt
		    ]]>
		  	</statement>
		</query>
    	
        <!-- 날인접수건 카운트- 메인화면 출력용 , 수정 : 날인/증명 카운트 통합-->
        <query id="las.contractmanager.countSeal" isCamelCase="false">
		 	<statement>
		    <![CDATA[
			SELECT  COUNT(APL_SQN) AS SEALSIGN_CNT  
     		  FROM TN_CLM_PRTB_SD_APL 
             WHERE DEL_YN = 'N'
               AND ( SEAL_FFMTMAN_ID = :vo.session_user_id  OR DOC_ISSUER_ID = :vo.session_user_id   )
               AND ( SEAL_FFMT_STATUS = 'SL0101' OR SEAL_FFMT_STATUS = 'SL0102' OR DOC_ISSUE_STATUS = 'DC0101')
               AND SEAL_RQST_STATUS = 'AP0103'
		    ]]>
		  	</statement>
		</query>
		<!-- 증명서류접수건 카운트 - 메인화면 출력용 -->
        <query id="las.contractmanager.countSigndoc" isCamelCase="false">
		 	<statement>
		    <![CDATA[
			SELECT COUNT(APL_SQN) AS CNT
			  FROM TN_CLM_PRTB_SD_APL 
			 WHERE SEAL_RQST_STATUS = 'AP0103' 
			   AND DOC_YN           = 'Y'
			   AND DOC_ISSUER_ID    = :vo.session_user_id
		    ]]>
		  	</statement>
		</query>
        
		        
	    <query id="las.contractmanager.OpnnHist" isCamelCase="false" comment="담당자 의견 반려 이력 추가">
	        <statement>
	        <![CDATA[
	           INSERT INTO TH_CLM_CONTRACT_CNSDREJCT
			         (
			         	 CNSDREQ_ID
						,CNTRT_ID
						,SEQNO
						,COMP_CD
						,COMP_NM
						,CNSD_DT
						,CNSD_OPNN
						,REJCT_DT
						,REJCT_OPNN
			         )VALUES(
			         	 :vo.cnsdreq_id
						,:vo.master_cntrt_id
						,:vo.param_seqno
						,:vo.session_comp_cd
						,:vo.session_comp_nm
					#if (!$vo.cnsd_opnn.equals(""))
						,GETDATE()
						,:vo.cnsd_opnn
					#else
						,''
						,''
					#end
					#if (!$vo.rejct_opnn.equals(""))
						,GETDATE()
						,:vo.rejct_opnn
					#else
						,''
						,''
					#end
					 )
	        ]]>
	        </statement>
	    </query>
	    
	    <query id="las.contractmanager.OpnnHistDept" isCamelCase="false" comment="담당자 의견 반려 이력 추가">
	        <statement>
	        <![CDATA[
	            INSERT INTO TH_CLM_CONTRACT_DEPTCNSDREJCT
			         (
			         	 CNSDREQ_ID
						,CNTRT_ID
						,CNSD_DEPT
						,SEQNO
						,COMP_CD
						,COMP_NM
						,CNSD_DT
						,CNSD_OPNN
						,REJCT_DT
						,REJCT_OPNN
			         )VALUES(
			         	 :vo.cnsdreq_id
						,:vo.master_cntrt_id
						,:vo.cnsd_dept
						,:vo.param_seqno
						,:vo.session_comp_cd
						,:vo.session_comp_nm
					#if ($vo.cnsd_dept.equals($vo.mn_cnsd_dept))
						,(SELECT CNSD_DT
						    FROM TN_CLM_CONTRACT_CNSD
						   WHERE CNSDREQ_ID = :vo.cnsdreq_id
						     AND CNTRT_ID = :vo.master_cntrt_id)
						,(SELECT CNSD_OPNN
							FROM TN_CLM_CONTRACT_CNSD
						   WHERE CNSDREQ_ID = :vo.cnsdreq_id
							 AND CNTRT_ID = :vo.master_cntrt_id)
					#else
						,(SELECT CNSD_DT
						    FROM TN_CLM_CONTRACT_DEPTCNSD
						   WHERE CNSDREQ_ID = :vo.cnsdreq_id
						     AND CNTRT_ID = :vo.master_cntrt_id
						     AND CNSD_DEPT = :vo.cnsd_dept)
						,(SELECT CNSD_OPNN
							FROM TN_CLM_CONTRACT_DEPTCNSD
						   WHERE CNSDREQ_ID = :vo.cnsdreq_id
							 AND CNTRT_ID = :vo.master_cntrt_id
							 AND CNSD_DEPT = :vo.cnsd_dept)
					#end
					#if (!$vo.rejct_opnn.equals(""))
						,GETDATE()
						,:vo.rejct_opnn
					#else
						,''
						,''
					#end
					 )
	        ]]>
	        </statement>
	    </query>
	    
	    <query id="las.contractmanager.makeOpnnHistSeqno" isCamelCase="false" comment="계약관리_계약별_검토반려_이력 테이블의  신규 SEQNO 리턴">
	        <statement>
	        <![CDATA[
	        SELECT ISNULL((SELECT MAX(SEQNO)+1
		  	  FROM TH_CLM_CONTRACT_CNSDREJCT
		 	 WHERE CNSDREQ_ID = :vo.cnsdreq_id
		 	   AND CNTRT_ID = :vo.master_cntrt_id),1) AS nextTransSeqno
	        ]]>
	        </statement>
	    </query>
	      
	     <query id="las.contractmanager.makeOpnnHistDeptSeqno" isCamelCase="false" comment="계약관리_계약별_부서검토반려_이력 테이블의  신규 SEQNO 리턴">
	        <statement>
	        <![CDATA[
	        SELECT ISNULL((SELECT MAX(SEQNO)+1
		  	  FROM TH_CLM_CONTRACT_DEPTCNSDREJCT
		 	 WHERE CNSDREQ_ID = :vo.cnsdreq_id
		 	   AND CNTRT_ID = :vo.master_cntrt_id
		 	   AND CNSD_DEPT = :vo.cnsd_dept),1) AS nextTransSeqno
	        ]]>
	        </statement>
	    </query>
	    
	    <query id="las.contractmanager.listConsideration_under_d" isCamelCase="false" comment="유관부서 팝업">
	        <statement>
	        <![CDATA[
				SELECT
					CASE WHEN :vo.session_user_locale = 'ko' THEN 
					  ISNULL((SELECT A.USER_NM + ' / ' + A.JIKGUP_NM + ' / ' + A.DEPT_NM + 
							DECODE(B.CNT, 0, '', ' 외 ' + B.CNT + '명')
						  FROM TB_COM_USER A,
										(SELECT MIN(RESPMAN_ID) AS RESPMAN_ID, COUNT(RESPMAN_ID)-1 CNT
											 FROM TN_CLM_CONT_CNSDREQ_RESPMAN
											WHERE CNSDREQ_ID = :vo.cnsdreq_id
										 		AND RESP_DEPT <> :vo.blngt_orgnz) B
						WHERE A.USER_ID = B.RESPMAN_ID), '최초의뢰')
					WHEN :vo.session_user_locale = 'fr' THEN 
					  ISNULL((SELECT A.USER_NM + ' / ' + A.JIKGUP_NM + ' / ' + A.DEPT_NM + 
							DECODE(B.CNT, 0, '', ' et ' + B.CNT + ' Personne(s)')
						  FROM TB_COM_USER A,
										(SELECT MIN(RESPMAN_ID) AS RESPMAN_ID, COUNT(RESPMAN_ID)-1 CNT
											 FROM TN_CLM_CONT_CNSDREQ_RESPMAN
											WHERE CNSDREQ_ID = :vo.cnsdreq_id
										 		AND RESP_DEPT <> :vo.blngt_orgnz) B
						WHERE A.USER_ID = B.RESPMAN_ID), 'FR_최초의뢰')
					WHEN :vo.session_user_locale = 'de' THEN 
					  ISNULL((SELECT A.USER_NM + ' / ' + A.JIKGUP_NM + ' / ' + A.DEPT_NM + 
							DECODE(B.CNT, 0, '', ' und ' + B.CNT + ' Person(en)')
						  FROM TB_COM_USER A,
										(SELECT MIN(RESPMAN_ID) AS RESPMAN_ID, COUNT(RESPMAN_ID)-1 CNT
											 FROM TN_CLM_CONT_CNSDREQ_RESPMAN
											WHERE CNSDREQ_ID = :vo.cnsdreq_id
										 		AND RESP_DEPT <> :vo.blngt_orgnz) B
						WHERE A.USER_ID = B.RESPMAN_ID), 'DE_최초의뢰')
					 ELSE
					   ISNULL((SELECT A.USER_NM + ' / ' + A.JIKGUP_NM + ' / ' + A.DEPT_NM + 
							DECODE(B.CNT, 0, '', ' and ' + B.CNT + ' others')
						  FROM TB_COM_USER A,
										(SELECT MIN(RESPMAN_ID) AS RESPMAN_ID, COUNT(RESPMAN_ID)-1 CNT
											 FROM TN_CLM_CONT_CNSDREQ_RESPMAN
											WHERE CNSDREQ_ID = :vo.cnsdreq_id
										 		AND RESP_DEPT <> :vo.blngt_orgnz) B
						WHERE A.USER_ID = B.RESPMAN_ID), 'Initial Request')
					 END AS RESPMAN_NM_SUB, 
					ISNULL((SELECT 'N'
						  FROM TB_COM_USER A,
										(SELECT MIN(RESPMAN_ID) AS RESPMAN_ID, COUNT(RESPMAN_ID)-1 CNT
											 FROM TN_CLM_CONT_CNSDREQ_RESPMAN
											WHERE CNSDREQ_ID = :vo.cnsdreq_id
										 		AND RESP_DEPT <> :vo.blngt_orgnz) B
						WHERE A.USER_ID = B.RESPMAN_ID), 'Y') AS FIRST_YN,
					ISNULL((SELECT 
							MIN(RESP_DEPT) AS RESP_DEPT
						FROM 
							TN_CLM_CONT_CNSDREQ_RESPMAN
						WHERE CNSDREQ_ID = :vo.cnsdreq_id
							AND RESP_DEPT <> :vo.blngt_orgnz), '') AS PREV_RESP_DEPT
	        ]]>
	        </statement>
	    </query>
	    
	    <query id="las.contractmanager.listContractDeptDiv" isCamelCase="false" comment="이력정보 리스트 기준 부서 조회">
			<statement>
			<![CDATA[	                            
				SELECT DECODE(VC_CNSD_DEPT, :vo.blngt_orgnz, 'VC', 'MN') AS DEPT_DIV
                  FROM TN_CLM_CONT_CNSDREQ
                 WHERE CNSDREQ_ID = :vo.cnsdreq_id
			]]>
			</statement>
		</query>
		
	    <query id="las.contractmanager.listHisDeptCnsdRejct" isCamelCase="false" comment="부서 검토 승인, 반려 이력 조회">
			<statement>
			<![CDATA[	                            
					SELECT  A.CNSDREQ_ID,
					        A.VC_CNSD_DEPT,
					        A.MN_CNSD_DEPT,
					        B.CNSD_DEPT,
					        B.SEQNO,
					        CONVERT(CHAR(10), B.CNSD_DT, 23) AS CNSD_DT, 
					        B.CNSD_OPNN,
					        CONVERT(CHAR(10), B.REJCT_DT, 23) AS REJCT_DT, 
					        B.REJCT_OPNN
					  FROM  (SELECT CNSDREQ_ID,
					                VC_CNSD_DEPT,
					                MN_CNSD_DEPT,
					                (SELECT MIN(CNTRT_ID) 
					                   FROM TN_CLM_CONTRACT_CNSD
					                  WHERE CNSDREQ_ID = A.CNSDREQ_ID) AS CNTRT_ID
					           FROM TN_CLM_CONT_CNSDREQ A
					          WHERE PRGRS_STATUS IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C042' )
					            AND DEL_YN = 'N'
					            AND CNSDREQ_ID IN (SELECT CNSDREQ_ID FROM DBO.[COM.GET_LINK_CNSDREQ_ID]( :vo.cnsdreq_id ))
					        ) A LEFT OUTER JOIN
					        (SELECT * FROM TH_CLM_CONTRACT_DEPTCNSDREJCT WHERE CNSD_DEPT = :vo.blngt_orgnz) B 
					        ON A.CNSDREQ_ID = B.CNSDREQ_ID AND  A.CNTRT_ID = B.CNTRT_ID
					 
					 ORDER BY A.CNSDREQ_ID, B.SEQNO
			]]>
			</statement>
		</query>
		<query id="las.contractmanager.listContractReview" isCamelCase="false" comment="검토이력 정보">
			<statement>
			<![CDATA[
				SELECT  
					T1.CNSDREQ_ID
					, T1.CR_FLAN_NM
					, RTRIM(T1.CR_FLAG) CR_FLAG
					, T1.TITLE
					, T1.MAN_ID
					, T1.MAN_NM
					, T1.DEPT
					, DBO.DECODE3(T2.COMP_CD,'C10','',(CASE WHEN T1.DEPT_NM IS NULL THEN '' ELSE ' / ' + T1.DEPT_NM END) ) AS DEPT_NM
					, DBO.DECODE3(T2.COMP_CD,'C10','',(CASE WHEN T1.JIKGUP_NM IS NULL THEN '' ELSE ' / ' + T1.JIKGUP_NM END)) AS JIKGUP_NM
					, CONVERT(CHAR(10), T1.REG_DT, 23) AS REG_DT 
					, ISNULL(T1.CONT,' ') AS CONT
					, T1.CNSD_DEPT
					, T1.RM
					, T1.CNTRT_INFO_GBN
					, T1.PLNDBN_REQ_YN
					, T1.LASTBN_CHGE_YN_NM
					, T1.PLNDBN_CHGE_CONT
					, T1.MN_CNSDMAN_NM
					, T1.MN_CNSD_DEPT_NM
					, T1.MN_CNSD_JIKGUP_NM
					, T1.MN_CNSD_DT
					, T1.MN_CNSD_OPNN
					, T1.MN_APBTMAN_NM
					, T1.MN_APBT_DEPT_NM
					, T1.MN_APBT_JIKGUP_NM
					, T1.MN_APBT_DT
					, T1.MN_APBT_OPNN
					, T1.VC_CNSDMAN_NM
					, T1.VC_CNSD_DEPT_NM
					, T1.VC_CNSD_JIKGUP_NM
					, T1.VC_CNSD_DT
					, T1.VC_CNSD_OPNN
					, T1.VC_APBTMAN_NM
					, T1.VC_APBT_DEPT_NM
					, T1.VC_APBT_JIKGUP_NM
					, T1.VC_APBT_DT
					, T1.VC_APBT_OPNN
				FROM  
					(
						SELECT * 
						FROM 
							(
								SELECT  
									CNSD_LEVEL RM
									, CNSDREQ_ID
									, CASE WHEN :vo.session_user_locale = 'ko' THEN
											'[' + CAST(CNSD_LEVEL AS NVARCHAR) + '차 의뢰' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
									  ELSE
									  		CASE WHEN CNSD_LEVEL = '1' THEN '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'st Request' + ']'
												 WHEN CNSD_LEVEL = '2' THEN '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'nd Request' + ']'
												 WHEN CNSD_LEVEL = '3' THEN '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'rd Request' + ']'
												 ELSE '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'th Request' + ']'
											END
									  END AS CR_FLAN_NM
									, 'CONSULT' AS CR_FLAG
									, '' AS CNTRT_ID
									, REQ_TITLE AS TITLE
									, REQMAN_ID AS MAN_ID
									, REQMAN_NM AS MAN_NM
									, REQ_DEPT AS DEPT
									, REQ_DEPT_NM AS DEPT_NM
									, REQMAN_JIKGUP_NM AS JIKGUP_NM
									, ACPT_DT REG_DT
									, CNSD_DEMND_CONT AS CONT
									, '' AS CNSD_DEPT
									, '' AS CNTRT_INFO_GBN
									, PLNDBN_REQ_YN
									, PRGRS_STATUS AS STATUS
									, (CASE WHEN LASTBN_CHGE_YN ='Y' THEN 'YES' WHEN LASTBN_CHGE_YN ='N' THEN 'NO' END) AS LASTBN_CHGE_YN_NM
									, PLNDBN_CHGE_CONT
									, '' AS MN_CNSDMAN_NM
									, '' AS MN_CNSD_DEPT_NM
									, '' AS MN_CNSD_JIKGUP_NM
									, '' AS MN_CNSD_DT
									, CAST('' AS NVARCHAR) AS MN_CNSD_OPNN
									, '' AS MN_APBTMAN_NM
									, '' AS MN_APBT_DEPT_NM
									, '' AS MN_APBT_JIKGUP_NM
									, '' AS MN_APBT_DT
									, '' AS MN_APBT_OPNN
									, '' AS VC_CNSDMAN_NM
									, '' AS VC_CNSD_DEPT_NM
									, '' AS VC_CNSD_JIKGUP_NM
									, '' AS VC_CNSD_DT
									, CAST('' AS NVARCHAR) AS VC_CNSD_OPNN
									, '' AS VC_APBTMAN_NM
									, '' AS VC_APBT_DEPT_NM
									, '' AS VC_APBT_JIKGUP_NM
									, '' AS VC_APBT_DT
									, '' AS VC_APBT_OPNN
								FROM  
									TN_CLM_CONT_CNSDREQ A
								WHERE 
									A.PRGRS_STATUS IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C042' )
									AND A.DEL_YN = 'N'				            
									AND FST_CNSDREQ_ID = (SELECT FST_CNSDREQ_ID FROM TN_CLM_CONT_CNSDREQ WHERE CNSDREQ_ID = :vo.cnsdreq_id)
							) SA

						UNION ALL

						SELECT  
							A.CNSD_LEVEL RM
							, A.CNSDREQ_ID
							, CASE WHEN :vo.session_user_locale = 'ko' THEN
									'[' + CAST(CNSD_LEVEL AS NVARCHAR) + '차 반려' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
							  ELSE
							  		CASE WHEN CNSD_LEVEL = '1' THEN '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'st Reject' + ']'
									 WHEN CNSD_LEVEL = '2' THEN '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'nd Reject' + ']'
									 WHEN CNSD_LEVEL = '3' THEN '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'rd Reject' + ']'
									 ELSE '[' + CAST(CNSD_LEVEL AS NVARCHAR) + 'th Reject' + ']'
								END
							  END AS CR_FLAN_NM
							, 'REJECT_' AS CR_FLAG
							, '' AS CNTRT_ID
							, A.REQ_TITLE AS TITLE
							, A.REQMAN_ID AS MAN_ID
							, A.REQMAN_NM AS MAN_NM
							, A.REQ_DEPT AS DEPT
							, A.REQ_DEPT_NM AS DEPT_NM
							, A.REQMAN_JIKGUP_NM AS JIKGUP_NM
							, A.ACPT_DT REG_DT
							, A.CNSD_DEMND_CONT AS CONT
							, '' AS CNSD_DEPT
							, '' AS CNTRT_INFO_GBN
							, A.PLNDBN_REQ_YN
							, A.PRGRS_STATUS AS STATUS
							, (CASE WHEN A.LASTBN_CHGE_YN ='Y' THEN 'YES' WHEN A.LASTBN_CHGE_YN ='N' THEN 'NO' END) AS LASTBN_CHGE_YN_NM
							, A.PLNDBN_CHGE_CONT
							, '' AS MN_CNSDMAN_NM
							, '' AS MN_CNSD_DEPT_NM
							, '' AS MN_CNSD_JIKGUP_NM
							, '' AS MN_CNSD_DT
							, CAST('' AS NVARCHAR) AS MN_CNSD_OPNN
							, '' AS MN_APBTMAN_NM
							, '' AS MN_APBT_DEPT_NM
							, '' AS MN_APBT_JIKGUP_NM
							, '' AS MN_APBT_DT
							, '' AS MN_APBT_OPNN
							, '' AS VC_CNSDMAN_NM
							, '' AS VC_CNSD_DEPT_NM
							, '' AS VC_CNSD_JIKGUP_NM
							, '' AS VC_CNSD_DT
							, CAST('' AS NVARCHAR) AS VC_CNSD_OPNN
							, '' AS VC_APBTMAN_NM
							, '' AS VC_APBT_DEPT_NM
							, '' AS VC_APBT_JIKGUP_NM
							, '' AS VC_APBT_DT
							, '' AS VC_APBT_OPNN
						FROM  
							TN_CLM_CONT_CNSDREQ A,
							TH_CLM_CONTRACT_DEPTCNSDREJCT B
						WHERE 
							A.DEL_YN = 'N'
							AND A.CNSDREQ_ID = B.CNSDREQ_ID
							AND B.CNTRT_ID = :vo.cntrt_id
							AND B.SEQNO = '1'
							AND B.CNSD_DEPT = :vo.blngt_orgnz
						
						UNION ALL

						SELECT  
							H.RM
							, H.CNSDREQ_ID
							, H.CR_FLAN_NM
							, 'REPLY__' AS CR_FLAG
							, H.CNTRT_ID
							, H.TITLE
							, H.MAN_ID
							, H.MAN_NM
							, H.DEPT
							, H.CNSDMAN_DEPT_NM AS DEPT_NM 
							, H.JIKGUP_NM
							, H.REG_DT
							, H.CONT
							, H.CNSD_DEPT
							, H.CNTRT_INFO_GBN
							, H.PLNDBN_REQ_YN							                  
							, H.STATUS
							, '' AS LASTBN_CHGE_YN_NM
							, '' AS PLNDBN_CHGE_CONT
							, H.CNSDMAN_NM AS MN_CNSDMAN_NM
							, H.CNSDMAN_DEPT_NM AS MN_CNSD_DEPT_NM
							, H.CNSDMAN_JIKGUP_NM AS MN_CNSD_JIKGUP_NM
							, CONVERT(CHAR(19), H.CNSD_DT, 20) AS MN_CNSD_DT 
							, H.CNSD_OPNN AS MN_CNSD_OPNN
							, H.APBTMAN_NM AS MN_APBTMAN_NM
							, H.APBT_DEPT_NM AS MN_APBT_DEPT_NM
							, H.APBT_JIKGUP_NM AS MN_APBT_JIKGUP_NM
							, CONVERT(CHAR(19), H.APBT_DT, 20) AS MN_APBT_DT 
							, H.APBT_OPNN AS MN_APBT_OPNN
							, I.CNSDMAN_NM AS VC_CNSDMAN_NM
							, J.DEPT_NM AS VC_CNSD_DEPT_NM
							, J.JIKGUP_NM AS VC_CNSD_JIKGUP_NM
							, CONVERT(CHAR(19), I.CNSD_DT, 20) AS VC_CNSD_DT 
							, I.CNSD_OPNN AS VC_CNSD_OPNN
							, I.APBTMAN_NM AS VC_APBTMAN_NM
							, K.DEPT_NM AS VC_APBT_DEPT_NM
							, K.JIKGUP_NM AS VC_APBT_JIKGUP_NM
							, CONVERT(CHAR(19), I.APBT_DT, 20) AS VC_APBT_DT 
							, I.APBT_OPNN AS VC_APBT_OPNN
						FROM  	 
							(
								SELECT  
									D.CNSD_LEVEL AS RM
									, D.CNSDREQ_ID
									, CASE WHEN :vo.session_user_locale = 'ko' THEN 
											'[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + '차 회신' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
									  ELSE
									  	CASE WHEN D.CNSD_LEVEL = '1' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'st Reply' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
											 WHEN D.CNSD_LEVEL = '2' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'nd Reply' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
											 WHEN D.CNSD_LEVEL = '3' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'rd Reply' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
											 ELSE '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'th Reply' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
										END
									  END AS CR_FLAN_NM
									, 'REPLY__' AS CR_FLAG
									, B.CNTRT_ID AS CNTRT_ID
									, B.CNTRT_NM AS TITLE
									, (CASE WHEN A.CNSDMAN_ID IS NULL THEN A.APBTMAN_ID ELSE A.CNSDMAN_ID END) MAN_ID
									, DBO.DECODE3(F.COMP_CD, 'C10', F.USER_NM, (CASE WHEN A.CNSDMAN_ID IS NULL THEN A.APBTMAN_NM ELSE A.CNSDMAN_NM END)) AS MAN_NM
									, D.MN_CNSD_DEPT DEPT
									, E.ORGNZ_NM AS DEPT_NM
									, (CASE WHEN A.CNSDMAN_ID IS NULL THEN G.JIKGUP_NM ELSE F.JIKGUP_NM END) AS JIKGUP_NM
									, ISNULL(A.APBT_DT, A.CNSD_DT) REG_DT
									, A.CNSD_OPNN AS CONT
									, D.VC_CNSD_DEPT AS CNSD_DEPT
									, B.CNTRT_INFO_GBN
									, D.PLNDBN_REQ_YN							                  
									, A.CNSD_STATUS AS STATUS
									, DBO.DECODE3(F.COMP_CD,'C10', F.USER_NM, A.CNSDMAN_NM) AS CNSDMAN_NM
									, DBO.DECODE3(F.COMP_CD, 'C10','',F.DEPT_NM) AS CNSDMAN_DEPT_NM
									, DBO.DECODE3(F.COMP_CD, 'C10','',F.JIKGUP_NM) AS CNSDMAN_JIKGUP_NM
									, A.CNSD_DT
									, A.CNSD_OPNN AS CNSD_OPNN
									, DBO.DECODE3(F.COMP_CD,'C10', G.USER_NM, A.APBTMAN_NM) AS APBTMAN_NM
									, DBO.DECODE3(G.COMP_CD,'C10','',G.DEPT_NM) AS APBT_DEPT_NM
									, DBO.DECODE3(G.COMP_CD,'C10','',G.JIKGUP_NM) AS APBT_JIKGUP_NM
									, A.APBT_DT
									, A.APBT_OPNN
								FROM  
									TN_CLM_CONTRACT_CNSD A 
									JOIN 
									TN_CLM_CONTRACT_MASTER B ON A.CNTRT_ID = B.CNTRT_ID
									LEFT OUTER JOIN
									TN_CLM_CONT_CNSDREQ D ON D.CNSDREQ_ID = A.CNSDREQ_ID
									LEFT OUTER JOIN
									TN_CLM_UNITORGNZ E ON D.MN_CNSD_DEPT = E.ORGNZ_CD  
									LEFT OUTER JOIN
									TB_COM_USER F ON A.CNSDMAN_ID = F.USER_ID
									LEFT OUTER JOIN
									TB_COM_USER G ON A.APBTMAN_ID = G.USER_ID
								WHERE A.CNTRT_ID = :vo.cntrt_id   
									AND  A.CNSD_STATUS = 'C04305'
							) H LEFT OUTER JOIN
							TN_CLM_CONTRACT_DEPTCNSD I ON H.CNSDREQ_ID = I.CNSDREQ_ID AND H.CNTRT_ID = I.CNTRT_ID AND H.CNSD_DEPT = I.CNSD_DEPT
							LEFT OUTER JOIN
							TB_COM_USER J ON I.CNSDMAN_ID = J.USER_ID
							LEFT OUTER JOIN
							TB_COM_USER K ON I.APBTMAN_ID = K.USER_ID

						UNION ALL

						SELECT  
							H.RM
							, H.CNSDREQ_ID
							, H.CR_FLAN_NM
							, 'REPLYREJECT__' AS CR_FLAG
							, H.CNTRT_ID
							, H.TITLE
							, H.MAN_ID
							, H.MAN_NM
							, H.DEPT
							, H.DEPT_NM
							, H.JIKGUP_NM
							, H.REG_DT
							, H.CONT
							, H.CNSD_DEPT
							, H.CNTRT_INFO_GBN
							, H.PLNDBN_REQ_YN							                  
							, H.STATUS
							, '' AS LASTBN_CHGE_YN_NM
							, '' AS PLNDBN_CHGE_CONT
							, H.CNSDMAN_NM AS MN_CNSDMAN_NM
							, H.CNSDMAN_DEPT_NM AS MN_CNSD_DEPT_NM
							, H.CNSDMAN_JIKGUP_NM AS MN_CNSD_JIKGUP_NM
							, CONVERT(CHAR(19), H.CNSD_DT, 20) AS MN_CNSD_DT 
							, H.CNSD_OPNN AS MN_CNSD_OPNN
							, H.APBTMAN_NM AS MN_APBTMAN_NM
							, H.APBT_DEPT_NM AS MN_APBT_DEPT_NM
							, H.APBT_JIKGUP_NM AS MN_APBT_JIKGUP_NM
							, CONVERT(CHAR(19), H.APBT_DT, 20) AS MN_APBT_DT 
							, H.APBT_OPNN AS MN_APBT_OPNN
							, I.CNSDMAN_NM AS VC_CNSDMAN_NM
							, J.DEPT_NM AS VC_CNSD_DEPT_NM
							, J.JIKGUP_NM AS VC_CNSD_JIKGUP_NM
							, CONVERT(CHAR(19), I.CNSD_DT, 20) AS VC_CNSD_DT 
							, I.CNSD_OPNN AS VC_CNSD_OPNN
							, I.APBTMAN_NM AS VC_APBTMAN_NM
							, K.DEPT_NM AS VC_APBT_DEPT_NM
							, K.JIKGUP_NM AS VC_APBT_JIKGUP_NM
							, CONVERT(CHAR(19), I.APBT_DT, 20) AS VC_APBT_DT 
							, I.APBT_OPNN AS VC_APBT_OPNN
						FROM  	 
							(
								SELECT  
									D.CNSD_LEVEL AS RM
									, D.CNSDREQ_ID
									, CASE WHEN :vo.session_user_locale = 'ko' THEN
											'[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + '차 회신 중 보류' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
									  ELSE
									  	CASE WHEN D.CNSD_LEVEL = '1' THEN '[Holding during the ' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'st Reply' + ']'
											 WHEN D.CNSD_LEVEL = '2' THEN '[Holding during the ' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'nd Reply' + ']'
											 WHEN D.CNSD_LEVEL = '3' THEN '[Holding during the ' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'rd Reply' + ']'
											 ELSE '[Holding during the ' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'th Reply' + ']'
									    END	
									  END AS CR_FLAN_NM
									, 'REPLY__' AS CR_FLAG
									, B.CNTRT_ID AS CNTRT_ID
									, B.CNTRT_NM AS TITLE
									, (CASE WHEN A.CNSDMAN_ID IS NULL THEN A.APBTMAN_ID ELSE A.CNSDMAN_ID END) MAN_ID
									, (CASE WHEN A.CNSDMAN_ID IS NULL THEN A.APBTMAN_NM ELSE A.CNSDMAN_NM END) MAN_NM
									, D.MN_CNSD_DEPT DEPT
									, E.ORGNZ_NM AS DEPT_NM
									, (CASE WHEN A.CNSDMAN_ID IS NULL THEN G.JIKGUP_NM ELSE F.JIKGUP_NM END) AS JIKGUP_NM
									, ISNULL(A.APBT_DT, A.CNSD_DT) REG_DT
									, A.CNSD_OPNN AS CONT
									, D.VC_CNSD_DEPT AS CNSD_DEPT
									, B.CNTRT_INFO_GBN
									, D.PLNDBN_REQ_YN							                  
									, A.CNSD_STATUS AS STATUS
									, A.CNSDMAN_NM AS CNSDMAN_NM
									, F.DEPT_NM AS CNSDMAN_DEPT_NM
									, F.JIKGUP_NM AS CNSDMAN_JIKGUP_NM
									, A.CNSD_DT
									, A.CNSD_OPNN AS CNSD_OPNN
									, A.APBTMAN_NM AS APBTMAN_NM
									, G.DEPT_NM AS APBT_DEPT_NM
									, G.JIKGUP_NM AS APBT_JIKGUP_NM
									, A.APBT_DT
									, A.APBT_OPNN
								FROM  
									TN_CLM_CONTRACT_CNSD A JOIN 
									TN_CLM_CONTRACT_MASTER B ON A.CNTRT_ID = B.CNTRT_ID
									LEFT OUTER JOIN 
									TN_CLM_CONT_CNSDREQ D ON D.CNSDREQ_ID = A.CNSDREQ_ID
									
									JOIN
						  			TN_CLM_CONT_CNSDREQ_HOLD C ON C.CNSDREQ_ID = D.CNSDREQ_ID
						  			
						  			
						  			JOIN
									TN_CLM_UNITORGNZ E ON D.MN_CNSD_DEPT = E.ORGNZ_CD
									LEFT OUTER JOIN
									TB_COM_USER F ON A.CNSDMAN_ID = F.USER_ID
									LEFT OUTER JOIN
									TB_COM_USER G ON A.APBTMAN_ID = G.USER_ID
								WHERE A.CNTRT_ID = :vo.cntrt_id      
									AND  A.CNSD_STATUS IN ('C04302','C04303')
						  			AND  C.HOLD_SEQNO = '1'
						  	) H LEFT OUTER JOIN
							TN_CLM_CONTRACT_DEPTCNSD I ON H.CNSDREQ_ID = I.CNSDREQ_ID AND H.CNTRT_ID = I.CNTRT_ID AND H.CNSD_DEPT = I.CNSD_DEPT
							LEFT OUTER JOIN
							TB_COM_USER J ON I.CNSDMAN_ID = J.USER_ID
							LEFT OUTER JOIN
							TB_COM_USER K ON I.APBTMAN_ID = K.USER_ID 

					UNION ALL
					
						SELECT  
							F.* 
							, '' AS LASTBN_CHGE_YN_NM
							, '' AS PLNDBN_CHGE_CONT 
							, '' AS MN_CNSDMAN_NM
							, '' AS MN_CNSD_DEPT_NM
							, '' AS MN_CNSD_JIKGUP_NM
							, '' AS MN_CNSD_DT
							, CAST('' AS NVARCHAR) AS MN_CNSD_OPNN
							, '' AS MN_APBTMAN_NM
							, '' AS MN_APBT_DEPT_NM
							, '' AS MN_APBT_JIKGUP_NM
							, '' AS MN_APBT_DT
							, '' AS MN_APBT_OPNN
							, '' AS VC_CNSDMAN_NM
							, '' AS VC_CNSD_DEPT_NM
							, '' AS VC_CNSD_JIKGUP_NM
							, '' AS VC_CNSD_DT
							, CAST('' AS NVARCHAR) AS VC_CNSD_OPNN
							, '' AS VC_APBTMAN_NM
							, '' AS VC_APBT_DEPT_NM
							, '' AS VC_APBT_JIKGUP_NM
							, '' AS VC_APBT_DT
							, '' AS VC_APBT_OPNN
						FROM  	 
							(
								SELECT  
									D.CNSD_LEVEL AS RM
									, D.CNSDREQ_ID
									, CASE WHEN :vo.session_user_locale = 'ko' THEN 
											'[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + '차 보류' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
									  ELSE
									  	CASE WHEN D.CNSD_LEVEL = '1' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'st Holding' + ']'
											 WHEN D.CNSD_LEVEL = '2' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'nd Holding' + ']'
											 WHEN D.CNSD_LEVEL = '3' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'rd Holding' + ']'
											 ELSE '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'th Holding' + ']'
										END
									  END AS CR_FLAN_NM
									, 'RESHOLD' AS CR_FLAG
									, B.CNTRT_ID AS CNTRT_ID
									, B.CNTRT_NM AS TITLE
									, C.REG_ID MAN_ID
									, C.REG_NM MAN_NM
									, D.MN_CNSD_DEPT DEPT
									, E.DEPT_NM AS DEPT_NM
									, E.JIKGUP_NM
									, C.REG_DT REG_DT
									, CAST(C.HOLD_CAUSE AS NVARCHAR(1000)) AS CONT
									, D.VC_CNSD_DEPT AS CNSD_DEPT
									, B.CNTRT_INFO_GBN
									, D.PLNDBN_REQ_YN
									, A.CNSD_STATUS AS STATUS
								FROM  
									TN_CLM_CONTRACT_CNSD A 
									JOIN 
									TN_CLM_CONTRACT_MASTER B ON A.CNTRT_ID = B.CNTRT_ID
									LEFT OUTER JOIN
									TN_CLM_CONT_CNSDREQ D ON D.CNSDREQ_ID = A.CNSDREQ_ID
									JOIN
									TN_CLM_CONT_CNSDREQ_HOLD C ON C.CNSDREQ_ID = D.CNSDREQ_ID
									LEFT OUTER JOIN
									TB_COM_USER E ON C.REG_ID = E.USER_ID
								WHERE C.HOLD_SEQNO = '1'
									AND  A.CNTRT_ID = :vo.cntrt_id
									
							) F
							
							
							
						UNION ALL
					
						SELECT  
							H.* 
							, '' AS LASTBN_CHGE_YN_NM
							, '' AS PLNDBN_CHGE_CONT 
							, '' AS MN_CNSDMAN_NM
							, '' AS MN_CNSD_DEPT_NM
							, '' AS MN_CNSD_JIKGUP_NM
							, '' AS MN_CNSD_DT
							, CAST('' AS NVARCHAR) AS MN_CNSD_OPNN
							, '' AS MN_APBTMAN_NM
							, '' AS MN_APBT_DEPT_NM
							, '' AS MN_APBT_JIKGUP_NM
							, '' AS MN_APBT_DT
							, '' AS MN_APBT_OPNN
							, '' AS VC_CNSDMAN_NM
							, '' AS VC_CNSD_DEPT_NM
							, '' AS VC_CNSD_JIKGUP_NM
							, '' AS VC_CNSD_DT
							, CAST('' AS NVARCHAR) AS VC_CNSD_OPNN
							, '' AS VC_APBTMAN_NM
							, '' AS VC_APBT_DEPT_NM
							, '' AS VC_APBT_JIKGUP_NM
							, '' AS VC_APBT_DT
							, '' AS VC_APBT_OPNN
						FROM  	 
							(
								SELECT  
									D.CNSD_LEVEL AS RM
									, D.CNSDREQ_ID
									, CASE WHEN :vo.session_user_locale = 'ko' THEN 
											'[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + '차 보류' + DBO.DECODE3(PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
									  ELSE
									  	CASE WHEN D.CNSD_LEVEL = '1' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'st Admin Reply' + ']'
											 WHEN D.CNSD_LEVEL = '2' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'nd Admin Reply' + ']'
											 WHEN D.CNSD_LEVEL = '3' THEN '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'rd Admin Reply' + ']'
											 ELSE '[' + CAST(D.CNSD_LEVEL AS NVARCHAR) + 'th Admin Reply' + ']'
										END
									  END AS CR_FLAN_NM
									, 'ZADMIN_REPLY' AS CR_FLAG
									, B.CNTRT_ID AS CNTRT_ID
									, B.CNTRT_NM AS TITLE
									, C.REG_ID MAN_ID
									, C.REG_NM MAN_NM
									, D.MN_CNSD_DEPT DEPT
									, E.DEPT_NM AS DEPT_NM
									, E.JIKGUP_NM
									, C.REG_DT REG_DT
									, CAST(C.RET_CAUSE AS NVARCHAR(1000)) AS CONT
									, D.VC_CNSD_DEPT AS CNSD_DEPT
									, B.CNTRT_INFO_GBN
									, D.PLNDBN_REQ_YN
									, A.CNSD_STATUS AS STATUS
								FROM  
									TN_CLM_CONTRACT_CNSD A 
									JOIN 
									TN_CLM_CONTRACT_MASTER B ON A.CNTRT_ID = B.CNTRT_ID
									LEFT OUTER JOIN
									TN_CLM_CONT_CNSDREQ D ON D.CNSDREQ_ID = A.CNSDREQ_ID
									JOIN
									TN_CLM_CONT_CNSDREQ_ADMRETURN C ON C.CNSDREQ_ID = D.CNSDREQ_ID
									LEFT OUTER JOIN
									TB_COM_USER E ON C.REG_ID = E.USER_ID
								WHERE C.RET_SEQNO = '1'
									AND  A.CNTRT_ID = :vo.cntrt_id
									
							) H						
							
								
						
						WHERE 1=1
					) T1
					, TB_COM_USER T2
				WHERE T1.MAN_ID = T2.USER_ID
				ORDER BY  T1.RM, T1.CR_FLAG
			]]>
			</statement>
		</query>  
		  
		<query id="las.contractmanager.listContractApprove" isCamelCase="false" comment="승인이력 정보">
			<statement>
			<![CDATA[
				SELECT  A.CNSDREQ_ID
						, A.CNTRT_ID
			            , B.TITLE
			            , 'en' ACTIVITY_NM
			            , C.USER_NAME
			            , C.APPROVED
			            , C.DEPT_NAME
			            , C.DUTY
			            , C.GROUP_NAME
			            , CONVERT(CHAR(10), CONVERT(DATETIME, LEFT( B.CREATE_DATE ,8) , 23) , 23) AS CREATE_DATE 
			            , C.SEQUENCE
						, C.ACTIVITY
						, C.OPINION
						, D.CD_NM	            
			            
			            
			            
			            , LEAD(A.CNTRT_ID) OVER(ORDER BY A.CNTRT_ID) LEAD_CNTRT_ID
			            , LAG(A.CNTRT_ID) OVER(ORDER BY A.CNTRT_ID) LAG_CNTRT_ID
			            , COUNT(B.MIS_ID) OVER(PARTITION BY B.MIS_ID) CNTRT_ID_CNT
			            , ((COUNT(B.MIS_ID) OVER(PARTITION BY B.MIS_ID)) + 1)*2 CNTRT_ID_CNT_NUM
			            , B.MIS_ID
			            ,(SELECT COUNT(*) FROM TB_COM_ATTACHMENT_WSVO WHERE MIS_ID = B.MIS_ID AND MODULE_ID = B.MODULE_ID) FILE_CNT
			            , CASE WHEN :vo.session_user_locale = 'ko' THEN
			            		CASE WHEN B.STATUS = '1' THEN '결재중'
			              			WHEN B.STATUS = '2' THEN '완결'
			              			WHEN B.STATUS = '3' THEN '반려'
			              			WHEN B.STATUS = '4' THEN '상신취소'
			              			WHEN B.STATUS = '5' THEN '전결'
			              			WHEN B.STATUS = '6' THEN '후완결'
			              			ELSE ' ' END
			              WHEN :vo.session_user_locale = 'fr' THEN
			            		CASE WHEN B.STATUS = '1' THEN 'Approbation en cours de traitement'
			              			WHEN B.STATUS = '2' THEN 'Complété'
			              			WHEN B.STATUS = '3' THEN 'Refuser'
			              			WHEN B.STATUS = '4' THEN 'Annuler'
			              			WHEN B.STATUS = '5' THEN 'Prise de décision'
			              			WHEN B.STATUS = '6' THEN 'Approuvé à l‘issue de la finalisation'
			              			ELSE ' ' END
			              WHEN :vo.session_user_locale = 'de' THEN
			            		CASE WHEN B.STATUS = '1' THEN 'Genehmigung in Bearbeitung'
			              			WHEN B.STATUS = '2' THEN 'Abgeschlossen'
			              			WHEN B.STATUS = '3' THEN 'Ablehnen'
			              			WHEN B.STATUS = '4' THEN 'Abbrechen'
			              			WHEN B.STATUS = '5' THEN 'Entscheidungsfindung'
			              			WHEN B.STATUS = '6' THEN 'Genehmigt nach Abschluss'
			              			ELSE ' ' END
			              ELSE
			              		CASE WHEN B.STATUS = '1' THEN 'Approval in Progress'
			            			WHEN B.STATUS = '2' THEN 'Completed'
			            			WHEN B.STATUS = '3' THEN 'Reject'
			            			WHEN B.STATUS = '4' THEN 'Cancel'
			            			WHEN B.STATUS = '5' THEN 'Decide Arbitrarily'
			            			WHEN B.STATUS = '6' THEN 'Approved after Completion'
			            			ELSE ' ' END
			              END STATUS
			      FROM  TN_CLM_CONTRACT_CNSD A, TB_COM_START_PROCESS_WSVO B, TB_COM_ROUTE_WSVO C, TB_COM_CD D
			     WHERE  A.CNSDREQ_ID = :vo.cnsdreq_id
			       AND  A.CNTRT_ID = :vo.cntrt_id
			       AND  A.CNSDREQ_ID = B.REF_KEY	
			       AND  B.MIS_ID = C.MIS_ID
			       AND  B.MODULE_ID = C.MODULE_ID
			       AND  B.APPRVL_CLSFCN IN ( SELECT CD FROM TB_COM_CD WHERE SYS_CD = 'LAS' AND GRP_CD = 'C030' )
			       AND  D.GRP_CD = 'SECFW_APPROVAL_ACTIVITY'
			       AND  D.CD=C.ACTIVITY
			       AND	B.STATUS > '0' 
			]]>
			</statement>
		</query>
		
		<query id="las.contractmanager.listContractSign" isCamelCase="false" comment="체결이력 정보">
			<statement>
			<![CDATA[
				SELECT  CNTRT_ID
						, CNTRT_NM
				        , TO_CHAR(TO_DATE(CNTRT_CNCLSNDAY, 'YYYY-MM-DD'), 'YYYY-MM-DD') CNTRT_CNCLSNDAY
				        , SEAL_MTHD
				        , (SELECT CD_NM FROM TB_COM_CD WHERE SYS_CD='LAS' AND GRP_CD='C021' AND CD=SEAL_MTHD) SEAL_MTHD_NM 
				        , SEAL_FFMTDAY
				        , SEAL_FFMTMAN_ID
				        , SEAL_FFMTMAN_NM
				        , SIGNMAN_ID
				        , SIGNMAN_NM
				        , OPPNT_SIGNMAN_NM
				        , OPPNT_SIGNMAN_DEPT
				        , TO_CHAR(TO_DATE(OPPNT_SIGNDAY, 'YYYY-MM-DD'), 'YYYY-MM-DD') OPPNT_SIGNDAY
				  FROM  TN_CLM_CONTRACT_MASTER
				 WHERE  CNTRT_ID = :vo.cntrt_id
				   AND  CNTRT_CNCLSN_YN = 'Y'
			]]>
			</statement>
		</query>
        
        <query id="las.contractmanager.listPendingHis" isCamelCase="false" comment="보류이력 정보">
			<statement>
			<![CDATA[
				SELECT A.CNSDREQ_ID
				       , CASE WHEN :vo.session_user_locale = 'ko' THEN 
				       		'[' + B.RM + '-' + A.HOLD_SEQNO + '차 의뢰' + DECODE(B.PLNDBN_REQ_YN, 'Y', '-최종본]', ']')
				       	 ELSE
				       	 	CASE WHEN A.HOLD_SEQNO = '1' THEN '[' + B.RM + '-' + A.HOLD_SEQNO + 'st Request' + DECODE(B.PLNDBN_REQ_YN, 'Y', '-Final Version]', ']') 
				       			 WHEN A.HOLD_SEQNO = '2' THEN '[' + B.RM + '-' + A.HOLD_SEQNO + 'nd Request' + DECODE(B.PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
				       			 WHEN A.HOLD_SEQNO = '3' THEN '[' + B.RM + '-' + A.HOLD_SEQNO + 'rd Request' + DECODE(B.PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
				       			 ELSE '[' + B.RM + '-' + A.HOLD_SEQNO + 'th Request' + DECODE(B.PLNDBN_REQ_YN, 'Y', '-Final Version]', ']')
				       		END
				       	 END AS CR_FLAN_NM
				       , TO_CHAR(A.HOLD_STARTDAY,'yyyy-MM-dd') HOLD_STARTDAY
      				   , TO_CHAR(A.HOLD_ENDDAY,'yyyy-MM-dd') HOLD_ENDDAY				      
				       , REPLACE(REPLACE(REPLACE(A.HOLD_CAUSE, chr(13), '<br>'),chr(10),'<Br>'),'<br><Br>','<br>') AS HOLD_CAUSE
				       , A.REG_NM
				       , B.RM
				  FROM TN_CLM_CONT_CNSDREQ_HOLD A
				       , (SELECT CNSD_LEVEL AS RM
				                 , CNSDREQ_ID
				                 , PLNDBN_REQ_YN
				            FROM TN_CLM_CONT_CNSDREQ WHERE DEL_YN = 'N'
					  	   START WITH  CNSDREQ_ID = :vo.cnsdreq_id
						 CONNECT BY PRIOR  PREV_CNSDREQ_ID = CNSDREQ_ID
				       )B     
				 WHERE A.CNSDREQ_ID = B.CNSDREQ_ID
				   AND A.HOLD_SEQNO = '1'
				 ORDER BY B.RM
			]]>
			</statement>
		</query>
		
		<query id="las.contractmanager.listConsiderationHold" isCamelCase="false" comment="보류이력 조회">
			<statement>
		    <![CDATA[
		   	SELECT CNSDREQ_ID
		   	  FROM TN_CLM_CONT_CNSDREQ_HOLD
		   	 WHERE CNSDREQ_ID = :vo.cnsdreq_id
		   	   AND HOLD_SEQNO = '1'
		    ]]>
			</statement>
		</query>
		
		<query id="las.contractmanager.listContractInfo" isCamelCase="false" comment="사전검토이력 정보">
			<statement>
			<![CDATA[
				SELECT  A.CNTRT_ID
		        		, A.BFHDCSTN_MTNMAN_ID
						, A.BFHDCSTN_MTNMAN_NM
						, A.BFHDCSTN_MTNMAN_JIKGUP_NM
						, A.BFHDCSTN_MTN_DEPT_NM
						, A.BFHDCSTN_MTNMAN_EMAIL

						 ,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
				      				WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
				      				WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
				       				ELSE CD_NM_ENG END FROM TB_COM_CD WHERE CD = A.BFHDCSTN_APBT_MTHD ) AS BFHDCSTN_APBT_MTHD_NM 
						, A.BFHDCSTN_APBTMAN_ID
						, A.BFHDCSTN_APBTMAN_NM
						, A.BFHDCSTN_APBTMAN_JIKGUP_NM
						, A.BFHDCSTN_APBT_DEPT_NM
						, CONVERT(CHAR(10), CONVERT(DATETIME, LEFT( A.BFHDCSTN_APBTDAY ,8) , 23) , 23) AS BFHDCSTN_APBTDAY 
				  FROM  TN_CLM_CONTRACT_MASTER A
				 WHERE  CNTRT_ID = :vo.cntrt_id
				   AND  DEL_YN = 'N'
			]]>
			</statement>
		</query>
		
		<query id="las.contractmanager.deleteContractAuthreq" isCamelCase="false" comment="권한요청 관련자 초기화">
			<statement>
		    <![CDATA[
		         DELETE TN_CLM_CONTRACT_AUTHREQ
		         WHERE CNTRT_ID = :vo.master_cntrt_id
		    ]]>
		  	</statement>
		</query>
		
		<query id="las.contractmanager.insertContractAuthreq" isCamelCase="false" comment="권한요청 관련자  입력">
			<statement>
		    <![CDATA[
		         INSERT INTO TN_CLM_CONTRACT_AUTHREQ         
		         (
		         	CNTRT_ID
					,DEMND_SEQNO
					,DEMNDMAN_ID
					,DEMNDMAN_NM
					,DEMNDMAN_DEPT_NM
					,TRGTMAN_ID
					,TRGTMAN_NM
					,TRGTMAN_DEPT_NM
					,TRGTMAN_JIKGUP_NM
					,RD_AUTH
					,AUTH_STARTDAY
					,DEMND_STATUS
					,DEMND_DT
					,DEMND_GBN
		         )VALUES(
		         	:vo.master_cntrt_id
					,:vo.demnd_seqno
					,:vo.demndman_id
					,:vo.demndman_nm
					,:vo.demndman_dept_nm
					,:vo.trgtman_id
					,:vo.trgtman_nm
					,:vo.trgtman_dept_nm
					,:vo.trgtman_jikgup_nm
					,:vo.rd_auth
					,:vo.auth_startday
					,:vo.demnd_status
					,GETDATE()
					,:vo.demnd_gbn
		         )
		    ]]>
		  	</statement>
		</query>
		
		<query id="las.contractmanager.detailCnsdreqRenewal" isCamelCase="false" comment="CNSDREQ(RENEWAL)">
		  <statement>
		    <![CDATA[
		    	SELECT   A.CNSDREQ_ID
		    			,C.CNTRT_ID
						,A.MN_CNSD_DEPT
						,A.MN_RESPMAN_APNT_YN
						,A.VC_CNSD_DEPT
						,A.VC_CNSD_DEMND_DT
						,A.VC_CNSD_DEMND_CONT
						,A.VC_RESPMAN_APNT_YN
						,A.DMSTFRGN_GBN
						,A.DRAFT_DEMND_YN
						,A.PLNDBN_REQ_YN
						,A.LAST_CNSD_YN
						,A.PREV_CNSDREQ_ID
						,A.REQ_TITLE
						,A.REQMAN_ID
						,A.REQMAN_NM
						,A.REQ_DEPT
						,A.REQ_DEPT_NM
						,(SELECT OFFICE_TEL_NO FROM TB_COM_USER WHERE USER_ID = A.REQMAN_ID) AS REQMAN_TEL
						,TO_CHAR(A.REQ_DT, 'yyyy-mm-dd hh24:mi') AS REQ_DT
						,SUBSTR(A.RE_DEMNDDAY,1,4) + '-' + SUBSTR(A.RE_DEMNDDAY,5,2) + '-' + SUBSTR(A.RE_DEMNDDAY,7,2) AS RE_DEMNDDAY
						,A.LASTBN_CHGE_YN
						,DECODE(A.LASTBN_CHGE_YN,'Y','YES','N','NO') AS LASTBN_CHGE_YN_NM
						,A.PRGRS_STATUS
						,A.REBFR_APPRVL_YN
						,CONVERT(CHAR(16),A.RE_DT,120) AS RE_DT 
						,A.PUB_YN
						,A.REG_DT
						,A.REG_ID
						,A.REG_NM
						,A.MOD_DT
						,A.MOD_ID
						,A.MOD_NM
						,A.DEL_YN
						,A.DEL_DT
						,A.DEL_ID
						,A.DEL_NM
						,A.REQ_OPERDIV
						,A.REQ_UP_DEPT
						,A.REQMAN_JIKGUP_NM
						,A.ACPT_DT
						,A.PLNDBN_CHGE_CONT
						,A.CNSD_HOLD_CAUSE
						,A.FST_REQ_DEPT
						,A.FST_REQ_UP_DEPT
						,A.REQ_INTNL_DEPT_CD
						,A.CNSD_DEMND_CONT
						,A.SYS_NM
						,A.CNSD_LEVEL
						,A.FST_CNSDREQ_ID
				      	,(SELECT OFFICE_TEL_NO FROM TB_COM_USER WHERE USER_ID = A.REQMAN_ID) AS REQMAN_TEL
				      	,DECODE(A.VC_CNSD_DEMND_DT, NULL, '', TO_CHAR(A.VC_CNSD_DEMND_DT, 'yyyy-mm-dd hh24:mi')) AS REQ_CNSD_DEMND_DT
				      	,(SELECT CD_NM FROM TB_COM_CD WHERE GRP_CD = 'C042' AND CD = A.PRGRS_STATUS) AS PRGRS_STATUS_NM
				      	,DECODE(B.DEMND_DT, NULL, '', TO_CHAR(B.DEMND_DT, 'yyyy-mm-dd hh24:mi')) AS REQ_DEMND_DT
				      	,DECODE(B.HNDL_DT, NULL, '', TO_CHAR(B.HNDL_DT, 'yyyy-mm-dd hh24:mi')) AS RES_HNDL_DT
				      	,COM_USER_INFO(B.DEMNDMAN_ID, 'H') AS REQ_DEMNDMAN_NM
				      	,COM_USER_INFO(B.HNDLMAN_ID, 'H') AS RES_HNDLMAN_NM
				      	,B.DEMND_CAUSE
				      	,B.HNDL_CAUSE
				      	,B.TRANS_STATUS
				      	,DECODE((SELECT COUNT(RESPMAN_ID) FROM TN_CLM_CONT_CNSDREQ_RESPMAN WHERE CNSDREQ_ID = A.CNSDREQ_ID AND RESP_DEPT = A.MN_CNSD_DEPT AND A.PRGRS_STATUS IN ('C04202', 'C04203', 'C04204', 'C04206') AND RESPMAN_ID = :vo.user_id), 1, DECODE(A.PLNDBN_REQ_YN, 'Y', 'Y', 'N'), 'N') AS RESP_USER_DIV
					    ,(SELECT COUNT(CNSD.CNTRT_ID) AS CNTRT_CNT 
					        FROM TN_CLM_CONTRACT_CNSD CNSD,
					             TN_CLM_CONTRACT_MASTER MTR
					       WHERE CNSD.CNSDREQ_ID = :vo.cnsdreq_id
					         AND CNSD.CNTRT_ID = MTR.CNTRT_ID
					         AND MTR.DEL_YN = 'N'
					         AND MTR.DEPTH_STATUS != 'C02603') AS CNTRT_CNT
					    ,(SELECT COUNT(DCNSD.CNTRT_ID)+1 
					        FROM TN_CLM_CONTRACT_DEPTCNSD DCNSD,
						  	   TN_CLM_CONTRACT_MASTER MTR
					       WHERE DCNSD.CNSDREQ_ID = :vo.cnsdreq_id
					         AND DCNSD.CNSD_DEPT = :vo.blngt_orgnz
					         AND DCNSD.CNTRT_ID = MTR.CNTRT_ID
					         AND MTR.DEL_YN = 'N'
					         AND MTR.DEPTH_STATUS != 'C02603') AS DEPT_CNSD_CNT
		    	  FROM  TN_CLM_CONT_CNSDREQ A,
		    	  		TN_CLM_CONT_CNSDREQ_TRANSFER B,
						TN_CLM_CONTRACT_CNSD C
				 WHERE  1=1 
				   AND  A.CNSDREQ_ID = :vo.cnsdreq_id
				   AND  A.CNSDREQ_ID = B.CNSDREQ_ID(+)
				   AND  A.CNSDREQ_ID = C.CNSDREQ_ID
				ORDER BY C.CNTRT_ID
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.detailMainCnsdRenewal" isCamelCase="false" comment="CONTRACT_CNSD(RENEWAL)">
		  <statement>
		    <![CDATA[
		    	SELECT   CNTRT_ID
						,CNSDMAN_ID
						,CNSDMAN_NM
						,CNSD_DT
						,CNSD_OPNN
						,APBTMAN_ID
						,APBTMAN_NM
						,APBT_DT
						,APBT_OPNN
						,CNSD_STATUS
						,RISK
						,REG_DT
						,REG_ID
						,REG_NM
						,MOD_DT
						,MOD_ID
						,MOD_NM
						,CNSD_MEMO
						,COM_USER_INFO(CNSDMAN_ID, 'H') AS CNSDMAN_INFO
		    	  FROM  TN_CLM_CONTRACT_CNSD
				 WHERE  1=1 
				   AND  CNSDREQ_ID = :vo.cnsdreq_id
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.detailContractRenewal" isCamelCase="false" comment="CONTRACT_MASTER(RENEWAL)">
		  <statement>
		    <![CDATA[
		    	SELECT   ROWNUM AS RN
		    			,A.CNTRT_NM
						,A.REGION_GBN
						,A.CNTRT_OPPNT_CD
						,A.CNTRT_OPPNT_NM
						,A.CNTRT_OPPNT_RPRSNTMAN
						,A.CNTRT_OPPNT_RESPMAN
						,A.CNTRT_OPPNT_TELNO
						,A.CNTRT_OPPNT_EMAIL
						,A.CNTRT_OPPNT_TYPE
						,A.BIZ_CLSFCN
						,A.DEPTH_CLSFCN
						,A.CNCLSNPURPS_BIGCLSFCN
						,A.CNCLSNPURPS_MIDCLSFCN
						,A.CNCLSNPURPS_MIDCLSFCN_ETC
						,A.CNTRT_TRGT
						,A.CNTRT_TRGT_DET
						,A.PSHDBKGRND_PURPS
						,A.PAYMENT_GBN
						,A.ANTCPTNEFCT
						,A.CNTRTPERIOD_STARTDAY
						,A.CNTRTPERIOD_ENDDAY
						,A.SECRET_KEEPPERIOD
						,A.CNTRT_UNTPRC
						,A.CNTRT_UNTPRC_EXPL
						,A.CNTRT_AMT
						,A.CRRNCY_UNIT
						,A.PAYMENT_COND
						,A.ETC_MAIN_CONT
						,A.AUTO_RNEW_YN
						,A.EXPRT_NOTIDAY
						,A.OBLGT_LMT
						,A.SPCL_COND
						,A.CNCLSN_PLNDDAY
						,A.CNTRT_RESPMAN_ID
						,A.CNTRT_RESPMAN_NM
						,A.CNTRT_RESP_DEPT
						,A.CNTRT_RESP_DEPT_NM
						,A.CNTRT_RESP_UP_DEPT
						,A.CNTRT_RESPMAN_JIKGUP_NM
						,A.FST_CNTRT_RESP_DEPT
						,A.FST_CNTRT_RESP_UP_DEPT
						,A.SIGN_PLNDMAN_ID
						,A.SIGN_PLNDMAN_NM
						,A.SIGN_PLND_DEPT_NM
						,A.SIGN_PLNDMAN_JIKGUP_NM
						,A.SEAL_MTHD
						,A.SEAL_RQSTDAY
						,A.SEAL_RQSTMAN_ID
						,A.SEAL_RQSTMAN_NM
						,A.SEAL_RQST_DEPT_NM
						,A.SEAL_RQSTMAN_JIKGUP_NM
						,A.SEAL_FFMTDAY
						,A.SEAL_FFMTMAN_ID
						,A.SEAL_FFMTMAN_NM
						,A.SEAL_FFMT_DEPT_NM
						,A.SEAL_FFMTMAN_JIKGUP_NM
						,A.CNTRT_CNCLSN_YN
						,A.CNTRT_CNCLSNDAY
						,A.CNTRT_NO
						,A.SIGNMAN_ID
						,A.SIGNMAN_NM
						,A.SIGN_DEPT_NM
						,A.SIGNMAN_JIKGUP_NM
						,A.SIGNDAY
						,A.OPPNT_SIGNMAN_NM
						,A.OPPNT_SIGNMAN_JIKGUP
						,A.OPPNT_SIGNMAN_DEPT
						,A.OPPNT_SIGNDAY
						,A.CPY_REGMAN_ID
						,A.CPY_REGMAN_NM
						,A.CPY_REGMAN_JIKGUP_NM
						,A.CPY_REG_DEPT_NM
						,A.CPY_REGDAY
						,A.LOAC
						,A.LOAC_ETC
						,A.DSPT_RESOLT_MTHD
						,A.DSPT_RESOLT_MTHD_DET
						,A.ORG_ACPT_DLAY_CAUSE
						,A.ORG_ACPTDAY
						,A.ORG_TKOVMAN_ID
						,A.ORG_TKOVMAN_NM
						,A.ORG_TKOV_DEPT_NM
						,A.ORG_TKOVMAN_JIKGUP_NM
						,A.ORG_HDOVMAN_ID
						,A.ORG_HDOVMAN_NM
						,A.ORG_HDOV_DEPT_NM
						,A.ORG_HDOVMAN_JIKGUP_NM
						,A.ORG_STRG_POS
						,A.CNTRT_STATUS
						,A.CNTRT_CHGE_DEMNDDAY
						,A.CNTRT_CHGE_DEMNDMAN_ID
						,A.CNTRT_CHGE_DEMNDMAN_NM
						,A.CNTRT_CHGE_DEMND_DEPT_NM
						,A.CNTRT_CHGE_DEMNDMAN_JIKGUP_NM
						,A.CNTRT_CHGE_DEMND_CAUSE
						,A.CNTRT_CHGE_PLNDDAY
						,A.CNTRT_CHGE_CONF_YN
						,A.CNTRT_CHGE_CONFDAY
						,A.CNTRT_CHGE_CONF_CONT
						,A.CNTRT_CHGE_CONFMAN_ID
						,A.CNTRT_CHGE_CONFMAN_NM
						,A.CNTRT_CHGE_CONF_DEPT_NM
						,A.CNTRT_CHGE_CONFMAN_JIKGUP_NM
						,A.PRCS_DEPTH
						,A.DEPTH_STATUS
						,A.BFHDCSTN_MTNMAN_ID
						,A.BFHDCSTN_MTNMAN_NM
						,A.BFHDCSTN_MTNMAN_JIKGUP_NM
						,A.BFHDCSTN_MTN_DEPT_NM
						,A.BFHDCSTN_MTNMAN_EMAIL
						,A.BFHDCSTN_APBT_MTHD
						,A.BFHDCSTN_APBTMAN_ID
						,A.BFHDCSTN_APBTMAN_NM
						,A.BFHDCSTN_APBTMAN_JIKGUP_NM
						,A.BFHDCSTN_APBT_DEPT_NM
						,A.BFHDCSTN_APBTDAY
						,A.REG_OPERDIV
						,A.REG_INTNL_DEPT_CD
						,A.REG_DT
						,A.REG_ID
						,A.REG_NM
						,A.MOD_DT
						,A.MOD_ID
						,A.MOD_NM
						,A.DEL_YN
						,A.DEL_DT
						,A.DEL_ID
						,A.DEL_NM
						,A.CNTRT_INFO_GBN
						,A.SYS_NM
						,A.CNCLSNAFT_CSTN_CAUSE
						,A.IF_SYS_CD
						,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	  WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	  WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	  ELSE CD_NM_ENG
			               	     END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.BIZ_CLSFCN ) AS BIZ_CLSFCN_NM
						,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	  WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	  WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	  ELSE CD_NM_ENG
			               	     END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.DEPTH_CLSFCN ) AS DEPTH_CLSFCN_NM
						,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	  WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	  WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	  ELSE CD_NM_ENG
			               	     END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNCLSNPURPS_BIGCLSFCN ) AS CNCLSNPURPS_BIGCLSFCN_NM
						,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	  WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	  WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	  ELSE CD_NM_ENG
			               	     END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNCLSNPURPS_MIDCLSFCN ) AS CNCLSNPURPS_MIDCLSFCN_NM
						,(SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	    	  WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	    	  WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	    	  ELSE CD_NM_ENG
			               	     END CD_NM FROM TN_COM_CONTRACTTYPE_CD WHERE TYPE_CD = A.CNTRT_TRGT ) AS CNTRT_TRGT_NM
						,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.PAYMENT_GBN ) AS PAYMENT_GBN_NM
						,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.BFHDCSTN_APBT_MTHD ) AS BFHDCSTN_APBT_MTHD_NM
						,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.CNTRT_OPPNT_TYPE ) AS CNTRT_OPPNT_TYPE_NM
						,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.LOAC ) AS LOAC_NM
						,(SELECT CD_NM FROM TB_COM_CD WHERE CD = A.DSPT_RESOLT_MTHD ) AS DSPT_RESOLT_MTHD_NM
						,(SELECT CD_NM FROM TB_COM_CD WHERE SYS_CD='LAS' AND GRP_CD='C021' AND CD = A.SEAL_MTHD) AS SEAL_MTHD_NM 
						,CASE WHEN :vo.session_user_locale = 'ko' THEN
							(CASE WHEN A.DEPTH_STATUS = 'C02603' THEN 'DROP계약' + ROWNUM ELSE '계약' + ROWNUM END)
					     WHEN :vo.session_user_locale = 'fr' THEN
							(CASE WHEN A.DEPTH_STATUS = 'C02603' THEN 'ABANDONNER le contrat' + ROWNUM ELSE 'Contrats' + ROWNUM END)
						 WHEN :vo.session_user_locale = 'de' THEN
							(CASE WHEN A.DEPTH_STATUS = 'C02603' THEN 'Vertrag ablegen' + ROWNUM ELSE 'Vertrag' + ROWNUM END)
						 ELSE	
						 	(CASE WHEN A.DEPTH_STATUS = 'C02603' THEN 'DROP Contract' + ROWNUM ELSE 'Contract' + ROWNUM END)
						 END AS TAB_NM
						,DECODE(TRIM(TO_CHAR(TO_NUMBER(ISNULL(A.CNTRT_AMT,0)), '999,999,999,999.99')), '0.00', '', TRIM(TO_CHAR(TO_NUMBER(ISNULL(A.CNTRT_AMT,0)), '999,999,999,999.99'))) AS CNTRT_AMT_CHG
		    	  FROM  TN_CLM_CONTRACT_MASTER A
				 WHERE  1=1 
				   AND  CNTRT_ID = :vo.cntrt_id
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.detailSubCnsdRenewal" isCamelCase="false" comment="CONTRACT_DEPTCNSD(RENEWAL)">
		  <statement>
		    <![CDATA[
		    	SELECT   CNSD_DEPT
						,CNSDMAN_ID
						,CNSDMAN_NM
						,CNSD_DT
						,APBTMAN_ID
						,APBTMAN_NM
						,APBT_DT
						,APBT_OPNN
						,CNSD_STATUS
						,CNSD_OPNN
						,WEEKDUTYYN
						,MONTHDUTYYN
						,CONF_WEEKDUTYYN
						,CONF_MONTHDUTYYN
						,MAIN_MATR_CONT
						,COM_USER_INFO(CNSDMAN_ID, 'H') AS CNSDMAN_INFO
		    	  FROM  TN_CLM_CONTRACT_DEPTCNSD
				 WHERE  1=1 
				   AND  CNSDREQ_ID = :vo.cnsdreq_id
				   AND  CNTRT_ID = :vo.cntrt_id
		    ]]>
		  </statement>
		</query>
		<query id="las.contractmanager.insertContractMasterHistory" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    INSERT INTO TH_CLM_CONTRACT_MASTER (
					 CNTRT_ID
					,COMP_CD
					,COMP_NM
					,CNTRT_NM
					,REGION_GBN
					,CNTRT_OPPNT_CD
					,CNTRT_OPPNT_NM
					,CNTRT_OPPNT_RPRSNTMAN
					,CNTRT_OPPNT_RESPMAN
					,CNTRT_OPPNT_TELNO
					,CNTRT_OPPNT_EMAIL
					,CNTRT_OPPNT_TYPE
					,BIZ_CLSFCN
					,DEPTH_CLSFCN
					,CNCLSNPURPS_BIGCLSFCN
					,CNCLSNPURPS_MIDCLSFCN
					,CNCLSNPURPS_MIDCLSFCN_ETC
					,CNTRT_TRGT
					,CNTRT_TRGT_DET
					,PSHDBKGRND_PURPS
					,PAYMENT_GBN
					,ANTCPTNEFCT
					,CNTRTPERIOD_STARTDAY
					,CNTRTPERIOD_ENDDAY
					,SECRET_KEEPPERIOD
					
					,CNTRT_UNTPRC_EXPL
					,CNTRT_AMT
					,CRRNCY_UNIT
					,PAYMENT_COND
					,ETC_MAIN_CONT
					,AUTO_RNEW_YN
					,EXPRT_NOTIDAY
					,OBLGT_LMT
					,SPCL_COND
					,CNCLSN_PLNDDAY
					,CNTRT_RESPMAN_ID
					,CNTRT_RESPMAN_NM
					,CNTRT_RESP_DEPT
					,CNTRT_RESP_DEPT_NM
					,CNTRT_RESP_UP_DEPT
					,CNTRT_RESPMAN_JIKGUP_NM
					,FST_CNTRT_RESP_DEPT
					,FST_CNTRT_RESP_UP_DEPT
					,SIGN_PLNDMAN_ID
					,SIGN_PLNDMAN_NM
					,SIGN_PLND_DEPT_NM
					,SIGN_PLNDMAN_JIKGUP_NM
					,SEAL_MTHD
					,SEAL_RQSTDAY
					,SEAL_RQSTMAN_ID
					,SEAL_RQSTMAN_NM
					,SEAL_RQST_DEPT_NM
					,SEAL_RQSTMAN_JIKGUP_NM
					,SEAL_FFMTDAY
					,SEAL_FFMTMAN_ID
					,SEAL_FFMTMAN_NM
					,SEAL_FFMT_DEPT_NM
					,SEAL_FFMTMAN_JIKGUP_NM
					,CNTRT_CNCLSN_YN
					,CNTRT_CNCLSNDAY
					,CNTRT_NO
					,SIGNMAN_ID
					,SIGNMAN_NM
					,SIGN_DEPT_NM
					,SIGNMAN_JIKGUP_NM
					,SIGNDAY
					,OPPNT_SIGNMAN_NM
					,OPPNT_SIGNMAN_JIKGUP
					,OPPNT_SIGNMAN_DEPT
					,OPPNT_SIGNDAY
					,CPY_REGMAN_ID
					,CPY_REGMAN_NM
					,CPY_REGMAN_JIKGUP_NM
					,CPY_REG_DEPT_NM
					,CPY_REGDAY
					,LOAC
					,LOAC_ETC
					,DSPT_RESOLT_MTHD
					,DSPT_RESOLT_MTHD_DET
					,ORG_ACPT_DLAY_CAUSE
					,ORG_ACPTDAY
					,ORG_TKOVMAN_ID
					,ORG_TKOVMAN_NM
					,ORG_TKOV_DEPT_NM
					,ORG_TKOVMAN_JIKGUP_NM
					,ORG_HDOVMAN_ID
					,ORG_HDOVMAN_NM
					,ORG_HDOV_DEPT_NM
					,ORG_HDOVMAN_JIKGUP_NM
					,ORG_STRG_POS
					,CNTRT_STATUS
					,CNTRT_CHGE_DEMNDDAY
					,CNTRT_CHGE_DEMNDMAN_ID
					,CNTRT_CHGE_DEMNDMAN_NM
					,CNTRT_CHGE_DEMND_DEPT_NM
					,CNTRT_CHGE_DEMNDMAN_JIKGUP_NM
					,CNTRT_CHGE_DEMND_CAUSE
					,CNTRT_CHGE_PLNDDAY
					,CNTRT_CHGE_CONF_YN
					,CNTRT_CHGE_CONFDAY
					,CNTRT_CHGE_CONF_CONT
					,CNTRT_CHGE_CONFMAN_ID
					,CNTRT_CHGE_CONFMAN_NM
					,CNTRT_CHGE_CONF_DEPT_NM
					,CNTRT_CHGE_CONFMAN_JIKGUP_NM
					,PRCS_DEPTH
					,DEPTH_STATUS
					,BFHDCSTN_MTNMAN_ID
					,BFHDCSTN_MTNMAN_NM
					,BFHDCSTN_MTNMAN_JIKGUP_NM
					,BFHDCSTN_MTN_DEPT_NM
					,BFHDCSTN_MTNMAN_EMAIL
					,BFHDCSTN_APBT_MTHD
					,BFHDCSTN_APBTMAN_ID
					,BFHDCSTN_APBTMAN_NM
					,BFHDCSTN_APBTMAN_JIKGUP_NM
					,BFHDCSTN_APBT_DEPT_NM
					,BFHDCSTN_APBTDAY
					,REG_OPERDIV
					,REG_INTNL_DEPT_CD
					,REG_DT
					,REG_ID
					,REG_NM
					,MOD_DT
					,MOD_ID
					,MOD_NM
					,DEL_YN
					,DEL_DT
					,DEL_ID
					,DEL_NM
					,CNTRT_INFO_GBN
					,SYS_NM
					,CNCLSNAFT_CSTN_CAUSE
					,IF_SYS_CD
				) VALUES (
					 :vo.cntrt_id
					,:vo.session_comp_cd
					,:vo.session_comp_nm
					,:vo.cntrt_nm
					,:vo.region_gbn
					,:vo.cntrt_oppnt_cd
					,:vo.cntrt_oppnt_nm
					,:vo.cntrt_oppnt_rprsntman
					,:vo.cntrt_oppnt_respman
					,:vo.cntrt_oppnt_telno
					,:vo.cntrt_oppnt_email
					,:vo.cntrt_oppnt_type
					,:vo.biz_clsfcn
					,:vo.depth_clsfcn
					,:vo.cnclsnpurps_bigclsfcn
					,:vo.cnclsnpurps_midclsfcn
					,:vo.cnclsnpurps_midclsfcn_etc
					,:vo.cntrt_trgt
					,:vo.cntrt_trgt_det
					#if(!$vo.pshdbkgrnd_purps.equals("") && $vo.pshdbkgrnd_purps)
               			,CAST(:vo.pshdbkgrnd_purps AS NTEXT)
					#else
	               		,NULL
               		#end
					,:vo.payment_gbn
					,:vo.antcptnefct
					,REPLACE(:vo.cntrtperiod_startday,'-','')
					,REPLACE(:vo.cntrtperiod_endday,'-','')
					,:vo.secret_keepperiod
					 
					,:vo.cntrt_untprc_expl
					#if(!$vo.cntrt_amt.equals("") && $vo.cntrt_amt)
						,CONVERT(FLOAT, :vo.cntrt_amt)
					#else
						,0
					#end	
					,:vo.crrncy_unit
					,:vo.payment_cond
					,:vo.etc_main_cont
					,:vo.auto_rnew_yn
					,REPLACE(:vo.exprt_notiday,'-','')
					,:vo.oblgt_lmt
					,:vo.spcl_cond
					,REPLACE(:vo.cnclsn_plndday,'-','')
					,:vo.cntrt_respman_id
					,:vo.cntrt_respman_nm
					,:vo.cntrt_resp_dept
					,:vo.cntrt_resp_dept_nm
					,:vo.cntrt_resp_up_dept
					,:vo.cntrt_respman_jikgup_nm
					,:vo.fst_cntrt_resp_dept
					,:vo.fst_cntrt_resp_up_dept
					,:vo.sign_plndman_id
					,:vo.sign_plndman_nm
					,:vo.sign_plnd_dept_nm
					,:vo.sign_plndman_jikgup_nm
					,:vo.seal_mthd
					,REPLACE(:vo.seal_rqstday,'-','')
					,:vo.seal_rqstman_id
					,:vo.seal_rqstman_nm
					,:vo.seal_rqst_dept_nm
					,:vo.seal_rqstman_jikgup_nm
					,REPLACE(:vo.seal_ffmtday,'-','')
					,:vo.seal_ffmtman_id
					,:vo.seal_ffmtman_nm
					,:vo.seal_ffmt_dept_nm
					,:vo.seal_ffmtman_jikgup_nm
					,:vo.cntrt_cnclsn_yn
					,replace(:vo.cntrt_cnclsnday,'-','')
					,:vo.cntrt_no
					,:vo.signman_id
					,:vo.signman_nm
					,:vo.sign_dept_nm
					,:vo.signman_jikgup_nm
					,REPLACE(:vo.signday,'-','')
					,:vo.oppnt_signman_nm
					,:vo.oppnt_signman_jikgup
					,:vo.oppnt_signman_dept
					,:vo.oppnt_signday
					,:vo.cpy_regman_id
					,:vo.cpy_regman_nm
					,:vo.cpy_regman_jikgup_nm
					,:vo.cpy_reg_dept_nm
					,REPLACE(:vo.cpy_regday,'-','')
					,:vo.loac
					,:vo.loac_etc
					,:vo.dspt_resolt_mthd
					,:vo.dspt_resolt_mthd_det
					,:vo.org_acpt_dlay_cause
					,:vo.org_acptday
					,:vo.org_tkovman_id
					,:vo.org_tkovman_nm
					,:vo.org_tkov_dept_nm
					,:vo.org_tkovman_jikgup_nm
					,:vo.org_hdovman_id
					,:vo.org_hdovman_nm
					,:vo.org_hdov_dept_nm
					,:vo.org_hdovman_jikgup_nm
					,:vo.org_strg_pos
					,:vo.cntrt_status
					,REPLACE(:vo.cntrt_chge_demndday,'-','')
					,:vo.cntrt_chge_demndman_id
					,:vo.cntrt_chge_demndman_nm
					,:vo.cntrt_chge_demnd_dept_nm
					,:vo.cntrt_chge_demndman_jikgup_nm
					,:vo.cntrt_chge_demnd_cause
					,REPLACE(:vo.cntrt_chge_plndday,'-','')
					,:vo.cntrt_chge_conf_yn
					,REPLACE(:vo.cntrt_chge_confday,'-','')
					,:vo.cntrt_chge_conf_cont
					,:vo.cntrt_chge_confman_id
					,:vo.cntrt_chge_confman_nm
					,:vo.cntrt_chge_conf_dept_nm
					,:vo.cntrt_chge_confman_jikgup_nm
					,:vo.prcs_depth
					,:vo.depth_status
					,:vo.bfhdcstn_mtnman_id
					,:vo.bfhdcstn_mtnman_nm
					,:vo.bfhdcstn_mtnman_jikgup_nm
					,:vo.bfhdcstn_mtn_dept_nm
					,:vo.bfhdcstn_mtnman_email
					,:vo.bfhdcstn_apbt_mthd
					,:vo.bfhdcstn_apbtman_id
					,:vo.bfhdcstn_apbtman_nm
					,:vo.bfhdcstn_apbtman_jikgup_nm
					,:vo.bfhdcstn_apbt_dept_nm
					,REPLACE(:vo.bfhdcstn_apbtday,'-','')
					,:vo.reg_operdiv
					,:vo.reg_intnl_dept_cd
					,GETDATE()
					,:vo.session_user_id
					,:vo.session_user_nm
					,:vo.mod_dt
					,:vo.mod_id
					,:vo.mod_nm
					,:vo.del_yn
					,:vo.del_dt
					,:vo.del_id
					,:vo.del_nm
					,:vo.cntrt_info_gbn
					,:vo.sys_nm
					#if(!$vo.cnclsnaft_cstn_cause.equals("") && $vo.cnclsnaft_cstn_cause)
						,CAST(:vo.cnclsnaft_cstn_cause AS NTEXT)
					#else
						,NULL
					#end
					,:vo.if_sys_cd
			    )
		    ]]>
		  </statement>
		</query>
		
		
		
		
		<query id="las.contractmanager.insertContCnsdreqHistory" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    INSERT INTO TH_CLM_CONT_CNSDREQ (
					CNSDREQ_ID
					,COMP_CD
					,COMP_NM
					,MN_CNSD_DEPT
					,MN_RESPMAN_APNT_YN
					,VC_CNSD_DEPT
					,VC_CNSD_DEMND_DT
					,VC_CNSD_DEMND_CONT
					,VC_RESPMAN_APNT_YN
					,DMSTFRGN_GBN
					,DRAFT_DEMND_YN
					,PLNDBN_REQ_YN
					,LAST_CNSD_YN
					,PREV_CNSDREQ_ID
					,REQ_TITLE
					,REQMAN_ID
					,REQMAN_NM
					,REQMAN_JIKGUP_NM
					,REQ_DEPT
					,REQ_DEPT_NM
					,REQ_INTNL_DEPT_CD
					,REQ_UP_DEPT
					,REQ_OPERDIV
					,REQ_DT
					,RE_DEMNDDAY
					,LASTBN_CHGE_YN
					,PRGRS_STATUS
					,REBFR_APPRVL_YN
					,RE_DT
					,PUB_YN
					,ACPT_DT
					,PLNDBN_CHGE_CONT
					,CNSD_HOLD_CAUSE
					,FST_REQ_DEPT
					,FST_REQ_UP_DEPT
					,CNSD_DEMND_CONT
					,SYS_NM
					,CNSD_LEVEL
					,FST_CNSDREQ_ID
					,FAST_TRACK_DIV
					,DEL_YN
					,REG_ID
					,REG_NM
					,REG_DT
					,MOD_ID
					,MOD_NM
					,MOD_DT
					,DEL_ID
					,DEL_NM
					,DEL_DT
				) VALUES (
					:vo.cnsdreq_id
					,:vo.session_comp_cd
					,:vo.session_comp_nm
					,:vo.mn_cnsd_dept
					,:vo.mn_respman_apnt_yn
					,:vo.vc_cnsd_dept
					,GETDATE()
					,:vo.vc_cnsd_demnd_cont
					,:vo.vc_respman_apnt_yn
					,:vo.dmstfrgn_gbn
					,:vo.draft_demnd_yn
					,:vo.plndbn_req_yn
					,:vo.last_cnsd_yn
					,:vo.prev_cnsdreq_id
					,:vo.req_title
					,:vo.reqman_id
					,:vo.reqman_nm
					,:vo.reqman_jikgup_nm
					,:vo.req_dept
					,:vo.req_dept_nm
					,:vo.req_intnl_dept_cd
					,:vo.req_up_dept
					,:vo.req_operdiv
					,GETDATE()
					,REPLACE(:vo.re_demndday,'-','')
					,:vo.lastbn_chge_yn
					,:vo.prgrs_status
					,:vo.rebfr_apprvl_yn
					,GETDATE()
					,:vo.pub_yn
					,GETDATE()
					,:vo.plndbn_chge_cont
					,:vo.cnsd_hold_cause
					,:vo.fst_req_dept
					,:vo.fst_req_up_dept
					#if(!$vo.cnsd_demnd_cont.equals("") && $vo.cnsd_demnd_cont)					
						,CAST(:vo.cnsd_demnd_cont AS NTEXT)
					#else
						,NULL
					#end
					,:vo.sys_nm
					,:vo.cnsd_level
					,:vo.fst_cnsdreq_id
					,:vo.fast_track_div
					,CASE WHEN ISNULL(:vo.del_yn,'') = '' THEN 'N'
						  ELSE :vo.del_yn
					 END
					,:vo.session_user_id
					,:vo.session_user_nm
					,GETDATE()
					,:vo.mod_id
					,:vo.mod_nm
					,GETDATE()
					,:vo.del_id
					,:vo.del_nm
					,GETDATE()
			    )
		    ]]>
		  </statement>
		</query>
		
		
		
		<query id="las.contractmanager.insertContractDeptcnsdHistory" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    INSERT INTO TH_CLM_CONTRACT_DEPTCNSD (
					CNSDREQ_ID
					,CNTRT_ID
					,CNSD_DEPT
					,COMP_CD
					,COMP_NM
					,CNSDMAN_ID
					,CNSDMAN_NM
					,CNSD_DT
					,APBTMAN_ID
					,APBTMAN_NM
					,APBT_OPNN
					,APBT_MEMO
					,APBT_DT
					,CNSD_STATUS
					,CNSD_OPNN
					,WEEKDUTYYN
					,MONTHDUTYYN
					,CONF_WEEKDUTYYN
					,CONF_MONTHDUTYYN
					,MAIN_MATR_CONT
					,REQ_LT
				) VALUES (
					:vo.cnsdreq_id
					,:vo.cntrt_id
					,:vo.cnsd_dept
					,:vo.comp_cd
					,:vo.comp_nm
					,:vo.cnsdman_id
					,:vo.cnsdman_nm
					,:vo.cnsd_dt
					,:vo.apbtman_id
					,:vo.apbtman_nm
					,:vo.apbt_opnn
					,:vo.apbt_memo
					,:vo.apbt_dt
					,:vo.cnsd_status
					,:vo.cnsd_opnn
					,:vo.weekdutyyn
					,:vo.monthdutyyn
					,:vo.conf_weekdutyyn
					,:vo.conf_monthdutyyn
					,:vo.main_matr_cont
					,:vo.req_lt
			    )
		    ]]>
		  </statement>
		</query>
		
		
		
		<query id="las.contractmanager.forwardLegalOpinion" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    
			    SELECT A.CNSDREQ_ID
			         , A.CNTRT_ID
			         , CNSD_OPNN
			         , C.REQ_TITLE
			         , C.PRGRS_STATUS
			         , B.CNTRT_NM
	                 , B.DEPTH_STATUS
                  FROM TN_CLM_CONTRACT_CNSD A
				  JOIN TN_CLM_CONTRACT_MASTER B ON A.CNTRT_ID = B.CNTRT_ID
				  JOIN TN_CLM_CONT_CNSDREQ C ON A.CNSDREQ_ID = C.CNSDREQ_ID
                 WHERE A.CNTRT_ID = :vo.cntrt_id
                   AND A.CNSDREQ_ID = (SELECT MAX(CNSDREQ_ID)
                                         FROM TN_CLM_CONTRACT_CNSD
					                    WHERE CNTRT_ID = :vo.cntrt_id
					                )
			    
		    ]]>
		  </statement>
		</query>
		
		<query id="las.contractmanager.forwardLegalAdminOpinion" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    
			    SELECT A.CNSDREQ_ID
			         , A.CNTRT_ID
			         , D.RET_CAUSE AS CNSD_OPNN
			         , C.REQ_TITLE
			         , C.PRGRS_STATUS
			         , B.CNTRT_NM
	                 , B.DEPTH_STATUS
                  FROM TN_CLM_CONTRACT_CNSD A
				  JOIN TN_CLM_CONTRACT_MASTER B ON A.CNTRT_ID = B.CNTRT_ID
				  JOIN TN_CLM_CONT_CNSDREQ C ON A.CNSDREQ_ID = C.CNSDREQ_ID
				  JOIN TN_CLM_CONT_CNSDREQ_ADMRETURN D ON C.CNSDREQ_ID = D.CNSDREQ_ID 
                 WHERE A.CNTRT_ID = :vo.cntrt_id
                   AND A.CNSDREQ_ID = (SELECT MAX(CNSDREQ_ID)
                                         FROM TN_CLM_CONTRACT_CNSD
					                    WHERE CNTRT_ID = :vo.cntrt_id
					                )
			    
		    ]]>
		  </statement>
		</query>
		
		
		
		<!-- legal admin이 admin_replay를 할 경우 검토의견을 수정 한다. -->        
         <query id="las.contractmanager.updateLegReplyOpinion" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
					UPDATE TN_CLM_CONT_CNSDREQ_ADMRETURN 
					   SET RET_CAUSE = :vo.cnsd_opnn
				     WHERE CNSDREQ_ID = :vo.cnsdreq_id	
						
                ]]>
            </statement>
        </query>
		
		<!-- 검토의견을 수정 한다. -->        
         <query id="las.contractmanager.updateLegOpinion" isCamelCase="false">
		  <statement>
		    <![CDATA[
    			
					UPDATE TN_CLM_CONTRACT_CNSD 
					   SET CNSD_OPNN = :vo.cnsd_opnn
				     WHERE CNTRT_ID = :vo.cntrt_id
				       AND CNSDREQ_ID = :vo.cnsdreq_id	
						
                ]]>
            </statement>
        </query>
        
        <!-- 필수 항목 중 값이 있는지 없는지를 판단할 자료 임. && 본문에 보여주는 영역 -->
		<query id="las.contractmanager.itemCheckResonDBYn" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				SELECT CNTRT_ID
				      ,ITEM_CD
				      ,COMP_CD
				      ,DIS_YN
				      ,REMARK
				      ,ROW_NUMBER() OVER(ORDER BY ITEM_CD) AS NO
				      ,B.CD_NM
				  FROM TN_CLM_REQU_ITEM A
				  JOIN TB_COM_CD B ON A.ITEM_CD = B.CD
				 WHERE CNTRT_ID = :vo.cntrt_id
				 #if(!$vo.comp_cd.equals("") && $vo.comp_cd)
				   AND COMP_CD IN ( :vo.comp_cd )
                 #end
		 	]]>
		  </statement>
		</query>
		
		<!-- 의뢰를 하게 되면 HQ Admin에게 메일 발송을 위한 리스트를 가지고 온다. -->
		<query id="las.contractmanager.selectMailRevList" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				SELECT A.SINGLE_ID
				     , A.EMAIL
				     , A.USER_ID
	              FROM TB_COM_USER A
	              JOIN TB_COM_ROLE_USER B ON A.USER_ID = B.USER_ID
	             WHERE B.ROLE_CD = 'HQ01'
	               AND A.EMAIL_RCV_YN = 'Y'
		 	]]>
		  </statement>
		</query>
		
		<!-- 필수 항목을 체크 했는지 여부를 판단 하기 위해서 마스터에 UPDATE 한다. -->
		<query id=" las.contractmanager.updateCheck_yn" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				UPDATE TN_CLM_CONTRACT_MASTER
                   SET CHECK_LIST_YN = 'Y'
                 WHERE CNTRT_ID = :vo.cntrt_id
                   
		 	]]>
		  </statement>
		</query>
		
		<!-- HQ로 의뢰 할 수 있는 팝업을 띄어 준다. 임시 저장 건도 있기 때문에 내용을 조회해야 한다. -->
		<query id="las.contractmanager.forwardRequestHQ" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    
			    SELECT HQ_CNSDREQ_ID
                      ,CNSDREQ_ID
	                  ,CNTRT_ID
	                  ,COMP_CD
	                  ,PREV_HQ_CNSDREQ_ID
	                  ,HQ_REQ_TITLE
	                  ,HQ_CNSD_DEMND_CONT
	                  ,REQMAN_ID
	                  ,CNSD_LEVEL
	                  ,HQ_CNSD_STATUS
                  FROM TN_CLM_HQ_CONT_CNSDREQ
                 WHERE CNSDREQ_ID = :vo.cnsdreq_id
                   AND CNTRT_ID = :vo.cntrt_id
                   AND COMP_CD = :vo.session_comp_cd
                   AND REQMAN_ID = :vo.session_user_id
                   AND HQ_CNSD_STATUS = 'C16201'
                   AND CNSD_LEVEL = (SELECT MAX(CNSD_LEVEL) AS MAX_LVL
                                       FROM TN_CLM_HQ_CONT_CNSDREQ
                                      WHERE CNSDREQ_ID = :vo.cnsdreq_id
					                    AND CNTRT_ID = :vo.cntrt_id
					                    AND COMP_CD = :vo.session_comp_cd
					                    AND REQMAN_ID = :vo.session_user_id
                                     )
			    
		    ]]>
		  </statement>
		</query>
		
		<!-- HQ로 재 의뢰 할 수 있는 팝업을 띄어 준다. 임시 저장 건도 있기 때문에 내용을 조회해야 한다. -->
		<query id="las.contractmanager.forwardRERequestHQ" isCamelCase="false">
		  <statement>
		    <![CDATA[
			    
			    SELECT A.HQ_CNSDREQ_ID
                      ,A.CNSDREQ_ID
	                  ,A.CNTRT_ID
	                  ,A.COMP_CD
	                  ,A.PREV_HQ_CNSDREQ_ID
	                  ,A.HQ_REQ_TITLE
	                  ,A.HQ_CNSD_DEMND_CONT
	                  ,A.REQMAN_ID
	                  ,A.CNSD_LEVEL
	                  ,A.HQ_CNSD_STATUS
	                  ,B.HQ_REQ_YN
                  FROM TN_CLM_HQ_CONT_CNSDREQ A
                  JOIN TN_CLM_CONTRACT_CNSD B ON A.CNTRT_ID = B.CNTRT_ID
                                             AND B.CNSDREQ_ID = :vo.cnsdreq_id
                 WHERE A.CNSDREQ_ID = :vo.cnsdreq_id
                   AND A.CNTRT_ID = :vo.cntrt_id
                   AND A.COMP_CD = :vo.session_comp_cd
                   AND A.REQMAN_ID = :vo.session_user_id
                   AND A.CNSD_LEVEL = (SELECT MAX(CNSD_LEVEL) AS MAX_LVL
                                         FROM TN_CLM_HQ_CONT_CNSDREQ
                                        WHERE CNSDREQ_ID = :vo.cnsdreq_id
					                      AND CNTRT_ID = :vo.cntrt_id
					                      AND COMP_CD = :vo.session_comp_cd
					                      AND REQMAN_ID = :vo.session_user_id
                                     )
			    
		    ]]>
		  </statement>
		</query>
		
		<!-- HQ 의뢰ID 구하기 -->
		<query id="las.contractmanager.searchHQCnsdReqId" isCamelCase="false">
		  <statement>
		    <![CDATA[
				SELECT 'HQ' + SUBSTRING(CNTRT_ID, 1, 8) + SUBSTRING(CNTRT_ID, 13, 30) AS HQ_CNSDREQ_ID 
				  FROM TN_CLM_CONTRACT_CNSD
				 WHERE CNSDREQ_ID = :vo.cnsdreq_id
                   AND CNTRT_ID = :vo.cntrt_id
                   AND COMP_CD = :vo.session_comp_cd
		 	]]>
		  </statement>
		</query>
		
		<!-- HQ 의뢰 임시저장 및 의뢰 -->
		<query id="las.contractmanager.insertHqRequest" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				MERGE INTO TN_CLM_HQ_CONT_CNSDREQ AS A
                     USING (SELECT :vo.hq_cnsdreq_id AS HQ_CNSDREQ_ID
                                  ,:vo.cnsdreq_id AS CNSDREQ_ID
                                  ,:vo.cntrt_id AS CNTRT_ID
                                  ,:vo.session_comp_cd AS COMP_CD
                                  ,:vo.session_user_id AS REQMAN_ID
                                  ,CONVERT(BIGINT, :vo.cnsd_level) AS CNSD_LEVEL ) AS B
	                    ON A.HQ_CNSDREQ_ID = B.HQ_CNSDREQ_ID
		               AND A.CNSDREQ_ID = B.CNSDREQ_ID
		               AND A.CNTRT_ID = B.CNTRT_ID
		               AND A.COMP_CD = B.COMP_CD
		               AND A.REQMAN_ID = B.REQMAN_ID
		               AND A.CNSD_LEVEL = B.CNSD_LEVEL
                  WHEN MATCHED THEN 
                      UPDATE SET A.HQ_REQ_TITLE = :vo.hq_req_title
                                ,A.HQ_CNSD_DEMND_CONT = :vo.hq_cnsd_demnd_cont
			                    ,A.MOD_ID = :vo.session_user_id
			                    ,A.MOD_DT = GETDATE()
			                    ,A.HQ_CNSD_STATUS = :vo.hq_cnsd_status
			                    ,A.HQ_REL_PRO = (SELECT MAX(RELATED_PRODUCTS)
			                                       FROM TN_CLM_CONTRACT_MASTER
			                                      WHERE CNTRT_ID = :vo.cntrt_id)
                  WHEN NOT MATCHED THEN
                      INSERT ( HQ_CNSDREQ_ID
                              ,CNSDREQ_ID
                              ,CNTRT_ID
                              ,CNSD_LEVEL
                              ,COMP_CD
                              ,COMP_NM
                              ,PREV_HQ_CNSDREQ_ID
                              ,HQ_REQ_TITLE
                              ,HQ_CNSD_DEMND_CONT
                              ,REQMAN_ID
                              ,REQMAN_NM
                              ,REQ_DEPT
                              ,REQ_DEPT_NM
                              ,REQ_DT
                              ,PRODUCT_GBN
		                      ,HQ_CNSD_STATUS
                              ,SYS_LAST_GBN
                              ,REG_DT
                              ,REG_ID
                              ,REBFR_APPRVL_YN
                              ,HQ_REL_PRO
                             ) 
	                  VALUES ( :vo.hq_cnsdreq_id
	                          ,:vo.cnsdreq_id
	                          ,:vo.cntrt_id
	                          ,(SELECT ISNULL(MAX(CNSD_LEVEL) + 1, 1) FROM TN_CLM_HQ_CONT_CNSDREQ WHERE HQ_CNSDREQ_ID = :vo.hq_cnsdreq_id)
	                          ,:vo.session_comp_cd
	                          ,:vo.session_comp_nm
	                          ,''
	                          ,:vo.hq_req_title
	                          ,:vo.hq_cnsd_demnd_cont
	                          ,:vo.session_user_id
	                          ,:vo.session_user_nm
	                          ,:vo.session_dept_cd
	                          ,:vo.session_dept_nm
	                          ,getdate()
	                          ,:vo.product_gbn
	                          ,:vo.hq_cnsd_status
	                          ,'N'
	                          ,getdate()
	                          ,:vo.session_user_id
	                          ,'N'
	                          ,(SELECT MAX(RELATED_PRODUCTS)
			                      FROM TN_CLM_CONTRACT_MASTER
			                     WHERE CNTRT_ID = :vo.cntrt_id)
	                         ) ;
                   
		 	]]>
		  </statement>
		</query>
		
		
		<!-- HQ 의뢰 상태 변경 -->
		<query id="las.contractmanager.updateHqRequest" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				UPDATE TN_CLM_CONTRACT_CNSD
                   SET HQ_REQ_YN = :vo.hq_req_yn
                 WHERE CNTRT_ID = :vo.cntrt_id
                  -- AND CNSDREQ_ID = :vo.cnsdreq_id
                   
		 	]]>
		  </statement>
		</query>
		
		<!-- HQ 재 의뢰 시 배정자 다시 배정 - 차수에 연관이 있음. -->
		<query id="las.contractmanager.insertHqRevier" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				INSERT INTO TN_CLM_HQ_CONT_CNSDREQ_RESPMAN
                    SELECT RESPMAN_ID
                          ,:vo.resp_key
	                      ,(SELECT ISNULL(MAX(CNSD_LEVEL) + 1 ,1)
	                          FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN
                             WHERE HQ_CNSDREQ_ID = :vo.resp_key) AS M_CNSD_LEVEL
	                      ,RESP_DEPT
	                      ,ASGN_DT
	                      ,ASGNMAN_ID
	                      ,ASGNMAN_NM
	                      ,RESPMAN_NM
	                      ,RESPMAN_JIKGUP_NM
	                      ,MAIN_CNSD_YN
	                      ,APBT_MEMO
                     FROM TN_CLM_HQ_CONT_CNSDREQ_RESPMAN
                    WHERE HQ_CNSDREQ_ID = :vo.db_cnsdreq_id
                   
		 	]]>
		  </statement>
		</query>
		
		<!-- 필수 항목 삭제 함. -->
		<query id="las.contractmanager.deleteCheckReson" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
		        DELETE TN_CLM_REQU_ITEM
		         WHERE CNTRT_ID = :vo.cntrt_id
		           AND COMP_CD = :vo.session_comp_cd
                   
		 	]]>
		  </statement>
		</query>
		
		<!-- 필수 항목 중 No로 체크한 내용을 저장을 한다. -->
		<query id="las.contractmanager.insertCheckReson" isCamelCase="false">
		  <statement>
		    <![CDATA[
		    
				INSERT INTO TN_CLM_REQU_ITEM (
				                             CNTRT_ID
				                            ,COMP_CD
				                            ,ITEM_CD
				                            ,DIS_YN
				                            ,REG_ID
				                            ,REG_DT
				                            ,REMARK
				                             )
				                      VALUES (
				                             :vo.cntrt_id
				                            ,:vo.session_comp_cd
				                            ,:vo.item_cd
				                            ,'N'
				                            ,:vo.session_user_id
				                            ,getdate()
				                            ,:vo.remark
				                             )
                   
		 	]]>
		  </statement>
		</query>
		
		<!-- 계약에 대한 체크 리스트 항목을 보여 준다. -->
		<query id="las.contractmanager.selectCheckItem" isCamelCase="false">
		  <statement>
		    <![CDATA[	 
					 SELECT A.COMP_CD
			              , ISNULL(A.ITEM_CD, '') AS ITEM_CD
			              , A.DIS_YN
			              , B.CD_NM
			              , COUNT(A.ITEM_CD) OVER(ORDER BY A.ITEM_CD) AS NO
			              , ISNULL( (SELECT  MAX(C.ITEM_CD) 
                               FROM TN_CLM_REQU_ITEM C 
						      WHERE A.COMP_CD = C.COMP_CD
				                AND A.ITEM_CD = C.ITEM_CD
                                AND C.CNTRT_ID = :vo.cntrt_id
				            ),'X')  AS REA_ITEM_CD
					      , COUNT(A.ITEM_CD) OVER(ORDER BY A.ITEM_CD) AS CNT1
					      ,(SELECT  MAX(C.REMARK) 
                              FROM TN_CLM_REQU_ITEM C 
						     WHERE A.COMP_CD = C.COMP_CD
				               AND A.ITEM_CD = C.ITEM_CD
                               AND C.CNTRT_ID = :vo.cntrt_id
				            ) AS REMARK
				          ,(SELECT COUNT(*) 
                              FROM TN_CLM_REQU_ITEM C 
						     WHERE C.CNTRT_ID = :vo.cntrt_id
				            ) AS CNT
				         ,B.USEMAN_MNG_ITM1
				         ,( SELECT CHECK_LIST_YN
                              FROM TN_CLM_CONTRACT_MASTER
                             WHERE CNTRT_ID = :vo.cntrt_id ) AS CHECK_LIST_YN
                       FROM TB_COM_REQU_ITEM A
                       JOIN TB_COM_CD B ON A.ITEM_CD = B.CD
                      WHERE B.GRP_CD = 'RI01'
                        AND A.COMP_CD = :vo.session_comp_cd
                        AND A.DIS_YN = 'Y'
                        AND B.USE_YN = 'Y'
					 
			    
		    ]]>
		  </statement>
		</query>
		
	</queries>
</queryservice>