<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE queryservice PUBLIC "-//ANYFRAME//DTD QUERYSERVICE//EN"
"http://www.anyframejava.org/dtd/anyframe-core-query-mapping-3.1.dtd">

<queryservice>
    <queries>
    
	    <!-- 전결규정 목록화면의 사업부 selectbox : 2011.09.26 : dawn -->
		<query id="clm.admin.operdivCdList" isCamelCase="false">
		  <statement>
		    <![CDATA[
				SELECT ORGNZ_CD
				     , ORGNZ_GBN
				     , ORGNZ_NM
				     , UP_ORGNZ_CD
				  FROM TN_CLM_UNITORGNZ
				 WHERE ORGNZ_CD LIKE '%B%'
				   AND DEL_YN = 'N'
				 ORDER BY ORGNZ_CD
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 목록화면의 비즈니스 단계  selectbox : 2011.09.26 : dawn -->
		<query id="clm.admin.bizClsfcnList" isCamelCase="false">
		  <statement>
		    <![CDATA[
				SELECT UP_TYPE_CD
				     , TYPE_CD
				     , CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              	WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              	WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              	ELSE CD_NM_ENG
			           END CD_NM
				  FROM TN_COM_CONTRACTTYPE_CD
				 WHERE UP_TYPE_CD = 'T01'
				   AND USE_YN = 'Y'
				 ORDER BY TYPE_CD
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결 규정 사용자 권한 조회 : 2011.09.28 : dawn -->
		<query id="clm.admin.roleCdDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
		        SELECT A.USER_ID
				     , B.ROLE_CD
				  FROM TB_COM_USER A
				     , TB_COM_ROLE_USER B
				 WHERE A.USER_ID = B.USER_ID
				   AND B.SYS_CD  = :vo.sys_cd
				   AND A.USER_ID = :vo.session_user_id
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 목록 조회 : 2011.09.26 : dawn -->
		<query id="clm.admin.listDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
				SELECT * FROM (
				       SELECT rownum RN, t.*, COUNT(1) over() TOTAL_CNT
				         FROM(
				              SELECT A.SEQNO
				                   , A.OPERDIV_CD
				                   , (SELECT ORGNZ_NM
				                        FROM TN_CLM_UNITORGNZ
				                       WHERE ORGNZ_CD LIKE '%B%'
						                 AND ORGNZ_CD = A.OPERDIV_CD
				                         AND DEL_YN   = 'N') OPERDIV_NM
				                   , A.BIZ_CLSFCN
				                   , (SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              						  WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              					      WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              						  ELSE CD_NM_ENG
			                                 END CD_NM
				                        FROM TN_COM_CONTRACTTYPE_CD
				                       WHERE UP_TYPE_CD = 'T01'
				                         AND TYPE_CD    = A.BIZ_CLSFCN
				                         AND USE_YN     = 'Y') BIZ_CLSFCN_NM
				                   , A.DCD_CRTRN
				                   , A.DCD_AUTHMAN
				                   , (SELECT CD_NM FROM TB_COM_CD
				                       WHERE SYS_CD = 'LAS'
				                         AND GRP_CD = 'C033'
				                         AND CD     = A.DCD_AUTHMAN
				                         AND USE_YN = 'Y') DCD_AUTHMAN_NM
				                   , A.NOTE
				                   , A.RULE_CONT
				                   , A.REG_DT
				                   , A.REG_ID
				                   , A.REG_NM
				                   , A.MOD_DT
				                   , A.MOD_ID
				                   , A.MOD_NM
				                   , A.DEL_YN
				                   , A.DEL_DT
				                   , A.DEL_ID
				                   , A.DEL_NM
					        FROM TN_CLM_DCD_RULE A
					       WHERE A.DEL_YN = 'N'
					         #if(!$vo.srch_operdiv_cd.equals(""))
					             AND A.OPERDIV_CD = :vo.srch_operdiv_cd
					         #end
					         #if(!$vo.srch_biz_clsfcn.equals(""))
					             AND A.BIZ_CLSFCN = :vo.srch_biz_clsfcn
					         #end
					       ORDER BY A.SEQNO DESC
				             ) T
					 )
				 WHERE RN BETWEEN :vo.start_index AND :vo.end_index
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 등록화면의 전결권자  selectbox : 2011.09.27 : dawn -->
		<query id="clm.admin.dcdAuthmanList" isCamelCase="false">
		  <statement>
		    <![CDATA[
				SELECT CD, CD_NM FROM TB_COM_CD
                 WHERE SYS_CD = 'LAS'
                   AND GRP_CD = 'C033'
                   AND USE_YN = 'Y'
				 ORDER BY CD
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 등록 SEQNO max값 조회 : 2011.09.27 : dawn -->
		<query id="clm.admin.insertmaxSeqNoDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
				SELECT ISNULL(MAX(SEQNO)+1, 1) AS MAX_SEQNO
  				  FROM TN_CLM_DCD_RULE
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 등록 : 2011.09.27 : dawn -->
		<query id="clm.admin.insertDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
		        INSERT INTO TN_CLM_DCD_RULE
					 ( SEQNO
					 , OPERDIV_CD
					 , BIZ_CLSFCN
					 , DCD_CRTRN
					 , DCD_AUTHMAN
					 , NOTE
					 , RULE_CONT
					 , REG_DT
					 , REG_ID
					 , REG_NM
					 , DEL_YN
					 )VALUES(
					   :vo.seqno
					 , :vo.operdiv_cd
					 , :vo.biz_clsfcn
					 , :vo.dcd_crtrn
					 , :vo.dcd_authman
					 , :vo.note
					 , :vo.rule_cont
					 , GETDATE()
					 , :vo.reg_id
					 , :vo.reg_nm
					 , 'N'
					 )
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 상세 : 2011.09.27 : dawn -->
		<query id="clm.admin.detailDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
		        SELECT A.SEQNO
				     , A.OPERDIV_CD
				     , (SELECT ORGNZ_NM
				          FROM TN_CLM_UNITORGNZ
				         WHERE ORGNZ_CD LIKE '%B%'
				           AND ORGNZ_CD = A.OPERDIV_CD
				           AND DEL_YN   = 'N') OPERDIV_NM
				     , A.BIZ_CLSFCN
				     , (SELECT CASE WHEN :vo.session_user_locale = 'ko' THEN CD_NM
			              			WHEN :vo.session_user_locale = 'fr' THEN CD_NM_FRA
			              			WHEN :vo.session_user_locale = 'de' THEN CD_NM_DEU
			              			ELSE CD_NM_ENG
			              		END CD_NM
				          FROM TN_COM_CONTRACTTYPE_CD
				         WHERE UP_TYPE_CD = 'T01'
				           AND TYPE_CD    = A.BIZ_CLSFCN
				           AND USE_YN     = 'Y') BIZ_CLSFCN_NM
				     , A.DCD_CRTRN
				     , A.DCD_AUTHMAN
				     , (SELECT CD_NM FROM TB_COM_CD
				         WHERE SYS_CD = 'LAS'
				           AND GRP_CD = 'C033'
				           AND CD     = A.DCD_AUTHMAN
				           AND USE_YN = 'Y') DCD_AUTHMAN_NM
				     , A.NOTE
				     , A.RULE_CONT
				     , A.REG_DT
				     , A.REG_ID
				     , A.REG_NM
				     , A.MOD_DT
				     , A.MOD_ID
				     , A.MOD_NM
				     , A.DEL_YN
				     , A.DEL_DT
				     , A.DEL_ID
				     , A.DEL_NM
				  FROM TN_CLM_DCD_RULE A
				 WHERE A.SEQNO = :vo.seqno
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 수정 : 2011.09.28 : dawn -->
		<query id="clm.admin.modefyDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
		        UPDATE TN_CLM_DCD_RULE
				   SET OPERDIV_CD  = :vo.operdiv_cd
				     , BIZ_CLSFCN  = :vo.biz_clsfcn
				     , DCD_AUTHMAN = :vo.dcd_authman
				     , NOTE        = :vo.note
				     , MOD_DT      = GETDATE()
				     , MOD_ID      = :vo.mod_id
				     , MOD_NM      = :vo.mod_nm
				 WHERE SEQNO       = :vo.seqno
		    ]]>
		  </statement>
		</query>
		
		<!-- 전결규정 삭제 : 2011.09.28 : dawn -->
		<query id="clm.admin.deleteDecideArbitrarilyRe" isCamelCase="false">
		  <statement>
		    <![CDATA[
		        UPDATE TN_CLM_DCD_RULE
				   SET DEL_YN = 'Y'
				     , DEL_DT = GETDATE()
				     , DEL_ID = :vo.del_id
				     , DEL_NM = :vo.del_nm
				 WHERE SEQNO  = :vo.seqno
		    ]]>
		  </statement>
		</query>
		
    </queries>
</queryservice>